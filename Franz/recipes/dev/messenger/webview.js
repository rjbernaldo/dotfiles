'use strict';

module.exports = Franz => {
  const getMessages = function getMessages() {
    let count = document.querySelectorAll('._5fx8:not(._569x),._1ht3:not(._569x)').length;
    const messageRequestsElement = document.querySelector('._5nxf');
    if (messageRequestsElement) {
      count += parseInt(messageRequestsElement.innerHTML, 10);
    }

    Franz.setBadge(count);
  };

  Franz.loop(getMessages);

  if (typeof Franz.onNotify === 'function') {
    Franz.onNotify(notification => {
      if (typeof notification.title !== 'string') {
        notification.title = ((notification.title.props || {}).content || [])[0] || 'Messenger';
      }

      return notification;
    });
  }
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1lc3Nlbmdlci93ZWJ2aWV3LmpzIl0sIm5hbWVzIjpbIm1vZHVsZSIsImV4cG9ydHMiLCJGcmFueiIsImdldE1lc3NhZ2VzIiwiY291bnQiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJsZW5ndGgiLCJtZXNzYWdlUmVxdWVzdHNFbGVtZW50IiwicXVlcnlTZWxlY3RvciIsInBhcnNlSW50IiwiaW5uZXJIVE1MIiwic2V0QmFkZ2UiLCJsb29wIiwib25Ob3RpZnkiLCJub3RpZmljYXRpb24iLCJ0aXRsZSIsInByb3BzIiwiY29udGVudCJdLCJtYXBwaW5ncyI6Ijs7QUFBQUEsT0FBT0MsT0FBUCxHQUFrQkMsS0FBRCxJQUFXO0FBQzFCLFFBQU1DLGNBQWMsU0FBU0EsV0FBVCxHQUF1QjtBQUN6QyxRQUFJQyxRQUFRQyxTQUFTQyxnQkFBVCxDQUEwQix1Q0FBMUIsRUFBbUVDLE1BQS9FO0FBQ0EsVUFBTUMseUJBQXlCSCxTQUFTSSxhQUFULENBQXVCLFFBQXZCLENBQS9CO0FBQ0EsUUFBSUQsc0JBQUosRUFBNEI7QUFDMUJKLGVBQVNNLFNBQVNGLHVCQUF1QkcsU0FBaEMsRUFBMkMsRUFBM0MsQ0FBVDtBQUNEOztBQUVEVCxVQUFNVSxRQUFOLENBQWVSLEtBQWY7QUFDRCxHQVJEOztBQVVBRixRQUFNVyxJQUFOLENBQVdWLFdBQVg7O0FBRUEsTUFBSSxPQUFPRCxNQUFNWSxRQUFiLEtBQTBCLFVBQTlCLEVBQTBDO0FBQ3hDWixVQUFNWSxRQUFOLENBQWVDLGdCQUFnQjtBQUM3QixVQUFJLE9BQU9BLGFBQWFDLEtBQXBCLEtBQThCLFFBQWxDLEVBQTRDO0FBQzFDRCxxQkFBYUMsS0FBYixHQUFxQixDQUFDLENBQUNELGFBQWFDLEtBQWIsQ0FBbUJDLEtBQW5CLElBQTRCLEVBQTdCLEVBQWlDQyxPQUFqQyxJQUE0QyxFQUE3QyxFQUFpRCxDQUFqRCxLQUF1RCxXQUE1RTtBQUNEOztBQUVELGFBQU9ILFlBQVA7QUFDRCxLQU5EO0FBT0Q7QUFDRixDQXRCRCIsImZpbGUiOiJtZXNzZW5nZXIvd2Vidmlldy5qcyIsInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gKEZyYW56KSA9PiB7XG4gIGNvbnN0IGdldE1lc3NhZ2VzID0gZnVuY3Rpb24gZ2V0TWVzc2FnZXMoKSB7XG4gICAgbGV0IGNvdW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLl81Zng4Om5vdCguXzU2OXgpLC5fMWh0Mzpub3QoLl81Njl4KScpLmxlbmd0aDtcbiAgICBjb25zdCBtZXNzYWdlUmVxdWVzdHNFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLl81bnhmJyk7XG4gICAgaWYgKG1lc3NhZ2VSZXF1ZXN0c0VsZW1lbnQpIHtcbiAgICAgIGNvdW50ICs9IHBhcnNlSW50KG1lc3NhZ2VSZXF1ZXN0c0VsZW1lbnQuaW5uZXJIVE1MLCAxMCk7XG4gICAgfVxuXG4gICAgRnJhbnouc2V0QmFkZ2UoY291bnQpO1xuICB9O1xuXG4gIEZyYW56Lmxvb3AoZ2V0TWVzc2FnZXMpO1xuICBcbiAgaWYgKHR5cGVvZiBGcmFuei5vbk5vdGlmeSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgIEZyYW56Lm9uTm90aWZ5KG5vdGlmaWNhdGlvbiA9PiB7XG4gICAgICBpZiAodHlwZW9mIG5vdGlmaWNhdGlvbi50aXRsZSAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgbm90aWZpY2F0aW9uLnRpdGxlID0gKChub3RpZmljYXRpb24udGl0bGUucHJvcHMgfHwge30pLmNvbnRlbnQgfHwgW10pWzBdIHx8ICdNZXNzZW5nZXInO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gbm90aWZpY2F0aW9uO1xuICAgIH0pO1xuICB9XG59O1xuIl19