var pluginHost="https://www.tubebuddy.com";var pluginFileRoot="chrome-extension://EXTENSION_ID/";var loadLocalHTML=true;var DOMPurifyConfig={ADD_TAGS:["meta","iframe"],ADD_ATTR:["itemprop","content","src","target"],SAFE_FOR_JQUERY:true,SANITIZE_DOM:false,WHOLE_DOCUMENT:true};DOMPurify.addHook("uponSanitizeAttribute",function(e,t,i){if(e.nodeName.toLowerCase()==="img"&&t.attrName.toLowerCase()==="src"){t.forceKeepAttr=true}return e});var TBYouTubeApi=function(){var e=false;var t=false;var i;var o;var a;var n;var r;var s;var l;var d;var u;var c;var p;var b=[];var y=[];var h=null;var f=0;var m;var g;var v;var T;var w;var j;var Q=function(){N();e=true};var x=function(e){d=e;var t=TBGlobal.host+TBGlobal.apiUrls.youtubeApiGetTrendingVideos;TBExtension.Get(t,"TBGetTrendingVideos",null)};var B=function(e,t){var i="https://www.googleapis.com/youtube/v3/channels?part=statistics&id="+e+"&key="+TBGlobal.Profile().ApiKey;TBExtension.Get(i,t,{channelId:e})};var k=function(e,t){var i="https://www.googleapis.com/youtube/v3/playlists?part=id&id="+encodeURIComponent(e)+"&key="+TBGlobal.Profile().ApiKey;TBExtension.Get(i,t,{playlistIds:e})};var L=function(e,t,i){var o="https://www.googleapis.com/youtube/v3/channels?part=id%2Csnippet%2Cstatistics%2CcontentDetails&id="+e+"&key="+TBGlobal.Profile().ApiKey;TBExtension.Get(o,t,{channelId:e,unique:i})};var U=function(e,t,o){i=o;var a=TBGlobal.host+TBGlobal.apiUrls.youtubeApiGetVideo+"?videoId="+e+"&part="+t;TBExtension.Get(a,"TBGetVideo",null)};var C=function(e){p=e;var t=TBGlobal.host+TBGlobal.apiUrls.youtubeApiGetCurrentChannel;TBExtension.Get(t,"TBGetCurrentChannel",null)};function A(e,t){if(t.success){var o=JSON.parse(t.response);if(o){i(o)}else{i(null)}}else{i(null)}}var S=function(e,t,i,a,n,r,s){g=a;v=n;T=r;w=s;o=i;var l=TBGlobal.host+TBGlobal.apiUrls.youtubeApiGetChannelUploadPlaylist+"?channelId="+e;TBExtension.Get(l,"TBApiGetChannelUploadPlaylist",null)};var E=function(e,t,i,o){if(!t)t=TBUtilities.GetUrlEncoded("id,snippet,statistics,contentDetails");j=i;var a=TBGlobal.host+TBGlobal.apiUrls.youtubeApiGetChannel+"?channelId="+e+"&part="+t;TBExtension.Get(a,"TBGetChannelDetails",null)};function I(e,t){a=t;var i=TBGlobal.host+TBGlobal.apiUrls.youtubeApiGetApiSubscribers+"?pageToken="+e;TBExtension.Get(i,"TBGetSubscribers",e)}function G(e,t,i){m=i;var o=TBGlobal.host+TBGlobal.apiUrls.youtubeApiGetCommentsOnVideo+"?videoId="+e+"&max="+t;TBExtension.Get(o,"TBGetCommentsOnVideo",{videoId:e})}function R(e,t){if(t.success){var i=JSON.parse(t.response);if(i.Success){jQuery.each(i.Subscribers,function(e,t){if(t.ChannelId){if(TBUtilities.GetInArray(y,"channelId",t.ChannelId)==null){y.push(t)}}});if(y.length>=1e3){var o=y.slice(0,1e3);y.length=0;a(o,i.PageToken)}else{if(i.PageToken!=null&&i.PageToken!=""){I(i.PageToken,a)}else{a(y,null)}}}else{a(y,null)}}else{a(y,null)}}function P(e,t,i,o,a,d,u,c){n=o;r=a;s=d;l=c;var p=TBGlobal.host+TBGlobal.apiUrls.youtubeApiGetPageOfVideos+"?pageToken="+t+"&playlistId="+e+"&store="+(u==true);TBExtension.Get(p,"TBGetPageOfVideos",null)}function D(e,t){if(t.success){var i=JSON.parse(t.response);if(i.Success){jQuery.each(i.PlaylistItems,function(e,t){if(l){if(t.snippet.resourceId.videoId!=l){b.push(t)}}else{b.push(t)}if(s!=null){if(b.length>=s){i.PageToken=null;return false}}});if(r!=null){r({totalCount:i.TotalResults,loaded:b.length})}TBUtilities.Log(i.PageToken);if(i.PageToken!=null&&i.PageToken!=""){h=i.PageToken;P(i.PlaylistId,i.PageToken,null,n,r,s,i.Store,l)}else{n(b)}}else{n(b)}}else{n(b)}}function V(e,t,i,o){u=i;c=o;var a=TBGlobal.host+TBGlobal.apiUrls.youtubeApiGetChannelVideoSearch+"?pageToken="+t+"&query="+encodeURIComponent(e);TBExtension.Get(a,"TBGetChannelVideoSearch","")}function _(e,t){if(t.success){var i=JSON.parse(t.response);if(i.Success){jQuery.each(i.Videos,function(e,t){b.push(t)});if(c!=null){c({totalCount:i.TotalResults,loaded:b.length})}if(i.PageToken!=null&&i.PageToken!=""){h=i.PageToken;V(i.Query,i.PageToken,u,c)}else{u(b)}}else{u(b)}}else{u(b)}}function M(e,t){if(t.success){var i=JSON.parse(t.response);m(i)}}function O(e,t){if(t.success){var i=JSON.parse(t.response);p(i)}else{p(null)}}function F(e,t){if(t.success){var i=JSON.parse(t.response);d(i)}else{d(null)}}var N=function(){jQuery(document.body).on("TBGetSubscribers",function(e,t){TBYouTubeApi.GetChannelSubscribersCallback(e,t)});jQuery(document.body).on("TBApiGetChannelUploadPlaylist",function(e,t){TBYouTubeApi.GetChannelUploadPlaylistCallback(e,t)});jQuery(document.body).on("TBGetChannelDetails",function(e,t){TBYouTubeApi.GetChannelDetailsCallback(e,t)});jQuery(document.body).on("TBGetPageOfVideos",function(e,t){TBYouTubeApi.GetPageOfVideosCallback(e,t)});jQuery(document.body).on("TBGetChannelVideoSearch",function(e,t){TBYouTubeApi.GetChannelVideoSearchCallback(e,t)});jQuery(document.body).on("TBGetVideo",function(e,t){TBYouTubeApi.GetVideoCallback(e,t)});jQuery(document.body).on("TBGetCommentsOnVideo",function(e,t){TBYouTubeApi.GetVideoCommentsCallback(e,t)});jQuery(document.body).on("TBGetCurrentChannel",function(e,t){TBYouTubeApi.GetCurrentChannelCallback(e,t)});jQuery(document.body).on("TBGetTrendingVideos",function(e,t){TBYouTubeApi.GetTrendingVideosCallback(e,t)})};return{Initialize:function(){if(!e)Q()},GetTrendingVideos:function(t){if(!e){Q()}return x(t)},GetVideoComments:function(t,i,o){if(!e){Q()}return G(t,i,o)},GetChannelStatisticsNoApiClient:function(e,t){return B(e,t)},GetChannelSubscribersCallback:function(e,t){return R(e,t)},GetPageOfVideosCallback:function(e,t){return D(e,t)},GetVideoCallback:function(e,t){return A(e,t)},GetChannelVideoSearchCallback:function(e,t){return _(e,t)},GetVideoCommentsCallback:function(e,t){return M(e,t)},GetCurrentChannelCallback:function(e,t){return O(e,t)},GetTrendingVideosCallback:function(e,t){return F(e,t)},GetChannelSnippetContentDetailsNoApiClient:function(e,t,i){return L(e,t,i)},GetPlaylistsNoApiClient:function(e,t){return k(e,t)},GetChannelSubscribers:function(t,i){if(!e){Q()}I(t,i)},GetCurrentChannel:function(t){if(!e){Q()}C(t)},GetChannelDetails:function(e,t,i,o){E(e,t,i,o)},GetChannelVideos:function(e,t,i,o,a,n,r){b=[];S(e,t,i,o,a,n,r)},GetChannelUploadPlaylistCallback:function(e,t){TBUtilities.Log("Got Response");if(t!=null&&t.response!=null){b=[];loggedInUploadPlaylistId=t.response;loggedInUploadPlaylistId=TBUtilities.ReplaceAll(loggedInUploadPlaylistId,'"',"");P(loggedInUploadPlaylistId,null,null,o,g,v,T,w)}else{o(null)}},GetChannelDetailsCallback:function(e,t){var i=JSON.parse(t.response);j(i)},GetChannelVideosSearch:function(t,i,o,a){b=[];if(!e){Q()}V(t,i,o,a)},GetPlaylistVideos:function(t,i,o,a){b=[];if(!e){Q()}P(t,null,i,o,a)},GetVideoDetails:function(t,i,o){if(!e){Q()}U(t,i,o)}}}();var TBUtilities=function(){var e=0;var t=[];var o=null;var a=null;var n="header-";var r='["asshole", "bitch", "blowjob", "cock", "cocksucker", "cunt", "piss", "fuck", "fuck you", "fucking", "motherfucker", "nigger", "pussy", "shit", "slut", "whore"]';var l=' window["ytInitialData"] = {"responseContext":';var d='window["ytInitialData"] = JSON.parse("';var u='window["ytInitialPlayerResponse"] = {"responseContext":';var c='window["ytInitialPlayerResponse"] = JSON.parse("';var p=function(t){if(TBGlobal.host.indexOf("www.tubebuddy.com")==-1){$("body").prepend("<span style='background-color:black; color:white; z-index: 9999999999999; font-size:16px; position:absolute; left:0; top:"+e++*18+"px; line-height:17px; border:solid 1px white;'>"+t+"</span>")}};var b=function(){if(a==null){a=JSON.parse(r)}return a};var y=function(e,t,i){var o=h();var a='<label class="tb-checkbox" for="'+o+'"><input type="checkbox" id="'+o+'" '+i+' class="'+t+'"><span class="tb-checkbox__indicator"></span></label >';return a};var h=function(e,t){var i="tb-";var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(var a=0;a<5;a++)i+=o.charAt(Math.floor(Math.random()*o.length));return i};var f=function(e,t){var i=m();var o="https://clients1.google.com/complete/search?client=youtube&hl=en&gl=us&gs_rn=23&gs_ri=youtube&tok="+i+"&ds=yt&cp=15&gs_id=a&q="+encodeURIComponent(e)+"&callback=google.sbox.p50&gs_gbg=3no8d";TBExtension.Get(o,function(i,o,a){var n=[];try{if(i){var r=a.indexOf("[");var s=a.indexOf("{");var o=a.substring(r,s);o=TBUtilities.ReplaceAll(o,'"',"'");var l=o.match(/'[^']*'/g);var d=0;var u=0;jQuery.each(l,function(t,i){i=TBUtilities.ReplaceAll(i,"'","").trim();i=TBUtilities.ReplaceAll(i,"\\u0027","'").trim();i=TBUtilities.ReplaceAll(i,"'","'").trim();var o=TBUtilities.GetInArray(n,null,i);if(o==null){if(i.toLowerCase()!=e.toLowerCase()){n.push(i)}}})}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyTagExplorer] CRTBTagExplorerGetYouTubeSuggest"})}finally{t(n)}},null)};var m=function(){var e=jQuery("body")[0].outerHTML;var t=e.indexOf('PSUGGEST_TOKEN":"')+'PSUGGEST_TOKEN":"'.length;var i=e.indexOf('"',t);var o=e.substring(t,i);return o};var g=function(e){var t=false;try{e=e.toLowerCase();if(a==null){a=JSON.parse(r)}var i=e.split(" ");for(var o=0;o<i.length;o++){var n=v(a,i[o]);if(n>-1){t=true;console.log(i[o])}}}catch(e){TBUtilities.Log(e)}return t};var v=function(e,t){var i=t.toLowerCase();var o;for(o=0;o<e.length;o++){if(e[o].toString()===i){return o}}return-1};var T=function(e){if(o==null){if(TBGlobal.host.indexOf("localhost")>-1||TBGlobal.host.indexOf("staging")>-1){o=true}else{o=false}}if(!o){var i=TBUtilities.GetCookie("forceDebugLocal");if(i&&i.length>0){o=true}}if(o){try{var a=Q(e);console.log(a)}catch(e){}}else{var a=Q(e);t.push(a)}};var w=function(){return t.join("\n")};var Q=function(e){var t="";if(e!==null&&typeof e==="object"){t=x()+" - "+JSON.stringify(e)}else{t=x()+" - "+e}return t};var x=function(){var e=new Date;var t=e.getFullYear();var i=e.getMonth()+1;var o=e.getDate();var a=e.getHours();var n=e.getMinutes();var r=e.getSeconds();return t+"-"+i+"-"+o+" "+a+":"+n+":"+r};var B=function(e,t,i){var o,a=e.length>t;i=i||true;e=a?e.substr(0,t-1):e;o=e.search(/\s/)===-1?true:false;if(!o){e=i&&a?e.substr(0,e.lastIndexOf(" ")):e}return a?e+"...":e};var k=function(e){if(TBGlobal.host.indexOf("www.tubebuddy.com")==-1){p(JSON.stringify(e))}};var L=function(e,t,i){var o;if(i){var a=new Date;a.setTime(a.getTime()+i*24*60*60*1e3);o="; expires="+a.toGMTString()}else{o=""}document.cookie=escape(e)+"="+escape(t)+o+"; path=/"};var U=function(e){var t=escape(e)+"=";var i=document.cookie.split(";");for(var o=0;o<i.length;o++){var a=i[o];while(a.charAt(0)===" ")a=a.substring(1,a.length);if(a.indexOf(t)===0)return unescape(a.substring(t.length,a.length))}return null};var C=function(e){if(e==" ")return"/s/";return e.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")};var A=function(e,t,i,o,a){if(e){e=e.toString().replace(/\u00A0/," ");var n="";if(a===true)n="\\b";if(o===true)return e.toString().replace(new RegExp(n+C(t)+n,"ig"),i);else return e.toString().replace(new RegExp(n+C(t)+n,"g"),i)}else{return e}};var S=function(){var e=new Date;var t=e.getHours();var i=e.getMinutes();var o=t>=12?"pm":"am";t=t%12;t=t?t:12;i=i<10?"0"+i:i;var a=t+":"+i+" "+o;return a};var E=function(e,t,i,o,a){if(e){e=e.toString().replace(/\u00A0/," ");var n="";var r="";if(o===true){n="\\b";r="\\b"}if(a===true){n="^";r="$"}var s;if(i===true)s=e.match(new RegExp(n+C(t)+r,"ig"));else s=e.match(new RegExp(n+C(t)+r,"g"));if(s==null)return 0;else return s.length}else{return 0}};var I=function(e,t,o){for(i=0;i<e.length;i++){if(t!=null){if(e[i][t]==o){return e[i]}}else{if(e[i]==o){return e[i]}}}};var G=function(e,t,i,o,a){e.sort((e,n)=>parseFloat(e[t])>parseFloat(n[t])?!i?1:-1:parseFloat(e[t])<parseFloat(n[t])?!i?-1:1:parseFloat(e[o])<parseFloat(n[o])?a?1:-1:!a?1:-1)};var R=function(e,t,i,o){if(o)e.sort((e,o)=>parseFloat(e[t])>parseFloat(o[t])?!i?1:-1:!i?-1:1);else e.sort((e,o)=>e[t]>o[t]?!i?1:-1:!i?-1:1)};var P=function(e,t,o){for(i=0;i<e.length;i++){if(e[i][t]==o){return e.splice(i,1)}}};var D=function(){var e="-";function t(){return((1+Math.random())*65536|0).toString(16).substring(1)}return t()+t()+e+t()+e+t()+e+t()+e+t()+t()+t()};var V=function(e){if(e==null)return false;var t=e.indexOf("@");var i=e.lastIndexOf(".");if(t<1||i<t+2||i+2>=e.length)return false;else return true};var _=function(e){if(!e)return false;var t=/(http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/;return t.test(e)};var M=function(e){if(e==null||isNaN(e))return"-99999";var t=e.toString().split(".");t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,",");return t.join(".")};var O=function(e,t,i){if(typeof t!="undefined"&&t!=null){if(e>=1e10)return(e/1e9).toFixed(t)+F("B",i);if(e>=1e9)return(e/1e9).toFixed(t)+F("B",i);if(e>=1e8)return(e/1e6).toFixed(t)+F("M",i);if(e>=1e7)return(e/1e6).toFixed(t)+F("M",i);if(e>=1e6)return(e/1e6).toFixed(t)+F("M",i);if(e>=1e5)return(e/1e3).toFixed(t)+F("K",i);if(e>=1e4)return(e/1e3).toFixed(t)+F("K",i);if(e>=1e3)return(e/1e3).toFixed(t)+F("K",i)}else{if(e>=1e10)return(e/1e9).toFixed(1)+F("B",i);if(e>=1e9)return(e/1e9).toFixed(2)+F("B",i);if(e>=1e8)return(e/1e6).toFixed(0)+F("M",i);if(e>=1e7)return(e/1e6).toFixed(1)+F("M",i);if(e>=1e6)return(e/1e6).toFixed(2)+F("M",i);if(e>=1e5)return(e/1e3).toFixed(0)+F("K",i);if(e>=1e4)return(e/1e3).toFixed(1)+F("K",i);if(e>=1e3)return(e/1e3).toFixed(2)+F("K",i)}return M(e)};var F=function(e,t){var i=e;if(t){i="<span class="+t+">"+e+"</span>"}return i};var N=function(e,t,o,a){t=isNaN(t=Math.abs(t))?2:t,o=o==undefined?".":o,a=a==undefined?",":a,s=e<0?"-":"",i=parseInt(e=Math.abs(+e||0).toFixed(t))+"",j=(j=i.length)>3?j%3:0;return s+(j?i.substr(0,j)+a:"")+i.substr(j).replace(/(\d{3})(?=\d)/g,"$1"+a)+(t?o+Math.abs(e-i).toFixed(t).slice(2):"")};var Y=function(e,t,i){var o=jQuery.ajax({type:"GET",url:e,datatype:"json",contentType:"application/json"});o.done(function(e){t(e)});o.fail(function(e,t){if(i){i(e,t)}})};var H=function(e,t,i,o){var a=jQuery.ajax({type:"POST",url:e,datatype:"json",data:JSON.stringify(t),contentType:"application/json"});a.done(function(e){i(e)});a.fail(function(e,t){if(o){o(e,t)}})};var z=function(e){var t=window.location.search.substring(1);var i=t.split("&");for(var o=0;o<i.length;o++){var a=i[o].split("=");if(a[0]==e){return a[1]}}try{TBUtilities.Log("In getUrlParameter "+window.location.href);if(window.location.href.indexOf("studio.youtube.com")>=0){TBUtilities.Log("In getUrlParameter2");if(window.location.href.indexOf("/#/")>0){return null}var n=window.location.href.indexOf("#");var r=window.location.href.substring("https://studio.youtube.com/?".length,n);var i=r.split("&");for(var o=0;o<i.length;o++){var a=i[o].split("=");if(a[0]==e){TBUtilities.Log("In getUrlParameter FOUND "+a[1]);return a[1]}}TBUtilities.Log("In getUrlParameter none found")}}catch(e){}return null};var W=function(e){if(e==null||e=="")return[];return e.match(/([a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9._-]+)/gi)};var q=function(e,t){var i="";for(var o=0;o<e.length;o++){var a=e.charCodeAt(o);if(a>=65&&a<=90)i+=String.fromCharCode((a-65+t)%26+65);else if(a>=97&&a<=122)i+=String.fromCharCode((a-97+t)%26+97);else i+=e.charAt(o)}return i};var X=function(e){var t=new moment(e);return t.format("MMM Do YYYY")};var K=function(e){e=A(e,"____-_-___","@");e=A(e,"__-__-__-__",".");e=A(e,"_|_-|__","{");e=A(e,"_--|_|__","}");e=A(e,"|-|_|_-_",":");return q(e,(26-10)%26)};var J=function(e,t,i){try{if(e==null)e={};var o={YouTubeChannelId:TBGlobal.CurrentChannelId(),ClientActionDate:(new Date).toISOString(),ChannelActionType:t,ToolId:i};$.extend(e,o);var a=TBGlobal.host+"/api/channelaction/add";TBExtension.Post(a,JSON.stringify(e),"notused",null,{contentType:"application/json; charset=utf-8"})}catch(e){ee({exception:e,location:"TBUtilities.addAction"})}};var Z=function(e,t,i){try{if(e==null)e={};var o={ActivityLogType:t,ClientActionDate:(new Date).toISOString(),ToolId:i,YouTubeChannelId:TBGlobal.CurrentChannelId()};$.extend(e,o);var a=TBGlobal.host+"/api/activitylog/add";TBExtension.Post(a,jQuery.param(e),null,null,{contentType:"application/x-www-form-urlencoded; charset=UTF-8"})}catch(e){ee({exception:e,location:"TBUtilities.addAction"})}};var ee=function(e){try{var t="unknown";try{t=TBExtension.GetExtensionVersion()}catch(e){}T(e);if(e!=null&&e.Exception!=null){var i=false;if(e.SkipSerialization){i=true}if(i==false){var o={};Object.getOwnPropertyNames(e.Exception).forEach(function(t){o[t]=e.Exception[t]});e.Exception=o}}var a=jQuery.param({UserAgent:navigator.userAgent,CookiesEnabled:navigator.cookieEnabled,BrowserLanguage:navigator.language,Details:"Extension version: "+t+" "+JSON.stringify(e),ClientDateLogged:(new Date).toISOString(),YouTubeChannelId:TBGlobal.CurrentChannelId()});TBUtilities.AddDebugObject(e);var n=TBGlobal.host+"/api/clienterror/add";TBExtension.Post(n,a,"TBClientError",null,{contentType:"application/x-www-form-urlencoded; charset=UTF-8"})}catch(e){console.log(ex)}};var te=function(e){try{var t="unknown";try{t=TBExtension.GetExtensionVersion()}catch(e){}T(e);var i=jQuery.param({UserAgent:navigator.userAgent,CookiesEnabled:navigator.cookieEnabled,BrowserLanguage:navigator.language,Details:"Extension version: "+t+" "+JSON.stringify(e),ClientDateLogged:(new Date).toISOString(),YouTubeChannelId:TBGlobal.CurrentChannelId()});TBUtilities.AddDebugObject(e);var o=TBGlobal.host+"/api/clienterror/add";TBExtension.Post(o,i,null,null,{contentType:"application/x-www-form-urlencoded; charset=UTF-8"})}catch(e){}};var te=function(e){try{var t="unknown";try{t=TBExtension.GetExtensionVersion()}catch(e){}T(e);var i=jQuery.param({UserAgent:navigator.userAgent,CookiesEnabled:navigator.cookieEnabled,BrowserLanguage:navigator.language,Details:"Extension version: "+t+" "+JSON.stringify(e),ClientDateLogged:(new Date).toISOString(),YouTubeChannelId:TBGlobal.CurrentChannelId()});TBUtilities.AddDebugObject(e);var o=TBGlobal.host+"/api/clienterror/add";TBExtension.Post(o,i,null,null,{contentType:"application/x-www-form-urlencoded; charset=UTF-8"})}catch(e){}};var ie=function(e){return jQuery("<div/>").text(e).html()};var oe=function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")};var ae=function(e){return e===null||e.match(/^ *$/)!==null};var ne=function(e,t,i){try{if(!i){i="tb-highlight"}var o={className:i,accuracy:{value:"exactly",limiters:[",","."]},separateWordSearch:false};var a=jQuery(t);a.mark(e,o);t=a[0].outerHTML}catch(e){TBUtilities.LogError(e)}return t};var re=function(e){return encodeURIComponent(e)};var se=function(e){return decodeURIComponent(e)};var le=function(e){return e.replace(/[|&;$%@"<>()+,]/g,"")};var de=function(e,t){var i="$";if(t){i="<span class="+t+">$</span >"}if(e==0)return i+"0.00";if(e.toString().indexOf(".")>-1){var o=e.toString().split(".");o[0]=o[0].replace(/\B(?=(\d{3})+(?!\d))/g,",");o[1]=(o[1]+"00").substr(0,2);return i+o[0]+"."+o[1]}else{return i+e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")+".00"}};var ue=function(e,t){if(!t)t=50;try{var i=parseInt(e.text());if(isNaN(i))i=0;var o=parseInt(e.attr("data-auto-count"));if(i<o){if(o-i>15)e.text(i+3);else e.text(i+1);setTimeout(TBUtilities.AutoIncrementCount,t,e)}}catch(e){TBUtilities.Log(e.message)}};var ce=function(e){var t=e%1e3;var i=Math.floor(e/1e3%60);var o=Math.floor(e/(60*1e3)%60);var a=Math.floor(e/(1e3*60*60)%24);return a+"h:"+o+"m:"+i+"s"};var pe=function e(t){return t.replace(/\\u[\dABCDEFabcdef][\dABCDEFabcdef][\dABCDEFabcdef][\dABCDEFabcdef]/g,function(e){return String.fromCharCode(parseInt(e.replace(/\\u/g,""),16))})};var be=function(e){if(/[^a-zA-Z0-9]/.test(e)){return false}return true};var ye=function(e,t){if(t=="js"){var i=document.createElement("script");i.setAttribute("type","text/javascript");i.setAttribute("src",e)}else if(t=="css"){var i=document.createElement("link");i.setAttribute("rel","stylesheet");i.setAttribute("type","text/css");i.setAttribute("href",e)}if(typeof i!="undefined")document.getElementsByTagName("head")[0].appendChild(i)};var he=function(e,t){var i=ge();if(t){alertify.alert(e,t).setHeader(i)}else{alertify.alert(e).setHeader(i)}};var fe=function(e,t,i){var o=ge();return alertify.confirm(e,t,i).setHeader(o).set({labels:{ok:"OK",cancel:"Cancel"}})};var me=function(e,t,i,o){var a=ge();alertify.prompt(e,t,i,o).setHeader(a)};var ge=function(){var e="<img style='height:20px;' src='https://www.tubebuddy.com/images/branding/logo_small.png'></img>";return e};var ve=function(e){var t=/^.*(youtu\.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/;var i=e.match(t);if(i&&i[2].length==11){return i[2]}else{return null}};var Te=function(e){var t=new RegExp("[&?]list=([a-z0-9_-]+)","i");var i=t.exec(e);if(i&&i[1].length>0){return i[1]}else{return null}};var we=function(e,t,i){var o=e.indexOf("#");var a=o===-1?"":e.substr(o);e=o===-1?e:e.substr(0,o);var n=new RegExp("([?&])"+t+"=.*?(&|$)","i");var r=e.indexOf("?")!==-1?"&":"?";if(!i){e=e.replace(new RegExp("([?&]?)"+t+"=[^&]*","i"),"");if(e.slice(-1)==="?"){e=e.slice(0,-1)}if(e.indexOf("?")===-1)e=e.replace(/&/,"?")}else if(e.match(n)){e=e.replace(n,"$1"+t+"="+i+"$2")}else{e=e+r+t+"="+i}return e+a};var je=function(e){if(TBExtension.GetType()=="safari"){var t=safari.extension.baseURI.replace(/\/$/,"");e=A(e,"{PLUGIN_FILE_ROOT}",t,true,false)}else{var t=chrome.extension.getURL("").replace(/\/$/,"");e=A(e,"{PLUGIN_FILE_ROOT}",t,true,false)}return e};var Qe=function(e,t){if(!t)t=window.location.href;e=e.replace(/[\[\]]/g,"\\$&");var i=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),o=i.exec(t);if(!o)return null;if(!o[2])return"";return decodeURIComponent(o[2].replace(/\+/g," "))};var xe=function(){try{var e=window.navigator.userAgent,t=window.navigator.platform,i=["Macintosh","MacIntel","MacPPC","Mac68K"],o=["Win32","Win64","Windows","WinCE"],a=["iPhone","iPad","iPod"],n=null;if(i.indexOf(t)!==-1){n="Mac OS"}else if(a.indexOf(t)!==-1){n="iOS"}else if(o.indexOf(t)!==-1){n="Windows"}else if(/Android/.test(e)){n="Android"}else if(!n&&/Linux/.test(t)){n="Linux"}return n}catch(e){return"Unknown"}};var Be=function(e){var t=TBGlobal.GetYouTubeUIFromHtml(e);var i=null;switch(t){case"studio":case"material":{var o='"XSRF_TOKEN":"';var a=e.indexOf(o);var n=e.substring(a+o.length,e.length);var r=n.indexOf('","');i=n.substring(0,r);if(i.length>=300){r=i.indexOf('"});<');i=n.substring(0,r)}break}case"default":{var o="'XSRF_TOKEN':";var a=e.indexOf(o);var n=e.substring(a+o.length,e.length);var r=n.indexOf('",');i=n.substring(0,r);i=i.replace(/['"]+/g,"").trim();break}}return i};var ke=function(){return new Promise(function(e,t){var i=jQuery("body")[0].outerHTML;var o=i.indexOf('PSUGGEST_TOKEN":"');if(o!==-1){o+=+'PSUGGEST_TOKEN":"'.length;var a=i.indexOf('"',o);var n=i.substring(o,a);e(n)}else{TBExtension.Get("https://www.youtube.com/",function(i,o,a){if(i===true){var n=a;var r=n.indexOf('PSUGGEST_TOKEN":"')+'PSUGGEST_TOKEN":"'.length;var s=n.indexOf('"',r);var l=n.substring(r,s);e(l)}else{t("error getting autocomplete")}},null,null)}})};var Le=function(e){return new Promise(function(t,i){TBUtilities.Log("getVideoTopics");var o=0;ke().then(function(i){var a=[];a.push("how "+e);a.push("how to "+e);a.push("why "+e);a.push("what "+e);a.push("where "+e);a.push("did "+e);a.push("can "+e);a.push("do "+e);a.push("does "+e);a.push("is "+e);a.push("top "+e);a.push("top 10"+e);var n=[];jQuery.each(a,function(e,r){TubeBuddyYouTubeActions.GetYouTubeAutoComplete(i,r,function(e){o++;jQuery.each(e,function(e,t){var i=TBUtilities.GetInArray(n,null,t);if(!i){n.push(t)}});if(o>=a.length){t(n)}})})})})};var Ue=function(e){var t='"INNERTUBE_API_KEY":"';var i=e.indexOf(t);var o=e.substring(i+t.length,e.length);var a=o.indexOf('","');token=o.substring(0,a);if(token.length>45){a=token.indexOf('"})');token=token.substring(0,a)}return token};var Ce=function(e){var t='"DELEGATED_SESSION_ID":"';var i=e.indexOf(t);if(i>=0){var o=e.substring(i+t.length,e.length);var a=o.indexOf('","');token=o.substring(0,a);if(isNaN(token)===true){a=o.indexOf('"}');token=o.substring(0,a)}return token}else{return null}};var Ae=function(e){var t='"INNERTUBE_CONTEXT_CLIENT_VERSION":"';var i=e.indexOf(t);var o=e.substring(i+t.length,e.length);var a=o.indexOf('","');token=o.substring(0,a);return token};var Se=function(e){var t='"INNERTUBE_CONTEXT_CLIENT_NAME":';var i=e.indexOf(t);var o=e.substring(i+t.length,e.length);var a=o.indexOf(",");token=o.substring(0,a);if(isNaN(token)===true){a=o.indexOf("}");token=o.substring(0,a)}return parseInt(token)};var Ee=function(e){var t='"INNERTUBE_CONTEXT_GL":"';var i=e.indexOf(t);var o=e.substring(i+t.length,e.length);var a=o.indexOf('","');token=o.substring(0,a);return token};var Ie=function(e){var t='"INNERTUBE_CONTEXT_HL":"';var i=e.indexOf(t);var o=e.substring(i+t.length,e.length);var a=o.indexOf('","');token=o.substring(0,a);if(token.length>10){a=token.indexOf('"})');token=token.substring(0,a)}return token};var Ge=function(e){return new Promise(function(t,i){TBUtilities.Log("processHeader");var o=lscache.get(n+TBGlobal.CurrentChannelId());if(o!==null){TBUtilities.Log("processHeader - cache found");e.header=o;t(e)}else{let o=TBUtilities.GetCookie("SS"+"ID");let a=TBUtilities.GetCookie("SA"+"PI"+"SI"+"D");let r=TBUtilities.GetCookie("S"+"ID");TBUtilities.Log("processHeader - getting string");TBExtension.Get(TBGlobal.host+"/api/youtubechannel/processstring?v="+o+"&f=h&s="+a+"&t="+r,function(o,a,r){r=TBUtilities.ReplaceAll(r,'"',"");e.header=r;if(o===true){lscache.set(n+TBGlobal.CurrentChannelId(),r,1);t(e)}else{i("failed to process header")}},null,null,null)}})};var Re=function(e){"use strict";var t,i;if(e.split(",")[0].indexOf("base64")!==-1){t=atob(e.split(",")[1])}else{t=decodeURI(e.split(",")[1])}i=e.split(",")[0].split(":")[1].split(";")[0];var o=new Array;for(var a=0;a<t.length;a++){o[a]=t.charCodeAt(a)}return new Blob([new Uint8Array(o)],{type:i})};var Pe=function(e){var t=TBGlobal.GetYouTubeUI();if(e.indexOf('window["ytInitialData"] = ')!=-1){t="material"}else{t="default"}var i=null;try{switch(t){case"studio":case"material":{var o=Me(e);var a=-1;for(var n=0;n<o.contents.twoColumnWatchNextResults.results.results.contents.length;n++){if(o.contents.twoColumnWatchNextResults.results.results.contents[n].itemSectionRenderer){a=n;break}}if(a!=-1){i=o.contents.twoColumnWatchNextResults.results.results.contents[a].itemSectionRenderer.continuations["0"].nextContinuationData.continuation}break}case"default":{var r=e.indexOf("COMMENTS_TOKEN");var s=e.indexOf('"',r);var l=e.indexOf('"',s+1);i=e.substring(s+1,l);break}}}catch(e){TBUtilities.Log(e)}return i};var De=function(e){var t=TBGlobal.GetYouTubeUI();if(e.indexOf('window["ytInitialData"] = ')!=-1){t="material"}else{t="default"}var i=null;switch(t){case"studio":case"material":{var o='"ID_TOKEN":"';var a=e.indexOf(o);var n=e.substring(a+o.length,e.length);var r=n.indexOf('","');i=n.substring(0,r);break}case"default":{break}}return i};var Ve=function(e){var t=TBGlobal.GetYouTubeUI();if(e.indexOf('window["ytInitialData"] = ')!=-1){t="material"}else{t="default"}var o=null;switch(t){case"studio":case"material":{var a=Me(e);jQuery.each(a.responseContext.serviceTrackingParams,function(e,t){if(t.service&&t.service=="CSI"){for(i=0;i<t.params.length;i++){if(t.params[i].key=="cver"){o=t.params[i].value}}}});break}case"default":{break}}return o};var _e=function(e){var t=null;try{jQuery.each(e,function(e,i){jQuery.each(i.itemSectionRenderer.contents,function(i,o){if(o.shelfRenderer||o.videoRenderer||o.channelRenderer){t=e;return false}});if(t!=null){return false}})}catch(e){TBUtilities.Log(e)}return t};var Me=function(e){let t=e.indexOf(l);let i=null;if(t!=-1){t=t+26;let o=e.substring(t,e.length);let a=o.indexOf("};")+1;let n=o.substring(0,a);i=jQuery.parseJSON(n)}else if(e.indexOf(d)!=-1){t=e.indexOf(d);t=t+d.length-1;let o=e.substring(t,e.length);let a=o.indexOf('");');let n=o.substring(0,a+1);i=JSON.parse(JSON.parse(n))}return i};var Oe=function(e){var t="window.chunkedPrefetchResolvers['id-1'].resolve(";var i=e.indexOf(t);var o=e.substring(i+t.length,e.length);var a=o.indexOf(");");token=o.substring(0,a);json=JSON.parse(token);return json};var Fe=function(e){let t=e.indexOf(u);let i=null;if(t!=-1){t=t+36;let o=e.substring(t,e.length);let a=o.indexOf("};")+1;let n=o.substring(0,a);i=jQuery.parseJSON(n)}else if(e.indexOf(c)!=-1){let t=e.indexOf(c);t=t+c.length-1;let o=e.substring(t,e.length);let a=o.indexOf('");');let n=o.substring(0,a+1);i=JSON.parse(JSON.parse(n))}return i};var Ne=function(e){return encodeURIComponent(e).replace(/[!'()*]/g,escape)};var Ye=function(e){var t=0;jQuery.each(e,function(e,i){var o=i.trim();o=o.replace(/\s/,"---");t+=o.length;t+=1});if(t>0)t--;return t};var He=function(e){try{if(TBExtension.GetType()==="chrome"&&TBGlobal.Profile()!==null&&TBGlobal.Profile().EnablePreview===true){chrome.runtime.sendMessage({type:"tb-corb-record",data:{url:e,host:TBGlobal.host}})}}catch(e){console.log(e)}};var ze=function(e,t){var i='"https://www.youtube.com/watch?v='+e+'" OR "https://youtu.be/'+e+'"';var o="https://twitter.com/i/search/timeline?f=tweets&vertical=default&src=tyah&reset_error_state=false&q="+TBUtilities.GetUrlEncoded(i);try{TBExtension.Get(o,function(e,i,o){if(e===true){var a=0;try{if(o&&o.new_latent_count>0){a=o.new_latent_count}}catch(e){TBUtilities.LogError(e)}t(true,a)}else{TBUtilities.LogError("getVideoTweetCount lookup failed");t(false)}},null,{credentials:false,dataType:"json",headers:{"Upgrade-Insecure-Requests":1,"X-YouTube-Client-Name":1,Accept:"application/json, text/javascript, */*; q=0.01","X-Twitter-Active-User":"yes","X-Requested-With":"XMLHttpRequest"}})}catch(e){TBUtilities.LogError(e);t(false)}};var We=function(e){return new Promise(function(t,i){let o={keyword:e,autoCompleteTags:[],keywordMisspellings:[],searchResults:null,searchResultTags:[],suggestions:[]};$e(o).then(tt).then(Ze).then(et).then(function(e){var i=qe(e);t(i)}).catch(function(e){TBUtilities.Log(e);i(e)})})};var qe=function(e){try{let t={};for(let i=0;i<e.searchResultTags.length;++i){if(!t[e.searchResultTags[i]])t[e.searchResultTags[i]]=0;++t[e.searchResultTags[i]]}let i=Object.keys(t).map(function(e){return[e,this[e]]},t).sort(function(e,t){return t[1]-e[1]});for(let e in i){if(i[e][1]<=1){delete i[e]}}let o=[];for(let e in i){o.push(i[e][0])}let a=o.indexOf(e.keyword);if(a>-1){o.splice(a,1)}jQuery.each(o,function(t,i){if(i){var o=Je(i,"search",2,"keyword");e.suggestions.push(o)}});jQuery.each(e.keywordMisspellings,function(t,i){jQuery.each(i.Alternatives,function(t,o){if(o.toLowerCase()!=e.keyword.toLowerCase()){var a=i.Keyword.split(" ");var n=o.split(" ");var r=null;for(var s=0;s<a.length;s++){if(a[s]!==n[s]){r=n[s];break}}var l=Je(o,"searchautocomplete",i.Keyword.toLowerCase()===e.keyword.toLowerCase()?0:1.5,"keyword",true,r);e.suggestions.push(l)}})});jQuery.each(e.autoCompleteTags,function(t,i){if(i.toLowerCase()!=e.keyword.toLowerCase()){var o=Je(i,"searchautocomplete",1,"keyword");e.suggestions.push(o)}})}catch(e){console.log(e)}return e.suggestions};var Xe=function(e,t){var i;var o=Ke({data:e});if(o==null)return;if(t.indexOf(".csv")==-1)t+=".csv";o="data:text/csv;charset=utf-8,"+encodeURIComponent(o);i=document.createElement("a");i.setAttribute("href",o);i.setAttribute("download",t);i.click()};var Ke=function(e){var t,i,o,a,n,r;r=e.data||null;if(r==null||!r.length){return null}a=e.columnDelimiter||",";n=e.lineDelimiter||"\n";o=Object.keys(r[0]);t="";t+=o.join(a);t+=n;r.forEach(function(e){i=0;o.forEach(function(o){if(i>0)t+=a;if(typeof e[o]=="string"){t+='"'+e[o].replace(/"/g,'""')+'"'}else{t+=encodeURI(e[o])}i++});t+=n});return t};var Je=function(e,t,i,o,a,n){var r=TBUtilities.IsWordCensored(e);var s={tag:e,source:t,priority:i,seed:o,isCensored:r,isMisSpell:a===true,misSpelledWord:n};return s};var $e=function(e){return new Promise(function(t,i){TubeBuddyYouTubeActions.GetYouTubeAutoComplete(m(),e.keyword,function(i){if(i.length>0){e.autoCompleteTags=i}t(e)})})};var Ze=function(e){return new Promise(function(t,i){TubeBuddyYouTubeActions.GetVideoSearchResults(e.keyword,function(i){if(i.length>0){i=i.slice(0,15);var o=i.map(function(e){return e.id});e.searchResults=o}t(e)})})};var et=function(e){return new Promise(function(t,i){if(e.searchResults&&e.searchResults.length>0){var o=0;for(var a=0;a<e.searchResults.length;a++){TubeBuddyYouTubeActions.GetVideoTags(e.searchResults[a],function(i){o++;try{e.searchResultTags=e.searchResultTags.concat(i)}catch(e){console.log(e)}if(o===e.searchResults.length){var a=[];jQuery.each(e.searchResultTags,function(e,t){if(/\s/.test(t)&&t!=""){var i=t.trim().toLowerCase();if(a.indexOf(i)==-1){a.push(i)}}});e.searchResultTags=a;t(e)}})}}else{t(e)}})};var tt=function(e){return new Promise(function(t,i){var o=TBGlobal.host+TBGlobal.apiUrls.grammerGetKeyWordMisspellings;e.autoCompleteTags.push(e.keyword);TBExtension.Post(o,JSON.stringify(e.autoCompleteTags),function(i,o,a){try{if(i===true){e.keywordMisspellings=a}}catch(e){TBUtilities.Log(e)}t(e)},null,{contentType:"application/json",dataType:"json"})})};var it=function(e){var t=Se(e);var i=Ae(e);var o=Ee(e);var a=Ie(e);var n={clientName:t,clientVersion:i,hl:a,gl:o,experimentsToken:""};return n};var ot=function(e){var t={client:it(e),request:{returnLogEntry:true},user:{onBehalfOfUser:Ce(e)},clientScreenNonce:""};return t};var at=function(e){var t=[];var i=0;return new Promise(function(o,a){if(e.length>0){e.forEach(function(n){var r=TBGlobal.host+TBGlobal.apiUrls.imageGetBytes+"?url="+encodeURIComponent(n);TBExtension.Get(r,function(n,r,s){i++;if(n===true){var l=JSON.parse(s).split(",")[1];var d={url:r,dataUrl:l};t.push(d)}else{a("error converting image to data url = "+r)}if(i>=e.length){o(t)}},n)})}else{o(t)}})};var nt=function(e,t,i){e.durationMs=t-i-e.offsetMs};var rt=function(e){return e.charAt(0).toUpperCase()+e.slice(1)};var st=function(e){return e.charAt(0).toLowerCase()+e.slice(1)};return{ActionTypes:{Unknown:0,AdvancedVideoEmbedding_Use:100,AnimatedGifGenerator_Generate:200,AnimatedGifGenerator_Share:201,AnnotationTemplates_Applied:300,BestTimeToPublish_Calculate:400,BrandAlerts_Fetch:500,BulkCopyAnnotations_Copy:600,BulkCopyCards_Copy:700,BulkDeleteAnnotations_Delete:800,BulkDeleteCards_Delete:900,BulkFindReplaceAppent_Find:1e3,BulkFindReplaceAppend_FindAndUpdate:1001,BulkPublishToFacebook_Publish:1100,BulkThumbnailOverlays_Add:1200,BulkThumbnailOverlays_Remove:1201,BulkUpdateAnnotations_Update:1300,BulkUpdateCards_Update:1400,CannedResponses_Use:1500,CaptionsService_Order:1600,CardTemplates_Apply:1700,ChannelBackup_Backup:1800,Channelytics_Use:1900,CommentFilters_ApplyFilter:2e3,CommunityConnect_External:2100,CommunityConnect_Internal:2101,CompetitorsScorecard_View:2200,CompetitorsUploadAlert_Fetch:2210,DefaultUploadProfiles_Apply:2300,DescriptionPromotion_Promote:2400,FeaturedVideoPromotions_Promote:2500,HealthReport_View:2600,LanguageAnalysis_Use:2700,PickAWinner_Pick:2800,PublishToFacebook_Publish:2900,QuickEditToolbar_PlaylistEdit:2970,QuickEditToolbar_MyVideosEdit:2971,QuickEditToolbar_VideoClick:2972,QuickLinksMenu_Click:3e3,ScheduleGoLive_Schedule:3100,SearchRanking_View:3200,ShareTracker_Track:3300,SocialMonitor_View:3400,SubscriberExport_Export:3500,SubscriberOutreach_ViewSocial:3600,SuggestedTags_Use:3700,SunsetVideos_Schedule:3800,TagExplorer_TagExplored:3900,TagSorter_Sorted:4e3,AutoTranslator_Use:4100,ThumbnailGenerator_Use:4200,VideoAbTests_Use:4300,VideoTopicPlanner_SaveComment:4400,VideoTopicPlanner_Use:4401,ViewAndCopyVideoTags_Copy:4500,WatchPageStats_Stats:4600,BulkCopyEndScreen_Copy:4700,Playlists_BulkUpdate:4800,Playlist_UpdateOrdering:4810,UploadChecklist_CompletedItem:4900,BestPractice_UserCompleted:5e3,Opportunities_MarkedAsComplete:5100,Opportunities_UserCompleted:5101,NotificationMenu_PostCommentReply:5200,CommentCloud_Show:5300,EndScreenTemplates_Apply:5400,SocialBluebookValuation_GetValue:5500,BulkUpdateEndScreens_Update:5600,ExportComments_Export:5700,TagLists_Export:5800,CopyTo_Export:5900,SearchTermAnalysis_Use:7100,InstaSuggest_Use:7200,SEOStudio_Save:7300,SEOStudio_ApplyToVideo:7301},ActivityLogTypes:{Unknown:0,QuickLinksMenu_MyAccount:1,QuickLinksMenu_HealthReport:2,QuickLinksMenu_CompetitorScorecard:3,QuickLinksMenu_BrandAlerts:4,QuickLinksMenu_ABTests:5,QuickLinksMenu_BackupsAndExports:6,QuickLinksMenu_CannedResponses:7,QuickLinksMenu_Settings:8,QuickLinksMenu_CommunityForums:9,QuickLinksMenu_TipsAndTricks:10,QuickLinksMenu_SuggestAFeature:11,QuickLinksMenu_KnowledgeBase:12,QuickLinksMenu_Dashboard:13,QuickLinksMenu_MyVideos:14,QuickLinksMenu_Playlists:15,QuickLinksMenu_LiveStreaming:16,QuickLinksMenu_Comments:17,QuickLinksMenu_Messages:18,QuickLinksMenu_Subscribers:19,QuickLinksMenu_Analytics:20,QuickLinksMenu_Realtime:21,QuickLinksMenu_TagExplorer:22,QuickLinksMenu_VideoTopicPlanner:23,QuickLinksMenu_BestTimeToPublish:24,PublishToFacebook_Blocked:30,BulkPublishToFacebook_UpgradeClick:40,ShowUpgradePage:50,Layout_SubmitDebugCode:60},GetActivityLogTypeValueFromString:function(e){for(var t in TBUtilities.ActivityLogTypes){if(t==e){return TBUtilities.ActivityLogTypes[t]}}return 0},AddDebug:function(e){p(e)},AddDebugObject:function(e){k(e)},CreateCookie:function(e,t,i){L(e,t,i)},GetCookie:function(e){return U(e)},RemoveCookie:function(e){L(e,"",-1)},ReplaceAll:function(e,t,i,o,a){return A(e,t,i,o,a)},CountMatches:function(e,t,i,o,a){return E(e,t,i,o,a)},GetInArray:function(e,t,i){return I(e,t,i)},RemoveFromArray:function(e,t,i){return P(e,t,i)},SortArray:function(e,t,i,o){return R(e,t,i,o)},SortArrayTwoNumberColumns:function(e,t,i,o,a){return G(e,t,i,o,a)},CreateGuid:function(){return D()},ValidateEmail:function(e){return V(e)},GetHtmlEncoded:function(e){return ie(e)},GetXmlEncoded:function(e){return oe(e)},GetUrlEncoded:function(e){return re(e)},HighlightText:function(e,t,i){return ne(e,t,i)},GetUrlDecoded:function(e){return se(e)},FormatNumberWithCommas:function(e){return M(e)},FormatNumberAbbreviated:function(e,t,i){return O(e,t,i)},FormatCurrency:function(e,t,i,o){return N(e,t,i,o)},PerformGet:function(e,t,i){Y(e,t,i)},PerformPost:function(e,t,i,o){H(e,t,i,o)},GetEmailsWithinString:function(e){return W(e)},AddAction:function(e,t,i){J(e,t,i)},AddActivityLog:Z,LogError:function(e){ee(e)},LogFailedWebRequest:te,UnicodeToChar:function(e){return pe(e)},FormatFileName:function(e){return le(e)},GetOs:function(){return xe()},GetUrlParameter:function(e){return z(e)},ToLongDateTimeString:function(e){return K(e)},ToShortDateString:function(e){return X(e)},ToCurrency:function(e,t){return de(e,t)},GetTime:function(){return S()},Log:function(e){return T(e)},MilliSecondsToTime:function(e){return ce(e)},AutoIncrementCount:function(e,t){ue(e,t)},LoadExternalFile:function(e,t){ye(e,t)},IsAlphaNumeric:function(e){return be(e)},Truncate:function(e,t,i){return B(e,t,i)},GetDebugEntries:function(){return w()},ValidateUrl:function(e){return _(e)},IsNullOrEmptyOrWhitespace:function(e){return ae(e)},GetVideoTweetCount:function(e,t){return ze(e,t)},Alert:function(e,t){he(e,t)},Confirm:function(e,t,i){return fe(e,t,i)},Prompt:function(e,t,i,o){me(e,t,i,o)},ParseVideoIdFromUrl:function(e){return ve(e)},ParsePlaylistIdFromUrl:function(e){return Te(e)},UpdateUrlParameter:function(e,t,i){return we(e,t,i)},DataURItoBlob:function(e){return Re(e)},ForceDebugging:function(){o=true},FixLocalHtml:function(e){return je(e)},GetParameterByName:function(e,t){return Qe(e,t)},ParseInnerTubeApiKey:function(e){return Ue(e)},ParseDelegatedSessionId:function(e){return Ce(e)},ParseInnerTubeApiClientVersion:function(e){return Ae(e)},ParseInnerTubeApiClientName:function(e){return Se(e)},ParseInnerTubeContextCountry:function(e){return Ee(e)},GetSessionToken:Be,GetCommentTokenFromWatchPageHtml:function(e){return Pe(e)},GetIdokenFromWatchPageHtml:function(e){return De(e)},GetYouTubeUIVersion:function(e){return Ve(e)},FixedEncodeURIComponent:function(e){return Ne(e)},IsWordCensored:function(e){return g(e)},GetCensoredWords:function(){return b()},GetYouTubeAutoSuggested:function(e,t){return f(e,t)},GetTubeBuddyCheckboxHtml:function(e,t,i){return y(e,t,i)},GetTagCharacterCount:function(e){return Ye(e)},CorbUrl:function(e){return He(e)},ParseResponseContextFromHtml:function(e){return Me(e)},ParseVideoEditObjectFromHtml:function(e){return Oe(e)},GetVideoSearchCollectionIndex:function(e){return _e(e)},ParsePlayerResponseFromHtml:function(e){return Fe(e)},GetKeywordRecommendedTags:function(e){return We(e)},BuildContextRequestObject:function(e){return ot(e)},ProcessHeader:function(e){return Ge(e)},ConvertImagesToDataUrls:function(e){return at(e)},AdjustEndScreenElementTiming:function(e,t,i){return nt(e,t,i)},GetVideoTopics:function(e){return Le(e)},DownloadArrayToCSV:function(e,t){Xe(e,t)},CapitlizeFirstLetterString:function(e){return rt(e)},LowerCaseFirstLetterString:function(e){return st(e)},HeaderCacheKey:function(){return n}}}();if(!String.prototype.padLeft){String.prototype.padLeft=function(e,t){var i=this,t=t||"0";while(i.length<e)i=t+i;return i}}if(!String.prototype.hashCode){String.prototype.hashCode=function(){var e=0,t,i;if(this.length===0)return e;for(t=0;t<this.length;t++){i=this.charCodeAt(t);e=(e<<5)-e+i;e|=0}return e}}var tbdelay=function(){var e=0;return function(t,i){clearTimeout(e);e=setTimeout(t,i)}}();(function(e){var t=e({});e.ajaxQueue=function(i){var o,a=e.Deferred(),n=a.promise();function r(t){o=e.ajax(i);o.done(a.resolve).fail(a.reject).then(t,t)}t.queue(r);n.abort=function(s){if(o){return o.abort(s)}var l=t.queue(),d=e.inArray(r,l);if(d>-1){l.splice(d,1)}a.rejectWith(i.context||i,[n,s,""]);return n};return n}})(jQuery);var TBGlobal=function(){var e="";var t="";var i;var o="";var a=null;var n=0;var r=[];var s=false;var l=[];var d="";var u=[];var c=[];var p="{S}";var b=null;var h=null;var f=[{id:"bulkcopycards",icon:"copy",category:"bulk",color:"#445569",pages:["My Videos"],name:"Bulk Copy Cards",summary:"Automate the process of copying Cards across some or all of your videos",howToVideoId:"llMep6_-ijY",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:false,Level1Access:false,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["Manually adding Cards on all your videos one by one takes forever and is a pain in the &#^@@$","Copying Cards through TubeBuddy ensures you have a clean, consistent look across all your videos",'<a href="https://support.google.com/youtube/answer/6140493?hl=en&ref_topic=6140492" target="_blank">Cards</a> are extemely important for marketing your brand on desktop and mobile'],whereToFindIt:'Go to your <a class="underline" target="_blank" href="https://www.youtube.com/my_videos">My Videos</a> page on YouTube and select "Bulk Copy Cards" from the TubeBuddy menu next to the video that you want to copy Cards <i>from</i>.<br /><img src="/assets/images/tools/screenshots/bulkcopycardswhere.png" />',tipsAndTricks:['Don\'t worry if your videos have different durations. TubeBuddy uses "Smart Timing" to figure out where to place the Cards on each destination video. For example, if you have a set of <i>end cards</i>, TubeBuddy automatically places them at the end of each destination video (same distance from end as source video).','If you are only using this tool for your most recent upload, use <a href="Tools?tool=cardtemplates">Card Templates</a> instead.','If want to get rid of all existing Cards from the destination videos before copying the new Cards, simply select the "remove existing cards" option in Step 2.',"Each video is processed 1 at a time and takes a second or two. So 1,000 videos might take about 30 minutes to process. We recommend limiting bulk copying to 2,000 or less videos. If you have more, consider breaking them up into playlists and running the tool for each playlist separately.","After processing is complete, you can click on the video link in the <i>Completed</i> area to quickly verify that it was done correctly.","You can customize Card properties on individual destination videos in Step 3.","TubeBuddy handles all Card types and each time YouTube puts out a new type of Card, it is added to our system within a day or two."],limits:'<div class="limitHeader">Starter (FREE) | Pro</div><div class="limitbody">Cannot copy Cards to more than one video at a time</div><div class="margin-top10 limitHeader2">Network | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"bulkdeletecards",icon:"remove",category:"bulk",color:"#445569",pages:["My Videos"],name:"Bulk Delete Cards",summary:"Delete Cards from some or all of your videos with just a few clicks",howToVideoId:"8D1HVZSLdNE",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:false,Level1Access:false,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["Manually deleting Cards on all your videos one by one would take forever",'It\'s an easy way to create a clean slate before executing a <a href="https://support.google.com/youtube/answer/6140493?hl=en&ref_topic=6140492" target="_blank">Cards</a> strategy',"Quickly remove Cards from an old or expired promotion"],whereToFindIt:'Go to your <a class="underline" target="_blank" href="https://www.youtube.com/my_videos">My Videos</a> page on YouTube and select "Delete Cards" from the Bulk TubeBuddy menu above your list of videos.<br /><img src="/assets/images/tools/screenshots/bulkdeletecardswhere.png" />',tipsAndTricks:["The Bulk Copy Cards tool has an option to delete all Cards on videos before copying new Cards. In some cases it makes sense to use that option instead of this tool.","Remember this process deletes ALL Cards from a video. (Some day we will add the ability to delete just certain types of Cards)","Each video is processed 1 at a time and takes a second or two. So 1,000 videos might take about 30 minutes to process. We recommend limiting bulk copying to 2,000 or less videos. If you have more, consider breaking them up into playlists and running the tool for each playlist separately.","After processing is complete, you can click on the video link in the <i>Completed</i> area to quickly verify that it was done correctly."],limits:'<div class="limitHeader">Starter (FREE) | Pro</div><div class="limitbody">Cannot delete Cards from more than one video at a time</div><div class="margin-top10 limitHeader2">Network | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"sunsetvideos",icon:"sun-o",category:"productivity",color:"#445569",name:"Sunset Videos",pages:["My Videos","Edit Video","Upload"],summary:"Schedule videos to be hidden and removed from playlists at a future date/time ",howToVideoId:"v7-29m5St_E",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:false,Level1Access:false,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You need to set a video's Privacy to Private or Unlisted at a certain time in the future","You want to remove a video from some or all your playlists at a certain time in the future","Protect yourself against licensed content"],whereToFindIt:'On the My Videos page, Upload Page or Edit Video page. <br /><img src="/assets/images/tools/screenshots/sunsetvideowhere.png" />',tipsAndTricks:["You will receive a notification 24 hours in advance before items scheduled to be sunsetted are actually sunsetted."],limits:'<div class="limitHeader">Starter (FREE) | Pro </div><div class="limitbody">Cannot Sunset Videos</div><div class="margin-top10 limitHeader2">Star | Network | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"navwindowcomments",icon:"comments-o",category:"productivity",color:"#445569",name:"Notification Commenting",pages:[""],summary:"Reply to comments directly from the YouTube notification window",howToVideoId:"OpYocrIanj0",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:true,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You want to comment on videos directly from the YouTube notification window","You don't want to leave the current page you are on to make a comment","You are frustrated that YouTube removed this basic functionality"],whereToFindIt:"Every YouTube Page",tipsAndTricks:[""],limits:'<div class="limitHeader">Starter (FREE) | Pro | Star</div><div class="limitbody">Cannot Sunset Videos</div><div class="margin-top10 limitHeader2">Network | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"playlistactions",icon:"bolt",category:"productivity",color:"#445569",name:"Playlist Actions",pages:["All Playlists"],summary:"Advanced ordering and filtering options for videos within playlists",howToVideoId:"6wmaBD5pVq8",Level0Limitation:"Can only use Standard / Misc Ordering options",Level1Limitation:null,Level2Limitation:null,Level0Access:false,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You want to order a playlist based on video Engagement, Subscribers Gained or Watch Time","You want to randomize, alphabetize or reverse the order of one or more playlists","You want to remove Private or Unlisted videos from your playlists"],whereToFindIt:'<a href="https://www.youtube.com/view_all_playlists" target="_blank">All Playlists Page</a>',tipsAndTricks:["Sort your playlist by Watch Time in order to gain the best SEO boost"],limits:'<div class="limitHeader">Starter (FREE) | Pro | Star</div><div class="limitbody">Cannot Sunset Videos</div><div class="margin-top10 limitHeader2">Network | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"bulkupdateplaylists",icon:"refresh",category:"bulk",color:"#445569",name:"Bulk Update Playlists",pages:["All Playlists"],summary:"Update Privacy, Ordering and Filtering settings across some or all your Playlists at once",howToVideoId:"fNh6kh8NGPU",Level0Limitation:"",Level1Limitation:null,Level2Limitation:null,Level0Access:false,Level1Access:false,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You want to set a group of playlists to Public or Private","You want to change the order of videos within some or all your playlists","You want to remove all Private and/or Unlisted videos quickly from all your playlists"],whereToFindIt:'<a href="https://www.youtube.com/view_all_playlists" target="_blank">All Playlists Page</a>',tipsAndTricks:[""],limits:'<div class="limitHeader">Starter (FREE) | Pro | Star</div><div class="limitbody">Cannot Sunset Videos</div><div class="margin-top10 limitHeader2">Network | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"bulkdemonetization",icon:"dollar",category:"bulk",color:"#445569",name:"Demonetization Double-Check",pages:["My Videos"],summary:"Quickly find demonetized videos on your channel then bulk submit them for manual review",howToVideoId:"",Level0Limitation:"",Level1Limitation:null,Level2Limitation:null,Level0Access:false,Level1Access:false,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You want to find old demonetized videos that you are not aware of","You want to submit videos for manual review in bulk","You want to ensure you are making the most money possible from your channel"],whereToFindIt:'<img src="/assets/images/tools/screenshots/bulkdemonetizationwhere.png" /><a href="https://www.youtube.com/my_videos" target="_blank">My Videos Page</a>',tipsAndTricks:["Run this process at least once per week to make sure you are not missing out on old videos that were demonetized."],limits:'<div class="limitHeader">Starter (FREE) | Pro | Star</div><div class="limitbody">Cannot Sunset Videos</div><div class="margin-top10 limitHeader2">Network | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"schedulegolive",icon:"power-off",category:"productivity",color:"#445569",name:"Scheduled Publish",pages:["My Videos","Edit Video","Upload"],summary:"Schedule unlisted videos to be published and added to playlists at a future date/time ",howToVideoId:"HY9MNQr8OY4",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:false,Level1Access:false,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You want to give your patron supporters early access to a video before making it public","You want to add a video to playlists at a certain time in the future","You want to pass around a video internally at your business before publishing it live"],whereToFindIt:'On the My Videos page, Upload Page or Edit Video page. <br /><img src="/assets/images/tools/screenshots/scheduledpublishwhere.png" />',tipsAndTricks:["(optional) You will receive a notification 24 hours in advance before items scheduled to be published are actually live."],limits:'<div class="limitHeader">Starter (FREE)</div><div class="limitbody">Cannot Scheduled Publish</div><div class="margin-top10 limitHeader2">Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"bulkthumbnailoverlays",icon:"photo",category:"bulk",color:"#445569",name:"Bulk Thumbnail Overlays",pages:["My Videos"],summary:"Add (and optionally remove later) a graphic overlay to some or all of your video thumbnails",howToVideoId:"JHnVDCA27ZQ",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:false,Level1Access:false,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You want to add your business logo to all your thumbnails but don't have 500 hours of spare time to do it manually","You want to run a promotion on your channel by adding (and later removing) a sponsor's logo to your videos' thumbnails","You want to add a distinct image overlay to all thumbnails in a certain playlist"],whereToFindIt:'Go to your <a class="underline" target="_blank" href="https://www.youtube.com/my_videos">My Videos</a> page on YouTube and select "Thumbnail Overlays" from the Bulk TubeBuddy menu above your list of videos.<br /><img src="/assets/images/tools/screenshots/bulkthumbnailoverlayswhere.png" />',tipsAndTricks:["This feature is coming soon! (we are just running some final tests)"],limits:'<div class="limitHeader">Starter (FREE) | Pro</div><div class="limitbody">Cannot update thumbnails of more than one video at a time</div><div class="margin-top10 limitHeader2">Network | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"bulkfindreplaceappend",icon:"refresh",category:"bulk",color:"#445569",name:"Bulk Find, Replace &amp; Append",pages:["My Videos"],summary:"Find & Replace, Append or Remove from video titles and descriptions across your entire channel",howToVideoId:"kRWO6ymiSO0",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:false,Level1Access:false,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You want to insert a new social profile in the middle of all your existing videos' descriptions","You want to replace a hyperlink in your videos' descriptions with a new link","You want to remove references to that website you were promoting"],whereToFindIt:'Go to your <a class="underline" target="_blank" href="https://www.youtube.com/my_videos">My Videos</a> page on YouTube and select "Titles & Descriptions" from the Bulk Meta Updates TubeBuddy menu above your list of videos.<br /><img src="/assets/images/tools/screenshots/bulkfindandreplacewhere.png" />',tipsAndTricks:["Use caSE SensiTivE and whole word matches to ensure you only update the text you want.","Preview changes before they go live by clicking on the search icon next to each video in step 3.","Each video is processed 1 at a time and takes a second or two. So 1,000 videos might take about 30 minutes to process. We recommend limiting bulk copying to 2,000 or less videos. If you have more, consider breaking them up into playlists and running the tool for each playlist separately."],limits:'<div class="limitHeader">Starter (FREE) | Pro</div><div class="limitbody">Cannot run Find / Replace / Append on more than one video at a time</div><div class="margin-top10 limitHeader2">Network | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"viewandcopyvideotags",icon:"copy",category:"optimization",color:"#9bba5c",name:"View and Copy Video Tags",pages:["Watch Video"],summary:"View and Copy video tags from any video (not just your own)",howToVideoId:"C95gGD6nr6Q",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:true,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You're wondering what your competitor is tagging their videos with","You're looking for ideas around what tags to use in your videos","You want to see why particular videos are rankings higher in search results"],whereToFindIt:'<img src="/assets/images/tools/viewandcopytagswhere2.png" />',tipsAndTricks:["You can hide this feature by going to your Settings tab in the main TubeBuddy menu next to the Upload button in YouTube.","Click on any Tag in the list to run the Tag Explorer tool on the tag."],limits:'<div class="limitHeader">Starter (FREE) | Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"emojipicker",icon:"smile-o",category:"productivity",color:"#9bba5c",name:"Emoji Picker",pages:["Edit Video"],summary:"Add Emojis to your Titles, Tags and Descriptions",howToVideoId:"ZWcAuhtDw-8",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:true,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You want to make your Titles stand out in a crowd","You want to tag your videos in unique ways to help in related videos section","You don't want to have to visit an external site to use emojis"],whereToFindIt:"Info and Settings + Upload Page for Videos",tipsAndTricks:["Use the Search bar to quickly find what you're looking for.","Use the Recently Used area for commong emojis"],limits:'<div class="limitHeader">Starter (FREE) | Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"tagsorter",icon:"reorder",category:"optimization",color:"#9bba5c",name:"Tag Sorter",pages:["Edit Video"],summary:"Reorder your video Tags on any video in any order quickly and easily",howToVideoId:"5rmcjDSFokw",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:true,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["YouTube removed the ability to reorder your Tags a long time ago","You want your most important Tags ranked first","Helps you rank higher in YouTube search results"],whereToFindIt:'Below your list of Tags on a Video Edit screen<br><img src="/assets/images/tools/screenshots/tagsortwhere.png" />',tipsAndTricks:["Put your most relevant Tags first.","Move tags that people are searching for to the top of your list to help rank higher in search."],limits:'<div class="limitHeader">Starter (FREE) | Pro | Network | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"tagexplorer",icon:"tags",category:"optimization",color:"#9bba5c",name:"Keyword Explorer",pages:["General Page","Edit Page","Watch Page"],summary:"The ultimate Keyword research tool for YouTube and Google Trends",howToVideoId:"DVGasw8T6g0",Level0Limitation:"Can only see top 3 results in each category, 25 searches per day.",Level1Limitation:null,Level2Limitation:null,Level0Access:false,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["Get your videos ranked higher in search results and ultimately get more views","Find long-tail search terms to better target what people are looking for on YouTube ","Discover trending Tags to keep your videos relevant long after they are published"],whereToFindIt:'<span style="font-size:12px; font-weight:bold;">[LOCATION 1]</span><br> Click Tag Explorer from the main TubeBuddy Menu <br /><img src="/assets/images/tools/tagexplorerwhere1.png" /><br><Br><span style="font-size:12px; font-weight:bold;">[LOCATION 2]</span><br> On a video edit screen, click the \'Tag Explorer\' button or click on any Tag in the Tag list<br/><img src="/assets/images/tools/tagexplorerwhere2.png" /><br/><br><span style="font-size:12px; font-weight:bold;">[LOCATION 3]</span> Click on any Tag in the Tag list on a video watch page<br> <img src="/assets/images/tools/viewandcopytagswhere1.png" /><br><Br><span style="font-size:12px; font-weight:bold;">[LOCATION 4]</span> While you are uploading a new video, click the \'Tag Explorer\' button or click on any Tag in the Tag list<br/><img src="/assets/images/tools/tagexplorerwhere2.png" />',tipsAndTricks:["Find Tags that have a high keyword score meaning they are searched often but there is not too much competition.","Unless you are PewDiePie, it's hard to get your videos ranked high for broad search terms. Try targeting long-tail (more specific) keywords.","If using Tag Explorer on a Video Edit screen or the Upload screen, you can click the (+) Plus Sign next to any Tag to add it to the Tag List in the video you are editing.","Click on any Tag in the results to re-run tag analysis on that Tag.","The Trending Tab only provides results for more general search terms or very popular specific terms."],limits:'<div class="limitHeader">Starter (FREE)</div><div class="limitbody">Cannot view more than the top three results in each section</div><div class="margin-top10 limitHeader2">Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"publishtofacebook",icon:"facebook",category:"productivity",color:"#445569",name:"Publish to Facebook",pages:["My Videos","Upload"],summary:"Publish your YouTube videos natively to Facebook with just a couple clicks",howToVideoId:"DJAaoh74iWQ",Level0Limitation:"",Level1Limitation:"",Level2Limitation:null,Level0Access:false,Level1Access:false,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["Facebook is becoming a leader in online video","Make it easier to people to find your content","Monetize your content across multiple social networks"],whereToFindIt:'Upload Page and My Videos page<br><img src="/assets/images/tools/screenshots/publishtofacebookwhere.png" />',tipsAndTricks:["Use this tools for ALL your videos!"],limits:'<div class="limitHeader">Starter (FREE)</div><div class="limitbody">No Access</div><div class="margin-top10 limitHeader2">Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"suggestedtags",icon:"magic",category:"optimization",color:"#9bba5c",name:"Suggested Tags",pages:["Edit Video"],summary:"Discover the best Tags to drive the most views to your video",howToVideoId:"T2j4iCNmpys",Level0Limitation:"Can only see top 3 results in each section",Level1Limitation:null,Level2Limitation:null,Level0Access:false,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["Get your videos ranked higher in YouTube search","Get your video to show up in related section of other videos","You don't have time to do research on your own"],whereToFindIt:'<span style="font-size:12px; font-weight:bold;">[LOCATION 1]</span><br> On a video edit screen, click the \'Suggested Tags\' button<br/><img src="/assets/images/tools/screenshots/suggestedtagswhere.png" /><br/><br><span style="font-size:12px; font-weight:bold;">[LOCATION 2]</span> While you are uploading a new video, click the \'Suggested Tags\' button<br/><img src="/assets/images/tools/suggestedtagswhere2.png" />',tipsAndTricks:["Adding Search Terms that people are finding your video on will only increase your rank and drive more views","Adding words from your Title will help you rank higher for those terms","Use long-tail results for searches that people are performing on YouTube"],limits:'<div class="limitHeader">Starter (FREE) | Pro</div><div class="limitbody">Cannot view more than the top three results in each section</div><div class="margin-top10 limitHeader2">Network | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"channelytics",icon:"area-chart",category:"research",color:"#f29b27",name:"Channelytics",pages:["Channel Page"],summary:"Stats & Analysis on any channel in YouTube from StatFire",howToVideoId:"zb11V1jsq6I",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:true,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You want to compare your channel with a competitor's channel","You like graphs and data"],whereToFindIt:"Go to any channel page and click the Channelytics Tab",tipsAndTricks:['The You vs Them graph is powered by <a target="_blank" href="http://www.statfire.com">StatFire.com</a>.'],limits:'<div class="limitHeader">Starter (FREE) | Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"languageanalysis",icon:"language",category:"research",color:"#f29b27",name:"Language Analysis",pages:["Edit Video"],summary:"Get a breakdown of languages spoken by your channel's audience",howToVideoId:"",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:true,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:['Use the data to choose which languages to translate key Tags to (using our <a href="/tools?tool=tagtranslator">Tag Translator</a>)',"Use the data to choose which languages to create Title and Description translations for","Use the data to learn more about your audience and who to target in your videos"],whereToFindIt:'On the <a href="/tools?tool=tagtranslator">Tag Translator</a> tool as well as the Translations Tab on any video Info &amp; Settings screen. <br /><img src="/assets/images/tools/screenshots/languageanalysiswhere.png" />',tipsAndTricks:["When using this data for Tags, try to focus on languages with at least 10%"],limits:'<div class="limitHeader">Starter (FREE) | Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"retentionanalyzer",icon:"clock-o",category:"research",color:"#f29b27",name:"Retention Analyzer",pages:[],summary:"See how videos across your channel are performing at various time intervals.",howToVideoId:"",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:false,Level1Access:false,Level2Access:false,Level3Access:true,Level4Access:true,whyYouNeedIt:["Identify what intros or opening sequences are causing viewers to leave.","Work to improve overall retention on your videos by identifying trends in audience viewership.","Test various End Screens to figure out which one perform the best. "],whereToFindIt:"TubeBuddy website channel features",tipsAndTricks:["Use the chart as a scoring system"],limits:'<div class="limitHeader">Starter (FREE) | Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"thumbnailgenerator",icon:"photo",category:"productivity",color:"#445569",name:"Thumbnail Generator",pages:["My Videos","Video Upload"],summary:"Create professional quality thumbnails using still frames from your video and text/image overlays",howToVideoId:"2MhYVAhH4YY",Level0Limitation:"Can only add one custom image, cannot create templates, cannot download a copy of image",Level1Limitation:null,Level2Limitation:null,Level0Access:false,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You spend too much time using Photoshop, taking screenshots, copying, pasting, adding, modifying, saving and uploading","You can save and re-use Templates for a clean, consistent look across your video thumbnails","You are paying for an Adobe Photoshop license just to create YouTube video thumbnails"],whereToFindIt:'Go to your <a class="underline" target="_blank" href="https://www.youtube.com/my_videos">My Videos</a> page on YouTube and select "Thumbnail Generator" from the TubeBuddy menu next to the video that you want to generate a thumbnail for.<br><img src="/assets/images/tools/screenshots/thumbnailgeneratorwhere.png" />',tipsAndTricks:["Visual Guidelines (from Creator Playbook): Close-ups on faces, well framed, good composition, looks great at both small and large sizes, accurately represents your content and visually compelling imagery","Create and use Templates to save time and get a consistent look across your videos.","Upload your own custom fonts to ensure thumbnails created in TubeBuddy match your existing content","Upload your logo and other brand images to reuse across videos.","Click on any layer (Text or Image) in the preview area to change its properties, rotate, resize or move it.","Your thumbnail will be updated immediately however, it can take a couple hours for the updated thumbnail to show up throughout all of YouTube."],limits:'<div class="limitHeader">Starter (FREE)</div><div class="limitbody"><ul class="margin-left30"><li>Cannot use Templates</li><li>Cannot upload more than one custom image</li><li>Cannot upload custom fonts</li><li>Cannot download a copy of image</li></ul></div><div class="margin-top10 limitHeader2">Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"coppacenter",icon:"child",category:"productivity",color:"#445569",name:"Coppa Center",pages:["My Videos"],summary:'Learn more about COPPA and quickly identify which videos of yours rated "Made for Kids" by  YouTube ',howToVideoId:"",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:true,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["Learn what COPPA means and how it can affect your channel","Scan your videos to identify which ones are marked as Made for Kids","See which videos that were rated for kids but you overrode as not made for kids"],whereToFindIt:"Click the Coppa Center link under Misc Tools on the Videos List page",tipsAndTricks:["Run periodically to ensure you are not missing new ratings from YouTube"],limits:'<div class="limitHeader">Starter (FREE)</div><div class="limitbody"><ul class="margin-left30"><li>Cannot use Templates</li><li>Cannot upload more than one custom image</li><li>Cannot upload custom fonts</li><li>Cannot download a copy of image</li></ul></div><div class="margin-top10 limitHeader2">Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"defaultuploadprofiles",icon:"upload",category:"productivity",color:"#445569",name:"Default Upload Profiles",pages:["Upload Defaults"],summary:"Create multiple Default Upload Profiles for each type of video you make",howToVideoId:"rutM_FOQU4Q",Level0Limitation:"Can only create one additional upload profile",Level1Limitation:null,Level2Limitation:null,Level0Access:false,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["YouTube only allows you to create one set of Upload Defaults","You have a different set of Tags and boilerplate for your description based on what type of video you are uploading","You can apply these settings to existing videos too (on Video Edit screen)"],whereToFindIt:'<b>Studio Beta:</b> on YouTube Settings, beside the Upload Defaults tab .<br /><img src="/assets/images/tools/screenshots/upload-defaults-where.png" /><br /><br /><b>Classic Studio: </b>On the <a class="underline" target="_blank" href="https://www.youtube.com/upload_defaults">Default Uploads</a> page on YouTube in the upper-right hand corner.<br /><img src="/assets/images/tools/uploaddefaults.png" />',tipsAndTricks:["You can apply your new upload profiles on the Upload page while your video is being uploaded.","Everyone has a different set of options based on their account permissions so if you ever hit a problem, let us know.","Apply your upload profiles to any of your old videos (not just new Uploads)."],limits:'<div class="limitHeader">Starter (FREE)</div><div class="limitbody">Cannot create more than one set of additional Upload Defaults</div><div class="margin-top10 limitHeader2">Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"cardtemplates",icon:"th-large",category:"productivity",color:"#445569",name:"Card Templates",pages:["Video Upload","Cards"],summary:"Set any video as a <i>Card Template</i> then easily apply its Cards to new uploads",howToVideoId:"fOmwUTfdhrI",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:false,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You are manually creating the same set of Cards on all new uploads","You want to handle all aspects of new uploads quickly and efficiently","You have different sets of Cards to apply depending on what type of video you upload"],whereToFindIt:'Set a video as a Cards Template at the bottom of the Cards page for that video (then you will be able to apply this template on the Upload screen after any new video has been uploaded and processed).<br /><img src="/assets/images/tools/screenshots/cardtemplateswhere2.png" /><br /><br /> <b>Studio Beta:</b> Above on the Video Editor page. <br /><img src="/assets/images/tools/screenshots/cardtemplateswhere.png" />',tipsAndTricks:["Set up different Card Templates for the different types of videos you create. Then on the Upload screen, choose a template based on the type of video being uploaded.",'TubeBuddy uses "Smart Timing" to ensure the Cards get applied in the correct location on your new upload no matter what the duration of the video is.'],limits:'<div class="limitHeader">Starter (FREE)</div><div class="limitbody">This tool is not available</div><div class="margin-top10 limitHeader2">Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"searchranking",icon:"line-chart",category:"optimization",color:"#9bba5c",name:"Search Rankings",pages:["My Videos","Watch Video"],summary:"See where your video ranks for all of its Tags in YouTube search",howToVideoId:"",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:false,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You want to know where your video ranks in YouTube search","You want to identify Tags that aren't helping you rank and should therefore be removed","Coming soon: You want to see you video rank position changes week to week"],whereToFindIt:'Go to your <a class="underline" target="_blank" href="https://www.youtube.com/my_videos">My Videos</a> page on YouTube and select "Search Rankings" from the TubeBuddy menu next to the video that you want to see its search rankings.<br /><img src="/assets/images/tools/screenshots/searchrankingswhere.png"/>',tipsAndTricks:["Add your own keywords to track beyond just your Tags"],limits:'<div class="limitHeader">Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited (Subject to change)</div>'},{id:"sharetracker",icon:"twitter",category:"promotion",color:"#bd382f",name:"Share Tracker",pages:["My Videos","Watch Video","Video Upload"],summary:"Share your video on multiple social networks and track which ones you've shared to",howToVideoId:"p0PmCuCu0x4",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:true,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You want your video to spread across all social networks","You always forget which social networks you have shared your videos to","You don't want to have to go to the video watch page just to share your video on other social networks"],whereToFindIt:'Go to your <a class="underline" target="_blank" href="https://www.youtube.com/my_videos">My Videos</a> page on YouTube and select "Share Tracker" from the TubeBuddy menu next to the video you want to share and track.<br /><img src="/assets/images/tools/screenshots/sharetrackerwhere.png" />',tipsAndTricks:["You can click on the green/grey dot to toggle the status as sent/not sent.","We hope to some day automate the sharing piece rather than having you manually click to share."],limits:'<div class="limitHeader">Starter (FREE) | Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"vid2vid",icon:"file-text-o",category:"promotion",color:"#bd382f",name:"Vid2Vid Promotion",pages:["My Videos","Video Upload"],summary:"Promote one of your videos in the descriptions of all your other videos",howToVideoId:"y9p_f5PLkhg",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:true,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You want to easily drive viewers of your old videos to your newest upload","You want to showcase an older video that is relevant to trending topics","You want to feature a video that is running a contest"],whereToFindIt:'Go to your <a class="underline" target="_blank" href="https://www.youtube.com/my_videos">My Videos</a> page on YouTube and select "Promote this Video (Vid2Vid)" from the TubeBuddy menu next to the video that you want to promote.<br /><img src="/assets/images/tools/screenshots/vid2vidwhere.png" />',tipsAndTricks:["Each time you run this tool, it <b>replaces</b> your previous promotion (rather than just appending it to your description)","You can customize the wording - make sure to choose something that a viewer is likely to click","As of right now, you can't easily remove a Description Promotion. You can only replace it. To remove it, you would have to use the Bulk Find / Replace / Append tools and remove each line seprately."],limits:'<div class="limitHeader">Starter (FREE) | Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"advancedvideoembedding",icon:"code",category:"productivity",color:"#445569",name:"Advanced Video Embed",pages:["My Videos","Watch Video","Playlist Edit"],summary:"Create embed codes with the full list of options for adding videos or playlists to your website",howToVideoId:"dVpGR7pf4qM",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:true,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["YouTube only gives you a few basic options for embedding videos and playlists","You want to customize the look of your embedded video or playlist","You don't want to have to go to the video watch page to get the embed code for your own video"],whereToFindIt:'Drop down next to any video on your <a target="_blank" href="https://www.youtube.com/my_videos">My Videos</a> page, "Tools" tab (above Description) on any <a target="_blank" href="https://www.youtube.com/watch?v=oJddzb2DKTU">Video Watch Page</a> or any edit Playlist page<br /><img src="/assets/images/tools/screenshots/advanceembedwhere.png" />',tipsAndTricks:["Click on on any of the options to learn more about what it does."],limits:'<div class="limitHeader">Starter (FREE) | Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"quicklinksmenu",icon:"link",category:"productivity",color:"#445569",name:"Quick Links Menu",pages:["General Page"],summary:"Easily navigate to common areas on YouTube without having to click 17 times",howToVideoId:"89b-6xna2GQ",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:true,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["YouTube makes you click 47 times and load 13 pages to simply get to your My Videos page (note: we maybe have exagerrated slightly)","There are only a few areas that you go to all the time and you should be able to get to them more easily","Coming soon: Customize the Quick Menu with your own links"],whereToFindIt:'Click the main TubeBuddy menu next to the Upload button on YouTube.<br /><img src="/assets/images/tools/screenshots/quicklinksmenuwhere.png" />',tipsAndTricks:["We hope to allow you to customize this menu in the near future"],limits:'<div class="limitHeader">Starter (FREE) | Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"quickedittoolbar",icon:"pencil",category:"productivity",color:"#445569",name:"Quick-Edit Toolbar",pages:["General Page","Video Edit","Edit Video","Annotations","Cards","My Videos","Playlist","All Playlists"],summary:"Easily navigate between videos when editing a list",howToVideoId:"EX9005yjQYo",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:true,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["There is no way to easily edit videos in a Playlist on YouTube without it","You are tired of having to click the My Videos page every time you want to edit another video","You like to be able to easily jump between videos"],whereToFindIt:"Any Video Edit screen - assuming you came from a Playlist page or My Videos page",tipsAndTricks:['Go to your <A href="https://www.youtube.com/view_all_playlists" target="_blank">Playlists</a> page to easily edit any playlist'],limits:'<div class="limitHeader">Starter (FREE) | Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"subscriberoutreach",icon:"bullhorn",category:"promotion",color:"#bd382f",name:"Subscriber Outreach",pages:["Subscribers"],summary:"Reach out to your YouTube Subscribers across multiple social networks",howToVideoId:"",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:true,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You want to build relationships with your audience","You want to collaborate with fans of your channel","You see what your popular subscribers are doing on social media"],whereToFindIt:"Next to each subscriber in your Subscribers list",tipsAndTricks:["Thank your audience for subscribing every day","DO NOT SPAM.","Say hello to your subscribers on other networks outside of YouTube"],limits:'<div class="limitHeader">Starter (FREE)</div><div class="limitbody">Cannot use Community Connect on videos that aren\'t yours</div><div class="margin-top10 limitHeader2">Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"commentfilters",icon:"filter",category:"productivity",color:"#445569",name:"Comment Filters",pages:["Comments"],summary:"Easily manage large amounts of comments using our advanced filtering options",howToVideoId:"BwnyfODCmOs",Level0Limitation:'Cannot Hide comments, can only use on the "All Videos" section of comments',Level1Limitation:null,Level2Limitation:null,Level0Access:false,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You're having trouble keeping up with comments on your channel because you get so many","YouTube's comment managing system is clunky and hard to use","You want to quickly and easily find questions, profanity, positive sentiment, negative sentiment or certain words within comments on your videos"],whereToFindIt:'Go to your <a class="underline" target="_blank" href="https://www.youtube.com/comments">Comments</a> page on YouTube and look right above the first comment.<br /><img src="/assets/images/tools/commentfilterswhere.png" />',tipsAndTricks:["Use this tool to find people who have asked questions on your videos but you haven't responded.","Want new filters added to this tool? Let us know!"],limits:'<div class="limitHeader">Starter (FREE)</div><div class="limitbody">Cannot use Comment Filters on individual videos</div><div class="margin-top10 limitHeader2">Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"channelbackup",icon:"download",category:"research",color:"#f29b27",name:"Channel Backup",pages:["My Videos"],summary:"Protect yourself against lost data by backing up all your videos' metadata",howToVideoId:"0k7bEQNIyHY",Level0Limitation:null,Level1Limitation:"Cannot export results to CSV",Level2Limitation:null,Level0Access:false,Level1Access:false,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You want peace of mind knowing that your channel information is backed up","You want to play with video metadata in Excel or Google Dogs","You want to search, filter or sort video data using a spreadsheet application"],whereToFindIt:'Go to your <a class="underline" target="_blank" href="https://www.youtube.com/my_videos">My Videos</a> page on YouTube and click the "Backup" button.<br /><img src="/assets/images/tools/screenshots/channelbackupwhere.png" />',tipsAndTricks:["Run the backup process often to ensure you never lose your hard earned work","Someday we hope to allow backing up of video files themselves","Someday we hope to add a way to restore a channel from CSV"],limits:'<div class="limitHeader">Starter (FREE) | Pro </div><div class="limitbody">Cannot export data to CSV</div><div class="margin-top10 limitHeader2">Network | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"exportcomments",icon:"file-excel-o",category:"research",color:"#f29b27",name:"Export Comments",pages:["My Videos"],summary:"Export Video Comments to CSV File",howToVideoId:"yeT8blc5rPs",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:false,Level1Access:false,Level2Access:false,Level3Access:true,Level4Access:true,whyYouNeedIt:["You want to search comments for particular words","You want to run analysis on your comment pages","You want to identify top influencers that are active on your channel"],whereToFindIt:'Video Tools menu on any video on the <a href="https://www.youtube.com/my_videos" target="_blank">My Videos</a> page',tipsAndTricks:[""],limits:'<div class="limitHeader">Starter (FREE) | Pro </div><div class="limitbody">Cannot export data to CSV</div><div class="margin-top10 limitHeader2">Network | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"socialmonitor",icon:"twitter",category:"research",color:"#f29b27",name:"Social Monitor",pages:["My Videos","Watch Video"],summary:"See where your videos are being talked about across Twitter, Reddit, Google+ and Pinterest",howToVideoId:"hs30hrV7WFg",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:true,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You want to know who's sharing your video on Twitter","You want to see if your video has made the front page of Reddit yet","You don't want to manually search every social network to find if you video is being talked about"],whereToFindIt:'Go to your <a class="underline" target="_blank" href="https://www.youtube.com/my_videos">My Videos</a> page on YouTube and select "Social Monitor" from the TubeBuddy menu next to the video that you want to monitor.<br /><img src="/assets/images/tools/screenshots/socialmonitorwhere.png" />',tipsAndTricks:["Check back every few days to see if there are new Tweets or posts about your videos.","Follow up with people who are talkinag about you."],limits:'<div class="limitHeader">Starter (FREE) | Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited (Subject to change)</div>'},{id:"cannedresponses",icon:"file-text-o",category:"productivity",color:"#445569",name:"Canned Responses",pages:["Subscribers","Watch Video"],summary:"Use pre-written messages in various areas of YouTube ",howToVideoId:"BwnyfODCmOs",Level0Limitation:"Can only create 1 Canned Response",Level1Limitation:null,Level2Limitation:null,Level0Access:false,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You find yourself writing the same response over and over in YouTube","You want to personalize messages but write them faster","You want to write messages in your own wording, then have someone else use TubeBuddy to actually send the responses"],whereToFindIt:'Click on the main TubeBuddy menu next to the Upload button then under Website Tools select Canned Responses.<br /><img src="/assets/images/tools/cannedresponses.png" />',tipsAndTricks:["Use {N} as a placeholder which will insert the channel's username into the message and personalize it.","Currently available in Subscribers List page and Community Connect tool. Want it in other areas? Let us know!"],limits:'<div class="limitHeader">Starter (FREE)</div><div class="limitbody">Cannot create more than one Canned Response</div><div class="margin-top10 limitHeader2">Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"pickawinner",icon:"trophy",category:"promotion",color:"#bd382f",name:"Pick a Winner",pages:["My Videos","Watch Video"],summary:"Randomly select a user who has commented on one of your videos",howToVideoId:"IXMRx3O63_E",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:true,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You are running a contest and need to randomly pick a winner","You want access to social profiles of a random commenter on a video","You want to flip through random comments on a video"],whereToFindIt:'Go to your <a class="underline" target="_blank" href="https://www.youtube.com/my_videos">My Videos</a> page on YouTube and select "Pick a Winner" from the TubeBuddy menu next to the video that you want to want to randomly select a commenter from.<br /><img src="/assets/images/tools/screenshots/pickawinnerwhere.png" />',tipsAndTricks:["If you are selecting more than one winner, simply click the button again"],limits:'<div class="limitHeader">Starter (FREE) | Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"promomaterials",icon:"bullhorn",category:"promotion",color:"#bd382f",name:"Promotion Materials",pages:[""],summary:"Specialized links and code for promoting your channel and videos",howToVideoId:"40AbO-orgbQ",Level0Limitation:"Cannot create custom links or run on custom video Ids",Level1Limitation:null,Level2Limitation:null,Level0Access:true,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You want to boost new uploads by linking to them in various areas","You want to add your most recent or most popular upload to an email signature","You want to embed a video player on your blog or website that always plays your most recent video"],whereToFindIt:'Log in at TubeBuddy.com/account and click "Promo Materials" under a channel.',tipsAndTricks:[""],limits:'<div class="limitHeader">Starter (FREE) | Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"channelvaluation",icon:"dollar",category:"research",color:"#9bba5c",name:"Channel Valuation",pages:["Dashboard"],summary:"Know your Worth. Brand Deal Valuations via SocialBluebook.com",howToVideoId:"",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:true,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You want to know how much to charge brands for a dedicated video","You want to know how much to charge brands for a shoutout","You want to monitor your channel's worth and see if it is rising or falling"],whereToFindIt:'<a href="https://www.youtube.com/dashboard">YouTube Dashboard</a>.',tipsAndTricks:['If you do not see your valuation, head to <a href="http://www.socialbluebook.com">socialbluebook.com</a> and link your channel'],limits:'<div class="limitHeader">Starter (FREE)</div><div class="limitbody">Cannot re-run analysis after the first time</div><div class="margin-top10 limitHeader2">Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"channelaccess",icon:"lock",category:"research",color:"#9bba5c",name:"Channel Access",pages:[],summary:"Grant specific people access to your TubeBuddy account",howToVideoId:"bJmJIhd4JW4",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:false,Level1Access:false,Level2Access:false,Level3Access:true,Level4Access:true,whyYouNeedIt:["You want to give another Creator access to your channel Health Report","You want to give your client access to view your progress and their statistics","You want to share your TubeBuddy license among employees in your company"],whereToFindIt:'In the Settings area of a channel on <a href="https://www.tubebuddy.com/account" target="_blank">TubeBuddy.com/Account',tipsAndTricks:["",""],limits:'<div class="limitHeader">Starter (FREE)</div><div class="limitbody">Cannot re-run analysis after the first time</div><div class="margin-top10 limitHeader2">Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"bulkupdatecards",icon:"refresh",category:"bulk",color:"#445569",name:"Bulk Update Cards",pages:["My Videos"],summary:"Automate the process of updating Cards across some or all of your videos",howToVideoId:"eI6FEimLNsg",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:false,Level1Access:false,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["Manually updating Cards on all your videos one by one takes forever and is a pain in the &#^@@$","You want to replace an old promotion link on all Cards to a new promotion link","You want to test different Teaser Text or Call To Action to see which converts better"],whereToFindIt:'Go to your <a class="underline" target="_blank" href="https://www.youtube.com/my_videos">My Videos</a> page on YouTube and select "Update" under "Bulk Card Updates" in the TubeBuddy menu at the top of the page. <br /><img src="/assets/images/tools/screenshots/bulkupdatecardswhere.png" />',tipsAndTricks:[],limits:'<div class="limitHeader">Starter (FREE) | Pro</div><div class="limitbody">Cannot update Cards to more than one video at a time</div><div class="margin-top10 limitHeader2">Network | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"videoabtests",icon:"adjust",category:"optimization",color:"#9bba5c",name:"Video A/B Tests",pages:[],summary:"Test Titles, Thumbnails, Tags and Descriptions to find what works best",howToVideoId:"3TRjq12ScJE",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level3Limitation:"Max of 10 concurrent tests",Level0Access:false,Level1Access:false,Level2Access:false,Level3Access:false,Level4Access:true,whyYouNeedIt:["You want to back up theories about what thumbnails work best for your audience","You want to find the best style for your Titles to drive the most clicks","You want to see if changes to your Title, Description or Tags affects your search traffic"],whereToFindIt:'TubeBuddy.com/Account (then click AB Tests under your channel)<br><br>Want to use A/B Tests to improve your YouTube SEO?<br/>Check out <a href="https://www.milesbeckler.com/youtube-seo/#videoseosoftware">https://www.milesbeckler.com/youtube-seo/#videoseosoftware</a>',tipsAndTricks:["(coming soon!)"],limits:'<div class="limitHeader">Starter (FREE) | Network | Pro | Star</div><div class="limitbody">This tool is not available</div><div class="margin-top10 limitHeader2">Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"competitorscorecard",icon:"pie-chart",category:"research",color:"#f29b27",name:"Competitor Scorecard",pages:[],summary:"See how your channel stacks up against the competition",howToVideoId:"NUoGzwGzzW8",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level3Limitation:"Max 10 Competitors",Level0Access:false,Level1Access:false,Level2Access:false,Level3Access:false,Level4Access:true,whyYouNeedIt:["You want to see how you compare with the competition in views, subscribers, uploads and engagement","You want a printable report showing data about you vs your competition","You want to Export to CSV YouTube data about your competition"],whereToFindIt:'TubeBuddy.com (click the "Competitor Scorecard" link on the main TubeBuddy menu on YouTube.com)',tipsAndTricks:["Has Print button to get a printer friendly copy of the Scorecard"],limits:'<div class="limitHeader">Starter (FREE) | Network | Pro | Star </div><div class="limitbody">This tool is not available</div><div class="margin-top10 limitHeader2">Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"competitoruploadalerts",icon:"bell",category:"research",color:"#f29b27",name:"Competitor Upload Alerts",pages:[],summary:"Get notification when a competitor uploads a video",howToVideoId:"",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level3Limitation:"Max 10 Competitors",Level0Access:false,Level1Access:false,Level2Access:false,Level3Access:false,Level4Access:true,whyYouNeedIt:["You want to be notified when a competitor uploads a video.","You can choose to be notified via email, TubeBuddy notification or text."],whereToFindIt:'Competitor icon on any of your linked channels at <a href="https://www.tubebuddy.com/account" target="_blank">TubeBuddy.com/account</a> and then click on Manage',tipsAndTricks:["Use this tool to keep track of your competitions video uploads.","This tool will notify you within minutes of an upload so you can monitor competitor activities."],limits:'<div class="limitHeader">Starter (FREE) | Network | Pro | Star </div><div class="limitbody">This tool is not available</div><div class="margin-top10 limitHeader2">Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"brandalerts",icon:"bell",category:"research",color:"#f29b27",name:"Brand Alerts",pages:[],summary:"Monitor YouTube for new videos, playlists and channels uploaded about you or your brand",howToVideoId:"CTctBDrbtDY",Level0Limitation:null,Level1Limitation:null,Level2Limitation:"Limited to just 1 Brand Alert",Level0Access:false,Level1Access:false,Level2Access:false,Level3Access:true,Level4Access:true,whyYouNeedIt:["You want to know when someone uploads a review video about your product","You want to track uploads about your competitors","You want to monitor general sentiment about you or your brand on YouTube"],whereToFindIt:'Brand Alert icon on any of your linked channels at <a href="https://www.tubebuddy.com/account" target="_blank">TubeBuddy.com/account</a>. <img src="/assets/images/tools/screenshots/brandalertswhere.png" />',tipsAndTricks:["Use this tool to thank your fans for uploading content about you!","Use this tool to track and find illegal uploaded content"],limits:'<div class="limitHeader">Starter (FREE) | Pro </div><div class="limitbody">This tool is not available</div><div class="margin-top10 limitHeader2">Star | Network</div><div class="limitbody">You can create 1 Brand Alert</div><div class="margin-top10 limitHeader2">Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"healthreport",icon:"heartbeat",category:"research",color:"#f29b27",name:"Health Report",pages:[],summary:"Get an overall look at the health and performance of your channel",howToVideoId:"ZybNWMQQdA8",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:false,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You want to discover what's working and what isn' on your channel","You want quick access to analytics - demographics, search traffic, related videos, watch time, etc","You want to improve your channel based on data insights"],whereToFindIt:"TubeBuddy.com Website (click heartbeat icon next to channel)",tipsAndTricks:["Data is updated once per day when YouTube Analytics are refreshed","Use information to find out what is working and what is not on your channel and make adjustments"],limits:'<div class="limitHeader">Starter (FREE)</div><div class="limitbody">This tool is not available</div><div class="margin-top10 limitHeader2">Pro | Star | Network | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"commentcloud",icon:"cloud",category:"research",color:"#f29b27",name:"Comment Word Cloud",pages:[],summary:"Get a visual representation of what people are saying about your videos",howToVideoId:"OpYocrIanj0",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:true,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["Understand if people have a positive or negative sentiment about a video","Get new video ideas by seeing what people are talking most about in your videos","Get a quick overall sense for how a video performed and what people think about it"],whereToFindIt:'Comments page - <a href="https://www.youtube.com/comments" target="_blank">https://www.youtube.com/comments</a> - and also on Video Watch pages </br></br><img src="/assets/images/tools/screenshots/wordcloud-where.jpg" /></br></br><img src="/assets/images/tools/screenshots/wordcloud-where2.jpg" />',tipsAndTricks:["Click the button again after loading more comments to refresh the cloud"],limits:'<div class="limitHeader">Starter (FREE)</div><div class="limitbody">This tool is not available</div><div class="margin-top10 limitHeader2">Pro | Star | Network | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"autotranslator",icon:"language",category:"optimization",color:"#9bba5c",name:"Tag Translator",pages:["Edit Video"],summary:"Translate video Tags into other languages to increase global viewership",howToVideoId:"25OHhrk5QyU",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level3Limitation:"Max 50 translations per day",Level0Access:false,Level1Access:false,Level2Access:false,Level3Access:true,Level4Access:true,whyYouNeedIt:["Your want people all around the world find and watch your video","You want your video showing up as a Related Video on other videos around the world","You recognize that YouTube is a global community and want to connect with everyone"],whereToFindIt:'Below your list of Tags on a Video Edit screen and on the Translations Tab on the video edit page <br><img src="/assets/images/tools/screenshots/autotranslatorwhere.png" />',tipsAndTricks:["You are limited in the total number of Tags on a video so only translate your most relevant Tags.","Check out your Analytics before deciding which Tags to translate and see what countries you are getting views from."],limits:'<div class="limitHeader">Starter (FREE) | Pro | Star</div><div class="limitbody">No access</div><div class="margin-top10 limitHeader2">Network | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"metaautotranslator",icon:"language",category:"optimization",color:"#9bba5c",name:"Auto Translator",pages:["Edit Video, Upload Page"],summary:"Translate video Title and Description into other languages to increase global viewership",howToVideoId:null,Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level3Limitation:"Max 50 translations per day",Level0Access:false,Level1Access:false,Level2Access:false,Level3Access:false,Level4Access:true,whyYouNeedIt:["Your want people all around the world find and read the video title and description in their own language","You want your video showing up as a Related Video on other videos around the world","You recognize that YouTube is a global community and want to connect with everyone"],whereToFindIt:'On a Video Edit screen and on the Translations Tab on the video edit page.  Or on the Upload page under the translations tab. <br><img src="/assets/images/tools/screenshots/metaautotranslatorwhere.png" />',tipsAndTricks:["You are limited in the total number of title and descriptions per day, 50.","Check out your Analytics before deciding which Tags to translate and see what countries you are getting views from."],limits:'<div class="limitHeader">Starter (FREE) | Pro | Star</div><div class="limitbody">No access</div><div class="margin-top10 limitHeader2">Network | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"videotopicplanner",icon:"edit",category:"productivity",color:"#445569",name:"Video Topic Planner",pages:["General Page","Edit Page","Watch Page"],summary:"Easily manage and get ideas for future video topics",howToVideoId:"BKf_y6zyV5I",Level0Limitation:"Maximum of 5 video topics and comment suggestions",Level1Limitation:"",Level2Limitation:"",Level3Limitation:"",Level0Access:false,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You have trouble coming up with ideas for new videos","You keep forgetting those great video suggestions from your audience in the video comments area","You don't have an easily accessible and reliable way of saving and tracking future video ideas"],whereToFindIt:'Click Video Topic Planner from the main TubeBuddy Menu<br><img src="/assets/images/tools/screenshots/videotopicplannerwhere.png" />',tipsAndTricks:["You can sort your list of topics by dragging them up/down in the list",'Head to the comments section of any of your videos, click the TubeBuddy icon next to a comment and then check the box next to "Comment Suggestion" and it will show up in the Video Topic Planner tool'],limits:'<div class="limitHeader">Starter (FREE)</div><div class="limitbody"><ul class="margin-left30"><li>Max of 5 Topics</li><li>Max of 5 Comment Suggestions</li></ul></div><div class="margin-top10 limitHeader2"> | Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"uploadchecklist",icon:"check-square-o",category:"productivity",color:"#445569",name:"Upload Checklist",pages:["My Videos, Upload"],summary:"Never forget an important step when uploading new videos",howToVideoId:"iFLnYHreEGU",Level0Limitation:"",Level1Limitation:"",Level2Limitation:"",Level3Limitation:"",Level0Access:true,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You don't always remember everything you need to do during the upload process","You want to follow what the YouTube experts recommend (you can import their lists)","You want a convenient way to organize all your tips and tricks during the upload process"],whereToFindIt:'Upload Page<br><img src="/assets/images/tools/screenshots/uploadchecklistwhere.png" />',tipsAndTricks:["Modify your checklist template by heading to TubeBuddy.com"],limits:'<div class="limitHeader">Starter (FREE)</div><div class="limitbody"><ul class="margin-left30"><li>Max of 5 Topics</li><li>Max of 5 Comment Suggestions</li></ul></div><div class="margin-top10 limitHeader2"> | Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"bestpractice",icon:"book",category:"optimization",color:"#445569",name:"Best Practice Audit",pages:["My Videos"],summary:"Automated checks to ensure you're following YouTube's recommendations",howToVideoId:"JeMrZmqpeSk",Level0Limitation:"",Level1Limitation:"",Level2Limitation:"",Level3Limitation:"",Level0Access:false,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You you want to ensure your video is set up correctly","You want to make sure there are no broken links in your video descriptions","You want to remember to add specific words or phrases in your titles/tags/descriptions"],whereToFindIt:"My Videos page, video edit page, and the TubeBuddy.com website",tipsAndTricks:["Create your own Best Practice items specific to your channel","Disable any Best Practice checks that don't apply to your channel"],limits:'<div class="limitHeader">Starter (FREE)</div><div class="limitbody"><ul class="margin-left30"><li>Max of 5 Topics</li><li>Max of 5 Comment Suggestions</li></ul></div><div class="margin-top10 limitHeader2"> | Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"opportunities",icon:"lightbulb-o",category:"optimization",color:"#445569",name:"Opportunity Finder",pages:["My Videos"],summary:"Suggestions for channel growth based on video performance and analytics",howToVideoId:"lkakEuHCY40",Level0Limitation:"",Level1Limitation:"",Level2Limitation:"",Level3Limitation:"",Level0Access:false,Level1Access:false,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You are missing out on opportunities outside of YouTube's website","It would take you too long to research items that TubeBuddy automatically finds for you","You can potentially gain views, subscribers and more engagement by following our recommendations"],whereToFindIt:"My Videos page and TubeBuddy.com website",tipsAndTricks:["You can disable Opportunities that don't apply to you","You can automate the Opportunity Finder on the Launch Pad Settings page if you have upgraded access"],limits:'<div class="limitHeader">Starter (FREE)</div><div class="limitbody"><ul class="margin-left30"><li>Max of 5 Topics</li><li>Max of 5 Comment Suggestions</li></ul></div><div class="margin-top10 limitHeader2"> | Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"bulkcopyendscreen",icon:"copy",category:"bulk",color:"#445569",pages:["My Videos"],name:"Bulk Copy End Screen",summary:"Automate the process of copying End Screens across some or all of your videos",howToVideoId:"_U4NewnOCNs",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:false,Level1Access:false,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["Manually adding End Screen Elements on all your videos one by one takes forever and is a pain in the &#^@@$","Copying End Screen Elements through TubeBuddy ensures you have a clean, consistent look across all your videos",'<a href="https://support.google.com/youtube/answer/6388789?p=end_screens&hl=en&rd=1" target="_blank">End Screens</a> are extemely important for marketing your brand on desktop and mobile'],whereToFindIt:'Go to your <a class="underline" target="_blank" href="https://www.youtube.com/my_videos">My Videos</a> page on YouTube and select "Bulk Copy End Screen" from the TubeBuddy menu next to the video that you want to copy Cards <i>from</i>.<br /><img src="/assets/images/tools/screenshots/bulkcopyendscreenwhere.png" />',tipsAndTricks:['Don\'t worry if your videos have different durations. TubeBuddy uses "Smart Timing" to figure out where to place the End Screen Elements on each destination video.','If want to get rid of all existing End Screen Elements from the destination videos before copying the new Elements, simply select the "Delete all existing End Screen Elements " option in Step 2.',"Each video is processed 1 at a time and takes a second or two. So 1,000 videos might take about 30 minutes to process. We recommend limiting bulk copying to 2,000 or less videos. If you have more, consider breaking them up into playlists and running the tool for each playlist separately.","After processing is complete, you can click on the video link in the <i>Completed</i> area to quickly verify that it was done correctly.","You can customize End Screen Element properties on individual destination videos in Step 3."],limits:'<div class="limitHeader">Starter (FREE) | Pro</div><div class="limitbody">Cannot copy End Screen Elements to more than one video at a time</div><div class="margin-top10 limitHeader2">Network | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"bulkdeleteendscreen",icon:"remove",category:"bulk",color:"#445569",pages:["My Videos"],name:"Bulk Delete End Screen",summary:"Automate the process of deleting End Screens Elements across some or all of your videos",howToVideoId:null,Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:false,Level1Access:false,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["Manually deleting End Screen Elements on all your videos one by one takes forever and is a pain in the &#^@@$","Delete an End Screen Element for a site, video or playlist you no longer want to promote"],whereToFindIt:'Go to your <a class="underline" target="_blank" href="https://www.youtube.com/my_videos">My Videos</a> page on YouTube and select the Bulk TubeBuddy menu above your list of videos.  Then select the "Delete" sub menu under the "End Screens" menu.<br /><img src="/assets/images/tools/screenshots/bulkdeleteendscreenwhere.png" />',tipsAndTricks:["Each video is processed 1 at a time and takes a second or two. So 1,000 videos might take about 30 minutes to process. We recommend limiting bulk copying to 2,000 or less videos. If you have more, consider breaking them up into playlists and running the tool for each playlist separately.","After processing is complete, you can click on the video link in the <i>Completed</i> area to quickly verify that it was done correctly."],limits:'<div class="limitHeader">Starter (FREE) | Pro</div><div class="limitbody">Cannot delete End Screen Elements to more than one video at a time</div><div class="margin-top10 limitHeader2">Network | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"endscreentemplates",icon:"th-large",category:"productivity",color:"#445569",name:"End Screen Templates",pages:["Video Upload, End Screen, My Videos"],summary:"Set any video as a <i>End Screen Template</i> then easily apply its End Screen Elements to new uploads",howToVideoId:"EyQ7DgUv228",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:false,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You are manually creating the same set of End Screen Elements on all new uploads","You want to handle all aspects of new uploads quickly and efficiently","You have different sets of End Screen Elements to apply depending on what type of video you upload"],whereToFindIt:'Set a video as a End Screen Template at the bottom of the End Screen page for that video (then you will be able to apply this template on the Upload screen after any new video has been uploaded and processed).<br /><img src="/assets/images/tools/endscreentemplateswhere2.png" /><br /><br /><b>Studio Beta:</b> Above on the Video Editor page. <br /><img src="/assets/images/tools/screenshots/endscreentemplateswhere.png" />',tipsAndTricks:["Set up different End Screen Templates for the different types of videos you create. Then on the Upload screen, choose a template based on the type of video being uploaded.",'TubeBuddy uses "Smart Timing" to ensure the End Screen get applied in the correct location on your new upload no matter what the duration of the video is.'],limits:'<div class="limitHeader">Starter (FREE)</div><div class="limitbody">This tool is not available</div><div class="margin-top10 limitHeader2">Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"shareontwitter",icon:"twitter",category:"promotion",color:"#445569",name:"Share on Twitter",pages:["Video Upload, My Videos"],summary:"Easy share your YouTube videos on Twitter and automatically attach your thumbnail to it",howToVideoId:"",Level0Limitation:"TubeBuddy branding on Post",Level1Limitation:null,Level2Limitation:null,Level0Access:true,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You want to easily share your videos on Twitter directly from YouTube","You want to attach your video thumbnail for a more eye-catching Tweet","You want to help drive more draffic and views to your videos"],whereToFindIt:'Any video list or video edit screen. <br /><img src="/assets/images/tools/screenshots/shareontwitterwhere.png" />',tipsAndTricks:["You can add as many Twitter accounts as you would like to post from","Check the box to attach your Thumbnail for a more visually appealing post"],limits:'<div class="limitHeader">Starter (FREE)</div><div class="limitbody">This tool is not available</div><div class="margin-top10 limitHeader2">Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"bulkupdateendscreens",icon:"list",category:"bulk",color:"#445569",name:"Bulk Update End Screens",pages:["My Videos"],summary:"Automate the process of updating End Screen across some or all of your videos",howToVideoId:"e2baTTR9ExU",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:false,Level1Access:false,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["Manually updating End Screens on all your videos one by one takes forever and is a pain in the &#^@@$","You want to replace an old promotion link on all End Screens to a new promotion link","You want to test different Titles or Images to see which converts better"],whereToFindIt:'Go to your <a class="underline" target="_blank" href="https://www.youtube.com/my_videos">My Videos</a> page on YouTube and select "Update" under "Bulk End Screen Updates" in the TubeBuddy menu at the top of the page. <br /><img src="/assets/images/tools/screenshots/bulkupdateendscreenswhere.png" />',tipsAndTricks:[],limits:'<div class="limitHeader">Starter (FREE) | Pro</div><div class="limitbody">Cannot update End Screens to more than one video at a time</div><div class="margin-top10 limitHeader2">Network | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"taglists",icon:"list-alt",category:"optimization",color:"#445569",name:"Tag Lists",pages:["General Page","Edit Page","Watch Page","Upload Page"],summary:"Create and manage centralized lists of Tags",howToVideoId:"yeT8blc5rPs",Level0Limitation:"Maximum of 3 lists",Level1Limitation:"",Level2Limitation:"",Level3Limitation:"",Level0Access:false,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You want to store related tags for later use","You want quick access to certain sets of tags","You want to ditch your Excel spreadsheets"],whereToFindIt:'My Videos page<br><img src="/assets/images/tools/screenshots/taglistswhere.png" /><br><br><br>[LOCATION 2] On a video edit screen, click the "Copy Tags" button<img src="/assets/images/tools/screenshots/copytags-where.png" />',tipsAndTricks:[],limits:'<div class="limitHeader">Starter (FREE)</div><div class="limitbody"><ul class="margin-left30"><li>Max of 3 Lists</li><li>Max of 3 Lists</li></ul></div><div class="margin-top10 limitHeader2"> | Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"keywordranktracking",icon:"list-ol",category:"optimization",color:"#9bba5c",name:"Search Rank Tracking",pages:[],summary:"Track your videos rankings (and your competitors) across YouTube and Google search for desired Keywords",howToVideoId:"8MEWI_10obg",Level0Limitation:null,Level1Limitation:null,Level2Limitation:"Max 5 Keywords, No Competitor Tracking, YouTube only (no Google)",Level3Limitation:"Max 50 Keywords",Level0Access:false,Level1Access:false,Level2Access:false,Level3Access:false,Level4Access:true,whyYouNeedIt:["You want to track your Video SEO efforts","You want to see where you rank compared to your Competitors for certain keywords","You want and overall status of how your channel is performing in YouTube and Google search"],whereToFindIt:"TubeBuddy Star, Legend or Enterprise Dashboard",tipsAndTricks:["Think about what people might search to find your product","Try to out-optimize your competitors"],limits:'<div class="limitHeader">Starter (FREE) | Network | Pro | Star </div><div class="limitbody">This tool is not available</div><div class="margin-top10 limitHeader2">Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"videolytics",icon:"line-chart",category:"research",color:"#9bba5c",name:"Videolytics",pages:[],summary:"Access advanced analytics and insights, instantly for any YouTube video",howToVideoId:"RO4gDgLp93o",Level0Limitation:"Can only compare video to channel's most popular video",Level1Limitation:null,Level2Limitation:null,Level3Limitation:null,Level0Access:true,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["Research competitor videos to see what's working and not working for them","Get insights on trending videos to see what's hot","Compare any video on YouTube with another video across a wide variety of stats"],whereToFindIt:"Video Watch Page",tipsAndTricks:[""],limits:'<div class="limitHeader">Starter (FREE) | Network | Pro | Star </div><div class="limitbody">This tool is not available</div><div class="margin-top10 limitHeader2">Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"scheduledvideoupdate",icon:"calendar",category:"productivity",color:"#445569",name:"Scheduled Video Update",pages:["My Videos","Edit Video","Upload"],summary:"Schedule video updates at a future date/time ",howToVideoId:"Tp1F7ERoSVQ",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:false,Level1Access:false,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You want to schedule a change to a video's Title, Tags, Description or Thumbnail in the future","You want to and or remove a video from playlists at a certain time in the future","You want to schedule a privacy change (Public / Unlisted / Private) to your video in the future"],whereToFindIt:'On the My Videos page and Edit Video page. <br /><img src="/assets/images/tools/screenshots/scheduledvideoupdatewhere.png" />',tipsAndTricks:["If you want to run a promotion, use the Rollback feature to automatically roll-back your changes at a later date/time."],limits:'<div class="limitHeader">Starter (FREE) | Pro </div><div class="limitbody">Cannot Sunset Videos</div><div class="margin-top10 limitHeader2">Star | Network | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"searchexplorer",icon:"search",category:"optimization",color:"#9bba5c",name:"Search Explorer",pages:["Search Results"],summary:"The ultimate Search Term research tool for YouTube",howToVideoId:"vFDZ_5S5X-A",Level0Limitation:"Can only see top 3 results in each category, 25 searches per day. ",Level1Limitation:null,Level2Limitation:null,Level0Access:false,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["Get your videos ranked higher in search results and ultimately get more views","Find long-tail search terms to better target what people are looking for on YouTube ","Discover search terms to target based on search volume, competition and overall score"],whereToFindIt:'On the Search page. *Only available on YouTube\'s new UI  <br /><img src="/assets/images/tools/screenshots/searchexplorerwhere.png" />',tipsAndTricks:["Find Tags that have a high keyword score meaning they are searched often but there is not too much competition.","Unless you are PewDiePie, it's hard to get your videos ranked high for broad search terms. Try targeting long-tail (more specific) keywords."],limits:'<div class="limitHeader">Starter (FREE)</div><div class="limitbody">Cannot view more than the top three results in each section</div><div class="margin-top10 limitHeader2">Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"instasuggest",icon:"magic",category:"optimization",color:"#9bba5c",name:"Insta-Suggest",pages:["Edit Video","Upload"],summary:"See tag suggestions in real-time as you type",howToVideoId:"HvVfXPC0wrA",Level0Limitation:"Can only see top 3 results",Level1Limitation:null,Level2Limitation:null,Level0Access:false,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You want to add tags matching what people are searching for",'You are <span style="text-decoration: line-through;">lazy</span> efficient and want to see results as you type',"You want helpful hints on popular trends and search phrases"],whereToFindIt:'<img src="/assets/images/tools/screenshots/instasuggestwhere.png" />',tipsAndTricks:["Click the Explore button at the bottom to dive deeper into the topic","Click the Suggest button at the bottom for more suggestions for the video"],limits:'<div class="limitHeader">Starter (FREE)</div><div class="limitbody">Cannot view more than the three results</div><div class="margin-top10 limitHeader2">Network | Pro | Star | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"demonetizationaudit",icon:"dollar",category:"research",color:"#9bba5c",name:"Demonetization Audit",pages:["Edit Video","Upload"],summary:"Find words in your tile, description or tags that could potentially cause demonetization of your video.",howToVideoId:"",Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:true,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You want to make sure you don't include words in your title, descrption or tags that could cause demonetization","You want to ensure you are making the most money possible from your channel"],whereToFindIt:'On the Video Edit page <img src="/assets/images/tools/screenshots/demonetizationauditwhere.png"/>',tipsAndTricks:["Can be disabled in TubeBuddy settings."],limits:'<div class="limitHeader">Starter (FREE) | Pro | Star</div><div class="limitbody">Cannot Sunset Videos</div><div class="margin-top10 limitHeader2">Network | Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"commentspotlight",icon:"search",category:"productivity",color:"#445569",name:"Comment Spotlight",pages:["Comments"],summary:"Easily identify comments from your Patreon supporters or recent subscribers",howToVideoId:null,Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:false,Level1Access:false,Level2Access:false,Level3Access:true,Level4Access:true,whyYouNeedIt:["You want to quickly and easily identify patreon supporters or recent subscribers in your comments.",'<a href="https://tubebuddy.freshdesk.com/solution/articles/5000817653-comment-spotlight" target="_blank"> Learn More </a> '],whereToFindIt:'Go to your <a class="underline" target="_blank" href="https://studio.youtube.com/comments">Comments</a> page on Creator Studio and look right above the first comment.<br /><img src="/assets/images/tools/commentspotlightwhere.png" />',tipsAndTricks:[],limits:'<div class="limitHeader">Starter (FREE) | Network | Pro | Star </div><div class="limitbody">This tool is not available</div><div class="margin-top10 limitHeader2">Legend | Enterprise</div><div class="limitbody">Unlimited</div>'},{id:"seostudio",icon:"line-chart",category:"optimization",color:"#9bba5c",name:"SEO Studio",pages:["Edit Video","Upload (classic)"],summary:"Optimize your video metadata for a specific keyword.",howToVideoId:null,Level0Limitation:null,Level1Limitation:null,Level2Limitation:null,Level0Access:false,Level1Access:true,Level2Access:true,Level3Access:true,Level4Access:true,whyYouNeedIt:["You want your video to show up in search and related"],whereToFindIt:'<span style="font-size:12px; font-weight:bold;">[LOCATION 1]</span><br> Click SEO Studio from the main TubeBuddy Menu <br /><img src="/assets/images/tools/seostudiowhere1.png" /> <br><Br><span style="font-size:12px; font-weight:bold;">[LOCATION 2]</span><br>Uploads (classic).<br/><img src="/assets/images/tools/seostudiowhere2.png" /><br/><br><br><Br><span style="font-size:12px; font-weight:bold;">[LOCATION 3]</span><br>On a Video Edit or Videos List screen in the Tools Menu.<br/><img src="/assets/images/tools/seostudiowhere3.png" /><br/><br>',tipsAndTricks:[],limits:""}];var m=function(){TBExtension.GetExtensionVersion();Q();B();g()};var g=function(){u.push({key:"fullscreen",name:"Fullscreen",url:"http://www.fullscreen.com"});u.push({key:"vevo",name:"VEVO",url:"http://www.vevo.com"});u.push({key:"vevostandard",name:"VEVO",url:"http://www.vevo.com"});u.push({key:"rpmnetworks",name:"Maker Studios",url:"http://www.makerstudios.com/"});u.push({key:"thegamestation",name:"Maker Studios",url:"http://www.makerstudios.com/"});u.push({key:"thestation user",name:"Maker Studios",url:"http://www.makerstudios.com/"});u.push({key:"thestation+user",name:"Maker Studios",url:"http://www.makerstudios.com/"});u.push({key:"paramaker_affiliate",name:"Maker Studios",url:"http://www.makerstudios.com/"});u.push({key:"stylehaul_affiliate",name:"StyleHaul",url:"http://www.StyleHaul.com"});u.push({key:"stylehaul affiliate",name:"StyleHaul",url:"http://www.StyleHaul.com"});u.push({key:"stylehaul",name:"StyleHaul",url:"http://www.StyleHaul.com"});u.push({key:"mitu",name:"Mitu",url:"https://mitunetwork.com/"});u.push({key:"machinima",name:"Machinima",url:"http://www.machinima.com/"});u.push({key:"machinima_managed",name:"Machinima",url:"http://www.machinima.com/"});u.push({key:"machinima managed",name:"Machinima",url:"http://www.machinima.com/"});u.push({key:"collective",name:"Collective Digital Studios",url:"http://collectivedigitalstudio.com/"});u.push({key:"collective_affiliate",name:"Collective Digital Studios",url:"http://collectivedigitalstudio.com/"});u.push({key:"collective affiliate",name:"Collective Digital Studios",url:"http://collectivedigitalstudio.com/"});u.push({key:"cds_female",name:"Collective Digital Studios",url:"http://collectivedigitalstudio.com/"});u.push({key:"cds female",name:"Collective Digital Studios",url:"http://collectivedigitalstudio.com/"});u.push({key:"broadbandtv_gaming",name:"Broadband TV",url:"http://bbtv.com/"});u.push({key:"broadbandtv gaming",name:"Broadband TV",url:"http://bbtv.com/"});u.push({key:"broadbandtv_entertainment",name:"Broadband TV",url:"http://bbtv.com/"});u.push({key:"broadbandtv entertainment",name:"Broadband TV",url:"http://bbtv.com/"});u.push({key:"broadbandtv_music",name:"Broadband TV",url:"http://bbtv.com/"});u.push({key:"broadbandtv music",name:"Broadband TV",url:"http://bbtv.com/"});u.push({key:"bbtv_vip_gaming_managed",name:"Broadband TV",url:"http://bbtv.com/"});u.push({key:"bbtv vip gaming managed",name:"Broadband TV",url:"http://bbtv.com/"});u.push({key:"omniamediaco",name:"Omnia Media",url:"http://www.omniamedia.co/"});u.push({key:"topbeautyblog",name:"VSP Group",url:"https://youpartnerwsp.com"});u.push({key:"youpartnervsp",name:"VSP Group",url:"https://youpartnerwsp.com"});u.push({key:"alloy",name:"Defy Media",url:"http://www.defymedia.com/"});u.push({key:"makercurse",name:"Curse Network",url:"http://www.unionforgamers.com/"});u.push({key:"curse_network_managed",name:"Curse Network",url:"http://www.unionforgamers.com/"});u.push({key:"curse network managed",name:"Curse Network",url:"http://www.unionforgamers.com/"});u.push({key:"anytv",name:"Freedom! Network",url:"http://www.freedom.tm"});u.push({key:"anytv_affiliate",name:"Freedom! Network",url:"http://www.freedom.tm"});u.push({key:"anytv affiliate",name:"Freedom! Network",url:"http://www.freedom.tm"});u.push({key:"wmg",name:"WMG",url:"http://www.wmg.com/"});u.push({key:"bigframe",name:"Big Frame",url:"http://www.bigfra.me/"});u.push({key:"quiczgroupaggregator",name:"Quiz Group",url:"http://quizgroup.com/"});u.push({key:"3bdnetwork",name:"3BlackDot",url:"http://3blackdot.com/"});u.push({key:"theorchardmusic",name:"The Orchard Music",url:"http://www.theorchard.com/"});u.push({key:"mixicom",name:"Mixicom",url:"http://www.Mixicom.com"});u.push({key:"deca",name:"Kin Community",url:"http://www.kincommunity.com/"});u.push({key:"believe",name:"Believe Music",url:"http://www.believedigitalstudios.com/"});u.push({key:"divimove_es",name:"DIVIMOVE",url:"http://www.divimove.com/"});u.push({key:"divimove es",name:"DIVIMOVE",url:"http://www.divimove.com/"});u.push({key:"air",name:"Agency of Internet Rights",url:"http://www.air.io/"});u.push({key:"siriusstarnetwork",name:"SiriusXM",url:"http://www.siriusxm.com/"});u.push({key:"awesomenesstv_managed",name:"AwesomenessTV",url:"http://www.awesomenesstvnetwork.com/"});u.push({key:"awesomenesstv",name:"AwesomenessTV",url:"http://www.awesomenesstvnetwork.com/"});u.push({key:"google",name:"Google",url:"https://www.google.com"});u.push({key:"tastemade",name:"Tastemade",url:"https://www.tastemade.com/"});u.push({key:"channelfrederator+user",name:"Frederator",url:"http://frederator.com/"});u.push({key:"channelfrederator user",name:"Frederator",url:"http://frederator.com/"});u.push({key:"sonybmg",name:"Sony",url:"https://www.sonymusic.com/"});u.push({key:"yvxpxuyhsivj4fycb8mohg",name:"Screenwave Media",url:"http://screenwavemedia.com/"});u.push({key:"nextnewnetworks",name:"Next New Networks",url:"http://www.nextnewnetworks.com"});u.push({key:"roosterteeth",name:"RoosterTeeth",url:"http://roosterteeth.com/"});u.push({key:"ygent",name:"YG Entertainment Inc.",url:"http://www.ygfamily.com/"});u.push({key:"lifetube",name:"LifeTube",url:"http://www.lifetube.pl/"});u.push({key:"buzzfeed+user",name:"BuzzFeed",url:"http://www.BuzzFeed.com"});u.push({key:"buzzfeed user",name:"BuzzFeed",url:"http://www.BuzzFeed.com"});u.push({key:"uuum",name:"UUUM",url:"http://www.uuum.jp/"});u.push({key:"channelflip",name:"Channel Flip",url:"http://www.channelflip.com/"});u.push({key:"tseriesmusic",name:"T-Series Music",url:"https://www.youtube.com/user/tseries"});u.push({key:"movieclips",name:"Movie Clips - Fandango",url:"http://www.movieclips.com/"});u.push({key:"spinninrecords",name:"Spinnin Reports",url:"https://www.spinninrecords.com/"});u.push({key:"gmmgrammy",name:"GMM Grammy",url:"https://www.youtube.com/user/gmmgrammyofficial/about"});u.push({key:"moguldomstudios_user",name:"Moguldom Studios",url:"http://moguldomstudios.com"});u.push({key:"moguldomstudios user",name:"Moguldom Studios",url:"http://moguldomstudios.com"});u.push({key:"fremantle",name:"Fremantle Media",url:"http://www.fremantlemedia.com/"})};var v=function(){if(TBExtension.GetType()!="safari")return;jQuery(document).on("focus","select",function(){var e=jQuery(this);jQuery(e).find('option[style*="display:none"], option[style*="display: none"]').each(function(e,t){c.push(jQuery(t).detach())})});jQuery(document).on("blur","select",function(){if(c.length>0){var e=jQuery(this);jQuery(c).each(function(t,i){jQuery(e).append(i)});c=[]}});TBUtilities.CreateCookie("tbCorrectInstanceCookie",i,180)};var T=function(){jQuery(document).on("mousedown","[data-draggable=false]",function(e){e.stopPropagation()});jQuery(document).on("mousedown","div [data-draggable=true]",function(e){var t=jQuery(this).closest(".draggable-container");if(e.offsetX==undefined){x=e.pageX-t.offset().left;y=e.pageY-t.offset().top}else{x=e.offsetX;y=e.offsetY}t.addClass("tb-draggable");h=t;jQuery(document).on("mousemove",function(e){if(h){h.offset({top:e.pageY-y,left:e.pageX-x})}});jQuery(document).on("mouseup",function(e){if(h){h=null;jQuery(".tb-draggable").removeClass("tb-draggable");jQuery(document).off("mousemove");jQuery(document).off("mouseup")}})})};var w=function(){jQuery(document.body).on("TBGlobalUpdateBrowserMetaData",function(e,t){TBUtilities.Log("TBGlobalUpdateBrowserMetaData")});jQuery(document.body).on("TBGetAccessToken",function(e,i){if(i!=null){t=i.value;I()}else{if(!s){s=true;TBGlobal.LoadModules()}}});jQuery(document.body).on("TBGetCurrentChannelId",function(t,i){if(i!=null)e=i.value});jQuery(document.body).on("TBGlobalGetProfile",function(e,i){TBUtilities.Log("TBGlobal - TBGlobalGetProfile");TBUtilities.Log(i);if(i.success&&i.response.indexOf("<title>Login")==-1){a=JSON.parse(i.response);TBUtilities.Log(a);TBGlobal.versionNumber=a.Version;jQuery.each(l,function(e,t){t()});if(a.BrowserMetaUpdate==true){G()}try{TBUtilities.Log("Refresh Twitter Module if needed");if(i.data!=null){if(i.data.callback=="TBLayoutTwitterReloadProfile"){if(TubeBuddyTwitterPost!=null)TubeBuddyTwitterPost.Reload()}}}catch(e){}}else{t=null;if(TubeBuddyLayout){if(i.response==401){TubeBuddyMenu.RefreshTokenError()}else{TubeBuddyMenu.FailedToLoadProfile();return}}}if(!s){s=true;TBGlobal.LoadModules()}});jQuery(document.body).on("CRTBGlobalGetChannelSwitcher",function(e,t){if(t.success){var i=DOMPurify.sanitize(t.response,DOMPurifyConfig);var o=jQuery(".channel-switcher-caption:first",i).text().replace("All for","").trim();if(o==null)return;if(o.indexOf(" ")>-1)o=o.substring(o.lastIndexOf(" ")+1,o.length);a.Email=o;var n=jstz.determine_timezone();var r=n.timezone;if(r!="undefined"){r.ambiguity_check()}var s=r.utc_offset}else{}});jQuery(document.body).on("CRGlobalGetActionCount",function(e,t){try{if(t.success){var i=parseInt(t.response);t.data.callback(i)}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyGlobal] [CRGlobalGetActionCount]"})}});jQuery(document.body).on("TBGetCurrentAccount",function(e,t){if(t.success){var i="";if(t.response.indexOf('"channel_external_id":"')>0){var a=t.response.indexOf('"channel_external_id":"')+'"channel_external_id":"'.length;i=t.response.substring(a,a+24)}else{try{var n=jQuery.parseHTML(DOMPurify.sanitize(t.response,DOMPurifyConfig));var r=jQuery(n).find("a.yt-user-name").first().attr("href");if(r){i=r.substr(r.lastIndexOf("/")+1)}else{var s=TBUtilities.ParseResponseContextFromHtml(t.response);if(s&&s.responseContext){i=s.responseContext.serviceTrackingParams[2].params[0].value}}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyGlobal] [TBGetCurrentAccount]"})}}if(S(i)===false&&t.response.indexOf("http://www.youtube.com/channel/")>0){var l=t.response.indexOf("http://www.youtube.com/channel/")+"http://www.youtube.com/channel/".length;i=t.response.substring(l,l+24)}if(S(i)){C(i);o="Found T9: "+i}}});jQuery(document).on("TBGetCurrentStudioAccount",function(e,t){j(0)})};var j=function(e){if(e>240)return;setTimeout(function(){try{var t=jQuery("a#home-button").first();if(t){var i=jQuery(t).attr("href");if(i){extractedId=i.substr("/channel/".length);var o=extractedId.indexOf("?");if(o>-1){extractedId=extractedId.substring(0,o)}if(S(extractedId)){C(extractedId);return}}}}catch(e){TBUtilities.log("Response failure on TBGetCurrentStudioAccount. Details: "+JSON.stringify(e))}j(++e)},250)};var Q=function(){var e="";try{var t=jQuery("body")[0].outerHTML;var i=t.indexOf('"host_language":"')+'"host_language":"'.length;var o=t.indexOf('"',i+1);var a=t.substring(i,o);if(a.length>=2&&a.length<=7)e=a}catch(e){}if(e!=""){try{var t=jQuery("body")[0].outerHTML;var i=t.indexOf("'FEEDBACK_LOCALE_LANGUAGE': \"")+"'FEEDBACK_LOCALE_LANGUAGE': \"".length;var o=t.indexOf('"',i+1);var a=t.substring(i,o);if(a.length>=2&&a.length<=7)e=a}catch(e){}}if(e!=""){try{var t=jQuery("body")[0].outerHTML;var i=t.indexOf("//www.youtube.com/yt/about/")+"//www.youtube.com/yt/about/".length;var o=t.indexOf("/",i+1);var a=t.substring(i,o);if(a.length>=2&&a.length<=7)e=a}catch(e){}}try{var n=jQuery("#yt-picker-language-button")[0].outerHTML;var i=n.indexOf("yt-picker-button-label");i=n.indexOf("</span>",i)+"</span>".length;var o=n.indexOf("<",i);TBGlobal.language=n.substring(i,o)}catch(e){}if(e=="")e="en";TBGlobal.languageCode=e};var B=function(){M("Starting Page Extract for url "+window.location.href);TBUtilities.Log("TBGlobal - Starting Page Extract for url "+window.location.href);try{if(jQuery("li.guide-channel").length>0){var e=false;jQuery("li.guide-channel").each(function(){var t=jQuery(this).attr("id");if(t.indexOf("UC")==0){t=t.replace("-guide-item","");if(S(t)){C(t);o="Found T1: "+t;e=true;M("Found id in channel-guide TEST: "+t)}return false}});if(e)return}var t=jQuery("body").html().indexOf('"viewer_id": "')+'"viewer_id": "'.length;if(t>100){var i=jQuery("body").html().substring(t,t+24);if(S(i)){C(i);o="Found T2: "+i+" [["+document.URL+"]]";M("Found id in viewer_id: "+i);return}}var a=jQuery("body").html().indexOf("viewer_id\\u003d")+"viewer_id\\u003d".length;if(a>100){var i=jQuery("body").html().substring(a,a+24);if(S(i)){C(i);o="Found T3: "+i+" [["+document.URL+"]]";M("Found id in viewer_id2: "+i);return}}var n=jQuery("body").html().indexOf("/bulk_actions_ajax?o=U&amp;channel=")+"/bulk_actions_ajax?o=U&amp;channel=".length;if(n>100){var i="UC"+jQuery("body").html().substring(n,n+22);if(S(i)){C(i);o="Found T4: "+i+" [["+document.URL+"]]";M("Found id in viewer_id3: "+i);return}}var r=jQuery("body").html().indexOf("'userExternalId': \"")+"'userExternalId': \"".length;if(r>100){var i="UC"+jQuery("body").html().substring(r,r+22);if(S(i)){C(i);o="Found T5: "+i+" [["+document.URL+"]]";M("Found id in viewer_id4: "+i);return}}if(jQuery(".video-thumb.yt-thumb.yt-thumb-46.g-hovercard").length>0){var s=jQuery(".video-thumb.yt-thumb.yt-thumb-46.g-hovercard:first").attr("data-ytid");if(S(i)){C(i);o="Found T6: "+s+" [["+document.URL+"]]";M("Found id in hovercard: "+i);M("HC: "+jQuery(".video-thumb.yt-thumb.yt-thumb-46.g-hovercard")[0].outerHTML);return}}if(document.URL.indexOf("/comments")>0){if(jQuery(".yt-user-photo").length>0){var l=jQuery(".yt-user-photo:first")[0].outerHTML;if(l.indexOf("data-ytid")>0){var d=l.indexOf("data-ytid")+11;var u=d+24;var c=l.substring(d,u);if(S(c)){C(c);o="Found yt-user-photo "+c+" [["+document.URL+"]]";M("Found id in yt-user-photo: "+c);return}}}}var p=jQuery("body").html().indexOf("my_liked_videos&amp;list=LL")+"my_liked_videos&amp;list=LL".length;if(p>100){var i="UC"+jQuery("body").html().substring(p,p+22);if(S(i)){C(i);o="Found T7: "+i+" [["+document.URL+"]]";M("Found id in my_liked_videos: "+i);return}}var b=jQuery("body").html().indexOf('"channel_id": "')+'"channel_id": "'.length;if(b>100){var i="UC"+jQuery("body").html().substring(b,b+22);if(S(i)){C(i);o="Found T8: "+i+" [["+document.URL+"]]";M("Found id in channel_id: "+i);return}}if(jQuery("body").html().indexOf("yt-suggest-menu-item")>0){TBUtilities.Log("yt-suggest-menu-item");var y=jQuery(".yt-suggest-menu-item").first();if(y){TBUtilities.Log("yes yt-suggest-menu-item");var i="UC"+y.find("a:first").attr("data-channel-external-id");if(S(i)){TBUtilities.Log("T9: "+i);C(i);o="Found T9: "+i+" [["+document.URL+"]]";M("Found id in T9 yt-suggest-menu-item: "+i);return}}}if(jQuery("body").html().indexOf('channel_external_id":"')>0&&window.location.href.indexOf("timedtext_editor")==-1){TBUtilities.Log("channel_external_id");var h=jQuery("body").html().indexOf('channel_external_id":"')+'channel_external_id":"'.length;var f=jQuery("body").html().substring(h,h+24);if(S(f)){TBUtilities.Log("T10: "+f);C(f);o="Found T10: "+f+" [["+document.URL+"]]";M("Found id in T10 channel_external_id: "+f);return}}if(jQuery("body").html().indexOf('"key":"creator_channel_id","value":"')>0){var h=jQuery("body").html().indexOf('"key":"creator_channel_id","value":"')+'"key":"creator_channel_id","value":"'.length;var f=jQuery("body").html().substring(h,h+24);if(S(f)){TBUtilities.Log("T11: "+f);C(f);o="Found T11: "+f+" [["+document.URL+"]]";M("Found id in T11 channel_external_id: "+f);return}}if(jQuery("body").html().indexOf('"key":"creator_channel_id","value":"')>0){var h=jQuery("body").html().indexOf('"key":"creator_channel_id","value":"')+'"key":"creator_channel_id","value":"'.length;var f=jQuery("body").html().substring(h,h+24);if(S(f)){TBUtilities.Log("T11: "+f);C(f);o="Found T11: "+f+" [["+document.URL+"]]";M("Found id in T11 channel_external_id: "+f);return}}if(jQuery("body").html().indexOf('href="#/channel/')>0){var h=jQuery("body").html().indexOf('href="#/channel/')+'href="#/channel/'.length;var f=jQuery("body").html().substring(h,h+24);if(S(f)){TBUtilities.Log("T12: "+f);C(f);o="Found T12: "+f+" [["+document.URL+"]]";M("Found id in T12 channel_external_id: "+f);return}}if(window.location.hostname.toLowerCase()==="studio.youtube.com"){var m=location.pathname;var g=[];TBUtilities.Log(m);if(m){g=m.substring(1).split("/");TBUtilities.Log(g);for(var v=0;v<5-g.length;v++){g.push("")}if(g[1]&&g[1].length==24){C(g[1]);return}}}M("DNF!");O("dnfc");if(window.location.hostname.toLowerCase()==="www.tubebuddy.com"){k()}else if(window.location.hostname.toLowerCase()==="studio.youtube.com"){TBExtension.Get("https://studio.youtube.com/channel/","TBGetCurrentStudioAccount")}else{TBExtension.Get("https://www.youtube.com/account","TBGetCurrentAccount")}}catch(e){M("Exception searching for ID!: "+e.message);M(jQuery("body").html())}TBExtension.GetDbValue("currentChannelId","TBGetCurrentChannelId")};var k=function(){};var L=function(e,t){var i=TBGlobal.host+TBGlobal.apiUrls.channelActionGetCount+"?actionType="+e;TBExtension.Get(i,t)};var U=function(){TBExtension.GetDbValue(TBGlobal.tokenKey+e,"TBGetAccessToken")};var C=function(t){TBUtilities.Log("TBGlobal - setCurrentChannelId: "+t);TBExtension.SetDbValue("currentChannelId",t);e=t;U()};var A=function(e){return TBUtilities.GetInArray(u,"key",e)};var S=function(e){if(e==null)return false;if(e.substring(0,2)!="UC")return false;if(e.length!=24)return false;if(e.indexOf(" ")>=0||e.indexOf(">")>=0||e.indexOf("<")>=0||e.indexOf("=")>=0||e.indexOf("'")>=0||e.indexOf('"')>=0||e.indexOf(";")>=0)return false;return true};var E=function(){TBUtilities.Log("PROFILE UPDATES");TBUtilities.Log(l.length);jQuery.each(l,function(e,t){t()})};var I=function(e){var i=jstz.determine_timezone();var o=i.timezone;if(o!="undefined"){o.ambiguity_check()}var a=o.utc_offset;if(t!=null&&t.length>0){var n=TBGlobal.host+TBGlobal.apiUrls.youtubeChannelGetProfile+"?timeZoneOffset="+TBUtilities.GetUrlEncoded(a);TBExtension.Get(n,"TBGlobalGetProfile",{callback:e})}else{if(!s){s=true;TBGlobal.LoadModules()}}};var G=function(){try{var e=Y();var t=W();if(t&&t.f6){e+=" - "+t.f6}var i=TBExtension.GetType();var o="pac"+"hck"+"jke"+"cff"+"pdp"+"hbp"+"mfo"+"lbl"+"odf"+"kgb"+"hl";R(o,function(t,o){var a={V:t,P:o,Pref:e,ExtensionType:i};var n=TBGlobal.host+TBGlobal.apiUrls.userUpdateBrowserMeta;TBExtension.Post(n,JSON.stringify(a),"TBGlobalUpdateBrowserMetaData",null,{contentType:"application/json"})})}catch(e){TBUtilities.Log("updateBrowserMetaData error");TBUtilities.Log(e)}};var R=function(e,t){var i=window.chrome,o=window.navigator,a=o.vendor,n=o.userAgent.indexOf("OPR")>-1,r=o.userAgent.indexOf("Edge")>-1,s=o.userAgent.match("CriOS");if(s){t(false,false)}else if(i!=null&&i!=undefined&&a=="Google Inc."&&n==false&&r==false){setTimeout(function(){var i;i=new Image;i.src="chr"+"ome-e"+"xtension://"+e+"/images/vi"+"diq"+"_pl"+"aypl"+"us.png";i.onload=function(){var e=false;try{var i=".vi"+"di"+"q-t"+"ool"+"ba"+"r-st"+"ats"+"-co"+"nta"+"iner";var o=".too"+"lba"+"r-upsell";if(jQuery(i).find(o).length==0){e=true}}catch(e){}t(true,e)};i.onerror=function(){t(false,false)}},8e3)}else{t(false,false)}};var P=function(e){var t=jstz.determine_timezone();var i=t.timezone;if(i!="undefined"){i.ambiguity_check()}var o=i.utc_offset;var a=TBGlobal.host+TBGlobal.apiUrls.youtubeChannelGetProfile+"?timeZoneOffset="+TBUtilities.GetUrlEncoded(o)+"&extensiontype="+TBUtilities.GetUrlEncoded(TBExtension.GetType());TBExtension.Get(a,"TBGlobalGetProfile",{callback:e})};var D=function(e){if(e==null)e="";var t=TBGlobal.host+"/account/upgrade";t+="?id="+TBGlobal.CurrentChannelId();t+="&f="+e;return t};var V=function(e,t){TBUtilities.AddActivityLog({Data:t+" ["+e+"]"},TBUtilities.ActivityLogTypes.ShowUpgradePage);if(e!=null&&e!=""){TubeBuddyUpgradeScreen.Show(e,t)}else if(t!=null){var i=window.open(D(t),"_blank");i.focus()}};var _=function(e){TubeBuddyWordCloud.Show(e)};var M=function(e){TBUtilities.Log(e);if(d==""){d+="Started: "+new Date;if(TBGlobal.Profile()!=null){d+="<br/>Channel: "+TBGlobal.CurrentChannelId();d+="<br/>License: "+TBGlobal.Profile().LicenseTypeName;d+="<br/>Network: "+TBGlobal.Profile().NetworkType}d+="<br/>Channel: https://www.youtube.com/channel/"+TBGlobal.CurrentChannelId();d+="<br/><br/>-----------------------------"}if(TBUtilities!=null)d+="<br/>&gt; "+TBUtilities.GetHtmlEncoded(e);else d+="<br/>&gt; "+e};var O=function(e){p+="{"+e+"}"};var F=function(e){d=""};var N=function(e,t){TBUtilities.Log("loadModules");TubeBuddyYouTubeActions.Initialize();TBYouTubeApi.Initialize();TubeBuddyUpgradeScreen.Initialize();if(e.indexOf("https://www.youtube.com")!=0&&e.indexOf("https://studio.youtube.com")!=0&&e.indexOf("http://www.youtube.com")!=0&&e.indexOf("www.youtube.com")!=0&&e.indexOf("youtube.com")!=0){return}if(e.indexOf("https://www.youtube.com")>=0||e.indexOf("https://studio.youtube.com")>=0){TubeBuddyStatFire.Initialize();TubeBuddyMenu.Initialize();TubeBuddyWordCloud.Initialize();TubeBuddyKidsCenter.Initialize()}if(e.indexOf("https://studio.youtube.com")==0){TBUtilities.Log("Studio Beta Parsing");var i=location.pathname;var o=[];TBUtilities.Log(i);TubeBuddyUploadDefaultsStudio.Initialize();TubeBuddyUploadStudio.Initialize();var a="tb-coppa-open-"+TBGlobal.CurrentChannelId();TBExtension.GetDbValue(a,function(e,t){TBExtension.RemoveDbValue(e);if(t){var i=setInterval(function(){if(jQuery("#main:visible").length>0){clearInterval(i);TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyKidsCenter.Show()}},500)}});if(i){var o=i.substring(1).split("/");TBUtilities.Log(o);for(var n=0;n<5-o.length;n++)o.push("");if(o[0]=="channel"&&o[1]==TBGlobal.CurrentChannelId()&&o[2]==""){TBUtilities.Log("Studio Dashboard!");TubeBuddyStudioDashboard.Initialize()}else if(o[0]=="channel"&&o[1]==TBGlobal.CurrentChannelId()&&o[2]=="videos"){TBUtilities.Log("Studio Videos List!");TubeBuddyVideosStudioList.Initialize();TubeBuddyQuickEditToolbarStudio.Initialize();TubeBuddyDemonetizationChecker.Initialize(true);TubeBuddyKidsCenter.Initialize();TubeBuddySchedule.Initialize();if(o[2]=="videos"&&o[3]=="upload"&&jQuery("paper-dialog.ytcp-uploads-dialog").length>0){TBUtilities.Log("Studio Video Upload");TubeBuddyUploadStudio.LoadTubeBuddyTools()}}else if(o[0]=="channel"&&o[1]==TBGlobal.CurrentChannelId()&&o[2]=="comments"){TBUtilities.Log("Studio Comments!");TubeBuddyCommentFilterStudio.Initialize(t)}else if(o[0]=="channel"&&o[1]==TBGlobal.CurrentChannelId()&&o[2]=="monetization"&&o[3]=="overview"){TBUtilities.Log("Studio Monetization Overview!")}else if(o[0]=="channel"&&o[1]==TBGlobal.CurrentChannelId()&&o[2]=="monetization"&&o[3]=="merchandising"){TBUtilities.Log("Studio Monetization Merchandising!")}else if(o[0]=="channel"&&o[1]==TBGlobal.CurrentChannelId()&&o[2]=="analytics"&&o[3]=="tab-overview"){TBUtilities.Log("Studio Analytics Overview!")}else if(o[0]=="channel"&&o[1]==TBGlobal.CurrentChannelId()&&o[2]=="analytics"&&o[3]=="tab-reach_viewers"){TBUtilities.Log("Studio Analytics Reach Viewers!")}else if(o[0]=="channel"&&o[1]==TBGlobal.CurrentChannelId()&&o[2]=="analytics"&&o[3]=="tab-interest_viewers"){TBUtilities.Log("Studio Analytics Reach Viewers!")}else if(o[0]=="channel"&&o[1]==TBGlobal.CurrentChannelId()&&o[2]=="analytics"&&o[3]=="tab-build_audience"){TBUtilities.Log("Studio Analytics Build an Audience!")}else if(o[0]=="channel"&&o[1]==TBGlobal.CurrentChannelId()&&o[2]=="analytics"&&o[3]=="tab-earn_revenue"){TBUtilities.Log("Studio Analytics Earn Revenue!")}else if(o[0]=="video"&&o[2]=="edit"){var r=o[1];TBUtilities.Log("Studio Video Edit!");TubeBuddyEditVideoStudio.Initialize();TubeBuddyEditVideoStudioUploadDefaults.Initialize();TubeBuddyQuickEditToolbarStudio.Initialize();TubeBuddyVideoMenuStudio.Initialize()}else if(o[0]=="video"&&o[2]=="editor"){var r=o[1];TBUtilities.Log("Studio Video Editor!");TubeBuddyVideoMenuStudio.Initialize();TubeBuddyVideoEditorStudio.Initialize()}else if(o[0]=="video"&&o[2]=="comments"){var r=o[1];TBUtilities.Log("Studio Video Comments!");TubeBuddyCommentFilterStudio.Initialize(t);TubeBuddyVideoMenuStudio.Initialize()}else if(o[0]=="video"&&o[2]=="analytics"&&o[3]=="tab-overview"){var r=o[1];TBUtilities.Log("Studio Video Ananlytics - Overview!");TubeBuddyVideoMenuStudio.Initialize()}else if(o[0]=="video"&&o[2]=="analytics"&&o[3]=="tab-reach_viewers"){var r=o[1];TBUtilities.Log("Studio Video Ananlytics - Reach Vieweres!")}else if(o[0]=="video"&&o[2]=="analytics"&&o[3]=="tab-interest_viewers"){var r=o[1];TBUtilities.Log("Studio Video Ananlytics - Interest Viewers!")}else if(o[0]=="video"&&o[2]=="analytics"&&o[3]=="tab-build_audience"){var r=o[1];TBUtilities.Log("Studio Video Ananlytics - Build Audience!")}else if(o[0]=="video"&&o[2]=="analytics"&&o[3]=="tab-earn_revenue"){var r=o[1];TBUtilities.Log("Studio Video Ananlytics - Earn Revenue!")}}}if(e.indexOf("youtube.com/playlist")>0){TubeBuddyPlaylist.Initialize()}if(e.indexOf("youtube.com/view_all_playlists")>0){TubeBuddyAllPlaylists.Initialize()}if(e.indexOf("youtube.com/edit")>0){TubeBuddyEditVideoUploadDefaults.Initialize();TubeBuddyEditVideo.Initialize();TubeBuddyQuickEditToolbar.Initialize();TubeBuddyVideoMenu.Initialize();TubeBuddyMagicLinks.Initialize()}if(e.indexOf("youtube.com/enhance")>0){TubeBuddyQuickEditToolbar.Initialize();TubeBuddyEnhancementsVideo.Initialize();TubeBuddyVideoMenu.Initialize()}if(e.indexOf("youtube.com/audio")>0&&e.indexOf("youtube.com/audiolibrary")==-1){TubeBuddyQuickEditToolbar.Initialize();TubeBuddyAudioVideo.Initialize();TubeBuddyVideoMenu.Initialize()}if(e.indexOf("youtube.com/timedtext_video")>0){TubeBuddyQuickEditToolbar.Initialize();TubeBuddySubtitlesAndCCVideo.Initialize();TubeBuddyVideoMenu.Initialize()}if(e.indexOf("youtube.com/cards")>0){TubeBuddyQuickEditToolbar.Initialize();TubeBuddyCardsVideo.Initialize();TubeBuddyVideoMenu.Initialize()}if(e.indexOf("youtube.com/my_videos_annotate")>0){TubeBuddyQuickEditToolbar.Initialize();TubeBuddyVideoMenu.Initialize()}if(e.indexOf("youtube.com/endscreen")>0){TubeBuddyQuickEditToolbar.Initialize();TubeBuddyVideoMenu.Initialize();TubeBuddyEndScreensVideo.Initialize()}if(e.indexOf("youtube.com/my_videos")>0){TubeBuddyVideosList.Initialize();TubeBuddyQuickEditToolbar.Initialize();TubeBuddyVideoMenu.Initialize();TubeBuddySchedule.Initialize();TubeBuddyDemonetizationChecker.Initialize(false)}if(e.indexOf("youtube.com/results")>0){}if(e.indexOf("youtube.com/subscribers")>0){TubeBuddySubscribersList.Initialize()}if(e.indexOf("youtube.com/upload_defaults")>0){TubeBuddyUploadDefaults.Initialize()}else if(e.indexOf("youtube.com/upload")>0){TubeBuddyUpload.Initialize();TubeBuddyMagicLinks.Initialize()}if(e.indexOf("youtube.com/watch")>0){TubeBuddyCommentManager.Initialize();TubeBuddyVideolytics.Initialize(t)}if(e.indexOf("youtube.com/comments")>0){TubeBuddyCommentFilter.Initialize();TubeBuddyCommentsCannedResponse.Initialize();TubeBuddySentiment.Initialize()}if(e.indexOf("youtube.com/my_live_events?action_create_live_event=1")>0||e.indexOf("youtube.com/my_live_events?action_edit_live_event=1&event_id=")>0||e.indexOf("youtube.com/my_live_events?event_id=")>0||e.indexOf("youtube.com/my_live_events?action_edit_live_event=1&editor_tab=advanced&event_id=")>0){TubeBuddyLiveEventsVideo.Initialize()}if(e.indexOf("youtube.com/live_dashboard")>0){TubeBuddyLiveDashboardVideo.Initialize()}if(e.indexOf("youtube.com/live_cards")>0){TubeBuddyLiveCardsVideo.Initialize()}if(e.indexOf("youtube.com/all_comments")>0||e.indexOf("https://apis.google.com")>=0&&e.indexOf("/_/widget/render/comments")>0&&jQuery("#root").length==1){TubeBuddyCommentManager.Initialize()}if(e.indexOf("youtube.com/results?search_query=")>0){TubeBuddySearchTermAnalysis.Initialize()}if(e.indexOf("youtube.com/c/")>0||e.indexOf("youtube.com/user/")>0||e.indexOf("youtube.com/channel/")>0){TubeBuddyChannelytics.Initialize()}else if(jQuery('[rel="canonical"]').length>0){var s=jQuery('[rel="canonical"]').first().attr("href");if(s){if(s.indexOf("youtube.com/c/")>0||s.indexOf("youtube.com/user/")>0||s.indexOf("youtube.com/channel/")>0){TubeBuddyChannelytics.Initialize()}}}if(t===true){TubeBuddyVideolytics.CleanPage();TubeBuddyChannelytics.CleanPage();TubeBuddySearchTermAnalysis.CleanPage()}};var Y=function(){if(b==null){var e=document.documentElement.innerHTML.indexOf("ytd-app");if(e!=-1){TBUtilities.Log("getYouTubeUI - material");b="material"}else{TBUtilities.Log("getYouTubeUI - default");b="default"}if(document.URL.indexOf("https://studio.youtube.com")==0){TBUtilities.Log("getYouTubeUI - studio");b="studio"}}else{}return b};var H=function(){var e=jQuery("html").attr("dark")=="true";TBUtilities.Log(e);return e};var z=function(e){var t="default";if(e&&e.indexOf("ytd-app")!=-1){t="material"}else if(e&&e.indexOf("youtube_creator_studio")!=-1){t="studio"}return t};var W=function(){var e=null;var t=TBUtilities.GetCookie("PREF");if(t){try{e=t.split("&").reduce(function(e,t,i,o){var a=t.split("=");e[decodeURIComponent(a[0])]=decodeURIComponent(a[1]);return e},{});TBUtilities.Log("getYouTubeUI - cookie f6 = "+e.f6)}catch(e){}}return e};return{Initialize:function(){TBUtilities.Log("tbGlobal Initialize");i=(new Date).getTime();w();T();m();v()},GetPrefCookieObject:function(){return W()},GetYouTubeUI:function(){return Y()},GetYouTubeUIFromHtml:function(e){return z(e)},CurrentChannelId:function(){return e},GetToken:function(){return t},CanPublishFacebookOnUploadScreen:function(){if(a==null)return false;return a.CanPublishFacebookOnUploadScreen==true},CanAccessLevel1Tools:function(){if(a==null)return false;return a.CanAccessLevel1Tools==true},CanAccessLevel2Tools:function(){if(a==null)return false;return a.CanAccessLevel2Tools},CanAccessLevel3Tools:function(){if(a==null)return false;return a.CanAccessLevel3Tools},SetCurrentChannelId:function(e){C(e)},LoadModules:function(e,t){if(e==null)e=window.location.toString();N(e,t)},IsAuthenticated:function(){if(t==null||a==null)return false;return t.length>0&&a.HasAccessToken},IsCorrectInstance:function(){var e=TBUtilities.GetCookie("tbCorrectInstanceCookie");var t=i==e;return t},Profile:function(){return a},ReloadProfile:function(e){I(e)},ReloadToken:function(){P()},ShowUpgradePage:function(e,t){V(e,t)},ShowWordCloud:function(e){_(e)},GetActionCount:function(e,t){L(e,t)},GetNetwork:function(e){return A(e)},ClassicForceParam:function(){return"&ar="+(new Date).getTime()},AddProfileUpdateListener:function(e){l.push(e)},AddUserDebugInfo:function(e){M(e)},AddDiagnostic:function(e){O(e)},GetDiagnostics:function(e){return p},ClearUserDebugInfo:function(){F()},UserDebugCode:function(){return d},TriggerProfileUpdated:function(){E()},GetAllTools:function(){return f},GetToolsInCategory:function(e){f.sort(function(e,t){var i=e.name;var o=t.name;return i==o?0:i>o?1:-1});var t=[];$.each(f,function(i,o){if(e==o.category){t.push(o)}});return t},GetToolsInCategoryByLevel:function(e,t){f.sort(function(e,t){var i=e.name;var o=t.name;return i==o?0:i>o?1:-1});var i=[];$.each(f,function(o,a){if(e==a.category&&(a.Level0Access&&!a.Level0Limitation&&t==-1||!a.Level0Access&&a.Level0Limitation&&t==0||a.Level1Access&&!a.Level0Access&&t==1&&!a.Level0Limitation||a.Level2Access&&!a.Level1Access&&t==2&&a.Level1Limitation||a.Level2Access&&!a.Level1Access&&t==3&&!a.Level1Limitation||a.Level3Access&&!a.Level2Access&&t==3&&a.Level2Limitation||a.Level3Access&&!a.Level2Access&&t==4&&!a.Level2Limitation||a.Level4Access&&!a.Level3Access&&t==4&&a.Level3Limitation||a.Level4Access&&!a.Level3Access&&t==4&&!a.Level0Limitation)){i.push(a)}});return i},GoogleAuthUser:function(){return n},SetGoogleAuthUser:function(e){n=e},IsDarkMode:function(){return H()},GetToolsOnPage:function(e){var t=[];$.each(f,function(i,o){if(o.pages!=null){$.each(o.pages,function(i,a){if(a==e)t.push(o)})}});return t},host:pluginHost,versionNumber:"1.0.0.3",tokenKey:"tubebuddyToken-",apiKey:"AIzaSyDW-hsukxcYtkBU7Mxe29gIUgxvWDaXFG0",language:"English",languageCode:"en",limitation:{annotations:"annotations",bestTimeToPublish:"besttimetopublish",tagexplorer:"tagexplorer",subscriberexport:"subscriberexport",campaigns:"campaigns",defaultuploadprofiles:"defaultuploadprofiles",findandreplace:"findandreplace",cards:"cards",deleteCards:"bulkdeletecards",deleteAnnotations:"deleteannotations",commentFilters:"commentfilters",thumbnails:"thumbnails",bulkthumbnail:"bulkthumbnail",bulkupdateplaylists:"bulkupdateplaylists",playlistactions:"playlistactions",annotationTemplates:"annotationtemplates",searchRanking:"searchranking",cardTemplates:"cardtemplates",suggestedTags:"suggestedtags",tagtranslator:"autotranslator",videoScheduledAction:"videoscheduledaction",scheduledvideoupdate:"scheduledvideoupdate",updateCards:"bulkupdatecards",updateAnnotations:"updateAnnotations",channelBackup:"channelbackup",bulkCopyToFacebook:"bulkpublishtofacebook",videoTopicPlanner:"videotopicplanner",bestpractice:"bestpractice",hideComments:"hideComments",exportComments:"exportComments",bulkUpdateEndScreens:"bulkUpdateEndScreens",tagLists:"tagLists",keywordranktracking:"keywordranktracking",autoTranslator:"autotranslator",bestpractices:"bestpractice",instasuggest:"instasuggest",seostudio:"seostudio",placeholders:""},apiUrls:{abtestsGetVideosToGather:"/api/abtests/GetVideosToGather",brandingsAdd:"/api/branding/add",brandingsDelete:"/api/branding/delete",brandingsGetAll:"/api/branding/getall",brandingsFontAdd:"/api/branding/fontadd",brandingsGetAllFonts:"/api/branding/getallfonts",brandingsGetBackgroundImages:"/api/branding/getbackgroundimages",brandingsAddBackgroundImage:"/api/branding/addbackgroundimage",brandingsDeleteBackgroundImage:"/api/branding/deletebackgroundimage",brandingsAddStilFrameImage:"/api/branding/addstillframeimage",campaignDelete:"/api/campaign/delete",campaignAdd:"/api/campaign/add",campaignUpdate:"/api/campaign/update",campaignGetByYouTubeChannelId:"/api/campaign/getbyyoutubechannelid",channelActionGetCount:"/api/channelaction/getcount",contactHistoryAdd:"/api/contacthistory/add",contactHistoryGetContactHistoryByChannelId:"/api/contacthistory/getcontacthistorybychannelid",debugAddLog:"/api/debug/addlog",gifAdd:"/api/gif/add",grammerGetKeyWordMisspellings:"/api/Grammer/GetKeyWordMisspellings",imageGetBytes:"/api/image/getbytes",sharedVideoGetHistory:"/api/sharedvideo/gethistory",sharedVideoAdd:"/api/sharedvideo/add",sharedVideoRemove:"/api/sharedvideo/remove",socialAccountsGetFacebook:"/api/socialaccounts/getfacebook",socialAccountsGetTwitter:"/api/socialaccounts/gettwitter",socialAccountsPostAnimatedGifToTwitter:"/api/socialaccounts/postanimatedgiftotwitter",uploadDefaultsDelete:"/api/uploaddefaults/delete",uploadDefaultsAdd:"/api/uploaddefaults/add",uploadDefaultsUpdate:"/api/uploaddefaults/update",uploadDefaultsList:"/api/uploaddefaults/list",userCancelMembership:"/api/user/CancelMembership",userUpdateSettings:"/api/user/updatesettings",userUpdateBrowserMeta:"/api/user/updatebrowsermeta",playlistsUpdatePlaylist:"/api/playlists/UpdatePlaylist",youtubeChannelGetProfile:"/api/youtubechannel/getprofile",youtubeChannelUpdate:"/api/youtubechannel/update",youtubeChannelUpdateMeta:"/api/youtubechannel/updatemeta",youtubeChannelUnlinkChannelFromProfile:"/api/youtubechannel/unlinkchannelfromprofile",youtubeChannelCheckNetwork:"/api/youtubechannel/checknetwork",youtubeChannelGetSubscribersRequiringRefresh:"/api/youtubechannel/getsubscribersrequiringrefresh",youtubeChannelGetSubscribersRequiringRefreshCount:"/api/youtubechannel/getsubscribersrequiringrefreshcount",youtubeChannelUpdateSubscriber:"/api/youtubechannel/updatesubscriber",youtubeChannelSyncSubscribers:"/api/youtubechannel/syncsubscribers",youtubeChannelGetSubscribers:"/api/youtubechannel/GetChannelSubscribers",youtubeChannelGetExportStatistics:"/api/youtubechannel/getexportstatistics",youtubeChannelKickOffExport:"/api/youtubechannel/kickoffexport",youtubeChannelActionGetCount:"/api/youtubechannelaction/getcount",youtubeChannelGetRelatedTitles:"/api/youtubechannel/getrelatedtitles",youtubeChannelGetRandomGuid:"/api/youtubechannel/GetRandomGuid",youtubeChannelGetMilestones:"/api/youtubechannel/getmilestones",youtubeChannelMarkAsSubscribedToTubeBuddy:"/api/youtubechannel/MarkAsSubscribedToTubeBuddy",youtubeChannelMarkAsNotSubscribedToTubeBuddy:"/api/youtubechannel/MarkAsNotSubscribedToTubeBuddy",youtubeChannelToggleChannelytics:"/api/youtubechannel/ToggleChannelytics",youtubeApiGetApiSubscribers:"/api/youtubeapi/getapisubscribers",youtubeApiGetPageOfVideos:"/api/youtubeapi/getpageofvideos",youtubeApiGetChannelVideoSearch:"/api/youtubeapi/getchannelvideosearch",youtubeApiGetVideo:"/api/youtubeapi/getvideo",youtubeApiGetCommentsOnVideo:"/api/youtubeapi/getcommentsonvideo",youtubeApiGetCurrentChannel:"/api/youtubeapi/getcurrentchannel",youtubeApiGetChannelUploadPlaylist:"/api/youtubeapi/getchanneluploadplaylist",youtubeApiGetChannel:"/api/youtubeapi/getchannel",youtubeApiGetVideoTrafficSearchTerms:"/api/youtubeapi/getvideotrafficsearchterms",youtubeApiGetVideoRelatedVideos:"/api/youtubeapi/getrelatedvideos",youtubeApiGetChannelTrafficSearchTerms:"/api/youtubeapi/getchanneltrafficsearchterms",youtubeApiGetTrendingVideos:"/api/youtubeapi/gettrendingvideos",youtubeApiPostCommentReply:"/api/youtubeapi/postcommentreply",youtubeApiGetRecentVideos:"/api/youtubeapi/getrecentvideos",youtubeApiGetChannelPlaylists:"/api/youtubeapi/getchannelplaylists",commentManagerToggle:"/api/youtubechannel/togglecommentmanager",commentManagerGetContactHistory:"/api/commentmanager/getcontacthistory",magiclinksGetRecent:"/api/magiclinks/GetRecent",magiclinksCreateLink:"/api/magiclinks/CreateLink",topicsToggleCommentAudienceSuggestedTopic:"/api/topics/togglecommentaudiencesuggestedtopic",topicsGetCommentAudienceSuggestedTopic:"/api/topics/getcommentaudiencesuggestedtopic",topicsGetVideoTopics:"/api/topics/getvideotopics",topicsUpdateVideoTopicsOrder:"/api/topics/updatevideotopicsorder",topicsDeleteVideoTopic:"/api/topics/deletevideotopic",topicsUpdateVideoTopic:"/api/topics/updatevideotopic",topicsAddVideoTopic:"/api/topics/addvideotopic",topicsAddVideoTopics:"/api/topics/addvideotopics",topicsGetAudienceSuggestedTopics:"/api/topics/getaudiencesuggestedtopics",thumbnailAdd:"/api/thumbnail/add",thumbnailGet:"/api/thumbnail/get",thumbnailGetOriginalImageFromUrl:"/thumbnail/getoriginalimagefromurl",thumbnailGetImageFromUrl:"/thumbnail/getimagefromurl",thumbnailGetImageBytes:"/api/thumbnail/getimagebytes",thumbnailAddOverlay:"/api/thumbnail/addoverlay",thumbnailRemoveOverlay:"/api/thumbnail/removeoverlay",thumbnailGetThumbnailPreview:"/thumbnail/GetThumbnailPreview",thumbnailAddTemplate:"/api/thumbnail/addtemplate",thumbnailGetTemplates:"/api/thumbnail/gettemplates",thumbnailGetTemplate:"/api/thumbnail/gettemplate",thumbnailGetTemplateList:"/api/thumbnail/gettemplatelist",thumbnailDeleteTemplate:"/api/thumbnail/deletetemplate",thumbnailUploadBulkOverlayImage:"/api/thumbnail/uploadBulkOverlayImage",twitterGetMentions:"/api/twitter/GetMentions",twitterGetVideoMentions:"/api/twitter/GetVideoMentions",twitterGetMessages:"/api/twitter/GetMessages",twitterRetweet:"/api/twitter/ReTweet",twitterRemoveRetweet:"/api/twitter/RemoveReTweet",twitterFavorite:"/api/twitter/Favorite",twitterUnFavorite:"/api/twitter/UnFavorite",twitterReply:"/api/twitter/Reply",twitterPost:"/api/twitter/Post",twitterReadMentions:"/api/twitter/ReadMentions",twitterGetRefreshStatus:"/api/twitter/GetRefreshedStatus",youTubeVideosGetVideo:"/api/youtubevideos/getvideo",youTubeVideosGetVideoStatus:"/api/youtubevideos/getvideostatus",youTubeVideosGetDownloadUrl:"/api/youtubevideos/getdownloadurl",youTubeVideosGetVideoCardTemplates:"/api/youtubevideos/getvideocardtemplates",youTubeVideosGetVideoEndScreenTemplates:"/api/youtubevideos/getvideoendscreentemplates",youTubeVideosGetVideoAnnotationTemplates:"/api/youtubevideos/getvideoannotationtemplates",youTubeVideosToggleCardTemplate:"/api/youtubevideos/togglecardtemplate",youTubeVideosToggleEndScreenTemplate:"/api/youtubevideos/toggleendscreentemplate",youTubeVideosToggleAnnotationTemplate:"/api/youtubevideos/toggleannotationtemplate",youTubeVideosGetYouTubeVideoScheduledAction:"/api/youtubevideos/getyoutubevideoscheduledaction",youTubeVideosGetYouTubeVideoScheduledActionsInFuture:"/api/youtubevideos/GetYouTubeVideoScheduledActionsInFuture",youTubeVideosAddYouTubeVideoScheduledAction:"/api/youtubevideos/addyoutubevideoscheduledaction",youTubeVideosDeleteYouTubeVideoScheduledAction:"/api/youtubevideos/deleteyoutubevideoscheduledaction",youTubeVideosUpdateYouTubeVideoScheduledAction:"/api/youtubevideos/updateyoutubevideoscheduledaction",youTubeVideosPublishToFacebook:"/api/youtubevideos/publishtofacebook",youTubeVideosBulkPublishToFacebook:"/api/youtubevideos/bulkpublishtofacebook",youTubeVideosGetLatestCopyToFacebook:"/api/youtubevideos/getlatestcopytofacebook",youTubeVideosGetTagsByCount:"/api/youtubevideos/gettagsbycount",youTubeVideosGradeTags:"/api/youtubevideos/gradetags",youTubeVideosGetPublishInterval:"/api/youtubevideos/getpublishinterval",youTubeVideosGetStats:"/api/youtubevideos/getstats",youTubeVideosGetUserNotes:"/api/youtubevideos/getusernotes",youTubeVideosSaveUserNotes:"/api/youtubevideos/saveusernotes",youTubeVideosGetFacebookThumbnail:"/api/youtubevideos/getfacebookthumbnail",scheduledMetaUpdatesGetByVideo:"/api/scheduledmetaupdates/getscheduledmetaupdatesbyvideo",scheduledMetaUpdatesCreate:"/api/scheduledmetaupdates/createscheduledmetaupdate",scheduledMetaUpdatesDelete:"/api/scheduledmetaupdates/deletescheduledmetaupdate",videolyticsGetVideoToCompare:"/api/videolytics/getvideotocompare",videolyticsGetVideoStats:"/api/videolytics/getvideostats",videoLyticsToggle:"/api/videolytics/toggle",searchTermAddSearchTerm:"/api/searchterm/addsearchterm",searchTermGetForVideo:"/api/searchterm/getforvideo",searchTermRemove:"/api/searchterm/removesearchterm",searchTermAnalysisToggle:"/api/searchtermanalysis/toggle",searchRankGetHistory:"/api/searchrank/gethistory",searchRankAddRankings:"/api/searchrank/addrankings",searchRankGetMostRecentBeforeToday:"/api/searchrank/getmostrecentbeforetoday",searchRankGetVideoRankings:"/api/searchrank/getvideorankings",searchRankGetTagRankingsForToday:"/api/searchrank/gettagrankingsfortoday",translateGetTranslation:"/api/translate/gettranslation",translateVideoMetadata:"/api/translate/translatevideometadata",googlePlusGetSearchResults:"/api/googleplus/getsearchresults",dataGetChannelLanguageStatistics:"/api/data/GetChannelLanguageStatistics",dataGetMyVideosPageVideoInfo:"/api/data/GetMyVideosPageVideoInfo",dataGetChannelSubscriberCount:"/api/data/GetChannelSubscriberCount",launchPadChecklistTemplateItemsExist:"/api/launchpad/ChecklistTemplateItemsExist",launchPadCreateChecklist:"/api/launchpad/CreateChecklist",launchPadUpdateItemStatus:"/api/launchpad/UpdateItemStatus",launchPadGetVideoChecklist:"/api/launchpad/GetVideoChecklist",launchPadImportChecklistTemplateItemDefaults:"/api/launchpad/ImportChecklistTemplateItemDefaults",launchPadGetBestPractices:"/api/launchpad/GetBestPractices",launchpadBestPracticesToggle:"/api/launchpad/togglebestpractices",launchPadGetVideoSummary:"/api/launchpad/getvideosummary",launchPadRunBestPracticeList:"/api/launchpad/runbestpracticelist",musicGenerateTrack:"/api/music/GenerateTrack",musicGetJukedeckGenres:"/api/music/GetJukedeckGenres",commentsMarkAsRead:"/api/comments/MarkAsRead",commentsMarkAsUnRead:"/api/comments/MarkAsUnRead",commentsGetReadComments:"/api/comments/GetReadComments",taglistsGetLists:"/api/taglists/getlists",taglistsAddList:"/api/taglists/addlist",taglistsAddListWithTags:"/api/taglists/addlistwithtags",taglistsAddTag:"/api/taglists/addtag",taglistsAddTags:"/api/taglists/addtags",taglistsGetListTags:"/api/taglists/getlisttags",taglistsRemoveTags:"/api/taglists/removetags",taglistsDeleteList:"/api/taglists/deletelist",taglistsAddTagListWithTags:"/api/taglists/addlistwithtags",tagScoreGet:"/api/tagscore/get",tagScoreGetStored:"/api/tagscore/getstored",patreonGetPatrons:"/api/patreon/getpatrons",highlightGetHighlights:"/api/Highlights/GetHighlights",seoScoreGetScores:"/api/seoscore/GetSeoScores",seoScoreAddScore:"/api/seoscore/AddSeoScore",seoScoreUpdateScore:"/api/seoscore/UpdateSeoScore",seoScoreDeleteScore:"/api/seoscore/DeleteSeoScore",seoScoreGetLatestKeyword:"/api/seoscore/GetLatestKeyword",seoScorePublishSavedThumbnailData:"/api/seoscore/PublishSavedThumbnailData"}}}();var TBExtension=function(){var extenstionType;var extenstionVersion;var safariEventName;var callbacks={};var getType=function(){if(extenstionType){return extenstionType}var e=false;try{e=window.chrome&&chrome.runtime}catch(e){}var t=false;try{t=safari&&safari.self}catch(e){}var i=navigator.userAgent.toLowerCase().indexOf("firefox")>-1;if(e){extenstionType="chrome";if(TBGlobal.host.indexOf("localhost")>-1)jQuery("body").prepend("<span class='tb-env' style='background-color:black; color:white; z-index: 9999999999999; font-size:12px; position:fixed; left:0; top:0px; padding:1px 3px; font-weight:500; border:solid 1px white;'>Local - Chome - "+TBUtilities.GetTime()+"</span>");else if(TBGlobal.host.indexOf("staging")>-1)jQuery("body").prepend("<span class='tb-env' style='background-color:yellow; color:red; z-index: 9999999999999; font-size:12px; position:fixed; left:0; top:0px; padding:1px 3px; font-weight:500; border:solid 1px white;'>!! TubeBuddy Beta !! - "+TBUtilities.GetTime()+"</span>")}else if(t){extenstionType="safari";if(TBGlobal.host.indexOf("localhost")>-1)jQuery("body").prepend("<span class='tb-env' style='background-color:black; color:white; z-index: 9999999999999; font-size:12px; position:fixed; left:0; top:0px; padding:1px 3px; font-weight:500; border:solid 1px white;'>Local - Safari - "+TBUtilities.GetTime()+"</span>");else if(TBGlobal.host.indexOf("staging")>-1)jQuery("body").prepend("<span class='tb-env' style='background-color:yellow; color:red; z-index: 9999999999999; font-size:12px; position:fixed; left:0; top:0px; padding:1px 3px; font-weight:500; border:solid 1px white;'>!! Staging - Safari - "+TBUtilities.GetTime()+"</span>");safari.self.addEventListener("message",handleSafariMessage)}else if(i){extenstionType="firefox";if(TBGlobal.host.indexOf("localhost")>-1)jQuery("body").prepend("<span class='tb-env' style='background-color:black; color:white; z-index: 9999999999999; font-size:12px; position:fixed; left:0; top:0px; padding:1px 3px; font-weight:500; border:solid 1px white;'>Local - FireFox - "+TBUtilities.GetTime()+"</span>");else if(TBGlobal.host.indexOf("staging")>-1)jQuery("body").prepend("<span class='tb-env' style='background-color:black; color:white; z-index: 9999999999999; font-size:12px; position:fixed; left:0; top:0px; padding:1px 3px; font-weight:500; border:solid 1px white;'>Staging - FireFox - "+TBUtilities.GetTime()+"</span>")}return extenstionType};var handleSafariMessage=function(event){if(event.name=="getDbValueSafariCallback"&&event.message){if(event.message.success=="false"){TBUtilities.Log("[FAIL] getDbValueSafariCallback error. Details: "+event.message.error)}else if(event.message.eventName.length>0){TBUtilities.Log("getDbValueSafariCallback for key: "+event.message.key);var value=event.message.value;if(value.indexOf("|")>-1){var dataType=value.substr(0,value.indexOf("|"));value=value.substr(value.indexOf("|")+1);value=decryptDataFromTransport(value,dataType)}if(safariEventName!=null&&typeof safariEventName==="function"){safariEventName(key,dbValue)}else{jQuery(document.body).trigger(event.message.eventName,[{key:event.message.key,value:value}])}}}else if(event.name=="setDbValueSafariCallback"){if(event.message.success=="false"){TBUtilities.Log("[FAIL] setDbValueSafariCallback error. Details: "+event.message.error)}}else if(event.name=="removeDbValueSafariCallback"){if(event.message.success=="false"){TBUtilities.Log("[FAIL] removeDbValueSafariCallback error. Details: "+event.message.error)}}else if(event.name=="getRequestSafariCallback"&&event.message.eventName){var response=decodeURIComponent(escape(window.atob(event.message.response)));var dataType=event.message.dataType;var data=decryptDataFromTransport(event.message.data,dataType);if(event.message.success=="false"){var error=decodeURIComponent(escape(window.atob(event.message.error)));TBUtilities.Log("[GET FAIL] getRequestSafariCallback error. StatusCode: "+response+" Details: "+error);jQuery(document.body).trigger(event.message.eventName,[{success:false,data:data,response:response}])}else{TBUtilities.Log("[GET SUCCESS] getRequestSafariCallback for event: "+event.message.eventName);if(event.message.eventName){if(event.message.eventName.toLowerCase().indexOf("function")>-1||data&&data.extensionCallbackId){if(data.extensionCallbackId){var func=null;func=callbacks[data.extensionCallbackId];if(func&&func!==null){func(true,data,response);callbacks[data.extensionCallbackId]=null}}else{eval("var fn = "+event.message.eventName);fn(true,data,response)}}else{jQuery(document.body).trigger(event.message.eventName,[{success:true,data:data,response:response}])}}}}else if(event.name=="postRequestSafariCallback"&&event.message.eventName){var response=decodeURIComponent(escape(window.atob(event.message.response)));var dataType=event.message.dataType;var data=decryptDataFromTransport(event.message.data,dataType);if(event.message.success=="false"){var error=decodeURIComponent(escape(window.atob(event.message.error)));TBUtilities.Log("[POST FAIL] postRequestSafariCallback error. StatusCode: "+response+" Details: "+error);jQuery(document.body).trigger(event.message.eventName,[{success:false,data:data,response:response}])}else{TBUtilities.Log("[POST SUCCESS] postRequestSafariCallback for event: "+event.message.eventName);if(event.message.eventName.toLowerCase().indexOf("function")>-1||data&&data.extensionCallbackId){if(data.extensionCallbackId){var func=null;func=callbacks[data.extensionCallbackId];if(func&&func!==null){func(true,data,response);callbacks[data.extensionCallbackId]=null}}else{eval("var fn = "+event.message.eventName);fn(true,data,response)}}else{jQuery(document.body).trigger(event.message.eventName,[{success:true,data:data,response:response}])}}}else if(event.name=="getExtensionVersionSafariCallback"){if(event.message.success=="false"){TBUtilities.Log("getExtensionVersionSafariCallback error. Details: "+event.message.error)}else TBExtension.SetExtensionVersion(event.message.version)}};var getFilePath=function(e){if(getType()==="safari"){return safari.extension.baseURI+e}else{return chrome.extension.getURL(e)}};var getDbValue=function(e,t){var i=getType();switch(i){case"chrome":case"firefox":{chrome.storage.sync.get(e,function(i){var o=i[e];if(typeof t==="function"){t(e,o)}else{jQuery(document.body).trigger(t,[{key:e,value:o}])}});break}case"safari":{if(window.top===window){safariEventName=t;safari.extension.dispatchMessage("getDbValueSafari",{key:e,eventName:t})}break}}};var setDbValue=function(e,t,i){var o=getType();switch(o){case"chrome":case"firefox":{var a={};a[e]=t;chrome.storage.sync.set(a,function(){});break}case"safari":{if(window.top===window){var n=getDataType(t);t=n+"|"+encryptDataForTransport(t,n);safari.extension.dispatchMessage("setDbValueSafari",{key:e,value:t,eventName:i})}break}}};var removeDbValue=function(e){TBUtilities.Log("remove db value");TBUtilities.Log("key="+e);var t=getType();switch(t){case"chrome":case"firefox":{chrome.storage.sync.remove(e,function(){TBUtilities.Log("removed value")});break}case"safari":{if(window.top===window){safari.extension.dispatchMessage("removeDbValueSafari",{key:e,eventName:eventName});TBUtilities.Log("removed value")}break}}};var get=function(e,t,i,o){var a=getType();o=o||{};o.cache=o.cache!==false;o.dataType=typeof o.dataType!="undefined"?o.dataType:"text";o.headers=o.headers||{};o.type="GET";o.url=e||o.url;o.hostname=window.location.hostname;var n=o.success;o.success=null;var r=o.error;o.error=null;o.useContent=false;o.headers.currentChannelId=TBGlobal.CurrentChannelId();o.headers.currentChannelToken=TBGlobal.GetToken();var s={type:"tb-xhr",data:{ajaxOptions:o},host:TBGlobal.host};if(isSameOrigin(e,window.location.href)){s.mode="same-origin";FetchUtilities.MakeFetchRequest(s,function(e){try{xHRResponseReceived(e,o,t,n,r,i)}catch(e){xHRExceptionLog(e,"GET",s);throw e}})}else{s.mode="cors";switch(a){case"firefox":{browser.runtime.sendMessage(s).then(e=>{try{xHRResponseReceived(e,o,t,n,r,i)}catch(e){xHRExceptionLog(e,"GET",s);throw e}});break}case"chrome":{chrome.runtime.sendMessage(s,function(e){try{xHRResponseReceived(e,o,t,n,r,i)}catch(e){xHRExceptionLog(e,"GET",s);throw e}});break}}}};var post=function(e,t,i,o,a,n){var r=getType();a=a||{};a.data=t||a.data;a.dataType=typeof a.dataType!="undefined"?a.dataType:"text";a.headers=a.headers||{};a.type="POST";a.url=e||a.url;var s=a.success;a.success=null;var l=a.error;a.error=null;a.useContent=false;a.headers.currentChannelId=TBGlobal.CurrentChannelId();a.headers.currentChannelToken=TBGlobal.GetToken();if(n){a.contentType="application/json";a.headers={"x-origin":"https://studio.youtube.com",Authorization:"SA"+"PI"+"SI"+"DH"+"AS"+"H "+n,"X-Goog-AuthUser":TBGlobal.GoogleAuthUser(),Accept:"*/*"}}if(a.data instanceof FormData){try{a.data=JSON.stringify(Object.fromEntries(a.data));a.dataIsSearlizedFormData=true}catch(e){TBUtilities.LogError(e);TBUtilities.LogError("Polyfil used for Object.fromEntries");Object.fromEntriesPoly=(e=>Object.assign({},...Array.from(e,([e,t])=>({[e]:t}))));a.data=JSON.stringify(Object.fromEntriesPoly(a.data));a.dataIsSearlizedFormData=true}}var d={type:"tb-xhr",data:{ajaxOptions:a},host:TBGlobal.host};if(isSameOrigin(e,window.location.href)){d.mode="same-origin";if(r==="firefox"){d.data.ajaxOptions.useContent=true}FetchUtilities.MakeFetchRequest(d,function(e){try{xHRResponseReceived(e,a,i,s,l,o)}catch(e){xHRExceptionLog(e,"POST",d);throw e}})}else{switch(r){case"firefox":{browser.runtime.sendMessage(d).then(e=>{try{xHRResponseReceived(e,a,i,s,l,o)}catch(e){xHRExceptionLog(e,"POST",d);throw e}});break}case"chrome":{chrome.runtime.sendMessage(d,function(e){try{xHRResponseReceived(e,a,i,s,l,o)}catch(e){xHRExceptionLog(e,"POST",d);throw e}});break}}}};var xHRResponseReceived=function(e,t,i,o,a,n){if(e.success===true){var r=e.response;if(t.dataType&&t.dataType.toLowerCase()==="json"){r=JSON.parse(r)}if(o){o(r)}if(typeof i==="function"){i(true,n,r)}else{jQuery(document.body).trigger(i,[{success:true,data:n,response:r}])}}else{if(a)a(e.response);if(typeof i==="function"){i(false,n,e.response)}else{jQuery(document.body).trigger(i,[{success:false,data:n,response:e.response}])}TBUtilities.Log("Response failure to URL "+t.url+". Details: "+JSON.stringify(e.response))}};var xHRExceptionLog=function(e,t,i){var o="";if(e.message){o+=e.message}if(e.stack){o+=" | stack: "+e.stack}TBUtilities.Log("Response failure on "+t+" to URL "+i.url+". Error: \n "+o)};const isSameOrigin=(e,t)=>{let i=false;try{let o=new URL(e);let a=new URL(t);if(o.host===a.host){i=true}}catch(e){console.log(e);i=false}return i};var generateUniqueId=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=Math.random()*16|0,i=e=="x"?t:t&3|8;return i.toString(16)})};var getExtensionVersion=function(){if(extenstionVersion)return extenstionVersion;var e=getType();switch(e){case"chrome":case"firefox":{extenstionVersion=chrome.runtime.getManifest().version;break}default:{extenstionVersion="unknown"}}};var getDataType=function(e){if(typeof e==="undefined")return"undefined";else if(e===null)return"null";else if(typeof e==="object")return"object";else return"string"};var encryptDataForTransport=function(e,t){if(t=="undefined")return window.btoa("");else if(t=="null")return window.btoa("");else if(t=="object"){e=JSON.stringify(e);return window.btoa(e)}else if(t=="string"){return window.btoa(e)}else TBUtilities.Log("Unknown encrypt dataType: "+t)};var decryptDataFromTransport=function(e,t){if(!t)return"unknown";else if(t=="undefined")return undefined;else if(t=="null")return null;else if(t=="object"){e=decodeURIComponent(escape(window.atob(e)));return JSON.parse(e)}else if(t=="string")return decodeURIComponent(escape(window.atob(e)));else TBUtilities.Log("Unknown decrypt dataType: "+t)};var getHost=function(e){var t=document.createElement("a");t.href=e;return t.hostname};var encodeUrl=function(e){if(e.indexOf("?")==-1)return e;e=e.replace(/"/g,"%22");e=e.replace(/ /g,"%20");return e};return{GetType:function(){return getType()},GetFilePath:getFilePath,Get:get,GetExtensionVersion:function(){return getExtensionVersion()},SetExtensionVersion:function(e){extenstionVersion=e},Post:post,SetDbValue:function(e,t,i){setDbValue(e,t,i)},GetDbValue:function(e,t){getDbValue(e,t)},RemoveDbValue:function(e){removeDbValue(e)}}}();var TubeBuddyYouTubeActions=function(){var e=false;var t=null;var o=null;var a=null;var n=null;var r=null;var s={url:null,text:null};var d=0;var u=0;var c=0;var p=0;var b={};var y=0;var h=0;var f=null;var m=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi;var g={};var v={};var T="studioHtml-";var w="authedUser-";var j=function(e,t,i,o){if(e){f=e}if(!f){TBUtilities.Log("Auto complete token not passed - "+t);TBExtension.Get("https://www.youtube.com/account",function(e,a,n){var r=n;var s=r.indexOf('PSUGGEST_TOKEN":"')+'PSUGGEST_TOKEN":"'.length;var l=r.indexOf('"',s);f=r.substring(s,l);Q(f,t,i,o)},null,null)}else{TBUtilities.Log("Auto complete token passed - "+t);Q(f,t,i,o)}};var Q=function(e,t,i,o){TBUtilities.Log("Getting autocomplete for - "+t);var a=TBGlobal.GetPrefCookieObject();var n="us";var r="en";if(a&&a.gl){n=a.gl}if(a&&a.hl){r=a.hl}var s="auto-"+t+o;var l=lscache.get(s);if(l==null){t=t.trim();h=i;var d="https://clients1.google.com/complete/search?client=youtube&hl="+r+"&gl="+n+"&gs_rn=23&gs_ri=youtube&tok="+f+"&ds=yt&cp=15&gs_id=a&q="+TBUtilities.GetUrlEncoded(t)+"&callback=google.sbox.p50&gs_gbg=3no8d";if(o=="google"){d="https://clients1.google.com/complete/search?client=youtube&hl="+r+"&gl="+n+"&gs_rn=23&gs_ri=youtube&tok="+f+"&cp=15&gs_id=a&q="+TBUtilities.GetUrlEncoded(t)+"&callback=google.sbox.p50&gs_gbg=3no8d"}TBExtension.Get(d,function(e,t,o){TBUtilities.Log("CRTBGetYouTubeSuggest success = "+e+" for term "+t.Term);var a=[];try{if(e===true){var n=o.indexOf("[");var r=o.indexOf("{");var s=o.substring(n,r);s=TBUtilities.ReplaceAll(s,'"',"'");var l=s.match(/'[^']*'/g);jQuery.each(l,function(e,t){t=x(t).trim();t=TBUtilities.ReplaceAll(t,"'","").trim();a.push(t)});var d=[];for(var u=0;u<a.length;u++){if(a[u]&&a[u].toLowerCase()===t.Term.toLowerCase()){d.push(u)}}for(var u=d.length-1;u>=0;u--){a.splice(d[u],1)}}}catch(e){TBUtilities.LogError({Exception:e,Location:"[YouTubeActions] makeAutoCompleteRequest"})}var c="auto-"+t.Term+t.Type;lscache.set(c,a,1440);i(a,t.Term)},{Term:t,Type:o})}else{TBUtilities.Log("Autocomplete cache length - "+l.length);i(l,t)}};var x=function(e){return e.replace(/\\u[\dA-Fa-f]{4}/g,function(e){return String.fromCharCode(parseInt(e.replace(/\\u/g,""),16))})};var B=function(e,t,i){o=i;var a="https://www.youtube.com/channel/"+e+"/about";TBExtension.Get(a,"CRTBLoadAboutPageForMessage",{message:t,channelid:e})};var k=function(e,t){a=t;var i="https://www.youtube.com/playlist?list="+e;TBUtilities.Log("YTFunctions - Getting Playlist: "+i);TBExtension.Get(i,"CRTBYTActionsLoadPlaylistPage",{})};var L=function(e,i){t=i;var o="https://www.youtube.com/channel/"+e+"/about";TBExtension.Get(o,"CRTBLoadAboutPageForSubscribe",{channelId:e})};var U=function(e){TBUtilities.Log("TubeBuddyYouTubeActions - CRTBLoadAboutPageForSubscribe success = "+e.success);try{if(e.success){try{var i=e.response.lastIndexOf(',"subscribed":')+',"subscribed":'.length;var o=e.response.substring(i,i+1);if(o=="t"){TBUtilities.Log("Already subbed: cRTBLoadAboutPageForSubscribe");l;t(e)}}catch{}var a=TBUtilities.GetSessionToken(e.response);var n="https://www.youtube.com/subscription_ajax?action_create_subscription_to_channel=1&c="+e.data.channelId;var r="session_token="+a;TBExtension.Post(n,r,"CRTBPostSubscribe",e.data,{contentType:"application/x-www-form-urlencoded; charset=UTF-8"})}else{t(e)}}catch(e){TBUtilities.Log(e)}};var C=function(e){TBUtilities.Log("TubeBuddyYouTubeActions - CRTBLoadAboutPageForMessage result = "+e.success);try{if(e.success==false){o(e);return}var t=null;var i=null;try{t=TBUtilities.GetSessionToken(e.response);i=P(e.response)}catch(e){TBUtilities.Log(e)}if(i!=null&&t!=null){var a="&user_id="+i;a+="&channel_id";a+="&content="+e.data.message;a+="&session_token="+t;var n="https://www.youtube.com/comment_ajax?action_send_message=1";TBExtension.Post(n,a,"CRTBMessagePost",e.data,{contentType:"application/x-www-form-urlencoded; charset=UTF-8"})}else{e.success=false;o(e)}}catch(t){TBUtilities.Log(t);e.success=false;o(e)}};var A=function(e){TBUtilities.Log("TubeBuddyYouTubeActions - CRTBMessagePost result = "+e.success);o(e)};var S=function(e){t(e)};var E=function(e){n(e)};var I=function(e){try{if(e.success==false){TBUtilities.Log("cRTBYTActionsLoadPlaylistPage failed");a(e);return}}catch(e){TBUtilities.LogError("cRTBYTActionsLoadPlaylistPage exception"+e);a(false)}};var G=function(e,t,i,o,a,r,s){TBUtilities.Log("TubeBuddyYouTubeActions - getSearchResults");n=i;var l="https://www.youtube.com/results?search_query="+TBUtilities.GetUrlEncoded(t)+"&page="+o;if(typeof r!=="undefined"){l=l+"&search_sort="+r}if(typeof s!=="undefined"){l=l+"&filters="+s}var d="https://www.youtube.com/results?search_query="+TBUtilities.GetUrlEncoded(t)+"&page="+o;TBExtension.Get(d,"CRTBYouTubeActionGetSearchResults",{id:a,searchTerm:t,pageNumber:o})};var R=function(e,t,o,a,n,r,s){TBUtilities.Log("TubeBuddyYouTubeActions - getVideoSearchRank");TBUtilities.Log("Use Incognito: "+TBGlobal.Profile().IncognitoSearch);if(typeof a==="undefined"||a==null){a=1}if(n==null){n=2}var l=TBUtilities.GetUrlEncoded(t);var d=e+"-"+l;var u="https://www.youtube.com/results?search_query="+l+"&page="+a;y++;if(y>=10){TBUtilities.Log("TubeBuddyYouTubeActions - getVideoSearchRank clearing cache");y=0;lscache.flushExpired()}if(s&&s==true){TBUtilities.Log("TubeBuddyYouTubeActions - getVideoSearchRank removing cache value for "+t+" if available ");lscache.remove(d)}var c=lscache.get(d);if(c!=null){TBUtilities.Log("TubeBuddyYouTubeActions - getVideoSearchRank cached value found for "+t+" rank = "+c);o(e,t,parseInt(c),r)}else{var p=true;if(TBGlobal.Profile().IncognitoSearch===true){p=false}TBExtension.Get(u,function(s,l,u){try{if(s){var c=false;var p=20*(a-1);var b=null;if(TBExtension.GetType()==="safari"){b=TBGlobal.GetYouTubeUIFromHtml(u)}else{b=TBGlobal.GetYouTubeUI()}if(b=="default"&&u.indexOf('window["ytInitialData"]')>-1){b="material"}switch(b){case"studio":case"material":{var y=u.indexOf('window["ytInitialData"] =');if(y!=-1){var h=TBUtilities.ParseResponseContextFromHtml(u);if(h.contents.twoColumnSearchResultsRenderer.primaryContents!=null){var f=TBUtilities.GetVideoSearchCollectionIndex(h.contents.twoColumnSearchResultsRenderer.primaryContents.sectionListRenderer.contents);if(f!=null){jQuery.each(h.contents.twoColumnSearchResultsRenderer.primaryContents.sectionListRenderer.contents[f].itemSectionRenderer.contents,function(t,o){if(o){if(o.shelfRenderer||o.videoRenderer||o.channelRenderer){p++}if(o.shelfRenderer){if(o.shelfRenderer.content.verticalListRenderer){var a=o.shelfRenderer.content.verticalListRenderer.collapsedItemCount;for(i=0;i<a;i++){if(o.shelfRenderer.content.verticalListRenderer.items[i]&&o.shelfRenderer.content.verticalListRenderer.items[i].videoRenderer){if(e==o.shelfRenderer.content.verticalListRenderer.items[i].videoRenderer.videoId){c=true;return false}if(i!=0){p++}}}}}else if(o.videoRenderer){if(e==o.videoRenderer.videoId){c=true;return false}}}})}}}break}case"default":{u=u.replace(/__ytRIL/g,"");u=TBUtilities.ReplaceAll(u,"window. &amp;&amp;","");var m=jQuery.parseHTML(DOMPurify.sanitize(u,DOMPurifyConfig));jQuery(".item-section",m).find("li > div").each(function(){if(jQuery(this).hasClass("spell-correction"))return;p++;jQuery(this).find("a").attr("target","_blank");jQuery(this).find(".yt-uix-menu-trigger").remove();var t=jQuery(this).find(".yt-lockup-byline").find("a:first").attr("data-ytid");var i=jQuery(this).find("h3 > a:first");if(i!=null){var o=i.attr("href");if(o==null)o="";if(o.indexOf("watch?")>0){var a=o.indexOf("v=")+2;var n=o.substring(a,a+11);if(e==n){c=true;return false}}}})}}if(c){lscache.set(d,p,5);o(e,t,p,r)}else{if(a<n){R(e,t,o,a+1,n,r)}else{lscache.set(d,0,5);o(e,t,0,r)}}}else{TBUtilities.LogFailedWebRequest({Location:"YouTubeActions.js|getVideoSearchRank",Data:l,Response:u});lscache.set(d,-1,30);o(e,t,-1,r)}}catch(i){TBUtilities.LogError({Exception:i,Location:"YouTubeActions.js|getVideoSearchRank"});lscache.set(d,-1,30);o(e,t,-1,r)}},null,{dataType:"text/html",credentials:p})}};var P=function(e){TBUtilities.Log("TubeBuddyYouTubeActions - parseUserId");var t='data-user-id="';var i=null;var o=e.indexOf(t);if(o!=-1){o=o+t.length;var a=e.indexOf('"',o+1);i=e.substring(o,a)}return i};var D=function(e,t,i,o,a){TBUtilities.Log("TubeBuddyYouTubeActions - copyCard");if(!v[a]){v[a]=1}else{let e=v[a];e++;v[a]=e}var n=new FormData;n.append("key","");n.append("start_ms",t.start_ms);n.append("session_token",i);switch(t.type){case"playlist":n.append("type","video");n.append("video_url",t.target_url);n.append("video_item_id",t.playlist_id);n.append("show_warnings","False");n.append("action_create_video",1);n.append("show_warnings","False");n.append("custom_message",t.custom_message);n.append("teaser_text",t.teaser_text);break;case"video":n.append("type",t.type);n.append("video_url",t.target_url);n.append("video_item_id",t.video_id);n.append("show_warnings","False");n.append("action_create_video",1);n.append("show_warnings","False");n.append("custom_message",t.custom_message);n.append("teaser_text",t.teaser_text);break;case"merch":n.append("type",t.type);n.append("action_create_merch",1);n.append("target_url",t.target_url);n.append("title",t.title);n.append("custom_message",t.custom_message);n.append("teaser_text",t.teaser_text);if(t.imagefile){n.append("imagefile",t.imagefile)}break;case"fundraising":n.append("type",t.type);n.append("action_create_fundraising",1);n.append("target_url",t.target_url);n.append("title",t.title);n.append("custom_message",t.custom_message);n.append("teaser_text",t.teaser_text);if(t.imagefile){n.append("imagefile",t.imagefile)}break;case"product":case"associated":n.append("type",t.type);n.append("action_create_associated",1);n.append("target_url",t.target_url);n.append("title",t.title);n.append("custom_message",t.custom_message);n.append("teaser_text",t.teaser_text);if(t.imagefile){n.append("imagefile",t.imagefile)}break;case"tip":n.append("type",t.type);n.append("action_create_tip",1);break;case"collaborator":n.append("type",t.type);n.append("action_create_collaborator",1);n.append("channel_url",t.channel_url);n.append("title",t.title);n.append("custom_message",t.custom_message);n.append("teaser_text",t.teaser_text);break;case"poll":n.append("type",t.type);n.append("action_create_poll",1);n.append("title",t.title);n.append("teaser_text",t.teaser_text);n.append("choices_as_string",t.choices.join());break}var r="https://www.youtube.com/cards_ajax?v="+e;try{TBUtilities.Log("TubeBuddyYouTubeActions - copyCard - data = ");var s={};n.forEach(function(e,t){s[t]=e});TBUtilities.Log(s)}catch(e){TBUtilities.Log(e)}TBExtension.Post(r,n,function(n,r,s){try{if(n){if(s.indexOf('"errors":["')>0){try{TBUtilities.Log("TubeBuddyYouTubeActions - copyCard - error = ");TBUtilities.Log(s)}catch(e){TBUtilities.Log(e)}var l=s.indexOf('"errors":["')+'"errors":["'.length;var d=s.indexOf("]",l)-2;var u=s.substring(l,d);if(u=="Invalid Reques"){l=s.indexOf('message":"');if(l>0){l+='message":"'.length;d=s.indexOf('"',l)-2;u=s.substring(l,d)}}let n=v[a];if(u.toLowerCase()==="could not save card"&&n<=3){TBUtilities.Log("TubeBuddyYouTubeActions - copyCard - retry = "+n);D(e,t,i,o,a)}else{o(false,e,s,u)}return}o(true,e,r)}else{if(s===503){TBUtilities.Log("503 returned from cards post");Qe(e,function(i){if(i&&i.feature_templates){var a=i.feature_templates;var n=false;switch(t.type){case"playlist":var l=a.find(e=>e.type==="playlist"&&t.playlist_id===e.playlist_id);if(l){n=true}break;case"video":var l=a.find(e=>e.type==="video"&&t.video_id===e.video_id);if(l){n=true}break;case"merch":var l=a.find(e=>e.type==="merch"&&t.target_url===e.target_url);if(l){n=true}break;case"fundraising":var l=a.find(e=>e.type==="fundraising"&&t.target_url===e.target_url);if(l){n=true}break;case"product":case"associated":var l=a.find(e=>(e.type==="associated"||e.type==="product")&&t.target_url===e.target_url);if(l){n=true}break;case"tip":n=true;break;case"collaborator":var l=a.find(e=>e.type==="collaborator"&&t.channel_url===e.channel_url);if(l){n=true}break;case"poll":var l=a.find(e=>e.type==="poll"&&t.title===e.title);if(l){n=true}break}TBUtilities.Log("found cards on video = "+n);if(n===true){o(true,e,r)}else{o(false,e,s,s)}}else{o(false,e,s,s)}})}else{TBUtilities.LogFailedWebRequest({Location:"YouTubeActions.js|copyCard",Data:r,Response:s});o(false,e,s,s)}}}catch(t){TBUtilities.LogError({Exception:t,Location:"YouTubeActions.js|copyCard"});o(false,e,s,s)}},null,{dataType:null,contentType:false,cache:false,timeout:18e4,contentTypeFireFox:"application/x-www-form-urlencoded"})};var V=function(e,t,i,o){TBUtilities.Log("TubeBuddyYouTubeActions - updateCard");var a=new FormData;a.append("key",t.key);a.append("start_ms",t.start_ms);a.append("session_token",i);switch(t.type){case"playlist":a.append("type","video");a.append("video_url",t.target_url);a.append("show_warnings","False");a.append("action_update_video",1);a.append("show_warnings","False");a.append("custom_message",t.custom_message);a.append("teaser_text",t.teaser_text);break;case"video":a.append("type",t.type);a.append("video_url",t.target_url);a.append("show_warnings","False");a.append("action_update_video",1);a.append("show_warnings","False");a.append("custom_message",t.custom_message);a.append("teaser_text",t.teaser_text);break;case"merch":a.append("type",t.type);a.append("action_update_merch",1);a.append("image_url",t.image_url);a.append("target_url",t.target_url);a.append("title",t.title);a.append("custom_message",t.custom_message);a.append("teaser_text",t.teaser_text);if(t.imagefile&&t.imagefile!=""){a.append("imagefile",t.imagefile)}else{a.append("imagefile","")}break;case"fundraising":a.append("type",t.type);a.append("action_update_fundraising",1);a.append("image_url",t.image_url);a.append("target_url",t.target_url);a.append("title",t.title);a.append("custom_message",t.custom_message);a.append("teaser_text",t.teaser_text);if(t.imagefile&&t.imagefile!=""){a.append("imagefile",t.imagefile)}else{a.append("imagefile","")}break;case"product":case"associated":a.append("type",t.type);a.append("action_update_associated",1);a.append("image_url",t.image_url);a.append("target_url",t.target_url);a.append("title",t.title);a.append("custom_message",t.custom_message);a.append("teaser_text",t.teaser_text);if(t.imagefile&&t.imagefile!=""){a.append("imagefile",t.imagefile)}else{a.append("imagefile","")}break;case"collaborator":a.append("type",t.type);a.append("action_update_collaborator",1);a.append("channel_url",t.channel_url);a.append("title",t.title);a.append("custom_message",t.custom_message);a.append("teaser_text",t.teaser_text);break}var n="https://www.youtube.com/cards_ajax?v="+e;TBExtension.Post(n,a,function(i,a,n){try{if(i){TBUtilities.Log({Success:i,Data:a,Response:n});if(n.indexOf('"errors":["')>0){var r=n.indexOf('"errors":["')+'"errors":["'.length;var s=n.indexOf("]",r)-2;var l=n.substring(r,s);if(n.indexOf('message":"',r)>=0){r=n.indexOf('message":"');if(r>0){r+='message":"'.length;s=n.indexOf('"',r)-1;l=n.substring(r,s)}}o(false,e,t,l);return}o(true,e,t)}else{TBUtilities.LogFailedWebRequest({Location:"YouTubeActions.js|updateCard",Data:a,Response:n});o(false,e,t)}}catch(i){TBUtilities.LogError({Exception:i,Location:"YouTubeActions.js|updateCard"});o(false,e,t)}},null,{dataType:null,cache:false,contentType:undefined})};var _=function(e,t,i,o,a,n,r,s,l){TBUtilities.Log("TubeBuddyYouTubeActions - addCard");var d=new FormData;d.append("key","");d.append("type",t);d.append("start_ms",i);d.append("show_warnings",o);d.append("video_item_id",a);d.append("video_url",n);d.append("action_create_video",r);d.append("session_token",s);var u="https://www.youtube.com/cards_ajax?v="+e;TBExtension.Post(u,d,function(t,i,o){try{if(t){l(true,e,o)}else{TBUtilities.LogFailedWebRequest({Location:"YouTubeActions.js|addCard",Data:i,Response:o});l(false,e,o)}}catch(t){TBUtilities.LogError({Exception:t,Location:"YouTubeActions.js|addCard"});l(false,e,o)}},null,{dataType:null,cache:false,contentType:undefined})};var M=function(e){return new Promise(function(t,i){X(e).then(function(o){if(o&&o.startMs){t(o.startMs)}else{TubeBuddyYouTubeActions.GetVideoDetailStudio(e).then(function(e){var i=2e4;if(e.videoDurationMs<=35e3){i=1e4}var o=e.videoDurationMs-i;t(o)}).catch(function(e){i(e)})}}).catch(function(e){i(e)})})};var O=function(e){let t={html:null,videoId:e,header:null,response:null};return new Promise(function(e,i){$(t).then(TBUtilities.ProcessHeader).then(Z).then(N).then(function(t){e(t)}).catch(function(e){i(e)})})};var F=function(e){return new Promise(function(t,i){TBYouTubeApi.GetVideoDetails(e,null,function(e){try{TBUtilities.Log(e);TBGlobal.AddUserDebugInfo("getVideoDuration - callback");var o=new timelord(e.contentDetails.duration);var a=o.ticks();var n={videoId:e.id,videoDurationMs:a};t(n)}catch(e){i("error getting video duration")}})})};var N=function(e){return new Promise(function(t,i){var o=TBUtilities.BuildContextRequestObject(e.html);var a=[];a.push(e.videoId);var n={context:o,failOnError:true,mask:{channelId:true,videoId:true,lengthSeconds:true,premiere:{all:true},status:true,thumbnailDetails:{all:true},title:true,draftStatus:true,downloadUrl:true,watchUrl:true,permissions:{all:true},timeCreatedSeconds:true,timePublishedSeconds:true,origin:true,livestream:{all:true},privacy:true,features:{all:true},videoEditorProject:{all:true},videoDurationMs:true,audioLanguage:{all:true},adFormats:{all:true},adBreaks:{all:true},monetizedStatus:true,videoStreamUrl:true,responseStatus:{all:true}},videoIds:a};var r=TBUtilities.ParseInnerTubeApiKey(e.html);var s="https://studio.youtube.com/youtubei/v1/creator/get_creator_videos?alt=json&key="+r;TBExtension.Post(s,JSON.stringify(n),function(o,a,n){if(o===true&&n.videos.length>0){t(n.videos[0])}else{Y();i("error getting video detail for video id"+e.videoId)}},null,{dataType:"json",cache:false,contentType:null},e.header)})};var Y=function(){TBUtilities.Log("removedCachedStudioValues");lscache.remove(TBUtilities.HeaderCacheKey+TBGlobal.CurrentChannelId());lscache.remove(w+TBGlobal.CurrentChannelId())};var H=function(e,t){let i={html:null,videoId:e,header:null,response:null,thumbnailDataUrl:t};return new Promise(function(e,t){$(i).then(TBUtilities.ProcessHeader).then(Z).then(z).then(function(t){e(t)}).catch(function(e){t(e)})})};var z=function(e){return new Promise(function(t,i){var o=TBUtilities.BuildContextRequestObject(e.html);var a={context:o,encryptedVideoId:e.videoId,videoStill:{image:{dataUri:e.thumbnailDataUrl},operation:"UPLOAD_CUSTOM_THUMBNAIL"}};var n=TBUtilities.ParseInnerTubeApiKey(e.html);var r="https://studio.youtube.com/youtubei/v1/video_manager/metadata_update?alt=json&key="+n;TBExtension.Post(r,JSON.stringify(a),function(o,a,n){if(o===true){t(n)}else{i("error publishing custom thumbnail for video id "+e.videoId)}},null,{dataType:"json",cache:false,contentType:null},e.header)})};var W=function(e,t,i){let o={html:null,videoId:e,header:null,response:null,filter:t?t:null,sort:i?i:"NEWEST"};return new Promise(function(e,t){$(o).then(TBUtilities.ProcessHeader).then(Z).then(q).then(function(t){e(t)}).catch(function(e){t(e)})})};var q=function(e){return new Promise(function(t,i){var o=TBUtilities.BuildContextRequestObject(e.html);var a={context:o,maxReplies:10,moderationState:"PUBLISHED",searchQuery:"",sortOrder:e.sort,videoId:e.videoId};if(e.filter==="responded"){a.commentsFilter={commentCategoryIn:{values:["COMMENT_CATEGORY_ENGAGED"]}}}var n=TBUtilities.ParseInnerTubeApiKey(e.html);var r="https://studio.youtube.com/youtubei/v1/comment/get_comments?alt=json&key="+n;TBExtension.Post(r,JSON.stringify(a),function(o,a,n){if(o===true){t(n)}else{Y();i("error getting comments for video id "+e.videoId)}},null,{dataType:"json",cache:false,contentType:null},e.header)})};var X=function(e){let t={html:null,videoId:e,header:null,response:null};return new Promise(function(e,i){$(t).then(TBUtilities.ProcessHeader).then(Z).then(ee).then(function(t){K(t.elements);e(t)}).catch(function(e){i(e)})})};var K=function(e){jQuery.each(e,function(e,t){if(t.videoEndscreenElement){t.type="VIDEO"}else if(t.playlistEndscreenElement){t.type="PLAYLIST"}else if(t.channelEndscreenElement){t.type="CHANNEL"}else if(t.websiteEndscreenElement){t.type="WEBSITE"}})};const J=(e,t,i)=>new Promise((o,a)=>{return e().then(o).catch(n=>{if(i-1>0){return wait(t).then(J.bind(null,e,t,i-1)).then(o).catch(a)}return a(n)})});var $=function(e){return new Promise(function(t,i){TBUtilities.Log("getStudioHtml");var o=lscache.get(T+TBGlobal.CurrentChannelId());if(o!==null){TBUtilities.Log("getStudioHtml - html cache found");e.html=o;t(e)}else{var a="https://studio.youtube.com/channel/"+TBGlobal.CurrentChannelId();TBUtilities.Log("getStudioHtml - getting "+a);TBExtension.Get(a,function(o,a,n){if(o===true){e.html=n;lscache.set(T+TBGlobal.CurrentChannelId(),n,15);t(e)}else{i("error getting studio html")}},null,null)}})};var Z=function(e){return new Promise(function(t,i){TBUtilities.Log("getAuthedUser");var o=lscache.get(w+TBGlobal.CurrentChannelId());if(o!==null){e.authedUser=o;TBGlobal.SetGoogleAuthUser(o);t(e)}else{var a="https://www.youtube.com/";TBExtension.Get(a,function(a,n,r){o=0;if(a===true){var s="authuser=";var l=r.indexOf(s);if(l>=0){var d=r.substring(l+s.length,r.length);var u=d.indexOf('"');token=d.substring(0,u);var c=token.match(/\d+/);o=c[0]}e.authedUser=parseInt(o);TBGlobal.SetGoogleAuthUser(e.authedUser);lscache.set(w+TBGlobal.CurrentChannelId(),e.authedUser,15);t(e)}else{i("error getting authed user")}},null,null)}})};var ee=function(e){return new Promise(function(t,i){var o=TBUtilities.BuildContextRequestObject(e.html);var a=[];a.push(e.videoId);var n={context:o,encryptedVideoIds:a};var r=TBUtilities.ParseInnerTubeApiKey(e.html);var s="https://studio.youtube.com/youtubei/v1/creator/get_creator_endscreens?alt=json&key="+r;TBExtension.Post(s,JSON.stringify(n),function(e,o,a){if(e===true){t(a.endscreens.length>0?a.endscreens[0]:null)}else{i("error getting endscreen elements")}},null,{dataType:"json",cache:false,contentType:null},e.header)})};var te=function(e,t,i){TBUtilities.Log("Starting: analyticsGetSummaryChannelTotals");if(!e)e=new Date(2005,4,8);if(!t)t=new Date;let o={html:null,header:null,startDate:e,endDate:t,metrics:i,resultData:[]};return new Promise(function(e,t){$(o).then(TBUtilities.ProcessHeader).then(Z).then(se).then(function(t){e(t)}).catch(function(e){t(e)})})};var ie=function(e,t,i){TBUtilities.Log("Starting: analyticsGetDailyChannelTotals");if(!e)e=new Date(2005,4,8);if(!t)t=new Date;let o={html:null,header:null,startDate:e,endDate:t,metrics:i,resultData:[]};return new Promise(function(e,t){$(o).then(TBUtilities.ProcessHeader).then(Z).then(le).then(function(t){e(t)}).catch(function(e){t(e)})})};var oe=function(e,t,i,o){TBUtilities.Log("Starting: analyticsGetDailyVideoTotals");if(!t)t=new Date(2005,4,8);if(!i)i=new Date;let a={html:null,header:null,startDate:t,endDate:i,metrics:o,videoId:e,resultData:[]};return new Promise(function(e,t){$(a).then(TBUtilities.ProcessHeader).then(Z).then(de).then(function(t){e(t)}).catch(function(e){t(e)})})};var ae=function(e,t,i,o){TBUtilities.Log("Starting: analyticsGetSummaryVideoTrafficSourcesTotals");if(!t)t=new Date(2005,4,8);if(!i)i=new Date;let a={html:null,header:null,startDate:t,endDate:i,metrics:o,videoId:e,resultData:[]};return new Promise(function(e,t){$(a).then(TBUtilities.ProcessHeader).then(Z).then(ue).then(function(t){e(t)}).catch(function(e){t(e)})})};var ne=function(e,t,i,o){TBUtilities.Log("Starting: analyticsGetSummaryVideoTotals");if(!t)t=new Date(2005,4,8);if(!i)i=new Date;let a={html:null,header:null,startDate:t,endDate:i,metrics:o,videoId:e,resultData:[]};return new Promise(function(e,t){$(a).then(TBUtilities.ProcessHeader).then(Z).then(ce).then(function(t){e(t)}).catch(function(e){t(e)})})};var re=function(e,t){let i={html:null,header:null,pageToken:null,maxToReturn:e,publicOnly:t};return new Promise(function(e,t){$(i).then(TBUtilities.ProcessHeader).then(Z).then(pe).then(function(t){e(t)}).catch(function(e){t(e)})})};var se=function(e){return new Promise(function(t,i){var o=TBUtilities.BuildContextRequestObject(e.html);TBUtilities.Log("Do not forget to eventually convert dates");var a={nodes:[{key:"0__KEY_METRIC_TOTAL_QUERY",value:{query:{dimensions:[],metrics:[],restricts:[{dimension:{type:"USER"},inValues:[""]}],orders:[],timeRange:{dateIdRange:{inclusiveStart:"",exclusiveEnd:""}},currency:"USD"}}}],context:o};TBUtilities.Log("analyticsGetSummaryChannelData nodes");a.nodes[0].value.query.restricts[0].inValues=TBGlobal.CurrentChannelId();a.nodes[0].value.query.timeRange.dateIdRange.inclusiveStart=new Date(e.startDate).getFullYear().toString()+(new Date(e.startDate).getMonth()+1).toString().padStart(2,"0")+new Date(e.startDate).getDate().toString().padStart(2,"0");a.nodes[0].value.query.timeRange.dateIdRange.exclusiveEnd=new Date(e.endDate).getFullYear().toString()+(new Date(e.endDate).getMonth()+1).toString().padStart(2,"0")+new Date(e.endDate).getDate().toString().padStart(2,"0");jQuery.each(e.metrics,function(e,t){a.nodes[0].value.query.metrics.push({type:t})});var n=TBUtilities.ParseInnerTubeApiKey(e.html);var r="https://studio.youtube.com/youtubei/v1/analytics_data/join?alt=json&key="+n;TBUtilities.Log("analyticsGetSummaryChannelData posting!");TBUtilities.Log(a);TBExtension.Post(r,JSON.stringify(a),function(o,a,n){if(o===true){jQuery.each(n.results[0].value.resultTable.resultColumns,function(t,i){e.resultData.push({Type:i.column.type,Value:i.values[0].double})});t(e)}else{i("error get videos list")}},null,{dataType:"json",cache:false,contentType:"application/json"},e.header)})};var le=function(e){return new Promise(function(t,i){var o=TBUtilities.BuildContextRequestObject(e.html);TBUtilities.Log("analyticsGetDailyChannelData");var a={nodes:[{key:"0__KEY_METRIC_DAILY_QUERY",value:{query:{dimensions:[{type:"DAY"}],metrics:[],restricts:[{dimension:{type:"USER"},inValues:[""]}],orders:[{dimension:{type:"DAY"},direction:"ANALYTICS_ORDER_DIRECTION_ASC"}],timeRange:{dateIdRange:{inclusiveStart:"",exclusiveEnd:""}},currency:"USD"}}}],context:o};TBUtilities.Log("analyticsGetDailyChannelData nodes");a.nodes[0].value.query.restricts[0].inValues=TBGlobal.CurrentChannelId();a.nodes[0].value.query.timeRange.dateIdRange.inclusiveStart=new Date(e.startDate).getFullYear().toString()+(new Date(e.startDate).getMonth()+1).toString().padStart(2,"0")+new Date(e.startDate).getDate().toString().padStart(2,"0");a.nodes[0].value.query.timeRange.dateIdRange.exclusiveEnd=new Date(e.endDate).getFullYear().toString()+(new Date(e.endDate).getMonth()+1).toString().padStart(2,"0")+new Date(e.endDate).getDate().toString().padStart(2,"0");jQuery.each(e.metrics,function(e,t){a.nodes[0].value.query.metrics.push({type:t})});var n=TBUtilities.ParseInnerTubeApiKey(e.html);var r="https://studio.youtube.com/youtubei/v1/analytics_data/join?alt=json&key="+n;TBUtilities.Log("analyticsGetDailyChannelData posting!");TBUtilities.Log(a);TBExtension.Post(r,JSON.stringify(a),function(o,a,n){if(o===true){for(var r=0;r<n.results[0].value.resultTable.resultColumns[0].values.length;r++){var s={};s.Date=new Date(0).setUTCSeconds(n.results[0].value.resultTable.resultColumns[0].values[r].double);jQuery.each(e.metrics,function(e,t){s["'"+n.results[0].value.resultTable.resultColumns[e+1].column.type+"'"]=n.results[0].value.resultTable.resultColumns[e+1].values[r].double});e.resultData.push(s)}t(e)}else{i("error get analyticsGetDailyChannelData")}},null,{dataType:"json",cache:false,contentType:"application/json"},e.header)})};var de=function(e){return new Promise(function(t,i){var o=TBUtilities.BuildContextRequestObject(e.html);var a={nodes:[{key:"0__KEY_METRIC_DAILY_QUERY",value:{query:{dimensions:[{type:"DAY"}],metrics:[],restricts:[{dimension:{type:"USER"},inValues:[""]},{dimension:{type:"VIDEO"},inValues:["#VIDEOID#"]}],orders:[{dimension:{type:"DAY"},direction:"ANALYTICS_ORDER_DIRECTION_ASC"}],timeRange:{dateIdRange:{inclusiveStart:"",exclusiveEnd:""}},currency:"USD"}}}],context:o};a.nodes[0].value.query.restricts[0].inValues=TBGlobal.CurrentChannelId();a.nodes[0].value.query.restricts[1].inValues=e.videoId;a.nodes[0].value.query.timeRange.dateIdRange.inclusiveStart=new Date(e.startDate).getFullYear().toString()+(new Date(e.startDate).getMonth()+1).toString().padStart(2,"0")+new Date(e.startDate).getDate().toString().padStart(2,"0");a.nodes[0].value.query.timeRange.dateIdRange.exclusiveEnd=new Date(e.endDate).getFullYear().toString()+(new Date(e.endDate).getMonth()+1).toString().padStart(2,"0")+new Date(e.endDate).getDate().toString().padStart(2,"0");jQuery.each(e.metrics,function(e,t){a.nodes[0].value.query.metrics.push({type:t})});var n=TBUtilities.ParseInnerTubeApiKey(e.html);var r="https://studio.youtube.com/youtubei/v1/analytics_data/join?alt=json&key="+n;TBExtension.Post(r,JSON.stringify(a),function(o,a,n){if(o===true){for(var r=0;r<n.results[0].value.resultTable.resultColumns[0].values.length;r++){var s={};s.Date=new Date(0).setUTCSeconds(n.results[0].value.resultTable.resultColumns[0].values[r].double);jQuery.each(e.metrics,function(e,t){s[n.results[0].value.resultTable.resultColumns[e+1].column.type]=n.results[0].value.resultTable.resultColumns[e+1].values[r].double});e.resultData.push(s)}e.html="";t(e)}else{i("error get analyticsGetDailyVideoData")}},null,{dataType:"json",cache:false,contentType:"application/json"},e.header)})};var ue=function(e){return new Promise(function(t,i){var o=TBUtilities.BuildContextRequestObject(e.html);var a={nodes:[{key:"0__TOTALS_SUMS_QUERY_KEY",value:{query:{dimensions:[{type:"TRAFFIC_SOURCE_TYPE"}],metrics:[],restricts:[{dimension:{type:"USER"},inValues:[""]},{dimension:{type:"VIDEO"},inValues:["#VIDEOID#"]}],orders:[],timeRange:{dateIdRange:{inclusiveStart:"",exclusiveEnd:""}},currency:"USD"}}}],context:o};a.nodes[0].value.query.restricts[0].inValues=TBGlobal.CurrentChannelId();a.nodes[0].value.query.restricts[1].inValues=e.videoId;a.nodes[0].value.query.timeRange.dateIdRange.inclusiveStart=new Date(e.startDate).getFullYear().toString()+(new Date(e.startDate).getMonth()+1).toString().padStart(2,"0")+new Date(e.startDate).getDate().toString().padStart(2,"0");a.nodes[0].value.query.timeRange.dateIdRange.exclusiveEnd=new Date(e.endDate).getFullYear().toString()+(new Date(e.endDate).getMonth()+1).toString().padStart(2,"0")+new Date(e.endDate).getDate().toString().padStart(2,"0");jQuery.each(e.metrics,function(e,t){a.nodes[0].value.query.metrics.push({type:t})});var n=TBUtilities.ParseInnerTubeApiKey(e.html);var r="https://studio.youtube.com/youtubei/v1/analytics_data/join?alt=json&key="+n;TBUtilities.Log("analyticsGetSummaryVideoTrafficSourcesTotalsData posting!");TBUtilities.Log(a);TBExtension.Post(r,JSON.stringify(a),function(o,a,n){if(o===true){for(var r=0;r<n.results[0].value.resultTable.resultColumns[0].values.length;r++){var s={};TBUtilities.Log(r);s.TrafficSource=n.results[0].value.resultTable.resultColumns[0].values[r].string;TBUtilities.Log(s.TrafficSource);jQuery.each(e.metrics,function(e,t){s[t]=n.results[0].value.resultTable.resultColumns[e+1].values[r].double});e.resultData.push(s)}e.html="";t(e)}else{i("error get analyticsGetSummaryVideoTrafficSourcesTotalsData")}},null,{dataType:"json",cache:false,contentType:"application/json"},e.header)})};var ce=function(e){return new Promise(function(t,i){var o=TBUtilities.BuildContextRequestObject(e.html);var a={nodes:[{key:"0__TOTALS_SUMS_QUERY_KEY",value:{query:{metrics:[],restricts:[{dimension:{type:"USER"},inValues:[""]},{dimension:{type:"VIDEO"},inValues:["#VIDEOID#"]}],orders:[],timeRange:{dateIdRange:{inclusiveStart:"",exclusiveEnd:""}},currency:"USD"}}}],context:o};a.nodes[0].value.query.restricts[0].inValues=TBGlobal.CurrentChannelId();a.nodes[0].value.query.restricts[1].inValues=e.videoId;a.nodes[0].value.query.timeRange.dateIdRange.inclusiveStart=new Date(e.startDate).getFullYear().toString()+(new Date(e.startDate).getMonth()+1).toString().padStart(2,"0")+new Date(e.startDate).getDate().toString().padStart(2,"0");a.nodes[0].value.query.timeRange.dateIdRange.exclusiveEnd=new Date(e.endDate).getFullYear().toString()+(new Date(e.endDate).getMonth()+1).toString().padStart(2,"0")+new Date(e.endDate).getDate().toString().padStart(2,"0");jQuery.each(e.metrics,function(e,t){a.nodes[0].value.query.metrics.push({type:t})});var n=TBUtilities.ParseInnerTubeApiKey(e.html);var r="https://studio.youtube.com/youtubei/v1/analytics_data/join?alt=json&key="+n;TBUtilities.Log("analyticsGetSummaryVideoData posting!");TBUtilities.Log(a);TBExtension.Post(r,JSON.stringify(a),function(o,a,n){if(o===true){var r={};jQuery.each(e.metrics,function(e,t){r[n.results[0].value.resultTable.resultColumns[e].column.type]=n.results[0].value.resultTable.resultColumns[e].values[0].double});e.resultData=r;e.html="";t(e)}else{i("error get analyticsGetSummaryVideoData")}},null,{dataType:"json",cache:false,contentType:"application/json"},e.header)})};var pe=function(e){return new Promise(function(t,i){var o=TBUtilities.BuildContextRequestObject(e.html);var a={filter:{and:{operands:[{channelIdIs:{value:""}},{videoOriginIs:{value:"VIDEO_ORIGIN_UPLOAD"}}]}},order:"VIDEO_ORDER_DISPLAY_TIME_DESC",pageSize:50,mask:{videoId:true,status:true,title:true,timeCreatedSeconds:true,timePublishedSeconds:true,origin:true,privacy:true,thumbnailDetails:{all:true},metrics:{all:true},audienceRestriction:{all:true},ageRestriction:true},context:o};if(e.pageToken){a.pageToken=e.pageToken}a.filter.and.operands[0].channelIdIs.value=TBGlobal.CurrentChannelId();var n=TBUtilities.ParseInnerTubeApiKey(e.html);var r="https://studio.youtube.com/youtubei/v1/creator/list_creator_videos?alt=json&key="+n;if(e.videosList==null)e.videosList=[];TBExtension.Post(r,JSON.stringify(a),function(o,a,n){if(o===true){jQuery.each(n.videos,function(t,i){TBUtilities.Log("Skip check");if(e.publicOnly&&i.privacy!="VIDEO_PRIVACY_PUBLIC"){TBUtilities.Log("Skipping because not public");return}if(e.maxToReturn==null||e.videosList.length<e.maxToReturn)e.videosList.push(i)});if(n.nextPageToken&&(e.maxToReturn==null||e.videosList.length<e.maxToReturn)){e.pageToken=n.nextPageToken;e.response=n;pe(e).then(e=>{t(e)})}else{TBUtilities.Log("no, nextPageToken or found MaxNeeded");e.response=n;t(e)}}else{i("error get videos list")}},null,{dataType:"json",cache:false,contentType:"application/json"},e.header)})};var be=function(e,t,i){let o={html:null,videoIdToEdit:e,endScreenStartMs:t,elementsToCopy:i,header:null,copyResponse:null};return new Promise(function(e,t){$(o).then(TBUtilities.ProcessHeader).then(Z).then(ye).then(function(t){e(t)}).catch(function(e){t(e)})})};var ye=function(e){return new Promise(function(t,i){var o=TBUtilities.BuildContextRequestObject(e.html);e.elementsToCopy=me(e.elementsToCopy);var a={endscreenEdit:{endscreen:{responseStatus:{statusCode:"CREATOR_ENTITY_STATUS_OK"},encryptedVideoId:e.videoIdToEdit,startMs:e.endScreenStartMs,elements:e.elementsToCopy}},externalVideoId:e.videoIdToEdit,context:o};var n=TBUtilities.ParseInnerTubeApiKey(e.html);var r="https://studio.youtube.com/youtubei/v1/video_editor/edit_video?alt=json&key="+n;TBExtension.Post(r,JSON.stringify(a),function(o,a,n){if(o===true){e.response=n;t(e)}else{i("error copy end screen elements")}},null,{dataType:"json",cache:false,contentType:"application/json"},e.header)})};var he=function(e,t,i,o,a,n,r){TBUtilities.Log("YouTubeActions.js|copyEndCardElements");var s={action_save:1,encrypted_video_id:e,impressionUrls:[],isNonStandardAspectRatio:"False",minStartMs:o,session_token:n,skip:"False",startMs:i,status:200,v:e,elements:[]};s.elements=fe(a);var l="https://www.youtube.com/endscreen_ajax?v="+e;TBExtension.Post(l,JSON.stringify(s),function(t,i,o){try{if(t){if(o["errors"]!=undefined&&o.errors.length>=1){var n=o.errors[0];if(n&&n.indexOf("Width must remain within allowed range")>-1){n="Video aspect ratio / resolution mismatch. Try copying from videos of same the aspect ratio or resolution."}r(false,e,o,n);return}if(o["elements"]!=undefined&&o.for_editor.elements.length!=a.length){var n="";r(false,e,o,n);return}else{r(true,e,o);return}}else{TBUtilities.LogFailedWebRequest({Location:"YouTubeActions.js|copyEndCardElements",Data:i,Response:o});r(false,e,o,o)}}catch(t){TBUtilities.LogError({Exception:t,Location:"YouTubeActions.js|copyEndCardElements"});r(false,e,o,o)}},null,{dataType:"json",cache:false,contentType:"application/json"})};var fe=function(e){var t=[];jQuery.each(e,function(e,i){switch(i.type){case"CHANNEL":{if(i.isSubscribe){delete i["clickUrls"];delete i["cta"];delete i["dismissUrls"];delete i["fallbackReason"];delete i["hoverUrls"];i.id=TBUtilities.CreateGuid();delete i["imageUrl"];delete i["impressionUrls"];delete i["playlistId"];delete i["playlistLength"];delete i["sessionData"];delete i["urlCheckOk"];delete i["websiteType"];t.push(i)}else{delete i["clickUrls"];delete i["cta"];delete i["dismissUrls"];delete i["fallbackReason"];delete i["hoverUrls"];delete i["htmlBlob"];delete i["iconUrl"];i.id=TBUtilities.CreateGuid();delete i["imageUrl"];delete i["impressionUrls"];delete i["playlistId"];delete i["playlistLength"];delete i["sessionData"];delete i["subscriberCount"];delete i["urlCheckOk"];delete i["websiteType"];delete i["videoDuration"];delete i["videoId"];delete i["videoType"];t.push(i)}break}case"WEBSITE":{delete i["channelId"];delete i["clickUrls"];delete i["dismissUrls"];delete i["fallbackReason"];delete i["hoverUrls"];delete i["htmlBlob"];i.id=TBUtilities.CreateGuid();delete i["impressionUrls"];delete i["isSubscribe"];delete i["playlistId"];delete i["playlistLength"];delete i["sessionData"];delete i["subscriberCount"];delete i["urlCheckOk"];delete i["imageUrl"];delete i["imageBlob"];delete i["imagefile"];if(i.websiteEndscreenElement){delete i.websiteEndscreenElement["customUploadedImage"];delete i.websiteEndscreenElement["icon"]}t.push(i);break}case"VIDEO":{delete i["callToAction"];delete i["channelId"];delete i["clickUrls"];delete i["cta"];delete i["dismissUrls"];delete i["fallbackReason"];delete i["hoverUrls"];delete i["htmlBlob"];delete i["iconUrl"];i.id=TBUtilities.CreateGuid();delete i["imageUrl"];delete i["impressionUrls"];delete i["isSubscribe"];delete i["playlistId"];delete i["playlistLength"];delete i["sessionData"];delete i["subscriberCount"];delete i["urlCheckOk"];delete i["websiteType"];t.push(i);break}case"PLAYLIST":{delete i["callToAction"];delete i["channelId"];delete i["clickUrls"];delete i["cta"];delete i["dismissUrls"];delete i["fallbackReason"];delete i["hoverUrls"];delete i["htmlBlob"];delete i["iconUrl"];i.id=TBUtilities.CreateGuid();delete i["imageUrl"];delete i["impressionUrls"];delete i["isSubscribe"];delete i["sessionData"];delete i["subscriberCount"];delete i["urlCheckOk"];delete i["websiteType"];delete i["videoType"];t.push(i);break}}});return t};var me=function(e){var t=[];jQuery.each(e,function(e,i){delete i["id"];switch(i.type){case"CHANNEL":{if(i.channelEndscreenElement.isSubscribe){delete i.channelEndscreenElement["icon"];i.channelEndscreenElement.channelId=TBGlobal.CurrentChannelId();t.push(i)}else{t.push(i)}break}case"WEBSITE":{if(i.websiteEndscreenElement){delete i.websiteEndscreenElement["customUploadedImage"];delete i.websiteEndscreenElement["icon"]}t.push(i);break}case"VIDEO":{if(i.videoEndscreenElement){delete i.videoEndscreenElement["playbackStartMs"]}t.push(i);break}case"PLAYLIST":{t.push(i);break}}delete i["type"]});return t};var ge=function(e,t,i,o,a,n){TBUtilities.Log("YouTubeActions.js|deleteAllEndCardElementsWithUrl");var r="https://www.youtube.com/endscreen_ajax?v="+e.videoId+"&encrypted_video_id="+e.videoId+"&action_load=1";TBExtension.Get(r,function(r,s,l){try{if(r){try{var d=l.for_editor.elements.length;var u=[];var c=o.replace(/^http:\/\//i,"https://");var p=o.replace(/^https:\/\//i,"http://");for(var b=0;b<d;b++){var y="";var h=l.for_editor.elements[b];switch(h.type){case"CHANNEL":{y=h.targetUrl;break}case"WEBSITE":{y=h.targetUrl;break}case"VIDEO":{switch(h.videoType){case"VIDEO_TYPE_RECENT_UPLOAD":{break}case"VIDEO_TYPE_FIXED":{y=h.targetUrl;break}case"VIDEO_TYPE_BEST_FOR_VIEWER":{break}}break}case"PLAYLIST":{y=h.targetUrl;break}}if(y!=""){if(a===true&&(y.toLowerCase().trim().indexOf(c.toLowerCase().trim())>=0||y.toLowerCase().trim().indexOf(p.toLowerCase().trim())>=0)||!a&&(y.toLowerCase().trim()==p.toLowerCase().trim()||y.toLowerCase().trim()==c.toLowerCase().trim())){u.push(h)}}}jQuery.each(u,function(e,t){var i=jQuery.inArray(t,l.for_editor.elements);if(i!==-1){l.for_editor.elements.splice(i,1)}});if(u.length>0){var f=fe(l.for_editor.elements);var m={action_save:1,encrypted_video_id:e.videoId,impressionUrls:[],isNonStandardAspectRatio:"False",minStartMs:l.for_editor.minStartMs,session_token:i,skip:"False",startMs:l.for_editor.startMs,status:200,v:e.videoId,elements:f};var g="https://www.youtube.com/endscreen_ajax?v="+e.videoId;TBExtension.Post(g,JSON.stringify(m),function(i,o,a){try{if(i){if(a["errors"]!=undefined&&a.errors.length>=1){var r=a.errors[0];n(false,e.videoId,t,a,r);return}if(a["elements"]!=undefined&&a.for_editor.elements.length!=f.length){var r="";n(false,e.videoId,t,a,r);return}else{n(true,e.videoId,t,a,"");return}}else{TBUtilities.LogFailedWebRequest({Location:"YouTubeActions.js|deleteAllEndCardElementsWithUrl",Data:o,Response:a});n(false,e.videoId,t,a,"Error updating elements")}}catch(i){TBUtilities.LogError({Exception:i,Location:"YouTubeActions.js|deleteAllEndCardElementsWithUrl"});n(false,e.videoId,t,a,"Error updating elements")}},null,{dataType:"json",contentType:"application/json",cache:false})}else{n(true,e.videoId,t)}}catch(i){TBUtilities.Log(i);n(false,e.videoId,t)}}else{TBUtilities.LogFailedWebRequest({Location:"YouTubeActions.js|deleteAllEndCardElementsWithUrl",Data:s,Response:l});n(false,e.videoId)}}catch(t){TBUtilities.LogError({Exception:t,Location:"YouTubeActions.js|deleteAllEndCardElementsWithUrl"});n(false,e.videoId)}},null,{dataType:"json"})};var ve=function(e,t,i,o){TBUtilities.Log("TubeBuddyYouTubeActions - deleteAllEndCardElements");var a={action_save:1,encrypted_video_id:e.videoId,impressionUrls:[],isNonStandardAspectRatio:"False",minStartMs:t.destVideoMilliseconds-2e4,session_token:i,skip:"False",startMs:t.destVideoMilliseconds-2e4,v:e.videoId,elements:[]};var n="https://www.youtube.com/endscreen_ajax?v="+e.videoId;TBExtension.Post(n,JSON.stringify(a),function(i,a,n){try{if(i){if(n.for_editor.elements.length!=0){var r="Error deleting endscreen elements";o(false,e,t,n,r)}else{o(true,e,t,n)}}else{TBUtilities.LogFailedWebRequest({Location:"YouTubeActions.js|deleteAllEndCardElements",Data:a,Response:n});o(false,e,t,n)}}catch(i){TBUtilities.LogError({Exception:i,Location:"YouTubeActions.js|deleteAllEndCardElements"});o(false,e,t,n)}},null,{contentType:"application/json",dataType:"json",cache:false})};var Te=function(e,t,i,o,a){TBUtilities.Log("TubeBuddyYouTubeActions - addEndCardElement");var n=new FormData;n.append("id","");n.append("type",t);n.append("encrypted_video_id",e);n.append("start_ms",i);n.append("video_type",showWarnings);n.append("video_item_id",videoItemId);n.append("video_url",videoUrl);n.append("action_create_video",actionCreateVideo);n.append("session_token",o);var r="https://www.youtube.com/endscreen_ajax?v="+e;TBExtension.Post(r,n,function(t,i,o){try{if(t){a(true,e,o)}else{TBUtilities.LogFailedWebRequest({Location:"YouTubeActions.js|addEndCardElement",Data:i,Response:o});a(false,e,o)}}catch(t){TBUtilities.LogError({Exception:t,Location:"YouTubeActions.js|addEndCardElement"});a(false,e,o)}},null,{cache:false,contentType:undefined,dataType:null})};var we=function(e,t,i,o){TBUtilities.Log("YouTubeActions.js|addWebsiteElementUpload");var a=new FormData;a.append("id","");a.append("type","associated");a.append("encrypted_video_id",e);a.append("endscreen",'{"skip":false,"startMs":'+t.startMs+',"impressionUrls":["https://www.youtube.com/player_204?id=endscreen&v='+e+'&event=iv&a-type=500&iv-event=2"],"minStartMs":'+t.startMs+',"elements":[],"isNonStandardAspectRatio":false,"trackingParams":""}');a.append("end_ms",0);a.append("start_ms",t.startMs);a.append("image_url","");a.append("target_url",t.targetUrl);a.append("title",t.title);a.append("cta",3);a.append("imagefile",t.imagefile);a.append("action_create_associated",1);var n="https://www.youtube.com/endscreen_ajax?v="+e;TBExtension.Post(n,a,function(e,i,a){try{TBUtilities.Log("YouTubeActions.js|addWebsiteElementUpload success = "+e);if(e){try{var n=jQuery.parseHTML(DOMPurify.sanitize(a,DOMPurifyConfig));TBUtilities.Log("YouTubeActions.js|addWebsiteElementUpload html = "+n);var r={};try{r=jQuery.parseJSON(n[4].innerHTML)}catch(e){TBUtilities.LogError({Exception:e,Location:"YouTubeActions.js|addWebsiteElementUpload method 1 fail"});try{r=jQuery.parseJSON(n[2].innerHTML)}catch(e){TBUtilities.LogError({Exception:e,Location:"YouTubeActions.js|addWebsiteElementUpload method 2 fail"});r=jQuery.parseJSON(n[5].innerHTML)}}var s=r.for_editor.elements["0"].uploadedImage;t.uploadedImage=s;o(t)}catch(e){TBUtilities.LogError({Exception:e,Location:"YouTubeActions.js|addWebsiteElementUpload method 3 fail"});t.uploadedImage=null;o(t)}}else{TBUtilities.LogFailedWebRequest({Location:loggingLocation,Data:i,Response:a});o()}}catch(e){TBUtilities.LogError({Exception:e,Location:loggingLocation});o()}},null,{timeout:28e4,cache:false,contentType:undefined,dataType:null,processData:false})};var je=function(e,t,i){TBUtilities.Log("TubeBuddyYouTubeActions - unpublishAnnotations");var o=new FormData;o.append("action_unpublish_annotations","1");o.append("session_token",t);var a="https://www.youtube.com/endscreen_ajax?v="+e+"&encrypted_video_id="+e;TBExtension.Post(a,o,function(t,o,a){try{if(t){i(true,e,a)}else{TBUtilities.LogFailedWebRequest({Location:"YouTubeActions.js|unpublishAnnotations",Data:o,Response:a});i(false,e,a)}}catch(t){TBUtilities.LogError({Exception:t,Location:"YouTubeActions.js|unpublishAnnotations"});i(false,e,a)}},null,{dataType:null,contentType:undefined,cache:false})};var Qe=function(e,t){TBUtilities.Log("TubeBuddyYouTubeActions - getCardList");var i="https://www.youtube.com/cards_ajax?v="+e+"&action_list=1";TBUtilities.Log(i);TBExtension.Get(i,function(e,i,o){try{if(e){t(o)}else{TBUtilities.LogFailedWebRequest({Location:"YouTubeActions.js|getCardList",Data:i,Response:o});t(null)}}catch(e){TBUtilities.LogError({Exception:e,Location:"YouTubeActions.js|getCardList"});t(null)}},null,{dataType:"json"})};var xe=function(e,t){TBUtilities.Log("TubeBuddyYouTubeActions - getEndScreenList");var i="https://www.youtube.com/endscreen_ajax?v="+e+"&encrypted_video_id="+e+"&action_load=1";TBUtilities.Log(i);TBExtension.Get(i,function(e,i,o){try{if(e){t(o)}else{TBUtilities.LogFailedWebRequest({Location:"YouTubeActions.js|getEndScreenList",Data:i,Response:o});t(null)}}catch(e){TBUtilities.LogError({Exception:e,Location:"YouTubeActions.js|getEndScreenList"});t(null)}},null,{dataType:"json"})};var Be=function(e,t,i,o,a,n){TBUtilities.Log("TubeBuddyYouTubeActions - deleteAllCards");r=i;d=0;u=0;p=0;c=0;s={url:o,text:n,videoId:e};var l="https://www.youtube.com/cards_ajax?v="+e+"&action_list=1";TBUtilities.Log("getting all cards from url = "+l);TBExtension.Get(l,function(i,r,s){try{if(i){d=s.feature_templates.length;TBUtilities.Log("card count = "+d);if(d==0){Ve(true,e)}else{var l=0;jQuery.each(s.feature_templates,function(i,r){l++;TBUtilities.Log("CARD DETAILS");TBUtilities.Log(r);if(o){var s=o.replace(/^http:\/\//i,"https://");var d=o.replace(/^https:\/\//i,"http://");var u=r.target_url;if(!u)u=r.channel_url;if(!u)u="";if(a===true&&(u.toLowerCase().trim().indexOf(s.toLowerCase().trim())>=0||u.toLowerCase().trim().indexOf(d.toLowerCase().trim())>=0)||!a&&(u.toLowerCase().trim()==d.toLowerCase().trim()||u.toLowerCase().trim()==s.toLowerCase().trim())){let i=TubeBuddyCards.CardDeleteDelay()*l;setTimeout(function(){TubeBuddyYouTubeActions.DeleteCard(e,r.key,r.type,r.start_ms,"False",e,"","",t,TubeBuddyYouTubeActions.BulkCardDeleted)},i)}else{Ve(true,e,r.key)}}else if(n){var c=r.title;var p=r.teaser_text;TBUtilities.Log("Card Title: "+c.toLowerCase().trim());TBUtilities.Log("text: "+n.toLowerCase().trim());TBUtilities.Log("includePartialMatches: "+a);TBUtilities.Log("Title Contains: "+(a===true&&c.toLowerCase().trim().indexOf(n.toLowerCase().trim())>=0)||!a&&c.toLowerCase().trim()==n.toLowerCase().trim());TBUtilities.Log("Teaser Text Contains: "+(a===true&&p.toLowerCase().trim().indexOf(n.toLowerCase().trim())>=0)||!a&&p.toLowerCase().trim()==n.toLowerCase().trim());if(a===true&&c.toLowerCase().trim().indexOf(n.toLowerCase().trim())>=0||!a&&c.toLowerCase().trim()==n.toLowerCase().trim()||(a===true&&p.toLowerCase().trim().indexOf(n.toLowerCase().trim())>=0||!a&&p.toLowerCase().trim()==n.toLowerCase().trim())){TBUtilities.Log("Text Match, Delete. ");let i=TubeBuddyCards.CardDeleteDelay()*l;setTimeout(function(){TubeBuddyYouTubeActions.DeleteCard(e,r.key,r.type,r.start_ms,"False",e,"","",t,TubeBuddyYouTubeActions.BulkCardDeleted)},i)}else{Ve(true,e,r.key)}}else{let i=TubeBuddyCards.CardDeleteDelay()*l;setTimeout(function(){TubeBuddyYouTubeActions.DeleteCard(e,r.key,r.type,r.start_ms,"False",e,"","",t,TubeBuddyYouTubeActions.BulkCardDeleted)},i)}})}}else{TBUtilities.LogFailedWebRequest({Location:"YouTubeActions.js|deleteAllCards",Data:r,Response:s});Ve(false,e)}}catch(t){TBUtilities.LogError({Exception:t,Location:"YouTubeActions.js|deleteAllCards"});Ve(false,e)}},null,{dataType:"json"})};var ke=function(e,t,i,o,a,n,r,s,l,d){TBUtilities.Log("YouTubeActions.js|deleteCard");var u=new FormData;u.append("key",t);u.append("type",i);u.append("start_ms",o);u.append("show_warnings",a);u.append("video_item_id",n);u.append("video_url",r);u.append("start_time",s);u.append("session_token",l);if(!g[t]){g[t]=1}else{let e=g[t];e++;g[t]=e}var c="https://www.youtube.com/cards_ajax?v="+e+"&action_delete=1";TBExtension.Post(c,u,function(u,c,p){try{if(u){d(true,e,t)}else{let u=g[t];if(u&&u<=3){ke(e,t,i,o,a,n,r,s,l,d)}else{if(u){delete g[t]}TBUtilities.LogFailedWebRequest({Location:"YouTubeActions.js|deleteCard",Data:c,Response:p});d(false,e,t)}}}catch(i){TBUtilities.LogError({Exception:i,Location:"YouTubeActions.js|deleteCard"});d(false,e,t)}},null,{contentType:undefined,dataType:null,cache:false})};var Le=function(e,t){TBUtilities.Log("YouTubeActions.js|getVideoTags - "+e);var i="https://www.youtube.com/watch?v="+e;TBExtension.Get(i,function(i,o,a){try{if(i){var n=[];if(a.indexOf('"keywords":"')>0){var r=a.indexOf('"keywords":"')+'"keywords":"'.length;var s=a.indexOf('"',r);var l=a.substring(r,s);jQuery.each(l.split(","),function(e,t){if(t!=""){var i=Ae(t);if(i){n.push(i)}}})}else if(a.indexOf('","keywords":[')>0){var r=a.indexOf('","keywords":[')+'","keywords":['.length;var s=a.indexOf("],",r);var l=a.substring(r,s-1);jQuery.each(l.split(","),function(e,t){if(t!=""){var i=Ae(t);if(i){n.push(i)}}})}else if(a.indexOf('true,"keywords":[')>0){var r=a.indexOf('true,"keywords":[')+'true,"keywords":['.length;var s=a.indexOf("],",r);var l=a.substring(r,s-1);jQuery.each(l.split(","),function(e,t){if(t!=""){var i=Ae(t);if(i){n.push(i)}}})}if(n.length==0&&a.indexOf('window["ytInitialPlayerResponse"] = ')!=-1){var d=TBUtilities.ParsePlayerResponseFromHtml(a);if(d.videoDetails.keywords&&d.videoDetails.keywords.length>0){n=d.videoDetails.keywords}}else if(n.length==0){TBUtilities.Log("YouTubeActions.js|getVideoTags no tags found for video = "+e);try{var u=a.indexOf('<meta property="og:video:tag" content="');var c=a.lastIndexOf('<meta property="og:video:tag" content="');if(u!=-1&&c!=-1){var p=a.indexOf('">',c);var b=a.substring(u,p+1);b=b.replace(m,"");var y=jQuery(b).filter('meta[property="og:video:tag"]');jQuery.each(y,function(e,t){var i=jQuery(t).attr("content");if(i&&i!=""){var o=Ae(i);if(o){n.push(o)}}})}}catch(e){TBUtilities.Log(e)}}t(n)}else{TBUtilities.LogFailedWebRequest({Location:"YouTubeActions.js|getVideoTags",Data:o,Response:a});t([])}}catch(e){TBUtilities.LogError({Exception:e,Location:"YouTubeActions.js|getVideoTags"});t([])}})};var Ue=function(e,t){TBUtilities.Log("YouTubeActions.js|getVideoInfo "+e);var i="https://www.youtube.com/watch?v="+e;TBExtension.Get(i,function(i,o,a){try{if(i){var n={tags:[],channelid:null,channelname:null,channelsubscribers:null,title:null,description:null,views:null,likes:null,dislikes:null,publishDate:null};try{if(a.indexOf('"keywords":"')>0){var r=a.indexOf('"keywords":"')+'"keywords":"'.length;var s=a.indexOf('"',r);var l=a.substring(r,s);jQuery.each(l.split(","),function(e,t){if(t!==""){var i=Ae(t);if(i){n.tags.push(i)}}})}else if(a.indexOf('","keywords":[')>0){var r=a.indexOf('","keywords":[')+'","keywords":['.length;var s=a.indexOf("]",r);var l=a.substring(r,s);jQuery.each(l.split(","),function(e,t){if(t!=""){var i=Ae(t);if(i){n.tags.push(i)}}})}if(n.tags.length==0&&a.indexOf('window["ytInitialPlayerResponse"] = ')!=-1){var d=TBUtilities.ParsePlayerResponseFromHtml(a);if(d.videoDetails.keywords&&d.videoDetails.keywords.length>0){jQuery.each(d.videoDetails.keywords,function(e,t){if(t&&t!=""){var i=Ae(t);if(i){n.tags.push(i)}}})}}if(n.tags.length==0){TBUtilities.Log("YouTubeActions.js|getVideoTags no tags found for video = "+e);var u=DOMPurify.sanitize(a,DOMPurifyConfig);var c=jQuery(u).filter('meta[property="og:video:tag"]');jQuery.each(c,function(e,t){var i=jQuery(t).attr("content");if(i&&i!=""){var o=Ae(i);if(o){n.tags.push(o)}}})}var p=TBUtilities.ParseResponseContextFromHtml(a);var b=0;var y=0;for(var h=0;h<p.contents.twoColumnWatchNextResults.results.results.contents.length;h++){if(p.contents.twoColumnWatchNextResults.results.results.contents[h].videoSecondaryInfoRenderer){b=h;break}}for(var h=0;h<p.contents.twoColumnWatchNextResults.results.results.contents.length;h++){if(p.contents.twoColumnWatchNextResults.results.results.contents[h].videoPrimaryInfoRenderer){y=h;break}}n.channelsubscribers=0;if(p.contents.twoColumnWatchNextResults.results.results.contents[y].videoPrimaryInfoRenderer.title.runs){n.title=p.contents.twoColumnWatchNextResults.results.results.contents[y].videoPrimaryInfoRenderer.title.runs[0].text}if(p.contents.twoColumnWatchNextResults.results.results.contents[b].videoSecondaryInfoRenderer.description&&p.contents.twoColumnWatchNextResults.results.results.contents[b].videoSecondaryInfoRenderer.description.simpleText){n.description=p.contents.twoColumnWatchNextResults.results.results.contents[b].videoSecondaryInfoRenderer.description.simpleText}else if(p.contents.twoColumnWatchNextResults.results.results.contents[b].videoSecondaryInfoRenderer.description&&p.contents.twoColumnWatchNextResults.results.results.contents[b].videoSecondaryInfoRenderer.description.runs&&p.contents.twoColumnWatchNextResults.results.results.contents[b].videoSecondaryInfoRenderer.description.runs.length>0){var f="";try{jQuery.each(p.contents.twoColumnWatchNextResults.results.results.contents[b].videoSecondaryInfoRenderer.description.runs,function(e,t){f+=t.text})}catch(e){TBUtilities.Log(e)}n.description=f}else{n.description=""}var m=p.contents.twoColumnWatchNextResults.results.results.contents[y].videoPrimaryInfoRenderer.viewCount.videoViewCountRenderer.viewCount.simpleText;v=null;if(m)v=m.match(/\d/g);if(v==null){v=0}else{v=v.join("")}n.views=parseInt(v);var g=p.contents.twoColumnWatchNextResults.results.results.contents[y].videoPrimaryInfoRenderer.videoActions.menuRenderer.topLevelButtons["0"].toggleButtonRenderer.accessibility.label;var v=g.match(/\d/g);if(v==null){v=0}else{v=v.join("")}n.likes=parseInt(v);var T=p.contents.twoColumnWatchNextResults.results.results.contents[y].videoPrimaryInfoRenderer.videoActions.menuRenderer.topLevelButtons[1].toggleButtonRenderer.accessibility.label;var v=T.match(/\d/g);if(v==null){v=0}else{v=v.join("")}n.dislikes=parseInt(v);if(p.contents.twoColumnWatchNextResults.results.results.contents[b].videoSecondaryInfoRenderer.owner.videoOwnerRenderer.navigationEndpoint.browseEndpoint.browseId){n.channelid=p.contents.twoColumnWatchNextResults.results.results.contents[b].videoSecondaryInfoRenderer.owner.videoOwnerRenderer.navigationEndpoint.browseEndpoint.browseId}if(p.contents.twoColumnWatchNextResults.results.results.contents[b].videoSecondaryInfoRenderer.owner.videoOwnerRenderer.title&&p.contents.twoColumnWatchNextResults.results.results.contents[b].videoSecondaryInfoRenderer.owner.videoOwnerRenderer.title.runs.length>0){n.channelname=p.contents.twoColumnWatchNextResults.results.results.contents[b].videoSecondaryInfoRenderer.owner.videoOwnerRenderer.title.runs[0].text}try{var w=p.contents.twoColumnWatchNextResults.results.results.contents[y].videoPrimaryInfoRenderer.dateText.simpleText;if(w&&w.indexOf("Published on ")!==-1){var j=Ce(w," ",2);var Q=w.substring(j,w.length);var x=new Date(Q.trim());n.publishDate=x}}catch(e){console.log(e)}}catch(e){TBUtilities.LogError(e)}finally{t(n)}}else{TBUtilities.Log("YouTubeActions.js|getVideoInfo - error getting video info for video id "+e);t(null)}}catch(e){TBUtilities.LogError({Exception:e,Location:"YouTubeActions.js|getVideoInfo"});t(null)}})};var Ce=function(e,t,i){return e.split(t,i).join(t).length};var Ae=function(e){var t=e.replace(/["']/g,"");t=t.replace("\\u0027","");t=t.replace("\\u0026","&");t=t.replace("&","&");t=t.replace(/\\\//g,"/");if(t){return t.toLowerCase()}else{return null}};var Se=function(e,t){TBUtilities.Log("YouTubeActions.js|getChannelInfoFromPage");TBUtilities.Log(e);TBExtension.Get(e,function(i,o,a){try{if(i){var n={ChannelId:null,Tags:null,Title:null};try{var r=TBGlobal.GetYouTubeUI();if(r=="default"&&a.indexOf('window["ytInitialData"]')>-1)r="material";switch(r){case"studio":case"material":{n.Title=jQuery("#channel-title").text();var s=TBUtilities.ParseResponseContextFromHtml(a);try{if(s.metadata&&s.header){n.Tags=s.metadata.channelMetadataRenderer.keywords;n.ChannelId=s.header.c4TabbedHeaderRenderer.channelId}else if(s.contents.twoColumnWatchNextResults){n.ChannelId=s.contents.twoColumnWatchNextResults.results.results.contents[1].videoSecondaryInfoRenderer.subscribeButton.subscribeButtonRenderer.channelId}else{throw"Unable to find channel id"}}catch(e){try{var l=a.indexOf('window["ytInitialData"] = ');l=l+26;var d=a.substring(l,a.length);var u=d.indexOf("};")+1;var d=d.substring(0,u);var s=jQuery.parseJSON(d);n.ChannelId=s.metadata.channelMetadataRenderer.externalId}catch(e){}}break}case"default":{var c=jQuery.parseHTML(DOMPurify.sanitize(a,DOMPurifyConfig));n.ChannelId=jQuery(c).find("meta[itemprop=channelId]").first().attr("content");if(!n.ChannelId){try{TBUtilities.Log("TubeBuddySocialBlade _currentChannelId is not found, second attempt");var p=e.substr(e.lastIndexOf("/")+1);if(p.length==24){_currentChannelId=p}}catch(e){n.ChannelId=null}}break}}}catch(e){n.ChannelId=null}t(n)}else{TBUtilities.LogFailedWebRequest({Location:"YouTubeActions.js|getChannelInfoFromPage",Data:o,Response:a});t(null)}}catch(e){TBUtilities.LogError({Exception:e,Location:"YouTubeActions.js|getChannelInfoFromPage"});t(null)}},null,{cache:false})};var Ee=function(e){var t=e;var i=["mil","tis.","mln.",".","k"];var o=["mio.","mil.","","m"];for(var a=0;a<i.length;a++){if((e.indexOf(i[a])>=0||e.toLowerCase().indexOf(i[a])>=0)&&e.toLowerCase().indexOf("mil.")==-1){e=TBUtilities.ReplaceAll(e.toLowerCase(),i[a],"");e=TBUtilities.ReplaceAll(e.toLowerCase(),",",".");return 1e3*Number(e)}}for(var a=0;a<o.length;a++){if(e.indexOf(o[a])>=0||e.toLowerCase().indexOf(o[a])>=0){e=TBUtilities.ReplaceAll(e.toLowerCase(),o[a],"");e=TBUtilities.ReplaceAll(e.toLowerCase(),",",".");return 1e6*Number(e)}}e=TBUtilities.ReplaceAll(e.toLowerCase(),".","");e=TBUtilities.ReplaceAll(e.toLowerCase(),",","");return num};var Ie=function(e,t,i){var o={success:true,channelViews:null,channelViewsFormatted:null,channelPublishDate:null,subscribers:null,subscribersFormatted:null,socialProfiles:[],channelId:null,subscribersDisplay:""};var a=null;if(typeof e=="undefined"||e==null){o.success=false;t(o);return}e=e.replace(/^http:\/\//i,"https://");var n=e.substr(e.lastIndexOf("/")+1);if(n&&n.length==24&&typeof i==="undefined"){TBUtilities.Log("getChannelInfoFromAboutPage - channelid = "+n);a=n;o=b[a];if(o){TBUtilities.Log("getChannelInfoFromAboutPage - cached channelInfo found for channel id = "+a);t(o);return}}var r=e+"/about";TBExtension.Get(r,function(e,i,o){try{if(!e){TBUtilities.LogFailedWebRequest({Location:"YouTubeActions.js|getChannelInfoFromAboutPage",Data:i,Response:o})}var a={success:true,channelViews:null,channelViewsFormatted:null,channelPublishDate:null,subscribers:null,subscribersFormatted:null,socialProfiles:[],channelId:null,subscribersFromHeader:null,subscribersFromHeaderFormatted:null,subscribersDisplay:""};var n="";try{var r=TBGlobal.GetYouTubeUI();if(o.indexOf('window["ytInitialData"] = ')>-1){r="material"}if(o.indexOf('"canonical"')>10){var s=o.indexOf('"canonical"');s=o.indexOf('href="https://www.youtube.com/channel/',s)+'href="https://www.youtube.com/channel/'.length;a.channelId=o.substring(s,s+24);n=a.channelId}switch(r){case"studio":case"material":{a.success=false;TBUtilities.Log("PHIL ytUI");var l=TBUtilities.ParseResponseContextFromHtml(o);var d=null;jQuery.each(l.contents.twoColumnBrowseResultsRenderer.tabs,function(e,t){if(t.tabRenderer&&t.tabRenderer.endpoint.commandMetadata.webCommandMetadata.url.indexOf("about")!=-1){d=t;return true}});TBUtilities.Log("PHIL b4Views");var u="0";try{if(d.tabRenderer.content.sectionListRenderer.contents["0"].itemSectionRenderer.contents["0"].channelAboutFullMetadataRenderer.viewCountText.runs){u=d.tabRenderer.content.sectionListRenderer.contents["0"].itemSectionRenderer.contents["0"].channelAboutFullMetadataRenderer.viewCountText.runs["0"].text}else if(d.tabRenderer.content.sectionListRenderer.contents["0"].itemSectionRenderer.contents["0"].channelAboutFullMetadataRenderer.viewCountText.simpleText){u=d.tabRenderer.content.sectionListRenderer.contents["0"].itemSectionRenderer.contents["0"].channelAboutFullMetadataRenderer.viewCountText.simpleText}var c=u.match(/\d/g);c=c.join("");a.channelViews=c;a.channelViewsFormatted=TBUtilities.FormatNumberAbbreviated(a.channelViews)}catch{a.channelViews=0;a.channelViewsFormatted="NA"}var p="";if(d.tabRenderer.content.sectionListRenderer.contents["0"].itemSectionRenderer.contents["0"].channelAboutFullMetadataRenderer.joinedDateText.runs){p=d.tabRenderer.content.sectionListRenderer.contents["0"].itemSectionRenderer.contents["0"].channelAboutFullMetadataRenderer.joinedDateText.runs["1"].text}else if(d.tabRenderer.content.sectionListRenderer.contents["0"].itemSectionRenderer.contents["0"].channelAboutFullMetadataRenderer.joinedDateText.simpleText){p=d.tabRenderer.content.sectionListRenderer.contents["0"].itemSectionRenderer.contents["0"].channelAboutFullMetadataRenderer.joinedDateText.simpleText}try{a.channelPublishDate=moment(p.trim(),"MMM DD, YYYY")}catch(e){TBUtilities.Log(e)}var y="";try{if(l.header.c4TabbedHeaderRenderer.subscribeButton.subscribeButtonRenderer.subscriberCountText!=undefined){y=l.header.c4TabbedHeaderRenderer.subscribeButton.subscribeButtonRenderer.subscriberCountText.simpleText}else if(l.header.c4TabbedHeaderRenderer.subscriberCountText.simpleText!=undefined){y=l.header.c4TabbedHeaderRenderer.subscriberCountText.simpleText.split(" ")[0]}}catch{try{y=l.header.c4TabbedHeaderRenderer.subscriberCountText.runs[0].text;if(y.indexOf(" ")>0){y=y.substring(0,y.indexOf(" "))}}catch{}}a.subscribersDisplay=y;try{y=Ee(y);var h=y;a.subscribers=h;a.subscribersFormatted=TBUtilities.FormatNumberAbbreviated(a.subscribers);a.subscribersFromHeader=y;a.subscribersFromHeaderFormatted=TBUtilities.FormatNumberAbbreviated(a.subscribersFromHeader)}catch{a.subscribers=y;a.subscribersFormatted=y;a.subscribersFromHeader=y;a.subscribersFromHeaderFormatted=y}a.success=true;if(d.tabRenderer.content.sectionListRenderer.contents["0"].itemSectionRenderer.contents["0"].channelAboutFullMetadataRenderer.primaryLinks){jQuery.each(d.tabRenderer.content.sectionListRenderer.contents["0"].itemSectionRenderer.contents["0"].channelAboutFullMetadataRenderer.primaryLinks,function(e,t){try{var i={image:t.icon.thumbnails["0"].url,url:t.navigationEndpoint.urlEndpoint.url,title:t.title.simpleText};a.socialProfiles.push(i)}catch(e){console.log(e)}})}try{if(l.header.c4TabbedHeaderRenderer.subscriberCountText&&l.header.c4TabbedHeaderRenderer.subscriberCountText.simpleText){var f=l.header.c4TabbedHeaderRenderer.subscriberCountText.simpleText;var m=f.match(/\d/g);m=m.join("");a.subscribersFromHeader=parseInt(m);a.subscribersFromHeaderFormatted=TBUtilities.FormatNumberAbbreviated(a.subscribersFromHeader)}else if(l.header.c4TabbedHeaderRenderer.subscriberCountText&&l.header.c4TabbedHeaderRenderer.subscriberCountText.runs){var f=l.header.c4TabbedHeaderRenderer.subscriberCountText.runs["0"].text;var m=f.match(/\d/g);m=m.join("");a.subscribersFromHeader=parseInt(m);a.subscribersFromHeaderFormatted=TBUtilities.FormatNumberAbbreviated(a.subscribersFromHeader)}}catch(e){console.log(e)}TBUtilities.Log("Final");TBUtilities.Log(a);break}case"default":{var g=jQuery.parseHTML(DOMPurify.sanitize(o,DOMPurifyConfig));a.socialProfiles=[];jQuery(g).find(".about-channel-link.yt-uix-redirect-link").each(function(e,t){try{var i={image:jQuery(this).find("img:first").attr("src"),url:jQuery(this).attr("href"),title:jQuery(this).attr("title")};a.socialProfiles.push(i)}catch(e){console.log(e)}});var v=jQuery(g).find(".about-stat").length;if(v==2){a.subscribers=null;a.subscribersFormatted=null}jQuery(g).find(".about-stat").each(function(e){var t=jQuery(this).html();var i=t.match(/\d/g);i=i.join("");if(v==3){if(e==0){a.subscribers=i;a.subscribersFormatted=TBUtilities.FormatNumberAbbreviated(a.subscribers)}else if(e==1){a.channelViews=i;a.channelViewsFormatted=TBUtilities.FormatNumberAbbreviated(a.channelViews)}else if(e==2){var o=t.indexOf(" ");var n=t.substring(o,t.length);a.channelPublishDate=moment(n.trim(),"MMM DD, YYYY")}}else if(v==2){if(e==0){a.channelViews=i;a.channelViewsFormatted=TBUtilities.FormatNumberAbbreviated(a.channelViews)}else if(e==1){var o=t.indexOf(" ");var n=t.substring(o,t.length);a.channelPublishDate=moment(n.trim(),"MMM DD, YYYY")}}});a.success=true;break}}}catch(e){a={success:true,channelViews:null,channelViewsFormatted:null,channelPublishDate:null,subscribers:null,subscribersFormatted:null,socialProfiles:[],channelId:n};a.success=false;TBUtilities.Log(e)}if(a.success==true){b[n]=a}t(a)}catch(e){TBUtilities.LogError({Exception:e,Location:"YouTubeActions.js|getChannelInfoFromAboutPage"})}},null,{cache:false,contentType:false})};var Ge=function(e,t,i){TBUtilities.Log("YouTubeActions.js|DeleteAnnotations");var o="https://www.youtube.com/my_videos_annotate?feature=vm&v="+e;TBExtension.Get(o,function(o,a,n){try{if(o){var r="";var s=n.match(/"auth_token": "(\S+)"/);if(s!==null)r=s[1];else{var l=n.indexOf('"auth_token":"')+'"auth_token":"'.length;var d=n.indexOf('"',l);r=n.substring(l,d)}var u='<?xml version="1.0" encoding="UTF-8" ?><document>';u+='<requestHeader video_id="'+e+'"/>';u+='<authenticationHeader video_id="'+e+'" '+'auth_token="'+r+'"/>';u+="<deletedItems>";jQuery.each(t,function(e,t){u+='<deletedItem id="'+t.id+'" author="'+t.author+'" />'});u+="</deletedItems>";u+="</document>";var c="https://www.youtube.com/annotations_auth/update2";TBExtension.Post(c,u,function(e,t,o){try{if(e){var a="https://www.youtube.com/annotations_auth/publish2";TBExtension.Post(a,u,function(e,t,o){try{if(e){i()}else{TBUtilities.LogFailedWebRequest({Location:"YouTubeActions.js|DeleteAnnotations",Data:t,Response:o});i()}}catch(e){TBUtilities.LogError({Exception:e,Location:"YouTubeActions.js|DeleteAnnotations"});i()}},null,{dataType:null,contentType:undefined})}else{TBUtilities.LogFailedWebRequest({Location:"YouTubeActions.js|DeleteAnnotations",Data:t,Response:o});i()}}catch(e){TBUtilities.LogError({Exception:e,Location:"YouTubeActions.js|DeleteAnnotations"});i()}},null,{dataType:null,contentType:undefined,cache:false})}else{TBUtilities.LogFailedWebRequest({Location:"YouTubeActions.js|DeleteAnnotations",Data:a,Response:n});i([])}}catch(e){TBUtilities.LogError({Exception:e,Location:"YouTubeActions.js|DeleteAnnotations"});i([])}})};var Re=function(e,t){TBUtilities.Log("YouTubeActions.js|getChannelId");try{if(!e)return null;if(e.substring(0,2)=="UC"&&e.length=="UCvubOhuUIhYoYnRyXHtcygQ".length){t(e);return}if(e.indexOf("/channel/")>0){var i=e.substring(e.indexOf("/channel/")+"/channel/".length,e.indexOf("/channel/")+"/channel/".length+"UCvubOhuUIhYoYnRyXHtcygQ".length);t(i);return}TBUtilities.Log("getting "+e);var o=e;if(e.indexOf("youtube.com")==-1)o="https://www.youtube.com/user/"+e;TBExtension.Get(o,function(i,a,n){try{if(i){TBUtilities.Log("in done1");var r=n.indexOf('itemprop="channelId"');if(r<50)return null;r=n.indexOf('content="',r)+'content="'.length;var s=n.substring(r,r+"UCvubOhuUIhYoYnRyXHtcygQ".length);t(s);TBUtilities.Log("in done done1 "+s)}else{TBUtilities.LogFailedWebRequest({Location:"YouTubeActions.js|getChannelId",Data:a,Response:n});o="https://www.youtube.com/"+e;TBExtension.Get(o,function(e,i,o){try{if(e){TBUtilities.Log("in done2");var a=o.indexOf('itemprop="channelId"');if(a<50)return null;a=o.indexOf('content="',a)+'content="'.length;var n=o.substring(a,a+"UCvubOhuUIhYoYnRyXHtcygQ".length);t(n);TBUtilities.Log("in done done2 "+n)}else{TBUtilities.LogFailedWebRequest({Location:"YouTubeActions.js|getChannelId",Data:i,Response:o});t(null)}}catch(e){TBUtilities.LogError({Exception:e,Location:"YouTubeActions.js|getChannelId"});t(null)}})}}catch(e){TBUtilities.LogError({Exception:e,Location:"YouTubeActions.js|getChannelId"})}})}catch(e){return null}};var Pe=function(e,t,i,o){TBUtilities.Log("TubeBuddyYouTubeActions - processAnnotationData");var a=[];var n=0;var r="";jQuery(e).find("annotation").each(function(){r+="0";var e={};e.id=jQuery(this).attr("id");e.author=jQuery(this).attr("author");if(e.author==null)e.author="";e.index=n;n=n+1;e.type=jQuery(this).attr("type");e.style=jQuery(this).attr("style");e.log_data=jQuery(this).attr("log_data");e.logable=jQuery(this).attr("logable");e.text=jQuery(this).find("TEXT").text();e.ref=jQuery(this).find("condition").attr("ref");e.url=jQuery(this).find("url").attr("value");e.dockAtStart=false;e.dockAtEnd=false;if(e.url==null)e.url=jQuery(this).find("action").find("url").attr("value");r+="1";switch(e.style){case"anchored":e.display="Speech Bubble";break;case"popup":e.display="Note";break;case"title":e.display="Title";break;case"highlightText":case"highlighttext":e.display="Spotlight";break;case"label":e.display="Label";break;default:e.display="Spotlight Text";break}r+="[Display: "+e.display+"]";e.startTime=jQuery(this).find("movingRegion rectRegion:nth-child(1)").attr("t");if(!e.startTime){e.startTime=jQuery(this).find("movingRegion anchoredRegion:nth-child(1)").attr("t")}if(!e.startTime){e.startTime="never"}var o=[];var s="";var l=[];var d=0;var u=0;var c=0;if(e.startTime!="never"&&e.endTime!="0:00.000"){o=e.startTime.split(".");s=parseInt(o[1]);l=o[0].split(":");d=0;u=0;c=0;if(l.length==3){d=parseInt(l[0]);u=parseInt(l[1]);c=parseInt(l[2])}else{u=parseInt(l[0]);c=parseInt(l[1])}e.startTimeTimeSpan=new TimeSpan(s,c,u,d);e.startTimeTimeMiliseconds=e.startTimeTimeSpan.totalMilliseconds();e.dockAtStart=e.startTimeTimeMiliseconds<i*.15}e.endTime=jQuery(this).find("movingRegion rectRegion:nth-child(2)").attr("t");if(!e.endTime)e.endTime=jQuery(this).find("movingRegion anchoredRegion:nth-child(2)").attr("t");if(!e.endTime)e.endTime="never";var o=[];var s="";var l=[];var d=0;var u=0;var c=0;if(e.startTime!="never"&&e.endTime!="0:00.000"){o=e.startTime.split(".");s=parseInt(o[1]);l=o[0].split(":");d=0;u=0;c=0;if(l.length==3){d=parseInt(l[0]);u=parseInt(l[1]);c=parseInt(l[2])}else{u=parseInt(l[0]);c=parseInt(l[1])}}if(e.endTime!="never"&&e.endTime!="0:00.000"){o=e.endTime.split(".");s=parseInt(o[1]);l=o[0].split(":");d=0;u=0;c=0;if(l.length==3){d=parseInt(l[0]);u=parseInt(l[1]);c=parseInt(l[2])}else{u=parseInt(l[0]);c=parseInt(l[1])}e.endTimeTimeSpan=new TimeSpan(s,c,u,d);e.endTimeTimeMiliseconds=e.endTimeTimeSpan.totalMilliseconds();e.dockAtEnd=e.endTimeTimeMiliseconds>i*.85;e.distanceFromEnd=i-e.endTimeTimeMiliseconds;if(e.distanceFromEnd<0)e.distanceFromEnd=0}if(e.startTimeTimeMiliseconds!=null){if(e.endTimeTimeMiliseconds!=null)e.totalTimeMiliseconds=e.endTimeTimeMiliseconds-e.startTimeTimeMiliseconds;else e.totalTimeMiliseconds=i-e.startTimeTimeMiliseconds}else if(e.endTimeTimeMiliseconds!=null){e.totalTimeMiliseconds=e.endTimeTimeMiliseconds}e.fullXML=jQuery(this).html();e.fullXML=TBUtilities.ReplaceAll(e.fullXML,"highlightfontcolor","highlightFontColor");e.fullXML=TBUtilities.ReplaceAll(e.fullXML,"textsize","textSize");e.fullXML=TBUtilities.ReplaceAll(e.fullXML,"fgcolor","fgColor");e.fullXML=TBUtilities.ReplaceAll(e.fullXML,"borderalpha","borderAlpha");e.fullXML=TBUtilities.ReplaceAll(e.fullXML,"spacerelative","spaceRelative");e.fullXML=TBUtilities.ReplaceAll(e.fullXML,"bgalpha","bgAlpha");e.fullXML=TBUtilities.ReplaceAll(e.fullXML,"bgcolor","bgColor");e.fullXML=TBUtilities.ReplaceAll(e.fullXML,"anchoredregion","anchoredRegion");e.fullXML=TBUtilities.ReplaceAll(e.fullXML,"movingregion","movingRegion");e.fullXML=TBUtilities.ReplaceAll(e.fullXML,"rectregion","rectRegion");if(e.fullXML.indexOf('"></padding>')>0||e.fullXML.indexOf(" ></padding>")>0)e.fullXML=TBUtilities.ReplaceAll(e.fullXML,"></padding>","/>");if(e.fullXML.indexOf('"></appearance>')>0||e.fullXML.indexOf(" ></appearance>")>0)e.fullXML=TBUtilities.ReplaceAll(e.fullXML,"></appearance>","/>");e.fullXML=TBUtilities.ReplaceAll(e.fullXML,"</text>","</TEXT>");e.fullXML=TBUtilities.ReplaceAll(e.fullXML,"<text>","<TEXT>");e.fullXML=TBUtilities.ReplaceAll(e.fullXML,"></condition>","/>");if(e.fullXML.indexOf('"></appearance>')>0||e.fullXML.indexOf(" ></appearance>")>0)e.fullXML=TBUtilities.ReplaceAll(e.fullXML,"></appearance>","/>");e.fullXML=TBUtilities.ReplaceAll(e.fullXML,"></rectregion>","/>");e.fullXMLOriginal=e.fullXML;e.videoId=t;if(e.type!="branding"&&e.type!="promotion"&&e.type!="card"){a.push(e)}});o(a)};var De=function(e,t){TBUtilities.Log("YouTubeActions.js|getAnnotations");var i=9999;try{i=new timelord(e.contentDetails.duration).ticks()}catch(e){}var o="https://www.youtube.com/annotations_auth/read2?video_id="+e.id;TBExtension.Get(o,function(o,a,n){try{if(o){Pe(n,e.id,i,t)}else{TBUtilities.LogFailedWebRequest({Location:"YouTubeActions.js|getAnnotations",Data:a,Response:n});var r="https://www.youtube.com/annotations_invideo?features=1&legacy=1&video_id="+e.id;TBExtension.Get(r,function(o,a,n){try{if(o){Pe(n,e.id,i,t)}else{TBUtilities.LogFailedWebRequest({Location:"YouTubeActions.js|getAnnotations",Data:a,Response:n});t(null)}}catch(e){TBUtilities.LogError({Exception:e,Location:"YouTubeActions.js|getAnnotations"});t(null)}})}}catch(e){TBUtilities.LogError({Exception:e,Location:"YouTubeActions.js|getAnnotations"});t(null)}})};var Ve=function(e,t,i){TBUtilities.Log("TubeBuddyYouTubeActions - bulkCardDeleted");u++;if(e){c++}else{p++}TBUtilities.Log(u+", "+d+", "+p);if(u==d||d==0){if(p>0&&s.url==null&&s.text==null){TBUtilities.Log("bulkCardDeleted failed to delete, checking to see if there are any cards on video");var o="https://www.youtube.com/cards_ajax?v="+t+"&action_list=1";TBUtilities.Log("getting all cards from url = "+o);TBExtension.Get(o,function(e,i,o){try{if(e){if(o.feature_templates.length==0){TBUtilities.Log("bulkCardDeleted failed to delete all cards, 0 cards found, returning success");p=0}r(p==0,t)}else{TBUtilities.LogFailedWebRequest({Location:"YouTubeActions.js|get cards - delete recheck",Data:i,Response:o});r(p==0,t)}}catch(e){TBUtilities.LogError({Exception:e,Location:"YouTubeActions.js|get cards - delete recheck"});r(p==0,t)}},null,{dataType:"json"})}else{r(p==0,t)}}};var _e=function(e,t,i){TBUtilities.Log("TubeBuddyYouTubeActions - getVideoChannelId for video id = "+e);if(t){TBUtilities.Log("TubeBuddyYouTubeActions - html passed");var o=Me(t);TBUtilities.Log("TubeBuddyYouTubeActions - getVideoChannelId = "+o);i(o)}else{var a="https://www.youtube.com/watch?v="+e;TBExtension.Get(a,function(e,t,o){try{if(e){TBUtilities.Log("TubeBuddyYouTubeActions - getVideoChannelId ajax call done");var a=Me(o);TBUtilities.Log("TubeBuddyYouTubeActions - getVideoChannelId = "+a);i(a)}else{TBUtilities.LogFailedWebRequest({Location:"YouTubeActions.js|getVideoChannelId",Data:t,Response:o});i(null)}}catch(e){TBUtilities.LogError({Exception:e,Location:"YouTubeActions.js|getVideoChannelId"});i(null)}})}};var Me=function(e){var t=null;try{var i=TBGlobal.GetYouTubeUIFromHtml(e);switch(i){case"studio":case"material":{var o=e.indexOf('],"channelId"');var a=e.indexOf('"',o+13);var n=e.indexOf('"',a+1);t=e.substring(a+1,n);if(t.length!==24){TBUtilities.Log("TubeBuddyYouTubeActions - parseChannelIdFromHtml - first attempt failed");o=e.indexOf('"ucid"');a=e.indexOf('"',o+6);n=e.indexOf('"',a+1);t=e.substring(a+1,n)}if(t.length!==24){TBUtilities.Log("TubeBuddyYouTubeActions - parseChannelIdFromHtml - second attempt failed");var r='externalChannelId":"';o=e.indexOf(r);t=e.substring(o+r.length,o+r.length+24)}if(t.length!==24){t=null}TBUtilities.Log("TubeBuddyYouTubeActions - parseChannelIdFromHtml - "+t);break}case"default":{var s=jQuery.parseHTML(DOMPurify.sanitize(e,DOMPurifyConfig));t=jQuery(s).find("meta[itemprop=channelId]").attr("content");break}}}catch(e){TBUtilities.Log(e)}return t};var Oe=function(e,t){try{e=e.replace(/([#0-9]\u20E3)|[\xA9\xAE\u203C\u2047-\u2049\u2122\u2139\u3030\u303D\u3297\u3299][\uFE00-\uFEFF]?|[\u2190-\u21FF][\uFE00-\uFEFF]?|[\u2300-\u23FF][\uFE00-\uFEFF]?|[\u2460-\u24FF][\uFE00-\uFEFF]?|[\u25A0-\u25FF][\uFE00-\uFEFF]?|[\u2600-\u27BF][\uFE00-\uFEFF]?|[\u2900-\u297F][\uFE00-\uFEFF]?|[\u2B00-\u2BF0][\uFE00-\uFEFF]?|(?:\uD83C[\uDC00-\uDFFF]|\uD83D[\uDC00-\uDEFF])[\uFE00-\uFEFF]?/g,"");var i="https://www.youtube.com/results?search_query="+TBUtilities.GetUrlEncoded(e);TBExtension.Get(i,function(e,i,o){try{if(e){TBUtilities.Log("TubeBuddyYouTubeActions - getVideoSearchResults ajax call done");var a=TBGlobal.GetYouTubeUI();if(a==="default"&&o.indexOf('window["ytInitialData"]')>-1)a="material";var n=[];switch(a){case"studio":case"material":{var r=o.indexOf('window["ytInitialData"] =');if(r!==-1){var s=TBUtilities.ParseResponseContextFromHtml(o);var l=TBUtilities.GetVideoSearchCollectionIndex(s.contents.twoColumnSearchResultsRenderer.primaryContents.sectionListRenderer.contents);if(l!=null){jQuery.each(s.contents.twoColumnSearchResultsRenderer.primaryContents.sectionListRenderer.contents[l].itemSectionRenderer.contents,function(e,t){try{if(t.videoRenderer){var i={id:null,title:null,description:"",views:null,thumbnail:null,channelId:null,channelName:null,channelUrl:null};i.id=t.videoRenderer.videoId;i.channelId="";if(t.videoRenderer.longBylineText&&t.videoRenderer.longBylineText.runs&&t.videoRenderer.longBylineText.runs.length>0){try{i.channelId=t.videoRenderer.longBylineText.runs["0"].navigationEndpoint.browseEndpoint.browseId;i.channelName=t.videoRenderer.longBylineText.runs["0"].text;i.channelUrl="https://www.youtube.com/channel/"+i.channelId}catch(e){TBUtilities.LogError(e)}}i.thumbnail=t.videoRenderer.thumbnail.thumbnails[0].url;if(t.videoRenderer.title.simpleText){i.title=t.videoRenderer.title.simpleText}else{i.title=t.videoRenderer.title.runs[0].text}if(t.videoRenderer.descriptionSnippet&&t.videoRenderer.descriptionSnippet.runs){for(var o=0;o<t.videoRenderer.descriptionSnippet.runs.length;o++){i.description+=t.videoRenderer.descriptionSnippet.runs[o].text}}if(t.videoRenderer.viewCountText&&t.videoRenderer.viewCountText.simpleText){i.views=t.videoRenderer.viewCountText.simpleText}else{if(t.videoRenderer.viewCountText&&t.videoRenderer.viewCountText.runs){i.views=t.videoRenderer.viewCountText.runs[0].text}else{i.views=0}}if(i.id!=null){n.push(i)}}}catch(e){TBUtilities.LogError(e)}})}t(n)}break}case"default":{o=o.replace(/__ytRIL/g,"");o=TBUtilities.ReplaceAll(o,"window. &amp;&amp;","");var d=jQuery.parseHTML(DOMPurify.sanitize(o,DOMPurifyConfig));jQuery(".item-section",d).find("li > div").each(function(){try{var e=jQuery(this);if(jQuery(this).hasClass("spell-correction"))return;var t={id:null,title:null,description:"",views:null,thumbnail:null,channelId:null,channelName:null,channelUrl:null};jQuery(this).find("a").attr("target","_blank");jQuery(this).find(".yt-uix-menu-trigger").remove();t.channelId=jQuery(this).find(".yt-lockup-byline").find("a:first").attr("data-ytid");var i=jQuery(this).find("h3 > a:first");if(i!=null){var o=i.attr("href");if(o==null)o="";if(o.indexOf("watch?")>0){var a=o.indexOf("v=")+2;t.id=o.substring(a,a+11)}t.title=i.attr("title");t.description=e.find(".yt-lockup-description").text();t.views=e.find("ul.yt-lockup-meta-info").children().eq(1).text();t.thumbnail=e.find("img").attr("src");t.channelName=e.find("a[data-ytid]").text();t.channelUrl="https://youtube.com/channel"+t.channelId;if(t.id!=null){n.push(t)}}}catch(e){TBUtilities.LogError(e)}});t(n);break}}}else{TBUtilities.LogFailedWebRequest({Location:"YouTubeActions.js|getVideoSearchResults",Data:i,Response:o});t(null)}}catch(e){TBUtilities.LogError({Exception:e,Location:"YouTubeActions.js|getVideoSearchResults"});t(null)}})}catch(e){TBUtilities.Log(e);t(null)}};var Fe=function(){jQuery(document.body).on("CRTBMessagePost",function(e,t){TubeBuddyYouTubeActions.CRTBMessagePost(t)});jQuery(document.body).on("CRTBLoadAboutPageForMessage",function(e,t){TubeBuddyYouTubeActions.CRTBLoadAboutPageForMessage(t)});jQuery(document.body).on("CRTBYTActionsLoadPlaylistPage",function(e,t){TubeBuddyYouTubeActions.CRTBYTActionsLoadPlaylistPage(t)});jQuery(document.body).on("CRTBLoadAboutPageForSubscribe",function(e,t){TubeBuddyYouTubeActions.CRTBLoadAboutPageForSubscribe(t)});jQuery(document.body).on("CRTBPostSubscribe",function(e,t){TubeBuddyYouTubeActions.CRTBPostSubscribe(t)});jQuery(document.body).on("CRTBYouTubeActionGetSearchResults",function(e,t){TubeBuddyYouTubeActions.CRTBYouTubeActionGetSearchResults(t)});jQuery(document.body).on("CRPostCard",function(e,t){TBUtilities.Log(t)})};var Ne=function(e,t){try{TBUtilities.Log("TubeBuddyYouTubeActions - isVideoInPlaylist");var i="https://www.youtube.com/channel/"+TBGlobal.CurrentChannelId();TBExtension.Get(i,function(i,o,a){try{if(i){var n=a.indexOf('"ID_TOKEN":"')+'"ID_TOKEN":"'.length;var r=a.indexOf('"',n+2);var s=a.substring(n,r);var l={video_ids:e,session_token:s,src_playlist_id:""};var d="https://www.youtube.com/addto_ajax?action_get_dropdown=1&hide_watch_later=true&feature=edit";TBExtension.Post(d,jQuery.param(l),function(e,i,o){try{if(e){var a=jQuery.parseHTML(DOMPurify.sanitize(o,DOMPurifyConfig));var n=false;jQuery(a).find("li").each(function(){var e=jQuery(this).find(".playlist-name:first").html();var t=jQuery(this).find("button:first").attr("aria-checked");var i=jQuery(this).attr("data-full-list-id");if(t=="checked"){n=true}});t(n)}else{TBUtilities.LogFailedWebRequest({Location:"YouTubeActions.js|isVideoInPlaylist",Data:i,Response:o});t(false)}}catch(e){TBUtilities.LogError({Exception:e,Location:"YouTubeActions.js|isVideoInPlaylist"});t(false)}},null,{contentType:"application/x-www-form-urlencoded; charset=UTF-8"})}else{TBUtilities.LogFailedWebRequest({Location:"YouTubeActions.js|isVideoInPlaylist",Data:o,Response:a})}}catch(e){TBUtilities.LogError({Exception:e,Location:"YouTubeActions.js|isVideoInPlaylist"})}})}catch(e){TBUtilities.Log(e);t(false)}};var Ye=function(e){return new Promise(function(t,i){var o=false;var a="https://www.youtube.com/results?search_query="+TBUtilities.GetUrlEncoded(e);TBUtilities.Log("getSearchEstimatedResultCount = "+a);TBExtension.Get(a,function(e,o,a){try{if(e===true){var n=null;var r=TBGlobal.GetYouTubeUIFromHtml(a);if(r=="default"&&a.indexOf('window["ytInitialData"]')>-1)r="material";switch(r){case"studio":case"material":{var s=a.indexOf('window["ytInitialData"] =');if(s!=-1){var l=TBUtilities.ParseResponseContextFromHtml(a);n=parseInt(l.estimatedResults)}break}case"default":{var d=DOMPurify.sanitize(a,DOMPurifyConfig);jQuery("#tb-tag-explorer-search-result-count").text(jQuery(".num-results",d).text());var u=jQuery(".num-results",d).html();if(!u)u="";u=u.replace(/\D/g,"");n=parseInt(u)}}if(isNaN(n)===false){t(n)}else{i("Error getting number of results")}}}catch(e){TBUtilities.LogError(e);i("Error getting number of results")}},{query:e},{credentials:o})})};return{Initialize:function(){if(!e){Fe();e=true}},GetVideoSearchRank:function(e,t,i,o,a,n){R(e,t,i,null,o,a,n)},GetVideoSearchResults:function(e,t){Oe(e,t)},AddCard:function(e,t,i,o,a,n,r,s,l){_(e,t,i,o,a,n,r,s,l)},CopyCard:function(e,t,i,o){D(e,t,i,o,TBUtilities.CreateGuid())},UnpublishAnnotations:function(e,t,i){je(e,t,i)},CopyEndScreenElementsStudio:function(e,t,i){return be(e,t,i)},DeleteAllEndScreenElementsStudio:function(e,t){return be(e,t,[])},GetVideosListStudio:function(e,t){return re(e,t)},CopyEndCardElements:function(e,t,i,o,a,n,r){var s=[];jQuery.each(a,function(e,t){switch(t.type){case"WEBSITE":{s.push(t);break}}});if(s.length>0){var l=0;jQuery.each(s,function(d,u){we(e,u,n,function(d){if(d&&d.uploadedImage!=null){l++;if(l>=s.length){he(e,t,i,o,a,n,r)}}else{TBUtilities.Log("Failed to upload website element for \n");TBUtilities.Log(d);r(false,null,null,"Error uploading image")}})})}else{he(e,t,i,o,a,n,r)}},UpdateEndCardElements:function(e,t,i,o,a,n){var r=[];jQuery.each(o,function(e,t){switch(t.type){case"WEBSITE":{if(t.imagefile){r.push(t)}break}}});if(r.length>0){var s=0;jQuery.each(r,function(l,d){we(e,d,a,function(l){if(l&&l.uploadedImage!=null){s++;if(s>=r.length){he(e,null,t,i,o,a,n)}}else{n(false,null,null,"Error uploading image")}})})}else{he(e,null,t,i,o,a,n)}},DeleteAllEndCardElements:function(e,t,i,o){ve(e,t,i,o)},DeleteAllEndCardElementsWithUrl:function(e,t,i,o,a,n){ge(e,t,i,o,a,n)},UpdateCard:function(e,t,i,o){V(e,t,i,o)},GetCardsList:function(e,t){Qe(e,t)},GetEndScreenList:function(e,t){xe(e,t)},GetEndScreenListStudio:function(e){return X(e)},GetVideoEndScreenStartMs:function(e){return M(e)},GetVideoDetailStudio:function(e){return O(e)},GetVideoDuration:function(e){return F(e)},GetVideoCommentsStudio:function(e,t,i){return W(e,t,i)},PostCustomThumbnailStudio:function(e,t){return H(e,t)},BulkCardDeleted:function(e,t,i){Ve(e,t,i)},DeleteAllCards:function(e,t,i){Be(e,t,i)},DeleteAllCardsWithUrl:function(e,t,i,o,a){Be(e,t,o,i,a)},DeleteAllCardsWithText:function(e,t,i,o,a){Be(e,t,o,null,a,i)},DeleteCard:function(e,t,i,o,a,n,r,s,l,d){ke(e,t,i,o,a,n,r,s,l,d)},DeleteAnnotations:function(e,t,i){Ge(e,t,i)},GetAnnotations:function(e,t){De(e,t)},SendMessage:function(e,t,i){B(e,t,i)},SetPlaylistOrderingToManual:function(e,t){k(e,t)},GetSearchResults:function(e,t,i,o,a,n,r){G(e,t,i,o,a,n,r)},GetChannelId:function(e,t){return Re(e,t)},GetVideoChannelId:function(e,t,i){_e(e,t,i)},SubscribeToChannel:function(e,t){L(e,t)},GetVideoTags:function(e,t){Le(e,t)},GetVideoInfo:function(e,t){Ue(e,t)},GetChannelInfoFromPage:function(e,t){Se(e,t)},GetYouTubeAutoComplete:function(e,t,i){j(e,t,i,"youtube")},GetGoogleAutoComplete:function(e,t,i){j(e,t,i,"google")},GetChannelInfoFromAboutPage:function(e,t,i){Ie(e,t,i)},GetFullNumberFromAbbreviation:function(e){return Ee(e)},CRTBLoadAboutPageForMessage:function(e){C(e)},CRTBMessagePost:function(e){A(e)},CRTBLoadAboutPageForSubscribe:function(e){U(e)},CRTBPostSubscribe:function(e){S(e)},CRTBYouTubeActionGetSearchResults:function(e){E(e)},CRTBYTActionsLoadPlaylistPage:function(e){I(e)},IsVideoInPlaylist:function(e,t){Ne(e,t)},AnalyticsGetSummaryChannelTotals:function(e,t,i){return te(e,t,i)},AnalyticsGetDailyChannelTotals:function(e,t,i){return ie(e,t,i)},AnalyticsGetDailyVideoTotals:function(e,t,i,o){return oe(e,t,i,o)},AnalyticsGetSummaryVideoTrafficSourcesTotals:function(e,t,i,o){return ae(e,t,i,o)},AnalyticsGetSummaryVideoTotals:function(e,t,i,o){return ne(e,t,i,o)},GetSearchEstimatedResultCount:function(e){return Ye(e)}}}();const TBApiMetrics={VIEWS:"VIEWS",COMMENTS:"COMMENTS",RATINGS_LIKES:"RATINGS_LIKES",AVERAGE_WATCH_PERCENTAGE:"AVERAGE_WATCH_PERCENTAGE",AVERAGE_WATCH_TIME:"AVERAGE_WATCH_TIME",SUBSCRIBERS_NET_CHANGE:"SUBSCRIBERS_NET_CHANGE",TOTAL_ESTIMATED_EARNINGS:"TOTAL_ESTIMATED_EARNINGS",IMPRESSIONS:"IMPRESSIONS",CLICKS:"CLICKS",VIDEO_THUMBNAIL_IMPRESSIONS:"VIDEO_THUMBNAIL_IMPRESSIONS",VIDEO_THUMBNAIL_IMPRESSIONS_VTR:"VIDEO_THUMBNAIL_IMPRESSIONS_VTR"};var TubeBuddyStudioDashboard=function(){var e=false;var t="";var i="";var o="";var a=[];var n=0;var r={};var s=1;var l=function(){var e=TBGlobal.host+"/ModuleManager/studiodashboard/studiodashboard?v="+TBGlobal.versionNumber;if(loadLocalHTML&&(TBExtension.GetType()=="chrome"||TBExtension.GetType()=="firefox")){e=chrome.extension.getURL("modules/studiodashboard.html")}else if(loadLocalHTML&&TBExtension.GetType()=="safari"){e="modules/studiodashboard.html"}TBExtension.Get(e,function(e,t,i){if(e){i=TBUtilities.FixLocalHtml(i);jQuery("body").append(i);if(TBGlobal.CanAccessLevel3Tools()){TBUtilities.Log("fetchProcessingTasksActivated");var o=jQuery("#tb-studio-dashboard-container")[0].outerHTML;jQuery("#main").after(o);u()}}})};var d=function(){var e=jQuery("html").html();var a=e.indexOf('"INNERTUBE_API_KEY":"')+'"INNERTUBE_API_KEY":"'.length;if(a>0){var n=e.indexOf('"',a);t=e.substring(a,n);a=e.indexOf('"DELEGATED_SESSION_ID":"')+'"DELEGATED_SESSION_ID":"'.length;if(a>0){n=e.indexOf('"',a);i=e.substring(a,n)}a=e.indexOf('"INNERTUBE_CONTEXT_CLIENT_NAME":')+'"INNERTUBE_CONTEXT_CLIENT_NAME":'.length;if(a>0){n=e.indexOf(",",a);o=e.substring(a,n)}}};var u=function(){TBUtilities.Log("fetchProcessingTasks");jQuery("#tb-studio-dashboard-processing").html('<div style="line-height:19px;"><img src="'+TBGlobal.host+'/images/general/loading1.gif" style="position:relative; top:3px;" /> Looking for A/B Tests that need CTR gathering...</div>');var e=TBGlobal.host+TBGlobal.apiUrls.abtestsGetVideosToGather;TBExtension.Get(e,function(e,t,i){TBUtilities.Log("fetchProcessingTasks BACK");TBUtilities.Log(e);TBUtilities.Log(i);if(e==false){if(i=="401"){var o=jstz.determine_timezone();var n=o.timezone;if(n!="undefined"){n.ambiguity_check()}var r=n.utc_offset;var s="";if(TBGlobal.Profile()!=null)s="&agencyid="+encodeURIComponent(TBGlobal.Profile().AgencyId);if(s==null)s="";jQuery("#tb-studio-dashboard-processing").html('<div style="line-height:16px; color:Red;"><b>We not longer have a valid Access Token for your channel.</b><br><br><a href="'+TBGlobal.host+"/oauth/AuthRedirect?channelid="+TBGlobal.CurrentChannelId()+"&redirectUrl="+encodeURIComponent("https://studio.youtube.com")+"&timeZoneOffset="+encodeURIComponent(r)+"&agencyId="+s+"&via=extension&channelId="+TBGlobal.CurrentChannelId()+'">CLICK HERE</a> to re-link your channel and fix it.</div>')}else{jQuery("#tb-studio-dashboard-processing").html('<span style="color:red">There was an error looking for A/B Tests that need processing. <br><br>Error: '+i+"</span>")}return}try{a=JSON.parse(i);TBUtilities.Log(a);if(a.length==0){jQuery("#tb-studio-dashboard-processing").html("No A/B Tests to Process.");jQuery("#tb-studio-dashboard-container").hide()}else{TBUtilities.Log(a.length);jQuery("#tb-studio-dashboard-container").show();c()}}catch(e){}})};var c=function(){if(n==a.length){jQuery("#tb-studio-dashboard-processing").html('<div style="color:green"><img style="position:relative; top:2px; height:15px;" src="'+TBGlobal.host+'/images/icons/check.png"> CTR Gathering Complete!</div>');setTimeout(function(){jQuery("#tb-studio-dashboard-container").hide()},5e3);return}var e=a[n];TBUtilities.Log("CurItem");TBUtilities.Log(e);jQuery("#tb-studio-dashboard-processing").html('<div style="padding-bottom:5px; margin-bottom:6px; border-bottom:solid 1px #eee; margin-right:10px;"><div style="padding-bottom:5px;">Video '+(n+1)+" of "+a.length+'</div><div style="padding-bottom:5px;">Processing CTR Data for</div><img src="'+e.VideoThumbnail+'" style="height:30px; float:left; margin-right:3px;" /> <b>'+e.VideoTitle+'</b><div style="clear:both"></div></div>');b(e.VideoId,new Date(e.StartDate),new Date(e.EndDate))};var p=function(e){jQuery("#tb-studio-dashboard-processing").find("img").remove();jQuery("#tb-studio-dashboard-processing").append('<div style="padding-top:5px;"><img src="'+TBGlobal.host+'/images/general/loading1.gif" style="position:relative; top:2px; height:12px; width:12px;" /> '+e+"</div>")};var b=function(e,o,a){var l=o.getFullYear().toString();if(o.getMonth()+1<10)l+="0"+(o.getMonth()+1).toString();else l+=(o.getMonth()+1).toString();if(o.getDate()<10)l+="0"+o.getDate().toString();else l+=o.getDate().toString();var d=a.getFullYear().toString();if(a.getMonth()+1<10)d+="0"+(a.getMonth()+1).toString();else d+=(a.getMonth()+1).toString();if(a.getDate()<10)d+="0"+a.getDate().toString();else d+=a.getDate().toString();var u=TBUtilities.GetCookie("SS"+"ID");var y=TBUtilities.GetCookie("SA"+"PI"+"SI"+"D");var h=TBUtilities.GetCookie("S"+"ID");p("Preparing for gather...");TBExtension.Get(TBGlobal.host+"/api/youtubechannel/processstring?v="+u+"&f=h&s="+y+"&t="+h,function(u,y,h){h=TBUtilities.ReplaceAll(h,'"',"");if(u){p("Preparation complete...")}else{if(h==401||h=="401"){TBUtilities.Alert("We were unable to collect CTR data.<br><br>It appears like we do not have a valid access token for your channel. <br><br>Please try re-linking this channel using the main TubeBuddy menu next to the upload button on YouTube.com.")}else{TBUtilities.Alert("Sorry, failed to pull CTR Data")}p("ERROR (CODE A1)");return}var f='"user": { "onBehalfOfUser": "'+i+'" }';if(i.indexOf("_")>-1)f="";var m='"nodes":[{"key":"3__KEY_METRIC_DAILY_CHART_QUERY","value":{"query":{"dimensions":[{"type":"DAY"}],"metrics":[{"type":"VIDEO_THUMBNAIL_IMPRESSIONS"},{"type":"VIDEO_THUMBNAIL_IMPRESSED_VIEWS"}],"restricts":[{"dimension":{"type":"USER"},"inValues":["'+TBGlobal.CurrentChannelId()+'"]},{"dimension":{"type":"VIDEO"},"inValues":["'+e+'"]}],"orders":[{"dimension":{"type":"DAY"},"direction":"ANALYTICS_ORDER_DIRECTION_ASC"}],"timeRange":{"dateIdRange":{"inclusiveStart":'+l+',"exclusiveEnd":'+d+'}},"currency":"USD"}}}],"connectors":[],"allowFailureResultNodes":true,"trackingLabel":"web_overview_channel_foreground"}';TBUtilities.Log("User section: "+f);if(f!=""){m='{ "context": { '+f+" }, "+m}else{m="{"+m}p("Fetching CTR Views...");TBExtension.Post("https://studio.youtube.com/youtubei/v1/analytics_data/join?alt=json&key="+t,m,function(t,i,l){if(t&&l.indexOf("PERMISSION_DENIED")==-1){p("Collected CTR Views...")}else{var d=false;if(TBGlobal.GoogleAuthUser()==0){p("Switching User Account...");try{TBExtension.Get("https://www.youtube.com",function(t,i,n){if(t){var r=n.indexOf("authuser=");if(r>0){r=r+"authuser=".length;var s=n.indexOf("\\",r);TBGlobal.SetGoogleAuthUser(parseInt(n.substring(r,s)));b(e,o,a);TBUtilities.Log("ytfailreturn");return}TBUtilities.Log("ytfailafterreturn")}else{TBUtilities.Log("ytfail")}},null,null);TBUtilities.Log("afer")}catch(e){TBUtilities.Log("ytex")}}else{TBUtilities.Alert("Sorry, failed to pull CTR Data");p("Failed to Collect CTR Views...");return}}var u=JSON.parse(l);r.VideoId=e;r.Items=[];if(u.results[0].value.resultTable==null){if(l.indexOf("PERMISSION_DENIED")==-1){jQuery("#tb-studio-dashboard-processing").find("img").remove();jQuery("#tb-studio-dashboard-processing").append('<div style="color:red"><br>There was an error gathering CTR data. If you see this message for more than 1 day, please contact support@tubebuddy.com so we can help fix it.</div>');return}else{s++;jQuery("#tb-studio-dashboard-processing").find("img").remove();if(s>3){jQuery("#tb-studio-dashboard-processing").append('<div style="color:red">Please contact support@tubebuddy.com if this message persists.</div>')}else{jQuery("#tb-studio-dashboard-processing").append('<div style="color:red">Gather attempt #'+s+"</div>")}}}if(u.results[0].value.resultTable.resultColumns[0].values!=null){for(var y=0;y<u.results[0].value.resultTable.resultColumns[0].values.length;y++){var h=new Date(u.results[0].value.resultTable.resultColumns[0].values[y].double);h=h.getFullYear()+"-"+(h.getMonth()+1)+"-"+h.getDate();var f={Date:h,CtrImpressions:u.results[0].value.resultTable.resultColumns[1].values[y].double,CtrViews:u.results[0].value.resultTable.resultColumns[2].values[y].double};r.Items.push(f);TBUtilities.Log("push");TBUtilities.Log(f)}}var m=jQuery.param(r);p("Storing Data...");TBExtension.Post(TBGlobal.host+"/api/AbTests/AddCtrData",m,function(e,t,i){TBUtilities.Log("Back!");if(e){p("Data successfully saved!")}else{TBUtilities.Alert("Sorry, failed to pull CTR Data");p("Failed to store data...");return}TBUtilities.Log("Process next");n++;c()},null,{contentType:"application/x-www-form-urlencoded; charset=UTF-8"})},null,null,h)},null,null,null)};var y=function(){jQuery(document).on("click","#tb-studio-processing-close",function(){jQuery("#tb-studio-processing").slideUp()})};return{Initialize:function(){if(!e){e=true;d();y();l()}}}}();var googlePlusActions=function(){var e=null;var t=0;var i=false;var o=null;var a=function(i,a,n,r,s){TBUtilities.Log("(Google+) addToGooglePlusCircle,"+i+","+a+","+n+","+r);if(s){o=s}if(e==null&&t<=3){TBUtilities.Log("(Google+) Google+ circle not found, looking up");var l=b(i,a)+"+google/posts";TBUtilities.Log("(Google+) looking up posts with url "+l);TBExtension.Get(l,"CRTBGooglePlusActionsGetPostsPage",{toGooglePlusId:n,fromGooglePlusId:a,channelName:r,isGooglePlusPage:i})}else if(e==null&&t>=3){TBUtilities.Log("(Google+) Error creating Google+ cirlce ");o(false,a,n,r)}else{TBUtilities.Log("(Google+) Getting getting sesion token");var d=b(i,a)+n+"/about";TBUtilities.Log("(Google+) Getting Google+ about page = "+d);TBExtension.Get(d,"CRTBGooglePlusActionsGetAboutPage",{toGooglePlusId:n,fromGooglePlusId:a,channelName:r,isGooglePlusPage:i})}};var n=function(i){TBUtilities.Log("(Google+) checkForGooglePlusFollowingCircle");t++;try{e=d(i.response);TBUtilities.Log("(Google+) Google+ TB circle id = "+e);if(e==null&&t<=3){TBUtilities.Log("(Google+) Circle id not found, creating Google+ circle");var n=u(i.response);var r=78968836;var s="f.req="+'["af.maf",[["af.add",'+r+',[{"'+r+'":["'+encodeURIComponent("TubeBuddy")+'",[]]}]]]]';s+="&at="+n;var l=p(0x73b52bf2bf682400,0x8f76995a0e302800);var c=b(i.data.isGooglePlusPage,i.data.fromGooglePlusId)+"_/PlusAppUi/mutate?ds.extension="+r+"&f.sid=-"+l+"&hl=en&soc-app=199&soc-platform=1&soc-device=1&_reqid="+p(1,6e5)+"&rt=c";TBExtension.Post(c,s,"CRTBGooglePlusCreateCircle",i.data)}else{TBUtilities.Log("(Google+) Google+ circle found, id = "+e);a(i.data.isGooglePlusPage,i.data.fromGooglePlusId,i.data.toGooglePlusId,i.data.channelName)}}catch(e){TBUtilities.Log("(Google+) checkForGooglePlusFollowingCircle exception "+e);o(false,i.data.fromGooglePlusId,i.data.toGooglePlusId,i.data.channelName)}};var r=function(e){TBUtilities.Log("(Google+) getGooglePlusSessionToken");if(e.success){var t=null;try{t=u(e.response);TBUtilities.Log("(Google+) Session token = "+t)}catch(t){TBUtilities.Log("(Google+) Exception getting session token for Google Id = "+e.data.toGooglePlusId)}if(t){TBUtilities.Log("(Google+) Making Google+ circle request");s(e,t);return}}TBUtilities.Log("(Google+) Failed to get session token");o(false,null,e.data.fromGooglePlusId,e.data.toGooglePlusId,e.data.channelName)};var s=function(t,i){TBUtilities.Log("(Google+) sendGooglePlusFollowRequest");var o=77801788;var a=p(0x73b52bf2bf682400,0x8f76995a0e302800);var n="f.req="+'["af.maf",[["af.add",'+o+',[{"'+o+'":[[[[[null,null,"'+t.data.toGooglePlusId+'"]]]],["'+e+'"],[]]}]]]]';n+="&at="+i;var r=b(t.data.isGooglePlusPage,t.data.fromGooglePlusId)+"_/PlusAppUi/mutate?ds.extension="+o+"&f.sid=-"+a+"&hl=en&soc-app=199&soc-platform=1&soc-device=1&_reqid="+p(1,6e5)+"&rt=c";TBExtension.Post(r,n,"CRTBGooglePlusActionsAddToCircleRequest",t.data)};var l=function(e){TBUtilities.Log("(Google+) addToCircleCallback result = "+e.success);TBUtilities.Log("(Google+) addToCircleCallback status code = "+e.httpErrorCode);o(e.success,e.httpErrorCode,e.data.fromGooglePlusId,e.data.toGooglePlusId,e.data.channelName)};var d=function(e){var t=null;if(e){var i=e.indexOf("Following");if(i!=-1){e=e.substring(i);var o=e.indexOf("TubeBuddy");if(o!=-1){var a=e.substring(o-20);var n=a.indexOf('"');a=a.substring(n,n+18);t=a}}}if(t){t=t.replace(/['"]+/g,"");t=t.replace(/[,]+/g,"");t=t.trim()}return t};var u=function(e){var t=null;TBUtilities.Log("(Google+) parseSessionToken");var t=null;var i='https://csi.gstatic.com/csi","';var o=e.indexOf(i);if(o!=-1){TBUtilities.Log("(Google+) parseSessionToken - session token found");var a=e.substring(o+i.length);t=a.substring(0,a.indexOf('"'))}if(t==null){TBUtilities.Log("(Google+) parseSessionToken - second method attempt");var i='SNlM0e":"';var o=e.indexOf(i);TBUtilities.Log("(Google+) parseSessionToken - startIndex = "+o);if(o!=-1){var a=e.substring(o+i.length);t=a.substring(0,a.indexOf('"'));TBUtilities.Log("(Google+) parseSessionToken - session token = "+t)}}return t};var c=function(){i=true;jQuery(document.body).on("CRTBGooglePlusActionsGetPostsPage",function(e,t){googlePlusActions.CheckForGooglePlusFollowingCircle(t)});jQuery(document.body).on("CRTBGooglePlusCreateCircle",function(e,t){var i=b(t.data.isGooglePlusPage,t.data.fromGooglePlusId)+"+google/posts";TBExtension.Get(i,"CRTBGooglePlusActionsGetPostsPage",t.data)});jQuery(document.body).on("CRTBGooglePlusActionsGetAboutPage",function(e,t){googlePlusActions.GetGooglePlusSessionToken(t)});jQuery(document.body).on("CRTBGooglePlusActionsAddToCircleRequest",function(e,t){googlePlusActions.AddToCircleCallback(t)})};var p=function(e,t){return Math.floor(Math.random()*(t-e+1))+e};var b=function(e,t){var i;if(e){i="https://plus.google.com/b/"+t+"/"}else{i="https://plus.google.com/"}return i};return{GetCircleId:function(e){return d(e)},GetSessionToken:function(e){return u(e)},AddToGooglePlusCircle:function(e,t,o,n,r){if(i==false){c()}a(e,t,o,n,r)},CheckForGooglePlusFollowingCircle:function(e){n(e)},GetGooglePlusSessionToken:function(e){r(e)},AddToCircleCallback:function(e){l(e)}}}();var TubeBuddyStatFire=function(){var e=false;var t;var i;var o;var a;var n=function(e,t,i,o){var a=TBGlobal.host+"/api/data/getchannelcompetitorstatistics?channelId="+e+"&competitorChannelId="+t+"&type="+i+"&days="+o;TBExtension.Get(a,"CRTBStatFireLoadChannelCompetitorStats",{channelId:e,competitorChannelId:t})};var r=function(e,t,i){var o=TBGlobal.host+"/api/data/getchannelstatistics?channelId="+e+"&type="+t+"&days="+i;TBExtension.Get(o,"CRTBStatFireLoadChannelStats",{channelId:e})};var s=function(e,t,i){var o=TBGlobal.host+"/api/data/getvideostatistics?channelId="+e+"&type="+t+"&count="+i;TBExtension.Get(o,"CRTBLoadVideoStats",{channelId:e})};var l=function(e){var t=TBGlobal.host+"/api/data/getchannelinfo?channelId="+e;TBExtension.Get(t,"CRTBStatFireGetChannelInfo",{channelId:e})};var d=function(){jQuery(document.body).on("CRTBStatFireLoadChannelStats",function(e,i){var o=[];if(i.success){o=JSON.parse(i.response)}t(i.data.channelId,o)});jQuery(document.body).on("CRTBStatFireLoadChannelCompetitorStats",function(e,t){var i=[];if(t.success){i=JSON.parse(t.response)}a(t.data,i)});jQuery(document.body).on("CRTBStatFireGetChannelInfo",function(e,t){var i=[];if(t.success){i=JSON.parse(t.response)}o(t.data.channelId,i)});jQuery(document.body).on("CRTBLoadVideoStats",function(e,t){var o=[];if(t.success){o=JSON.parse(t.response)}i(t.data.channelId,o)})};return{Initialize:function(){if(!e){d();e=true}},GetCompetitorChannelStats:function(e,t,i,o,r){a=r;n(e,t,i,o)},GetChannelStats:function(e,i,o,a){t=a;r(e,i,o)},GetVideoStats:function(e,t,o,a){i=a;s(e,t,o)},GetChannelInfo:function(e,t){o=t;l(e)}}}();var TubeBuddyLayout=function(){var e=false;var t=false;var i=false;var o=false;var a=false;var n;var r;var s=false;var l=false;var d=false;var u=-1;var c=null;var p=[];var b;var y;var h=null;var f={general:{name:"General Page",tubeBuddyTools:[{title:"How-To Videos",description:"There are no tools specific to the page you are on. Check out our how-to playlist.",url:"https://www.youtube.com/playlist?list=PLpzjxyndddwKn0VuIEn8vMvKkczsPhmgB",thumbnailUrl:TBGlobal.host+"/images/icons/how-to.png"}],resources:[{title:"YouTube Creators Blog",source:"YouTube",sourceUrl:"http://www.youtube.com/",url:"http://youtubecreator.blogspot.com/",thumbnailUrl:TBGlobal.host+"/images/icons/social/youtube-video.png"},{title:"ReelSEO - YouTube Marketing",source:"ReelSEO",sourceUrl:"http://www.reelseo.com/",url:"http://www.reelseo.com/video/youtube-marketing/",thumbnailUrl:TBGlobal.host+"/images/icons/social/reelseo-video.png"},{title:"YouTube Creator Playbook",source:"YouTube",sourceUrl:"http://www.youtube.com",url:"http://www.youtube.com/yt/playbook/",thumbnailUrl:TBGlobal.host+"/images/icons/social/youtube-video.png"}]},search_results:{name:"Search Results",tubeBuddyTools:[{title:"Tag Explorer",description:"Find trending and popular Tags related to the term you just searched for.",url:"https://www.youtube.com/watch?v=3X80E-_b-mI&index=1&list=PLpzjxyndddwKn0VuIEn8vMvKkczsPhmgB",thumbnailUrl:"https://i.ytimg.com/vi/3X80E-_b-mI/mqdefault.jpg"}],resources:[{title:"How To Write Optimized YouTube Tags for Video SEO",source:"Video Creators",sourceUrl:"https://www.youtube.com/channel/UCcB3bcWy0_QK7uPQvTD0LwQ",url:"https://www.youtube.com/watch?v=BL1dPTHbjj0",thumbnailUrl:"https://i.ytimg.com/vi/BL1dPTHbjj0/mqdefault.jpg"},{title:"YouTube Optimization: Myths Busted, Secrets Revealed! [Case Study]",source:"ReelSEO",sourceUrl:"https://www.reelseo.com",url:"http://www.reelseo.com/youtube-optimization-case-study/",thumbnailUrl:TBGlobal.host+"/images/icons/social/reelseo-video.png"},{title:"How to Properly Tag your YouTube Videos",source:"Derral Eves",sourceUrl:"https://www.youtube.com/channel/UC3pV6eELigzhTjzBUPmT6_A",url:"https://www.youtube.com/watch?v=YGZOm_dCgMg",thumbnailUrl:"https://i.ytimg.com/vi/YGZOm_dCgMg/mqdefault.jpg"}]},video_edit:{name:"Edit Video",tubeBuddyTools:[{title:"Tag Explorer",description:"Find trending and popular Tags related to the term you just searched for.",url:"https://www.youtube.com/watch?v=3X80E-_b-mI&index=1&list=PLpzjxyndddwKn0VuIEn8vMvKkczsPhmgB",thumbnailUrl:"https://i.ytimg.com/vi/3X80E-_b-mI/mqdefault.jpg"},{title:"Copy Tags",description:"Easily copy your video tags to the clipboard",url:"https://www.youtube.com/watch?v=mfxV5xJI4kI&index=5&list=PLpzjxyndddwKn0VuIEn8vMvKkczsPhmgB",thumbnailUrl:"https://i.ytimg.com/vi/mfxV5xJI4kI/mqdefault.jpg"}],resources:[{title:"How to create the best Titles &amp; Thumbnails",source:"YouTube Creator Academy",sourceUrl:"https://www.youtube.com/channel/UCkRfArvrzheW2E7b6SVT7vQ",url:"https://www.youtube.com/watch?v=7zLUm7BeCGE",thumbnailUrl:"https://i.ytimg.com/vi_webp/7zLUm7BeCGE/mqdefault.webp"},{title:"How to Properly Tag your YouTube Videos",source:"Derral Eves",sourceUrl:"https://www.youtube.com/channel/UC3pV6eELigzhTjzBUPmT6_A",url:"https://www.youtube.com/watch?v=YGZOm_dCgMg",thumbnailUrl:"https://i.ytimg.com/vi/YGZOm_dCgMg/mqdefault.jpg"},{title:"Optimizing Video SEO for Reach vs Retention",source:"Video Creators",sourceUrl:"https://www.youtube.com/channel/UCcB3bcWy0_QK7uPQvTD0LwQ",url:"https://www.youtube.com/watch?v=erfgDfzPILo",thumbnailUrl:"https://i.ytimg.com/vi/erfgDfzPILo/mqdefault.jpg"}]},video_watch:{name:"Watch Video",tubeBuddyTools:[{title:"Community Connect",description:"Quickly and easily reach out to contact video and channel commenters.",url:"https://www.youtube.com/watch?v=lSJh2TE_8Vg&index=1&list=PLpzjxyndddwKn0VuIEn8vMvKkczsPhmgB",thumbnailUrl:"https://i.ytimg.com/vi/lSJh2TE_8Vg/mqdefault.jpg"},{title:"Tag Explorer",description:"Find trending and popular Tags related to the term you just searched for.",url:"https://www.youtube.com/watch?v=3X80E-_b-mI&index=1&list=PLpzjxyndddwKn0VuIEn8vMvKkczsPhmgB",thumbnailUrl:"https://i.ytimg.com/vi/3X80E-_b-mI/mqdefault.jpg"},{title:"Bulk Copy Annotations",description:"Copy multiple annotations from a video to any of your other videos with just a couple clicks.",url:"https://www.youtube.com/watch?v=D7Q94YWj6RE&index=2&list=PLpzjxyndddwKn0VuIEn8vMvKkczsPhmgB",thumbnailUrl:"https://i.ytimg.com/vi/D7Q94YWj6RE/mqdefault.jpg"},{title:"Bulk Description Promotion",description:"Drive traffic to a particular videos of yours using Bulk Description Promotions.",url:"https://www.youtube.com/watch?v=y9p_f5PLkhg&index=3&list=PLpzjxyndddwIdctzlTk-MCljMFzR9gwqV",thumbnailUrl:"https://i.ytimg.com/vi/y9p_f5PLkhg/mqdefault.jpg"},{title:"Share Tracker",description:"Keep track of which social networks you have shared your video with.",url:"https://www.youtube.com/watch?v=p0PmCuCu0x4&index=2&list=PLpzjxyndddwIdctzlTk-MCljMFzR9gwqV",thumbnailUrl:"https://i.ytimg.com/vi/p0PmCuCu0x4/mqdefault.jpg"},{title:"Advanced Embed",description:"Easily create stunning video thumbnails using video still frames.",url:"https://www.youtube.com/watch?v=9RXiuBCRBLo&t=227",thumbnailUrl:"https://i.ytimg.com/vi/9RXiuBCRBLo/mqdefault.jpg"}],resources:[{title:"How Dominate Related Videos on YouTube",source:"Video Creators",sourceUrl:"https://www.youtube.com/channel/UCcB3bcWy0_QK7uPQvTD0LwQ",url:"https://www.youtube.com/watch?v=9frnl4TGurM",thumbnailUrl:"https://i.ytimg.com/vi/9frnl4TGurM/mqdefault.jpg"},{title:"YouTube Creators Blog",source:"YouTube",sourceUrl:"http://www.youtube.com/",url:"http://youtubecreator.blogspot.com/",thumbnailUrl:TBGlobal.host+"/images/icons/social/youtube-video.png"},{title:"YouTube Creator Playbook",source:"YouTube",sourceUrl:"http://www.youtube.com",url:"http://www.youtube.com/yt/playbook/",thumbnailUrl:TBGlobal.host+"/images/icons/social/youtube-video.png"}]},channel_discussion:{name:"Watch Video",tubeBuddyTools:[{title:"Community Connect",description:"Quickly and easily reach out to contact video and channel commenters.",url:"https://www.youtube.com/watch?v=lSJh2TE_8Vg&index=1&list=PLpzjxyndddwKn0VuIEn8vMvKkczsPhmgB",thumbnailUrl:"https://i.ytimg.com/vi/lSJh2TE_8Vg/mqdefault.jpg"}],resources:[{title:"YouTube Creator Playbook",source:"YouTube",sourceUrl:"http://www.youtube.com",url:"http://www.youtube.com/yt/playbook/",thumbnailUrl:TBGlobal.host+"/images/icons/social/youtube-video.png"}]},upload_defaults:{name:"Upload Defaults",tubeBuddyTools:[{title:"Multiple Sets of Upload Defaults",description:"Create multiple sets of upload defaults for each type of video you make.",url:"https://www.youtube.com/watch?v=u3ENBfEimIc&list=PLpzjxyndddwKn0VuIEn8vMvKkczsPhmgB&index=3",thumbnailUrl:"https://i.ytimg.com/vi/u3ENBfEimIc/mqdefault.jpg"}],resources:[{title:"How to create the best Titles &amp; Thumbnails",source:"YouTube Creator Academy",sourceUrl:"https://www.youtube.com/channel/UCkRfArvrzheW2E7b6SVT7vQ",url:"https://www.youtube.com/watch?v=7zLUm7BeCGE",thumbnailUrl:"https://i.ytimg.com/vi_webp/7zLUm7BeCGE/mqdefault.webp"},{title:"How to Properly Tag your YouTube Videos",source:"Derral Eves",sourceUrl:"https://www.youtube.com/channel/UC3pV6eELigzhTjzBUPmT6_A",url:"https://www.youtube.com/watch?v=YGZOm_dCgMg",thumbnailUrl:"https://i.ytimg.com/vi/YGZOm_dCgMg/mqdefault.jpg"},{title:"Optimizing Video SEO for Reach vs Retention",source:"Video Creators",sourceUrl:"https://www.youtube.com/channel/UCcB3bcWy0_QK7uPQvTD0LwQ",url:"https://www.youtube.com/watch?v=erfgDfzPILo",thumbnailUrl:"https://i.ytimg.com/vi/erfgDfzPILo/mqdefault.jpg"},{title:"How Dominate Related Videos on YouTube",source:"Video Creators",sourceUrl:"https://www.youtube.com/channel/UCcB3bcWy0_QK7uPQvTD0LwQ",url:"https://www.youtube.com/watch?v=9frnl4TGurM",thumbnailUrl:"https://i.ytimg.com/vi/9frnl4TGurM/mqdefault.jpg"}]},channel:{name:"Channel Page",tubeBuddyTools:[{title:"Community Connect",description:"Quickly and easily reach out to contact video and channel commenters.",url:"https://www.youtube.com/watch?v=lSJh2TE_8Vg&index=1&list=PLpzjxyndddwKn0VuIEn8vMvKkczsPhmgB",thumbnailUrl:"https://i.ytimg.com/vi/lSJh2TE_8Vg/mqdefault.jpg"},{title:"See Social Blade data in YouTube",description:"No need to leave YouTube - get access to all Social Blade data in YouTube.",url:"https://www.youtube.com/watch?v=dSuLZejPgFE&index=4&list=PLpzjxyndddwKn0VuIEn8vMvKkczsPhmgB",thumbnailUrl:"https://i.ytimg.com/vi/dSuLZejPgFE/mqdefault.jpg"}],resources:[{title:"YouTube Creators Blog",source:"YouTube",sourceUrl:"http://www.youtube.com/",url:"http://youtubecreator.blogspot.com/",thumbnailUrl:TBGlobal.host+"/images/icons/social/youtube-video.png"},{title:"ReelSEO - YouTube Marketing",source:"ReelSEO",sourceUrl:"http://www.reelseo.com/",url:"http://www.reelseo.com/video/youtube-marketing/",thumbnailUrl:TBGlobal.host+"/images/icons/social/reelseo-video.png"},{title:"YouTube Creator Playbook",source:"YouTube",sourceUrl:"http://www.youtube.com",url:"http://www.youtube.com/yt/playbook/",thumbnailUrl:TBGlobal.host+"/images/icons/social/youtube-video.png"}]},upload:{name:"Video Upload",tubeBuddyTools:[{title:"Multiple Sets of Upload Defaults",description:"Create multiple sets of upload defaults for each type of video you make.",url:"https://www.youtube.com/watch?v=u3ENBfEimIc&list=PLpzjxyndddwKn0VuIEn8vMvKkczsPhmgB&index=3",thumbnailUrl:"https://i.ytimg.com/vi/u3ENBfEimIc/mqdefault.jpg"}],resources:[{title:"How to create the best Titles &amp; Thumbnails",source:"YouTube Creator Academy",sourceUrl:"https://www.youtube.com/channel/UCkRfArvrzheW2E7b6SVT7vQ",url:"https://www.youtube.com/watch?v=7zLUm7BeCGE",thumbnailUrl:"https://i.ytimg.com/vi_webp/7zLUm7BeCGE/mqdefault.webp"},{title:"How to Properly Tag your YouTube Videos",source:"Derral Eves",sourceUrl:"https://www.youtube.com/channel/UC3pV6eELigzhTjzBUPmT6_A",url:"https://www.youtube.com/watch?v=YGZOm_dCgMg",thumbnailUrl:"https://i.ytimg.com/vi/YGZOm_dCgMg/mqdefault.jpg"},{title:"Optimizing Video SEO for Reach vs Retention",source:"Video Creators",sourceUrl:"https://www.youtube.com/channel/UCcB3bcWy0_QK7uPQvTD0LwQ",url:"https://www.youtube.com/watch?v=erfgDfzPILo",thumbnailUrl:"https://i.ytimg.com/vi/erfgDfzPILo/mqdefault.jpg"},{title:"How Dominate Related Videos on YouTube",source:"Video Creators",sourceUrl:"https://www.youtube.com/channel/UCcB3bcWy0_QK7uPQvTD0LwQ",url:"https://www.youtube.com/watch?v=9frnl4TGurM",thumbnailUrl:"https://i.ytimg.com/vi/9frnl4TGurM/mqdefault.jpg"}]},comments:{name:"Comments",tubeBuddyTools:[{title:"Comment Filters",description:"Quickly and easily find the comments that matter by filtering out the ones that don't.",url:"https://www.youtube.com/watch?v=NmC8Jc5A9K0&list=PLpzjxyndddwKn0VuIEn8vMvKkczsPhmgB&index=3",thumbnailUrl:"https://i.ytimg.com/vi/u3ENBfEimIc/mqdefault.jpg"}],resources:[{title:"How to create the best Titles &amp; Thumbnails",source:"YouTube Creator Academy",sourceUrl:"https://www.youtube.com/channel/UCkRfArvrzheW2E7b6SVT7vQ",url:"https://www.youtube.com/watch?v=7zLUm7BeCGE",thumbnailUrl:"https://i.ytimg.com/vi_webp/7zLUm7BeCGE/mqdefault.webp"},{title:"How to Properly Tag your YouTube Videos",source:"Derral Eves",sourceUrl:"https://www.youtube.com/channel/UC3pV6eELigzhTjzBUPmT6_A",url:"https://www.youtube.com/watch?v=YGZOm_dCgMg",thumbnailUrl:"https://i.ytimg.com/vi/YGZOm_dCgMg/mqdefault.jpg"},{title:"Optimizing Video SEO for Reach vs Retention",source:"Video Creators",sourceUrl:"https://www.youtube.com/channel/UCcB3bcWy0_QK7uPQvTD0LwQ",url:"https://www.youtube.com/watch?v=erfgDfzPILo",thumbnailUrl:"https://i.ytimg.com/vi/erfgDfzPILo/mqdefault.jpg"},{title:"How Dominate Related Videos on YouTube",source:"Video Creators",sourceUrl:"https://www.youtube.com/channel/UCcB3bcWy0_QK7uPQvTD0LwQ",url:"https://www.youtube.com/watch?v=9frnl4TGurM",thumbnailUrl:"https://i.ytimg.com/vi/9frnl4TGurM/mqdefault.jpg"}]},my_videos:{name:"My Videos",tubeBuddyTools:[{title:"Bulk Copy Cards",description:"Copy multiple cards from a video to any of your other videos with just a couple clicks.",url:"https://www.youtube.com/watch?v=jlANfsXXbPU&index=2&list=PLpzjxyndddwKn0VuIEn8vMvKkczsPhmgB",thumbnailUrl:"https://i.ytimg.com/vi/jlANfsXXbPU/mqdefault.jpg"},{title:"Bulk Copy Annotations",description:"Copy multiple annotations from a video to any of your other videos with just a couple clicks.",url:"https://www.youtube.com/watch?v=D7Q94YWj6RE&index=2&list=PLpzjxyndddwKn0VuIEn8vMvKkczsPhmgB",thumbnailUrl:"https://i.ytimg.com/vi/D7Q94YWj6RE/mqdefault.jpg"},{title:"Bulk Find / Rreplace / Append",description:"Find / Replace / Append video titles and descriptions in bulk.",url:"https://www.youtube.com/watch?v=kRWO6ymiSO0&index=2&list=PLpzjxyndddwKn0VuIEn8vMvKkczsPhmgB",thumbnailUrl:"https://i.ytimg.com/vi/kRWO6ymiSO0/mqdefault.jpg"},{title:"Advanced Embed",description:"Easily create stunning video thumbnails using video still frames.",url:"https://www.youtube.com/watch?v=9RXiuBCRBLo&t=227",thumbnailUrl:"https://i.ytimg.com/vi/9RXiuBCRBLo/mqdefault.jpg"},{title:"Share Tracker",description:"Keep track of which social networks you have shared your video with.",url:"https://www.youtube.com/watch?v=p0PmCuCu0x4&index=2&list=PLpzjxyndddwIdctzlTk-MCljMFzR9gwqV",thumbnailUrl:"https://i.ytimg.com/vi/p0PmCuCu0x4/mqdefault.jpg"},{title:"Thumbnail Generator",description:"Easily create stunning video thumbnails using video still frames.",url:"https://www.youtube.com/watch?v=S8UdKj7GtG0&t=173",thumbnailUrl:"https://i.ytimg.com/vi/S8UdKj7GtG0/mqdefault.jpg"}],resources:[{title:"Drive Fan Engagement",source:"Creator Academy",sourceUrl:"https://www.youtube.com/user/creatoracademy",url:"https://www.youtube.com/watch?v=vEj2iqsQLqw&list=PLpjK416fmKwTpjMX227XZjciduCo1-EkD",thumbnailUrl:"https://i.ytimg.com/vi/vEj2iqsQLqw/mqdefault.jpg"},{title:"Encourage Viewers to Watch More",source:"Creator Academy",sourceUrl:"https://www.youtube.com/user/creatoracademy",url:"https://www.youtube.com/watch?v=tZIHFNcK1vE&list=PLpjK416fmKwQMugNHzCUl_NrbLy021HwY",thumbnailUrl:"https://i.ytimg.com/vi/tZIHFNcK1vE/mqdefault.jpg"}]},subscribers:{name:"Subscribers",tubeBuddyTools:[{title:"Welcome new Subscribers",description:"Use TubeBuddy to quickly send pre-formatted welcome messages to your new subscribers.",url:"https://www.youtube.com/watch?v=P3yXe-XLEtY&list=PLpzjxyndddwKn0VuIEn8vMvKkczsPhmgB&index=7",thumbnailUrl:"https://i.ytimg.com/vi/P3yXe-XLEtY/mqdefault.jpg"},{title:"Find Twitter Influencers on YouTube",description:"Export a full list of your subscribers along with their Twitter/Facebook info.",url:"https://www.youtube.com/watch?v=rodGhLkNXw0&list=PLpzjxyndddwKn0VuIEn8vMvKkczsPhmgB&index=8",thumbnailUrl:"https://i.ytimg.com/vi/rodGhLkNXw0/mqdefault.jpg"}],resources:[{title:"How to grow with 0 Views and 0 Subscribers",source:"Video Creators",sourceUrl:"https://www.youtube.com/user/videocreators",url:"https://www.youtube.com/watch?v=boBex_v3_eA",thumbnailUrl:"https://i.ytimg.com/vi/boBex_v3_eA/mqdefault.jpg"},{title:"How to get more Views on YouTube",source:"Darral Eves",sourceUrl:"https://www.youtube.com/channel/UC3pV6eELigzhTjzBUPmT6_A",url:"https://www.youtube.com/watch?v=bBFlwytJu_4",thumbnailUrl:"https://i.ytimg.com/vi/bBFlwytJu_4/mqdefault.jpg"}]},playlists:{name:"Playlists",tubeBuddyTools:[{title:"How-To Videos",description:"There are no tools specific to the page you are on. Check out our how-to playlist.",url:"https://www.youtube.com/playlist?list=PLpzjxyndddwKn0VuIEn8vMvKkczsPhmgB",thumbnailUrl:TBGlobal.host+"/images/icons/how-to.png"}],resources:[{title:"YouTube Creator Playbook [Playlists]",source:"YouTube",sourceUrl:"http://www.youtube.com",url:"http://www.youtube.com/yt/playbook/playlists.html",thumbnailUrl:TBGlobal.host+"/images/icons/social/youtube-video.png"},{title:"YouTube Playlists: The Complete Guide Intro - Vidpow",source:"Vidpow",sourceUrl:"http://www.youtube.com/user/vidpowbam",url:"https://www.youtube.com/watch?v=Fxq4sgOsVMQ",thumbnailUrl:"https://i.ytimg.com/vi/Fxq4sgOsVMQ/mqdefault.jpg"},{title:"Increase Watch Time by Sharing your Video's Playlist URL",source:"ReelSEO",sourceUrl:"http://www.reelseo.com/",url:"https://www.youtube.com/watch?v=UKjNEGISOlM",thumbnailUrl:"https://i.ytimg.com/vi/UKjNEGISOlM/mqdefault.jpg"}]},cards:{name:"Cards",tubeBuddyTools:[{title:"How-To Videos",description:"There are no tools specific to the page you are on. Check out our how-to playlist.",url:"https://www.youtube.com/playlist?list=PLpzjxyndddwKn0VuIEn8vMvKkczsPhmgB",thumbnailUrl:TBGlobal.host+"/images/icons/how-to.png"}],resources:[{title:"YouTube Creator Playbook [Playlists]",source:"YouTube",sourceUrl:"http://www.youtube.com",url:"http://www.youtube.com/yt/playbook/playlists.html",thumbnailUrl:TBGlobal.host+"/images/icons/social/youtube-video.png"},{title:"YouTube Playlists: The Complete Guide Intro - Vidpow",source:"Vidpow",sourceUrl:"http://www.youtube.com/user/vidpowbam",url:"https://www.youtube.com/watch?v=Fxq4sgOsVMQ",thumbnailUrl:"https://i.ytimg.com/vi/Fxq4sgOsVMQ/mqdefault.jpg"},{title:"Increase Watch Time by Sharing your Video's Playlist URL",source:"ReelSEO",sourceUrl:"http://www.reelseo.com/",url:"https://www.youtube.com/watch?v=UKjNEGISOlM",thumbnailUrl:"https://i.ytimg.com/vi/UKjNEGISOlM/mqdefault.jpg"}]},annotations:{name:"Annotations",tubeBuddyTools:[{title:"How-To Videos",description:"There are no tools specific to the page you are on. Check out our how-to playlist.",url:"https://www.youtube.com/playlist?list=PLpzjxyndddwKn0VuIEn8vMvKkczsPhmgB",thumbnailUrl:TBGlobal.host+"/images/icons/how-to.png"}],resources:[{title:"YouTube Creator Playbook [Playlists]",source:"YouTube",sourceUrl:"http://www.youtube.com",url:"http://www.youtube.com/yt/playbook/playlists.html",thumbnailUrl:TBGlobal.host+"/images/icons/social/youtube-video.png"},{title:"YouTube Playlists: The Complete Guide Intro - Vidpow",source:"Vidpow",sourceUrl:"http://www.youtube.com/user/vidpowbam",url:"https://www.youtube.com/watch?v=Fxq4sgOsVMQ",thumbnailUrl:"https://i.ytimg.com/vi/Fxq4sgOsVMQ/mqdefault.jpg"},{title:"Increase Watch Time by Sharing your Video's Playlist URL",source:"ReelSEO",sourceUrl:"http://www.reelseo.com/",url:"https://www.youtube.com/watch?v=UKjNEGISOlM",thumbnailUrl:"https://i.ytimg.com/vi/UKjNEGISOlM/mqdefault.jpg"}]}};var m=function(){if(TBExtension.GetType()=="chrome"){jQuery(".tb-layout-chrome-icon").show();TBExtension.GetDbValue("tb-rated-chrome-store",function(e,t){TBUtilities.Log("tb-rated-chrome-store: "+t);if(t==true)jQuery(".tb-layout-goto-rating-container").hide()})}else if(TBExtension.GetType()=="firefox"){jQuery(".tb-layout-firefox-icon").show();TBExtension.GetDbValue("tb-rated-firefox-store",function(e,t){TBUtilities.Log("tb-rated-firefox-store: "+t);if(t==true)jQuery(".tb-layout-goto-rating-container").hide()})}jQuery(".tb-layout-channel-launch-pad-link").attr("href",TBGlobal.host+"/launchpad/dashboard/"+TBGlobal.CurrentChannelId());jQuery(".tb-layout-channel-health-report-link").attr("href",TBGlobal.host+"/channel/healthreport/"+TBGlobal.CurrentChannelId());jQuery(".tb-layout-channel-valuation-link").attr("href",TBGlobal.host+"/channel/valuation/"+TBGlobal.CurrentChannelId());jQuery(".tb-layout-channel-competitor-scorecard-link").attr("href",TBGlobal.host+"/channel/competitors/"+TBGlobal.CurrentChannelId());jQuery(".tb-layout-channel-brand-alerts-link").attr("href",TBGlobal.host+"/channel/brandalertlist/"+TBGlobal.CurrentChannelId());jQuery(".tb-layout-channel-ab-tests-link").attr("href",TBGlobal.host+"/channel/abtestlist/"+TBGlobal.CurrentChannelId());jQuery(".tb-layout-channel-backups-and-export-link").attr("href",TBGlobal.host+"/channel/backup/"+TBGlobal.CurrentChannelId());jQuery(".tb-layout-channel-canned-responses-link").attr("href",TBGlobal.host+"/channel/cannedresponses/"+TBGlobal.CurrentChannelId());jQuery(".tb-layout-channel-settings-link").attr("href",TBGlobal.host+"/channel/preferences/"+TBGlobal.CurrentChannelId());jQuery(".tb-layout-channel-promo-materials-link").attr("href",TBGlobal.host+"/promomaterials/channel/"+TBGlobal.CurrentChannelId());jQuery(".tb-layout-channel-search-rank-tracking-link").attr("href",TBGlobal.host+"/keywordranktracking/keywordrankingreport/"+TBGlobal.CurrentChannelId());jQuery(".tb-layout-channel-usage-statistics-link").attr("href",TBGlobal.host+"/channel/usage/"+TBGlobal.CurrentChannelId())};var g=function(){try{var e=TBUtilities.GetUrlParameter("tbft");o=e==1||e=="1";var t=TBGlobal.host+"/ModuleManager/layout?v="+TBGlobal.versionNumber+"&hl="+TBGlobal.languageCode;if(loadLocalHTML&&(TBExtension.GetType()=="chrome"||TBExtension.GetType()=="firefox")){t=chrome.extension.getURL("modules/layout.html")}else if(loadLocalHTML&&TBExtension.GetType()=="safari"){t="modules/layout.html"}TBExtension.Get(t,"TBLoadLayoutTemplate")}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyLayout] loadHtml"})}};var v=function(){try{}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyLayout] loadCss"})}};var T=function(){};var w=function(){if(jQuery("#tb-industry-milestones-loading").css("display")!="none"){TBUtilities.Log("Loading Milestones");TBExtension.Get(TBGlobal.host+TBGlobal.apiUrls.youtubeChannelGetMilestones,"TBLoadLayoutLoadMilestones")}};var j=function(){t=false;jQuery(".tb-layout-menu-dropdown:first").hide();q();clearTimeout(n);n=null};var Q=false;var x=function(){jQuery(document.body).on("tbGetLastMilestone",function(e,t){TBUtilities.Log("tbGetLastMilestone response");TBUtilities.Log(t);if(t){var i=new Date(new Date(t.value).getTime()+60*60*12*1e3);TBUtilities.Log(i);if(new Date<i){TBUtilities.Log("Done since yesterday");return}}TBUtilities.Log("Trigger Click");w()});jQuery(document.body).on("tbGetLastMilestoneItem",function(e,t){TBUtilities.Log("tbGetLastMilestoneItem response");TBUtilities.Log(t);if(t){h=t.value}});jQuery(document).on("click",".tb-site-login-dialog-closex",function(){jQuery("#tb-site-login-dialog").hide();TubeBuddyLayout.HideBackground()});jQuery(document).on("click","#tb-layout-tb-tools-subscribe-tb-button",function(){TBUtilities.Log("Clicked Subscirbe");TBExtension.Get(TBGlobal.host+TBGlobal.apiUrls.youtubeChannelMarkAsSubscribedToTubeBuddy,"")});jQuery(document).on("click","[data-action]",function(){J(jQuery(this).data("action"))});jQuery(document).on("click",".ytd-notification-topbar-button-renderer",function(){if(Q==true)return;Q=true;setTimeout(function(){jQuery("ytd-notification-renderer").each(function(){if(jQuery(this).parent().attr("id")!="items")return;TBUtilities.Log("BB");var e=jQuery(this).find("a").attr("href");if(!e){TBUtilities.Log("No link");return}var t=e.indexOf("lc=")+3;var i=e.length;var o=e.substring(t,i);TBUtilities.Log("Link: "+e);TBUtilities.Log(o);if(!o)return;if(o.indexOf("?")>=0)return;if(o.indexOf("=")>=0)return;var a=TBUtilities.ReplaceAll(o,".","_");if(jQuery("#tb-layout-notification-item-"+a).length>0)return;var n=jQuery(this).find(".text.style-scope.ytd-notification-renderer").height()+15;jQuery(this).prepend('<div id="tb-layout-notification-reply-'+a+'" class="tb-layout-notification-reply" data-comment-id="'+a+'" style="position:absolute; text-align:center; height:20px; top:'+(n-15)+'px; left:13px; cursor:pointer; width:50px; color:blue;"><img id="tb-layout-notification-'+a+'" src="'+TBGlobal.host+'/images/branding/icon_tiny.png" style="margin-right: 2px; vertical-align: text-bottom; position:relative; top:-1px;" /> <span style="opacity:.5">reply</span></div>');TBUtilities.Log(n);var r=" ";try{var s=jQuery(this).find("yt-formatted-string.message:first").text();s=s.substring(0,s.indexOf(":"));var l=s.split(" ");for(var d=0;d<l.length-1;d++)r+=l[d]+" "}catch(e){}var u=jQuery(".tb-layout-notification2-comment-block:last")[0].outerHTML;u=TBUtilities.ReplaceAll(u,"#COMMENT_ID#",a);u=TBUtilities.ReplaceAll(u,"#TOP#",n-20+"px");u=TBUtilities.ReplaceAll(u,"#COMMENTER#",r);jQuery(this).prepend(u)});jQuery(".feed-item-container").removeClass("yt-uix-tile");jQuery(".feed-item-container").each(function(){jQuery(this).removeClass("yt-uix-tile")})},1050)});jQuery(document).on("click",".tb-env",function(){});jQuery(document).on("click","#tb-popout-milestones-tab-header",function(){TBUtilities.Log("Clicked Milestones");w()});jQuery(document).on("change",".requiredCheckbox",function(){if(jQuery(".requiredCheckbox:checked").length==2){jQuery("#tb-sign-in-link").attr("href",jQuery("#tb-sign-in-link").attr("data-url"));jQuery("#tb-sign-in-link").css("cursor","pointer");jQuery("#tb-sign-in-link").attr("title","");var e=jQuery("#tb-sign-in-img").attr("src");jQuery("#tb-sign-in-img").attr("src",e.replace("login-disabled.png","login.png"));jQuery("#tb-sign-in-link").off("click");jQuery("#tb-sign-in-link").click(function(){var e=new Date;e.setFullYear(e.getFullYear()+10);TBUtilities.CreateCookie("GdprApprovalDate","true",10*365)})}else{A()}});jQuery(document).on("click","#yt-masthead-notifications-button",function(){setTimeout(function(){jQuery(".feed-item-container").each(function(){TBUtilities.Log("BB");var e=jQuery(this).find(".yt-lockup-content:first").find("h3").find("a").attr("href");if(!e){TBUtilities.Log("No link");return}var t=e.indexOf("lc=")+3;var i=e.length;var o=e.substring(t,i);TBUtilities.Log("Link: "+e);TBUtilities.Log(o);if(!o)return;if(o.indexOf("?")>=0)return;if(o.indexOf("=")>=0)return;var a=TBUtilities.ReplaceAll(o,".","_");if(jQuery("#tb-layout-notification-item-"+a+"-post").length>0)return;jQuery(this).find(".yt-lockup-byline").first("li").append('&nbsp; <img id="tb-layout-notification-'+a+'" src="'+TBGlobal.host+'/images/branding/icon_tiny.png" style="margin-right: 2px; vertical-align: text-bottom; position:relative; top:-1px;"><a id="tb-layout-notification-reply-'+a+'" class="tb-layout-notification-reply" data-comment-id="'+a+'">Reply</a>');var n=jQuery(".tb-layout-notification-comment-block:first")[0].outerHTML;n=TBUtilities.ReplaceAll(n,"#COMMENT_ID#",a);jQuery(this).find(".yt-lockup-byline").after(n)});jQuery(".feed-item-container").removeClass("yt-uix-tile");jQuery(".feed-item-container").each(function(){jQuery(this).removeClass("yt-uix-tile")})},1050)});jQuery(document).on("click",".tb-notification-comment-reply",function(e){e.stopPropagation()});jQuery(document).on("click",".tb-layout-notification-reply",function(e){TBUtilities.Log(".tb-layout-notification-reply");var t=jQuery(this).attr("data-comment-id");TBUtilities.Log(t);if(jQuery("#tb-layout-notification-item-"+t).is(":visible")){jQuery("#tb-layout-notification-item-"+t).hide()}else{jQuery("#tb-layout-notification-item-"+t).show()}TBUtilities.Log("#tb-layout-notification-item-"+t);TBUtilities.Log(jQuery("#tb-layout-notification-item-"+t).length);e.stopPropagation()});jQuery(document).on("click",".tb-layout-notification-cancel-button",function(e){TBUtilities.Log(".tb-layout-notification-cancel-button");jQuery(this).closest(".tb-layout-notification-comment-block").hide();jQuery(this).closest(".tb-layout-notification2-comment-block").hide();e.stopPropagation()});jQuery(document).on("click",".tb-layout-notification-reply-button",function(e){TBUtilities.Log(".tb-layout-notification-reply-button");var t=jQuery(this).attr("data-comment-id");var i=jQuery("#tb-notification-comment-reply-"+t).val();TBUtilities.Log(i);TBUtilities.Log(t);if(!i){TBUtilities.Alert("You must enter a Comment");return}var o=TBUtilities.ReplaceAll(t,"_",".");jQuery(this).attr("disabled","disabled");var a=jQuery.param({ParentCommentId:o,CommentText:i});TBExtension.Post(TBGlobal.host+TBGlobal.apiUrls.youtubeApiPostCommentReply,a,"TBLayoutPostCommentReply",{commentId:t});jQuery("#tb-layout-notification-reply-loading-"+t).show();TBUtilities.AddAction(null,TBUtilities.ActionTypes.NotificationMenu_PostCommentReply,"navwindowcomments");e.stopPropagation()});TBGlobal.AddProfileUpdateListener(S);var e=document.querySelector("title");if(c==null){c=window.location.toString()}var i=new MutationObserver(function(e){if(e&&e.length>0){console.log(e[0].target.nodeValue)}if(c!=window.location.toString()){c=window.location.toString();TBUtilities.Log("tile and url updated");TBGlobal.LoadModules(null,true)}});var o={subtree:true,characterData:true,childList:true};i.observe(e,o);jQuery(document).on("click",".tb-layout-competitor-analysis-link-hidden",function(){s=true;j();H();TubeBuddyCompetitorAnalysis.Show()});jQuery(document).on("click","#tb-layout-debug-toggle",function(){if(jQuery(this).hasClass("yt-uix-button-destructive")){jQuery(this).removeClass("yt-uix-button-destructive");jQuery(this).addClass("yt-uix-button-payment");jQuery(this).find("span").text("Debug mode ON");jQuery("body").append(jQuery("#tb-debug-modal-template").html());b=jQuery("html").html()}else{jQuery(this).addClass("yt-uix-button-destructive");jQuery(this).removeClass("yt-uix-button-payment");jQuery(this).find("span").text("Debug mode OFF");jQuery("#tb-debug-modal:first").remove()}});jQuery(document).on("click","#tb-layout-debug-send",function(){jQuery(this).prop("disabled",true);jQuery(this).find("span").text("Sending....");k()});jQuery(document).on("click",".tb-layout-generate-music",function(){s=true;j();H();jQuery("#tb-jukedeck-container").show();TubeBuddyMusic.LoadGeneratedTracks()});jQuery(document).on("click",".tb-module-close",function(){jQuery(this).closest(".tb-module-template").hide();TubeBuddyLayout.HideBackground()});jQuery(document).on("click",".tb-layout-realtime-analytics",function(){q();j()});jQuery(document).on("click","#tb-popout-messages-tab-header",function(){jQuery.each(TBGlobal.Profile().SystemMessageProductUpdates,function(e,t){TBExtension.SetDbValue("tbMessage"+t.Id,true)})});jQuery(document).on("click",".tb-show-upgrade-page",function(){TBGlobal.ShowUpgradePage()});jQuery(document).on("click",".tb-layout-view-diagnostics",function(){jQuery(".tb-layout-diagnostics").show();jQuery(this).hide()});jQuery(document).on("click",".tb-show-upgrade-page-featured",function(){TBGlobal.ShowUpgradePage(null,"featured")});jQuery(document).on("click",".tb-show-upgrade-page-support",function(){TBGlobal.ShowUpgradePage(null,"support")});jQuery(document).on("click",".tb-layout-feature-suggest-link",function(){X(TubeBuddyLayout.Tabs.SubmitIdea)});jQuery(document).on("click",".tb-layout-send-to-tubebuddy",function(){var e=TBGlobal.GetDiagnostics()+"<br><br><br>\n\n\n"+TBGlobal.UserDebugCode();TBUtilities.AddActivityLog({Data:diagnostics},TBUtilities.ActivityLogTypes.Layout_SubmitDebugCode);jQuery(".tb-layout-diagnostics").hide();TBUtilities.Alert("Thanks! We will look at the data and get back to you if needed.")});jQuery(document).on("focus",".yt-commentbox-text, .comment-simplebox-text, textarea.iron-autogrow-textarea",function(){jQuery(".tb-emoji-toggle").hide();jQuery(this).before('<span style="position:absolute; right:2px; top:-1px; opacity:.7; z-index:99999999" class="tb-emoji-toggle"><img src="'+TBGlobal.host+'/images/modules/emoji/face.png" style=" cursor:pointer; position:relative; top:5px;" /></span>')});jQuery(document).on("click",".tb-emoji-toggle",function(){if(TBExtension.GetType()=="safari"){window.open("http://getemoji.com")}else{var e=jQuery(this).next();if(e.attr("tb-emoji-added")!=="1"){e.emojiPicker({height:"300px",width:"450px",button:false});e.attr("tb-emoji-added","1")}e.emojiPicker("toggle")}});jQuery(document).on("click",".tb-layout-goto-rating",function(){TBExtension.SetDbValue("tb-rated-chrome-store",true);jQuery(".tb-layout-goto-rating-container").hide()});jQuery(document).on("click",".tb-layout-goto-firefox-rating",function(){TBExtension.SetDbValue("tb-rated-firefox-store",true);jQuery(".tb-layout-goto-firefox-rating-container").hide()});jQuery(document).on("click","#tb-modal-overlay",function(){if(t){K();jQuery(".tb-layout-menu-dropdown:first").hide()}if(!s)W()});jQuery(document).on("click","#tb-modal-overlay-menu",function(){K();jQuery(".tb-layout-menu-dropdown:first").hide()});jQuery(document).on("click",".tb-manage-account-close",function(){W()});jQuery(document).on("click",".tb-popout-tab-header",function(){try{var e=jQuery(this).attr("data-tab-id");switch(e){case"tb-popout-home-tab":M();break}jQuery(".tb-popout-tab").hide();jQuery("#"+jQuery(this).attr("data-tab-id")).fadeIn();jQuery(".tb-popout-tab-header").removeClass("selected");jQuery(this).addClass("selected")}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyLayout] tb-popout-tab-header [click]"})}});jQuery(document).on("click","#tb-layout-home-subscribe-to-tubebuddy",function(){TubeBuddyYouTubeActions.SubscribeToChannel("UCo33niDKpTpgwZ_dohqvylg","");jQuery("#tb-layout-home-issubscribed").show();jQuery("#tb-layout-home-subscribe-to-tubebuddy").hide()});jQuery(document).on("click",".tb-layout-links-my-account",function(){X(TubeBuddyLayout.Tabs.Profile)});jQuery(document).on("click",".tb-layout-links-home",function(){X(TubeBuddyLayout.Tabs.Home)});jQuery(document).on("click",".tb-layout-links-submit-idea",function(){X(TubeBuddyLayout.Tabs.SubmitIdea)});jQuery(document).on("click",".tb-my-videos, .tb-pop-out-token-error",function(){if(jQuery(".tb-layout-menu-dropdown:first").is(":visible")){K();jQuery(".tb-layout-menu-dropdown:first").hide()}else{D(d||l)}});jQuery(document).on("click","#yt-masthead-content",function(){if(jQuery(".tb-layout-menu-dropdown:first").is(":visible")){K();jQuery(".tb-layout-menu-dropdown:first").hide()}});jQuery(document).on("click","#tb-modal-overlay",function(){if(!s)W();j()});jQuery(document).on("click",".tb-layout-tag-explorer-link",function(){s=true;j();H();var e=jQuery(this);TBUtilities.Log(jQuery(".video-settings-tag-chips-container").length);if(jQuery(".video-settings-tag-chips-container").length>0)e=jQuery(".video-settings-add-tag:first");TBUtilities.Log(jQuery(".video-settings-add-tag:first").length);TubeBuddyTagExplorer.ShowTagExplorer(null,e)});jQuery(document).on("click",".tb-layout-topic-generator-link",function(){s=true;j();H();TubeBuddyTopicGenerator.Show()});jQuery(document).on("click",".tb-layout-best-time-to-publish-link",function(){s=true;j();H();TubeBuddyBestTimeToPublish.ShowBestTimeToPublish()});jQuery(document).on("click",".tb-layout-tag-lists-link",function(){s=true;j();H();TubeBuddyTagLists.Show()})};var B=function(){jQuery("#tb-layout-support-widget-loading").hide()};var k=function(e){jQuery("#tb-layout-debug-toggle").addClass("yt-uix-button-destructive");jQuery("#tb-layout-debug-toggle").removeClass("yt-uix-button-payment");jQuery("#tb-layout-debug-toggle").find("span").text("Debug mode OFF");var t=jQuery("html").html();var i=TBUtilities.GetDebugEntries();html2canvas(document.body,{onrendered:function(e){var o=jQuery.param({StartingHTML:b,EndingHTML:t,ScreenShot:e.toDataURL(),Logs:i});TBExtension.Post(TBGlobal.host+TBGlobal.apiUrls.debugAddLog,o);jQuery("#tb-debug-modal:first").remove();b="";TBUtilities.Alert("Thanks! We will review the info and get back to you.")}})};var L=function(){jQuery(".tb-pop-out-token-error").show()};var U=function(){jQuery(".tb-pop-out-token-error").hide()};var C=function(){var e=TBGlobal.GetYouTubeUI();var t=null;switch(e){case"material":{t="#page-manager";break}case"studio":case"default":{t="#content";break}}return t};var A=function(){var e="Please review our Privacy Policy and Terms of Use and check the boxes that you agree before logging in.";jQuery("#tb-sign-in-link").attr("href","#");jQuery("#tb-sign-in-link").css("cursor","default");jQuery("#tb-sign-in-link").attr("title",e);var t=jQuery("#tb-sign-in-img").attr("src");jQuery("#tb-sign-in-img").attr("src",t.replace("login.png","login-disabled.png"));jQuery("#tb-privacy").css("display","block");jQuery("#tb-sign-in-link").off("click");jQuery("#tb-sign-in-link").click(function(t){t.preventDefault();alert(e);jQuery(".required-checkbox-container").css("background-color","yellow");return false})};var S=function(){try{if(TBGlobal.Profile()==null){TBGlobal.ReloadProfile();TBYouTubeApi.GetChannelDetails(TBGlobal.CurrentChannelId(),null,P);var e=TBUtilities.GetCookie("GdprApprovalDate");if(!e){A()}return}jQuery("#tb-layout-settings-comment-canned-responses").prop("checked",TBGlobal.Profile().SettingsShowCommentCannedResponses);jQuery("#tb-layout-settings-community-connect").prop("checked",TBGlobal.Profile().SettingsShowCommunityConnect);jQuery("#tb-popout-channel-thumbnail").attr("src",TBGlobal.Profile().ThumbnailUrl);jQuery("#tb-popout-insider-thumbnail").attr("src",TBGlobal.Profile().ThumbnailUrl);jQuery("#tb-popout-channel-title").text(TBGlobal.Profile().Title);var t=TBGlobal.Profile().LicenseName;if(TBGlobal.Profile().NetworkType>=1){t+=' | <img style="height:16px; position:relative; top:2px;" src="'+TBGlobal.host+TBGlobal.Profile().NetworkLogoUrl+'" /> <a target="_blank" href="'+TBGlobal.Profile().NetworkWebsite+'">'+TBGlobal.Profile().NetworkName+"</a>"}jQuery("#tb-layout-license-name").html(t);jQuery(".tb-popout-channel-thumbnail").attr("src",TBGlobal.Profile().ThumbnailUrl);jQuery(".tb-popout-channel-title").text(TBGlobal.Profile().Title);if(TBGlobal.Profile().ThumbnailUrl==null||TBGlobal.Profile().ThumbnailUrl==""){TBYouTubeApi.GetChannelDetails(TBGlobal.CurrentChannelId(),null,P)}if(TBGlobal.Profile().UserIdForLoginLink!=null)jQuery("#tb-layout-my-account").attr("href",TBGlobal.host+"/account?UserIdForLoginLink="+TBGlobal.Profile().UserIdForLoginLink);else jQuery("#tb-layout-my-account").attr("href",TBGlobal.host+"/account?EmailHint="+TBGlobal.Profile().GoogleEmail);TBUtilities.Log("LOOKING FOR SYSTEM MESSAGES");if(TBGlobal.Profile().SystemMessages.length>0){jQuery("#tb-popout-messages-tab-header").show();jQuery("#tb-layout-messages-list").empty();if(TBGlobal.Profile().SystemMessageAlerts.length>0){l=true;var i='<div style="padding:7px 0px 0px 8px; margin-bottom:6px; margin-right:15px; background-color:red;"> <span style="color:white; font-size:18px; position:relative; top:-3px; font-weight:500">Alerts</span></div>';jQuery("#tb-layout-messages-list").append(i);jQuery.each(TBGlobal.Profile().SystemMessageAlerts,function(e,t){var i='<div style="padding:5px 5px 7px">';i+='<div style="font-size:13px; font-weight:500; padding-left:5px; color:red; margin-bottom:3px;"><img src="'+TBGlobal.host+'/images/icons/button-red.png" style="padding-right:2px; height:10px; position:relative; top:0px;" />'+t.DisplayOnDateFriendly+"</div>";i+='<div style="font-size:14px; padding-left:15px; padding-right:20px; color:#333; line-height:20px; font-weight:normal;">'+t.Message+"</div>";i+="</div>";jQuery("#tb-layout-messages-list").append(i)})}jQuery.each(TBGlobal.Profile().SystemMessageProductUpdates,function(e,t){TBExtension.GetDbValue("tbMessage"+t.Id,function(e,i){TBUtilities.Log("Unread blue: "+t.Id+": "+i);if(!i){d=true;jQuery(".tb-layout-messages-image").attr("src",TBGlobal.host+"/images/icons/button-blue.png");jQuery(".tb-layout-menu-image").css("display","none");jQuery(".tb-layout-messages-image").show()}})});if(TBGlobal.Profile().SystemMessageProductUpdates.length>0){jQuery(".tb-layout-messages-icon").attr("src",TBGlobal.host+"/images/icons/button-blue.png");jQuery(".tb-layout-messages-icon").show();var i='<div style="padding:8px 0px 0px 8px; margin-bottom:6px; margin-right:15px; background-color:#3399cc;"> <span style="color:white; font-size:18px; position:relative; top:-3px; font-weight:500">TubeBuddy Updates</span></div>';jQuery("#tb-layout-messages-list").append(i);jQuery.each(TBGlobal.Profile().SystemMessageProductUpdates,function(e,t){var i='<div style="padding:5px 5px 7px">';i+='<div style="font-size:13px; font-weight:500; padding-left:5px; color:#3399cc; margin-bottom:3px;"><img src="'+TBGlobal.host+'/images/icons/button-blue.png" style="padding-right:2px; height:10px; position:relative; top:0px;" />'+t.DisplayOnDateFriendly+"</div>";i+='<div style="font-size:14px; padding-left:15px; padding-right:20px; color:#333; line-height:20px; font-weight:normal;">'+t.Message+"</div>";i+="</div>";jQuery("#tb-layout-messages-list").append(i)})}TBUtilities.Log("Buddont");if(l){jQuery(".tb-layout-messages-icon").attr("src",TBGlobal.host+"/images/icons/button-red.png");jQuery(".tb-layout-messages-image").attr("src",TBGlobal.host+"/images/icons/button-red.png");jQuery(".tb-layout-menu-image").css("display","none");jQuery(".tb-layout-messages-icon").show();jQuery(".tb-layout-messages-image").show()}else if(d){TBUtilities.Log("blue");jQuery(".tb-layout-messages-image").attr("src",TBGlobal.host+"/images/icons/button-blue.png");jQuery(".tb-layout-menu-image").css("display","none");jQuery(".tb-layout-messages-image").show()}}else{jQuery("#tb-popout-messages-tab-header").hide()}var o=jstz.determine_timezone();var a=o.timezone;if(a!="undefined"){a.ambiguity_check()}var n=a.utc_offset;var r="";if(TBGlobal.Profile()!=null)r="&agencyid="+encodeURIComponent(TBGlobal.Profile().AgencyId);if(r==null)r="";jQuery(".tb-missing-token-oauth-link-add").attr("href",TBGlobal.host+"/oauth/AuthRedirect?channelid="+TBGlobal.CurrentChannelId()+"&redirectUrl="+encodeURIComponent(window.location)+"&timeZoneOffset="+encodeURIComponent(n)+"&agencyId="+r+"&via=extension&channelId="+TBGlobal.CurrentChannelId());jQuery("#tb-layout-linked-channels-list").empty();if(TBGlobal.Profile().NetworkType>=1){jQuery("#tb-layout-profile-network-checking").hide();jQuery("#tb-layout-profile-network-check").hide();jQuery("#tb-popout-profile-has-network").html('<img src="'+TBGlobal.host+TBGlobal.Profile().NetworkLogoUrl+'" style="height:15px; margin-right:3px; position:relative; top:1px; left:1px" /> '+TBGlobal.Profile().NetworkName);jQuery("#tb-popout-profile-has-network").attr("href",TBGlobal.Profile().NetworkWebsite);jQuery("#tb-popout-profile-has-network").show()}if(TBGlobal.Profile().EnableDebug&&TBGlobal.Profile().EnableDebug==true){jQuery("#tb-layout-debug-panel").show();jQuery("#tb-layout-support-panel").css("margin-bottom","0px")}if(TBGlobal.Profile().IsSubscribedToTubeBuddy===true){TBUtilities.Log("Is Subscribed to TubeBuddy")}else if(TBGlobal.Profile().IsSubscribedToTubeBuddy===false){TBUtilities.Log("Is NOT Subscribed to TubeBuddy");jQuery("#tb-layout-tb-tools-container").css("max-height","320px");jQuery("#tb-layout-tb-tools-subscribe-tb").show()}else{TBUtilities.Log("NULL Subscribed to TubeBuddy");TBExtension.Get("https://www.youtube.com/channel/UCo33niDKpTpgwZ_dohqvylg","tbLayoutGetTubeBuddyPage")}if(TBGlobal.Profile().IsLoggedIn){jQuery("#tb-layout-web-signed-out").hide();jQuery("#tb-layout-web-signed-in").show()}else{var o=jstz.determine_timezone();var a=o.timezone;if(a!="undefined"){a.ambiguity_check()}var n=a.utc_offset;jQuery("#tb-layout-sign-in-button").attr("href",TBGlobal.host+"/oauth/AuthRedirectLogin/?channelid="+TBGlobal.CurrentChannelId()+"&redirectUrl="+encodeURIComponent(window.location)+"&timeZoneOffset="+encodeURIComponent(n)+"&via=extension&channelId="+TBGlobal.CurrentChannelId());jQuery("#tb-layout-web-signed-out").show();jQuery("#tb-layout-web-signed-in").hide()}jQuery("#tb-layout-logged-in-email").text(TBGlobal.Profile().Email)}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyLayout] loadProfile"})}};var E;var I=function(e){try{E=chanel;TBYouTubeApi.GetChannelDetails(TBUtilities.GetUrlParameter("cid"),null,G)}catch(e){}};var G=function(e){try{var t=""}catch(e){}};var R=function(){jQuery(document.body).on("tbLayoutGetTubeBuddyPage",function(e,t){TBUtilities.Log("tbLayoutGetTubeBuddyPage");try{if(t.success){TBUtilities.Log(t.response.length);var i=t.response.lastIndexOf(',"subscribed":')+',"subscribed":'.length;TBUtilities.Log("START: "+i);TBUtilities.Log("VAL: "+t.response.substring(i,i+1));var o=t.response.substring(i,i+1);if(o!="t"){TBUtilities.Log("Not Subscribed");jQuery("#tb-layout-tb-tools-container").css("max-height","320px");jQuery("#tb-layout-tb-tools-subscribe-tb").show();TBExtension.Get(TBGlobal.host+TBGlobal.apiUrls.youtubeChannelMarkAsNotSubscribedToTubeBuddy,"")}else{TBUtilities.Log("Subscribed");TBExtension.Get(TBGlobal.host+TBGlobal.apiUrls.youtubeChannelMarkAsSubscribedToTubeBuddy,"")}}}catch(e){}});jQuery(document.body).on("TBLayoutPostCommentReply",function(e,t){TBUtilities.Log("TBLayoutPostCommentReply");TBUtilities.Log(e);TBUtilities.Log(t);try{if(t.success){var i=t.data.commentId;if(t.response=='"success"'){jQuery("#tb-layout-notification-item-"+i+"-post").hide();jQuery("#tb-layout-notification-item-"+i+"-posted").show();jQuery("#tb-layout-notification-reply-"+i).hide();jQuery("#tb-layout-notification-reply-loading-"+i).hide();jQuery("#tb-layout-notification-"+i).hide()}else{TBUtilities.Alert("Sorry, there was a problem posting your comment.\r\n\r\nError: "+t.response)}}else{TBUtilities.Alert("Sorry, there was a problem posting your comment.\r\n\r\nIf this continues, contact TubeBuddy")}}catch(e){}});jQuery(document.body).on("TBWindowMessage",function(e,t){try{if(t.settings.tab==null)t.settings.tab="profile";var i=0;switch(t.settings.tab){case"support":i=3;break}W();TubeBuddyLayout.ShowTubeBuddyPanel(i)}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyLayout] CRTBWindowMessage"})}});jQuery(document.body).on("TBGetRandomGuid",function(e,t){try{if(t.success){var i=jQuery.parseJSON(t.response);if(i!=null&&i.length==36){jQuery(".tb-missing-token-oauth-link").each(function(e,t){var o=jQuery(this).prop("href");var a=TBUtilities.UpdateUrlParameter(o,"agencyid",i);jQuery(this).prop("href",a)})}}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyLayout] CRTBGetRandomGuid"})}});jQuery(document.body).on("TBLoadLayoutLoadMilestones",function(e,t){TBUtilities.Log("TBLoadLayoutLoadMilestones");TBUtilities.Log(t);try{if(t.success){TBExtension.SetDbValue("tb-last-milestone-fetch-"+TBGlobal.CurrentChannelId(),(new Date).toString(),"");TBUtilities.Log("Added DB Value - "+new Date);var i=JSON.parse(t.response);if(i.Milestones.length>0){var o=false;var a=0;jQuery.each(i.Milestones,function(e,t){TBUtilities.Log("Loop : foundRecent="+o+"   and newItems="+a);TBUtilities.Log(t.MilestoneText);TBUtilities.Log("_recentMilestoneItem: "+h);if(h==t.MilestoneText)o=true;if(!o)a++;var i=jQuery("#tb-milestone-item-template").html();i=TBUtilities.ReplaceAll(i,"{0}",TBGlobal.host+"/content/images/mobile/icons/Milestone"+t.MilestoneTypeFriendly+".png");i=TBUtilities.ReplaceAll(i,"{1}",t.MilestoneValueFriendly+" "+t.MilestoneTypeFriendly);i=TBUtilities.ReplaceAll(i,"{2}",t.MilestoneText);i=TBUtilities.ReplaceAll(i,"{3}",TBGlobal.host+t.CertificateUrl);i=TBUtilities.ReplaceAll(i,"{4}","https://www.facebook.com/sharer/sharer.php?u="+TBUtilities.GetUrlEncoded(TBGlobal.host+t.CertificateUrl));i=TBUtilities.ReplaceAll(i,"{5}","https://twitter.com/intent/tweet?text="+"My channel reached the "+t.MilestoneValueFriendly+" "+t.MilestoneTypeFriendly+" Milestone! &#x1f3c6; via @TubeBuddy "+TBUtilities.GetUrlEncoded(TBGlobal.host+t.CertificateUrl));jQuery("#tb-industry-milestones-container").append(i)});TBExtension.SetDbValue("tb-last-milestone-fetch-item-"+TBGlobal.CurrentChannelId(),i.Milestones[0].MilestoneText,"");if(a>0){jQuery("#tb-popout-milestones-tab-header-count").text(a);jQuery("#tb-popout-milestones-tab-header-count").fadeIn(1e3)}}else{jQuery("#tb-industry-milestones-container").append('<div style="padding:10px 14px">Sorry, no Milestones found in the last 30 days. <div style="padding-top:6px;">Come back when you hit your next Milestone (listed below)</div></div>')}jQuery("#tb-layout-views-next").html(i.NextViewsMilestone.MilestoneValueFriendly);jQuery("#tb-layout-sub-next").html(i.NextSubscribersMilestone.MilestoneValueFriendly);jQuery("#tb-layout-uploads-next").html(i.NextUploadsMilestone.MilestoneValueFriendly);jQuery("#tb-layout-views-to-go").html("~"+i.NextViewsMilestone.MilestoneToGoValueFriendly+" to go");jQuery("#tb-layout-sub-to-go").html("~"+i.NextSubscribersMilestone.MilestoneToGoValueFriendly+" to go");jQuery("#tb-layout-uploads-to-go").html("~"+i.NextUploadsMilestone.MilestoneToGoValueFriendly+" to go");jQuery("#tb-industry-milestones-loading").hide();jQuery("#tb-industry-milestones-container").show();jQuery("#tb-industry-milestones-container-next").show()}else{}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyLayout] CRTBProfileUpdated"})}});jQuery(document.body).on("TBProfileUpdated",function(e,t){try{if(t.success){jQuery("#tb-popout-profile-save-button").text("Save Changes");jQuery("#tb-popout-success-message").hide();jQuery("#tb-popout-success-message").fadeIn();jQuery("#tb-popout-success-message-text").text("Your changes have been successfully saved!");TBGlobal.ReloadProfile()}else{}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyLayout] CRTBProfileUpdated"})}});jQuery(document.body).on("TBLoadLayoutTemplate",function(e,t){try{if(t.success){t.response=TBUtilities.FixLocalHtml(DOMPurify.sanitize(t.response,DOMPurifyConfig));jQuery("body").append(t.response);jQuery("#tb-modal-overlay-menu").insertBefore("#body-container");jQuery("#tb-layout-login-webiste").attr("href",TBGlobal.host+"/oauth/AuthRedirectLogin/?channelid="+TBGlobal.CurrentChannelId()+"&redirectUrl="+encodeURIComponent(window.location)+"&timeZoneOffset="+encodeURIComponent(c)+"&via=extension&channelId="+TBGlobal.CurrentChannelId());var i=TBGlobal.GetYouTubeUI();TBUtilities.Log("TBLayout - TBLoadLayoutTemplate YouTubeUI = "+i);switch(i){case"material":{if(jQuery("#end").length>0){jQuery("#end").prepend(jQuery(".tb-layout-menu-container:last")[0].outerHTML);jQuery("#tb-modal-overlay-menu").css("z-index",2e3)}else{jQuery("#yt-masthead-user").prepend(jQuery(".tb-layout-menu-container:last")[0].outerHTML)}break}case"default":{jQuery("#yt-masthead-user").prepend(jQuery(".tb-layout-menu-container:last")[0].outerHTML);break}case"studio":{jQuery("#tb-layout-youtube-dashboard").attr("href","https://studio.youtube.com/channel/"+TBGlobal.CurrentChannelId());jQuery("#tb-layout-youtube-my-videos").attr("href","https://studio.youtube.com/channel/"+TBGlobal.CurrentChannelId()+"/videos/upload");jQuery("#tb-layout-youtube-my-playlists").attr("href","https://www.youtube.com/view_all_playlists");jQuery("#tb-layout-youtube-live-streaming").attr("href","https://studio.youtube.com/channel/"+TBGlobal.CurrentChannelId()+"/videos/live");jQuery("#tb-layout-youtube-comments").attr("href","https://studio.youtube.com/channel/"+TBGlobal.CurrentChannelId()+"/comments");jQuery("#tb-layout-youtube-subscribers").attr("href","https://www.youtube.com/subscribers");jQuery("#tb-layout-youtube-analytics").attr("href","https://studio.youtube.com/channel/"+TBGlobal.CurrentChannelId()+"/analytics/tab-overview/period-4_weeks");jQuery("#tb-layout-youtube-real-time").attr("href","https://www.youtube.com/analytics?o=U#r=realtime");jQuery("#tb-layout-youtube-messages").attr("href","https://www.youtube.com/messages");jQuery("#tb-layout-youtube-my-playlists").text("Playlists (Classic)");jQuery("#tb-layout-youtube-subscribers").text("Subscribers (Classic)");jQuery("#tb-layout-youtube-real-time").css("display","none");jQuery(document).on("click",".tb-layout-youtube-menu-item",function(){j()});jQuery("#left-nav").css("border-right","0");jQuery("#video-list").css("border-left","solid 1px #ddd");var a=jQuery("ytcp-icon-button#search-icon").css("visibility");if(a=="hidden")jQuery("ytcp-icon-button#search-icon").after(jQuery(".tb-layout-menu-container:last")[0].outerHTML);else jQuery("ytcp-icon-button#search-icon").before(jQuery(".tb-layout-menu-container:last")[0].outerHTML);var n=jQuery("#tb-modal-overlay-menu")[0].outerHTML;jQuery("#tb-modal-overlay-menu").remove();jQuery("#main-container").prepend(n);jQuery("#tb-modal-overlay-menu").css("z-index","2");jQuery(".tb-layout-menu-container").css("bottom","-5px");jQuery("#tb-main-menu").removeClass("tb-button-default");var r=TBExtension.GetFilePath("images/branding/icon_tiny_white.png");var s=TBExtension.GetFilePath("images/icons/menu_white.png");jQuery("#tb-main-menu").find("img:first").attr("src",r);jQuery(".tb-layout-menu-image").attr("src",s);jQuery("#main-container").prepend("<style type='text/css'> #tb-main-menu { background-color:#bf3730 !important; border:0px !important; border-radius:2px; }</style>");break}}jQuery(".tb-my-videos").show();jQuery(".tb-layout-channel-dashboard-link").attr("href",TBGlobal.host+"/channel/healthreport/"+TBGlobal.CurrentChannelId());var l=C();jQuery(l).append(jQuery(".tb-content-flag").clone().attr("data-is-flag","true")[0].outerHTML);jQuery("#tb-popout-channel-title").attr("href","https://www.youtube.com/channel/"+TBGlobal.CurrentChannelId());var d=jstz.determine_timezone();var u=d.timezone;if(u!="undefined"){u.ambiguity_check()}var c=u.utc_offset;var p="";if(TBGlobal.Profile()!=null)p="&agencyid="+encodeURIComponent(TBGlobal.Profile().AgencyId);if(p==null)p="";jQuery(".tb-missing-token-oauth-link").attr("href",TBGlobal.host+"/oauth/AuthRedirect?channelid="+TBGlobal.CurrentChannelId()+"&redirectUrl="+encodeURIComponent(window.location)+"&timeZoneOffset="+encodeURIComponent(c)+p+"&via=extension&channelId="+TBGlobal.CurrentChannelId());jQuery(".tb-missing-token-oauth-link").attr("data-url",TBGlobal.host+"/oauth/AuthRedirect?channelid="+TBGlobal.CurrentChannelId()+"&redirectUrl="+encodeURIComponent(window.location)+"&timeZoneOffset="+encodeURIComponent(c)+p+"&via=extension&channelId="+TBGlobal.CurrentChannelId());if(TBGlobal.Profile()==null||!TBGlobal.Profile().HasAccessToken){if(TBGlobal.Profile()==null)TBGlobal.AddDiagnostic("lllt:PN");else if(!TBGlobal.Profile().HasAccessToken)TBGlobal.AddDiagnostic("lllt:NAT");L()}else{U();jQuery("#tb-layout-research-tools").show();jQuery("#tb-layout-web-tools").show();jQuery("#tb-industry-news-container").empty();jQuery.each(TBGlobal.Profile().NewsItems,function(e,t){var i=jQuery("#tb-news-item-template").html();i=TBUtilities.ReplaceAll(i,"{0}",TBGlobal.host+"/images/mobile/industrynews/"+t.SourceNameNoSpace+".png");i=TBUtilities.ReplaceAll(i,"{1}",t.ShortenedUrl);i=TBUtilities.ReplaceAll(i,"{2}",t.Title);i=TBUtilities.ReplaceAll(i,"{3}",t.Preview);i=TBUtilities.ReplaceAll(i,"{4}",t.DateFriendly);TBUtilities.Log(t);jQuery("#tb-industry-news-container").append(i)})}if(o){jQuery("#tb-layout-logged-in").show();if(TBGlobal.GetYouTubeUI()=="studio"){jQuery("#tb-layout-logged-in-link").css("color","white")}jQuery("#tb-layout-logged-in-link").attr("href","https://www.youtube.com/channel/"+TBUtilities.GetUrlParameter("cid"));if(jQuery("#tb-pop-out-token-error-id").is(":visible")){jQuery("#tb-layout-logged-in").hide();var b='<div><b style="color:red; font-size:1.2em">Oops! You selected the wrong channel.</b></div>';b+='<div style="padding:13px 0 10px;">Here is a link to the channel you selected: <br><a target="_blank" href="https://www.youtube.com/channel/'+TBUtilities.GetUrlParameter("cid")+'">https://www.youtube.com/channel/'+TBUtilities.GetUrlParameter("cid")+"</a></div>";b+='<div style="padding:13px 0 10px;">This is the channel you\'re logged into YouTube with and should be selecting: <br><a target="_blank" href="https://www.youtube.com/channel/'+TBGlobal.CurrentChannelId()+'">https://www.youtube.com/channel/'+TBGlobal.CurrentChannelId()+"</a></div>";b+="<div style=\"padding:3px 0 10px;\">Sometimes the channel you select has the same logo and/or name so you think it's the same channel but it's actually not. So please try signing in again and selecting the channel that you're currently logged into YouTube with.</div>";TBUtilities.Alert(b)}}m();M();S()}else{}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyLayout] CRTBLoadLayoutTemplate"})}})};var P=function(e){try{if(!e||!e.Snippet||!e.Snippet.Thumbnails)return;TBUtilities.Log(e);jQuery("#tb-popout-channel-thumbnail").attr("src",e.Snippet.Thumbnails.ThumbnailDefault);jQuery("#tb-popout-insider-thumbnail").attr("src",e.Snippet.Thumbnails.ThumbnailDefault);jQuery("#tb-popout-channel-title").text(e.Snippet.Title);if(TBGlobal.Profile()==null||TBGlobal.Profile().ThumbnailUrl==null||TBGlobal.Profile().ThumbnailUrl==""){var t=jQuery.param({id:TBGlobal.CurrentChannelId(),thumbnailUrl:e.snippet.thumbnails.default.url,title:e.snippet.title})}}catch(t){TBUtilities.LogError({Exception:t,Location:"[TubeBuddyLayout] gotChannelDetails [[[Channel Results: "+JSON.stringify(e)+"]]]"})}};var D=function(e){jQuery(".tb-layout-version-number").text("v"+TBExtension.GetExtensionVersion());try{var t=jQuery("#player").length>0;var i=navigator.userAgent.indexOf("Firefox")>-1;var o=document.location.href.indexOf("/watch")>-1;if(t&&i&&o){jQuery("#watch-header")[0].scrollIntoView()}}catch(e){}N();V();jQuery(".tb-layout-menu-dropdown").show();if(u==-1){if(TBGlobal.IsAuthenticated())if(e==true)X(TubeBuddyLayout.Tabs.Messages,true);else X(TubeBuddyLayout.Tabs.ThisPage,true);else X(TubeBuddyLayout.Tabs.Profile,true)}clearTimeout(n);n=null};var V=function(){TBUtilities.Log("Checking Milestones");TBExtension.GetDbValue("tb-last-milestone-fetch-"+TBGlobal.CurrentChannelId(),"tbGetLastMilestone");TBExtension.GetDbValue("tb-last-milestone-fetch-item-"+TBGlobal.CurrentChannelId(),"tbGetLastMilestoneItem")};var _=function(){try{if(TBGlobal.GetToken()==null||TBGlobal.GetToken().trim()==""){if(TBGlobal.GetToken()==null)TBGlobal.AddDiagnostic("lrte:GT");if(TBGlobal.GetToken()=="")TBGlobal.AddDiagnostic("lrte:ES");L()}else{U()}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyLayout] refreshTokenError"})}};var M=function(){var e=f.general;var t=window.location.href;if(t.indexOf("/discussion")>0){e=f.channel_discussion}if(t.indexOf("youtube.com/edit")>0){e=f.video_edit}if(t.indexOf("youtube.com/my_videos")>0&&t.indexOf("youtube.com/my_videos_annotate")==-1){e=f.my_videos}if(t.indexOf("youtube.com/results")>0){e=f.search_results}if(t.indexOf("youtube.com/subscribers")>0){e=f.subscribers}if(t.indexOf("youtube.com/upload_defaults")>0){e=f.upload_defaults}else if(t.indexOf("youtube.com/upload")>0){e=f.upload}if(t.indexOf("youtube.com/my_videos_annotate")>0){e=f.annotations}if(t.indexOf("youtube.com/cards")>0){e=f.cards}if(t.indexOf("youtube.com/watch")>0){e=f.video_watch}if(t.indexOf("youtube.com/comments")>0){e=f.comments}if(t.indexOf("youtube.com/c/")>0||t.indexOf("youtube.com/user/")>0||t.indexOf("youtube.com/channel/")>0){e=f.channel}if(t.indexOf("youtube.com/playlist")>0||t.indexOf("/playlist")>0&&(t.indexOf("youtube.com/channel/")>0||t.indexOf("youtube.com/user/")>0||t.indexOf("youtube.com/c/")>0)){e=f.playlists}jQuery("#tb-layout-current-page-label").text(e.name);jQuery("#tb-layout-tb-tools-container").empty();jQuery("#tb-layout-tb-resources-container").empty();jQuery.each(TBGlobal.GetToolsOnPage(e.name),function(e,t){var i=jQuery(".tb-layout-tb-feature-container:last")[0].outerHTML;i=TBUtilities.ReplaceAll(i,"#TITLE#",t.name);i=TBUtilities.ReplaceAll(i,"#DESCRIPTION#",t.summary);i=TBUtilities.ReplaceAll(i,"#TOOLTIP#","");i=TBUtilities.ReplaceAll(i,"#URL#",TBGlobal.host+"/tools?tool="+t.id);if(t.howToVideoId)i=TBUtilities.ReplaceAll(i,"#THUMBNAILURL#","https://i.ytimg.com/vi/"+t.howToVideoId+"/mqdefault.jpg");else i=TBUtilities.ReplaceAll(i,"#THUMBNAILURL#","https://yt3.ggpht.com/-ajEGKkfBLmM/AAAAAAAAAAI/AAAAAAAAAAA/LvxQt9F7it0/s176-c-k-no/photo.jpg");jQuery("#tb-layout-tb-tools-container").append(i)})};var O=function(){jQuery("#tb-popout-success-message").hide()};var F=function(e){p.push(e)};var N=function(){jQuery("#tb-modal-overlay-menu").show()};var Y=function(){s=false;jQuery("#tb-modal-overlay").css("cursor","default");jQuery("#tb-modal-overlay").show();q()};var H=function(){s=true;jQuery("#tb-modal-overlay").css("cursor","no-drop");jQuery("#tb-modal-overlay").show();q()};var z=function(){var e='<a target="_blank" href="http://status.tubebuddy.com" onclick="TBUtilities.Alert(\'Sorry, it looks like the TubeBuddy.com website is currently down. This can temporarily happen while we publish updates to our tools.\\n\\nThis message will automatically go away and TubeBuddy functionality will come back when the site is back online.\\n\\nIn the meantime, you can visit http://status.tubebuddy.com to get the current status.\');" class="yt-uix-button yt-uix-button-default yt-uix-button-size-default" style="margin-right: 10px; padding-right:5px;"><span class="yt-uix-button-content" style="vertical-align: middle; color:red; font-size:11px; font-weight:500">TubeBuddy &#9888;&nbsp;</span></a>';jQuery("#yt-masthead-user").prepend(e)};var W=function(){jQuery("#tb-modal-overlay").hide();jQuery.each(p,function(e,t){t()})};var q=function(){jQuery("#tb-modal-overlay-menu").hide()};var X=function(e,i){try{S();t=true;if(i==null)N();if(e==null)e=8;if(!TBGlobal.IsAuthenticated()){jQuery("#tb-popout-profile-missing-tab-header").show();jQuery("#tb-popout-submit-idea-tab-header").hide();jQuery("#tb-popout-settings-tab-header").hide();jQuery("#tb-popout-this-page-tab-header").hide()}if(e!=u){switch(e){case 0:if(TBGlobal.IsAuthenticated()){jQuery("#tb-popout-account-tabs-missing-token").hide();jQuery("#tb-popout-profile-tab").show();jQuery("#tb-popout-profile-tab-header").trigger("click")}else{jQuery("#tb-popout-account-tabs-missing-token").show();jQuery("#tb-popout-profile-tab").hide();jQuery("#tb-popout-profile-missing-tab-header").trigger("click")}break;case 3:break;case 4:jQuery("#tb-popout-welcome-tab-header").trigger("click");break;case 6:jQuery("#tb-popout-submit-idea-tab-header").trigger("click");break;case 7:if(TBGlobal.IsAuthenticated())jQuery("#tb-popout-home-tab-header").trigger("click");else jQuery("#tb-popout-profile-missing-tab-header").trigger("click");break;case 8:jQuery("#tb-popout-this-page-tab-header").trigger("click");break;case 9:jQuery("#tb-popout-messages-tab-header").trigger("click");break}}if(TBGlobal.Profile()!=null){if(TBGlobal.Profile().IsBanned==true){jQuery("#tb-popout-profile-missing-tab-header").hide();jQuery("#tb-popout-submit-idea-tab-header").hide();jQuery("#tb-popout-settings-tab-header").hide();jQuery("#tb-popout-this-page-tab-header").hide();jQuery(".tb-layout-menu-links-list").hide();jQuery("#tb-popout-banned-tab-header").show();jQuery("#tb-popout-banned-tab-header").trigger("click")}}jQuery(".tb-layout-menu-dropdown").find('li[style*="display:none"], li[style*="display: none"]').each(function(e,t){jQuery(t).remove()});jQuery(".tb-layout-menu-dropdown:first").show();clearTimeout(n);n=null;u=e}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyLayout] showTubeBuddyPanel"})}};var K=function(){t=false;q()};var J=function(e){var t=TBUtilities.GetActivityLogTypeValueFromString(e);switch(t){case TBUtilities.ActivityLogTypes.QuickLinksMenu_MyAccount:case TBUtilities.ActivityLogTypes.QuickLinksMenu_HealthReport:case TBUtilities.ActivityLogTypes.QuickLinksMenu_CompetitorScorecard:case TBUtilities.ActivityLogTypes.QuickLinksMenu_BrandAlerts:case TBUtilities.ActivityLogTypes.QuickLinksMenu_ABTests:case TBUtilities.ActivityLogTypes.QuickLinksMenu_BackupsAndExports:case TBUtilities.ActivityLogTypes.QuickLinksMenu_CannedResponses:case TBUtilities.ActivityLogTypes.QuickLinksMenu_Settings:case TBUtilities.ActivityLogTypes.QuickLinksMenu_CommunityForums:case TBUtilities.ActivityLogTypes.QuickLinksMenu_TipsAndTricks:case TBUtilities.ActivityLogTypes.QuickLinksMenu_SuggestAFeature:case TBUtilities.ActivityLogTypes.QuickLinksMenu_KnowledgeBase:case TBUtilities.ActivityLogTypes.QuickLinksMenu_TagExplorer:case TBUtilities.ActivityLogTypes.QuickLinksMenu_VideoTopicPlanner:case TBUtilities.ActivityLogTypes.QuickLinksMenu_BestTimeToPublish:case TBUtilities.ActivityLogTypes.QuickLinksMenu_PrivacyPolicy:case TBUtilities.ActivityLogTypes.QuickLinksMenu_TermsOfUse:TBUtilities.AddActivityLog(null,e,"quicklinksmenu");break;case TBUtilities.ActivityLogTypes.QuickLinksMenu_Dashboard:case TBUtilities.ActivityLogTypes.QuickLinksMenu_MyVideos:case TBUtilities.ActivityLogTypes.QuickLinksMenu_Playlists:case TBUtilities.ActivityLogTypes.QuickLinksMenu_LiveStreaming:case TBUtilities.ActivityLogTypes.QuickLinksMenu_Comments:case TBUtilities.ActivityLogTypes.QuickLinksMenu_Subscribers:case TBUtilities.ActivityLogTypes.QuickLinksMenu_Analytics:case TBUtilities.ActivityLogTypes.QuickLinksMenu_Realtime:TBUtilities.AddAction(null,TBUtilities.ActionTypes.QuickLinksMenu_Click,"quicklinksmenu");TBUtilities.AddActivityLog(null,e,"quicklinksmenu");break}};var $=function(){var e=TBGlobal.GetYouTubeUI();if(!y){y=true;TBUtilities.Log(e)}switch(e){case"material":{var t=jQuery("#yt-masthead-user").is(":visible");var i=jQuery("#end").length>0;if(t===true||i===true){g()}else{setTimeout($,500)}break}case"studio":{var o=jQuery("div.ytcp-header").is(":visible");if(o===true){g()}else{setTimeout($,500)}break}case"default":{g();break}}};return{Initialize:function(){if(document.URL.indexOf("youtube.com")==-1||document.URL.indexOf("tubebuddy.com")>=0||document.URL.indexOf("localhost")>=0)return;if(!e){if(TBGlobal.CurrentChannelId()=="U"+"C"+"jbhDmV6Yl-nS7OQOnmgdSA"||TBGlobal.CurrentChannelId()=="U"+"C"+"3XArDZvhJ6j2697yTTPSmQ"||TBGlobal.CurrentChannelId()=="U"+"C"+"b6EhLOlLuL2PkJYGfmslGw"||TBGlobal.CurrentChannelId()=="U"+"C"+"4S0693-QVZqxBKLj7vq0Zw"){TBUtilities.ForceDebugging()}R();$();v();T();x();e=true;var t=TBExtension.GetExtensionVersion();TBUtilities.Log("TubeBuddyLayout - Extension Version: "+t)}},AddHideBackgroundListener:function(e){F(e)},LoadProfile:function(){S()},ShowComingSoon:function(e){showComingSoon(e)},ShowBackground:function(){Y()},ShowBackgroundSticky:function(){H()},HideBackground:function(){W()},ShowTubeBuddyPanel:function(e){X(e)},RefreshTokenError:function(){_()},FailedToLoadProfile:function(){z()},Tabs:{Profile:0,Support:3,Features:4,Insiders:5,SubmitIdea:6,Home:7,ThisPage:8,Messages:9}}}();!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e(require("jquery")):e(jQuery)}(function(e){function t(t,i){this.element=t,this.$element=e(this.element),this.doc=e(document),this.win=e(window),this.settings=e.extend({},r,i),"object"==typeof this.$element.data("tipso")&&e.extend(this.settings,this.$element.data("tipso"));for(var o=Object.keys(this.$element.data()),a={},l=0;l<o.length;l++){var d=o[l].replace(n,"");if(""!==d){d=d.charAt(0).toLowerCase()+d.slice(1),a[d]=this.$element.data(o[l]);for(var u in this.settings)u.toLowerCase()==d&&(this.settings[u]=a[d])}}this._defaults=r,this._name=n,this._title=this.$element.attr("title"),this.mode="hide",this.ieFade=!s,this.settings.preferedPosition=this.settings.position,this.init()}function i(t){var i=t.clone();i.css("visibility","hidden"),e("body").append(i);var o=i.outerHeight(),a=i.outerWidth();return i.remove(),{width:a,height:o}}function o(e){e.removeClass("top_right_corner bottom_right_corner top_left_corner bottom_left_corner"),e.find(".tipso_title").removeClass("top_right_corner bottom_right_corner top_left_corner bottom_left_corner")}function a(t){var n,r,s,l=t.tooltip(),d=t.$element,u=t,c=e(window),p=10,b=u.settings.background,y=u.titleContent();switch(void 0!==y&&""!==y&&(b=u.settings.titleBackground),d.parent().outerWidth()>c.outerWidth()&&(c=d.parent()),u.settings.position){case"top-right":r=d.offset().left+d.outerWidth(),n=d.offset().top-i(l).height-p,l.find(".tipso_arrow").css({marginLeft:-u.settings.arrowWidth,marginTop:""}),n<c.scrollTop()?(n=d.offset().top+d.outerHeight()+p,l.find(".tipso_arrow").css({"border-bottom-color":b,"border-top-color":"transparent","border-left-color":"transparent","border-right-color":"transparent"}),o(l),l.addClass("bottom_right_corner"),l.find(".tipso_title").addClass("bottom_right_corner"),l.find(".tipso_arrow").css({"border-left-color":b}),l.removeClass("top-right top bottom left right"),l.addClass("bottom")):(l.find(".tipso_arrow").css({"border-top-color":u.settings.background,"border-bottom-color":"transparent ","border-left-color":"transparent","border-right-color":"transparent"}),o(l),l.addClass("top_right_corner"),l.find(".tipso_arrow").css({"border-left-color":u.settings.background}),l.removeClass("top bottom left right"),l.addClass("top"));break;case"top-left":r=d.offset().left-i(l).width,n=d.offset().top-i(l).height-p,l.find(".tipso_arrow").css({marginLeft:-u.settings.arrowWidth,marginTop:""}),n<c.scrollTop()?(n=d.offset().top+d.outerHeight()+p,l.find(".tipso_arrow").css({"border-bottom-color":b,"border-top-color":"transparent","border-left-color":"transparent","border-right-color":"transparent"}),o(l),l.addClass("bottom_left_corner"),l.find(".tipso_title").addClass("bottom_left_corner"),l.find(".tipso_arrow").css({"border-right-color":b}),l.removeClass("top-right top bottom left right"),l.addClass("bottom")):(l.find(".tipso_arrow").css({"border-top-color":u.settings.background,"border-bottom-color":"transparent ","border-left-color":"transparent","border-right-color":"transparent"}),o(l),l.addClass("top_left_corner"),l.find(".tipso_arrow").css({"border-right-color":u.settings.background}),l.removeClass("top bottom left right"),l.addClass("top"));break;case"bottom-right":r=d.offset().left+d.outerWidth(),n=d.offset().top+d.outerHeight()+p,l.find(".tipso_arrow").css({marginLeft:-u.settings.arrowWidth,marginTop:""}),n+i(l).height>c.scrollTop()+c.outerHeight()?(n=d.offset().top-i(l).height-p,l.find(".tipso_arrow").css({"border-bottom-color":"transparent","border-top-color":u.settings.background,"border-left-color":"transparent","border-right-color":"transparent"}),o(l),l.addClass("top_right_corner"),l.find(".tipso_title").addClass("top_left_corner"),l.find(".tipso_arrow").css({"border-left-color":u.settings.background}),l.removeClass("top-right top bottom left right"),l.addClass("top")):(l.find(".tipso_arrow").css({"border-top-color":"transparent","border-bottom-color":b,"border-left-color":"transparent","border-right-color":"transparent"}),o(l),l.addClass("bottom_right_corner"),l.find(".tipso_title").addClass("bottom_right_corner"),l.find(".tipso_arrow").css({"border-left-color":b}),l.removeClass("top bottom left right"),l.addClass("bottom"));break;case"bottom-left":r=d.offset().left-i(l).width,n=d.offset().top+d.outerHeight()+p,l.find(".tipso_arrow").css({marginLeft:-u.settings.arrowWidth,marginTop:""}),n+i(l).height>c.scrollTop()+c.outerHeight()?(n=d.offset().top-i(l).height-p,l.find(".tipso_arrow").css({"border-bottom-color":"transparent","border-top-color":u.settings.background,"border-left-color":"transparent","border-right-color":"transparent"}),o(l),l.addClass("top_left_corner"),l.find(".tipso_title").addClass("top_left_corner"),l.find(".tipso_arrow").css({"border-right-color":u.settings.background}),l.removeClass("top-right top bottom left right"),l.addClass("top")):(l.find(".tipso_arrow").css({"border-top-color":"transparent","border-bottom-color":b,"border-left-color":"transparent","border-right-color":"transparent"}),o(l),l.addClass("bottom_left_corner"),l.find(".tipso_title").addClass("bottom_left_corner"),l.find(".tipso_arrow").css({"border-right-color":b}),l.removeClass("top bottom left right"),l.addClass("bottom"));break;case"top":r=d.offset().left+d.outerWidth()/2-i(l).width/2,n=d.offset().top-i(l).height-p,l.find(".tipso_arrow").css({marginLeft:-u.settings.arrowWidth,marginTop:""}),n<c.scrollTop()?(n=d.offset().top+d.outerHeight()+p,l.find(".tipso_arrow").css({"border-bottom-color":b,"border-top-color":"transparent","border-left-color":"transparent","border-right-color":"transparent"}),l.removeClass("top bottom left right"),l.addClass("bottom")):(l.find(".tipso_arrow").css({"border-top-color":u.settings.background,"border-bottom-color":"transparent","border-left-color":"transparent","border-right-color":"transparent"}),l.removeClass("top bottom left right"),l.addClass("top"));break;case"bottom":r=d.offset().left+d.outerWidth()/2-i(l).width/2,n=d.offset().top+d.outerHeight()+p,l.find(".tipso_arrow").css({marginLeft:-u.settings.arrowWidth,marginTop:""}),n+i(l).height>c.scrollTop()+c.outerHeight()?(n=d.offset().top-i(l).height-p,l.find(".tipso_arrow").css({"border-top-color":u.settings.background,"border-bottom-color":"transparent","border-left-color":"transparent","border-right-color":"transparent"}),l.removeClass("top bottom left right"),l.addClass("top")):(l.find(".tipso_arrow").css({"border-bottom-color":b,"border-top-color":"transparent","border-left-color":"transparent","border-right-color":"transparent"}),l.removeClass("top bottom left right"),l.addClass(u.settings.position));break;case"left":r=d.offset().left-i(l).width-p,n=d.offset().top+d.outerHeight()/2-i(l).height/2,l.find(".tipso_arrow").css({marginTop:-u.settings.arrowWidth,marginLeft:""}),r<c.scrollLeft()?(r=d.offset().left+d.outerWidth()+p,l.find(".tipso_arrow").css({"border-right-color":u.settings.background,"border-left-color":"transparent","border-top-color":"transparent","border-bottom-color":"transparent"}),l.removeClass("top bottom left right"),l.addClass("right")):(l.find(".tipso_arrow").css({"border-left-color":u.settings.background,"border-right-color":"transparent","border-top-color":"transparent","border-bottom-color":"transparent"}),l.removeClass("top bottom left right"),l.addClass(u.settings.position));break;case"right":r=d.offset().left+d.outerWidth()+p,n=d.offset().top+d.outerHeight()/2-i(l).height/2,l.find(".tipso_arrow").css({marginTop:-u.settings.arrowWidth,marginLeft:""}),r+p+u.settings.width>c.scrollLeft()+c.outerWidth()?(r=d.offset().left-i(l).width-p,l.find(".tipso_arrow").css({"border-left-color":u.settings.background,"border-right-color":"transparent","border-top-color":"transparent","border-bottom-color":"transparent"}),l.removeClass("top bottom left right"),l.addClass("left")):(l.find(".tipso_arrow").css({"border-right-color":u.settings.background,"border-left-color":"transparent","border-top-color":"transparent","border-bottom-color":"transparent"}),l.removeClass("top bottom left right"),l.addClass(u.settings.position))}if("top-right"===u.settings.position&&l.find(".tipso_arrow").css({"margin-left":-u.settings.width/2}),"top-left"===u.settings.position){var h=l.find(".tipso_arrow").eq(0);h.css({"margin-left":u.settings.width/2-2*u.settings.arrowWidth})}if("bottom-right"===u.settings.position){var h=l.find(".tipso_arrow").eq(0);h.css({"margin-left":-u.settings.width/2,"margin-top":""})}if("bottom-left"===u.settings.position){var h=l.find(".tipso_arrow").eq(0);h.css({"margin-left":u.settings.width/2-2*u.settings.arrowWidth,"margin-top":""})}r<c.scrollLeft()&&("bottom"===u.settings.position||"top"===u.settings.position)&&(l.find(".tipso_arrow").css({marginLeft:r-u.settings.arrowWidth}),r=0),r+u.settings.width>c.outerWidth()&&("bottom"===u.settings.position||"top"===u.settings.position)&&(s=c.outerWidth()-(r+u.settings.width),l.find(".tipso_arrow").css({marginLeft:-s-u.settings.arrowWidth,marginTop:""}),r+=s),r<c.scrollLeft()&&("left"===u.settings.position||"right"===u.settings.position||"top-right"===u.settings.position||"top-left"===u.settings.position||"bottom-right"===u.settings.position||"bottom-left"===u.settings.position)&&(r=d.offset().left+d.outerWidth()/2-i(l).width/2,l.find(".tipso_arrow").css({marginLeft:-u.settings.arrowWidth,marginTop:""}),n=d.offset().top-i(l).height-p,n<c.scrollTop()?(n=d.offset().top+d.outerHeight()+p,l.find(".tipso_arrow").css({"border-bottom-color":b,"border-top-color":"transparent","border-left-color":"transparent","border-right-color":"transparent"}),l.removeClass("top bottom left right"),o(l),l.addClass("bottom")):(l.find(".tipso_arrow").css({"border-top-color":u.settings.background,"border-bottom-color":"transparent","border-left-color":"transparent","border-right-color":"transparent"}),l.removeClass("top bottom left right"),o(l),l.addClass("top")),r+u.settings.width>c.outerWidth()&&(s=c.outerWidth()-(r+u.settings.width),l.find(".tipso_arrow").css({marginLeft:-s-u.settings.arrowWidth,marginTop:""}),r+=s),r<c.scrollLeft()&&(l.find(".tipso_arrow").css({marginLeft:r-u.settings.arrowWidth}),r=0)),r+u.settings.width>c.outerWidth()&&("left"===u.settings.position||"right"===u.settings.position||"top-right"===u.settings.position||"top-left"===u.settings.position||"bottom-right"===u.settings.position||"bottom-right"===u.settings.position)&&(r=d.offset().left+d.outerWidth()/2-i(l).width/2,l.find(".tipso_arrow").css({marginLeft:-u.settings.arrowWidth,marginTop:""}),n=d.offset().top-i(l).height-p,n<c.scrollTop()?(n=d.offset().top+d.outerHeight()+p,l.find(".tipso_arrow").css({"border-bottom-color":b,"border-top-color":"transparent","border-left-color":"transparent","border-right-color":"transparent"}),o(l),l.removeClass("top bottom left right"),l.addClass("bottom")):(l.find(".tipso_arrow").css({"border-top-color":u.settings.background,"border-bottom-color":"transparent","border-left-color":"transparent","border-right-color":"transparent"}),o(l),l.removeClass("top bottom left right"),l.addClass("top")),r+u.settings.width>c.outerWidth()&&(s=c.outerWidth()-(r+u.settings.width),l.find(".tipso_arrow").css({marginLeft:-s-u.settings.arrowWidth,marginTop:""}),r+=s),r<c.scrollLeft()&&(l.find(".tipso_arrow").css({marginLeft:r-u.settings.arrowWidth}),r=0)),l.css({left:r+u.settings.offsetX,top:n+u.settings.offsetY}),n<c.scrollTop()&&("right"===u.settings.position||"left"===u.settings.position)&&(d.tipso("update","position","bottom"),a(u)),n+i(l).height>c.scrollTop()+c.outerHeight()&&("right"===u.settings.position||"left"===u.settings.position)&&(d.tipso("update","position","top"),a(u))}var n="tipso",r={speed:400,background:"#55b555",titleBackground:"#333333",color:"#ffffff",titleColor:"#ffffff",titleContent:"",showArrow:!0,position:"top",width:200,maxWidth:"",delay:200,hideDelay:0,animationIn:"",animationOut:"",offsetX:0,offsetY:0,arrowWidth:8,tooltipHover:!1,content:null,ajaxContentUrl:null,ajaxContentBuffer:0,contentElementId:null,useTitle:!1,templateEngineFunc:null,onBeforeShow:null,onShow:null,onHide:null};e.extend(t.prototype,{init:function(){{var e=this,t=this.$element;this.doc}if(t.addClass("tipso_style").removeAttr("title"),e.settings.tooltipHover){var i=null,o=null;t.on("mouseover."+n,function(){clearTimeout(i),clearTimeout(o),o=setTimeout(function(){e.show()},150)}),t.on("mouseout."+n,function(){clearTimeout(i),clearTimeout(o),i=setTimeout(function(){e.hide()},200),e.tooltip().on("mouseover."+n,function(){e.mode="tooltipHover"}).on("mouseout."+n,function(){e.mode="show",clearTimeout(i),i=setTimeout(function(){e.hide()},200)})})}else t.on("mouseover."+n,function(){e.show()}),t.on("mouseout."+n,function(){e.hide()});e.settings.ajaxContentUrl&&(e.ajaxContent=null)},tooltip:function(){return this.tipso_bubble||(this.tipso_bubble=e('<div class="tipso_bubble"><div class="tipso_title"></div><div class="tipso_content"></div><div class="tipso_arrow"></div></div>')),this.tipso_bubble},show:function(){var t=this.tooltip(),i=this,o=this.win;i.settings.showArrow===!1?t.find(".tipso_arrow").hide():t.find(".tipso_arrow").show(),"hide"===i.mode&&(e.isFunction(i.settings.onBeforeShow)&&i.settings.onBeforeShow(i.$element,i.element,i),i.settings.size&&t.addClass(i.settings.size),i.settings.width?t.css({background:i.settings.background,color:i.settings.color,width:i.settings.width}).hide():i.settings.maxWidth?t.css({background:i.settings.background,color:i.settings.color,maxWidth:i.settings.maxWidth}).hide():t.css({background:i.settings.background,color:i.settings.color,width:200}).hide(),t.find(".tipso_title").css({background:i.settings.titleBackground,color:i.settings.titleColor}),t.find(".tipso_content").html(i.content()),t.find(".tipso_title").html(i.titleContent()),a(i),o.on("resize."+n,function(){i.settings.position=i.settings.preferedPosition,a(i)}),window.clearTimeout(i.timeout),i.timeout=null,i.timeout=window.setTimeout(function(){i.ieFade||""===i.settings.animationIn||""===i.settings.animationOut?t.appendTo("body").stop(!0,!0).fadeIn(i.settings.speed,function(){i.mode="show",e.isFunction(i.settings.onShow)&&i.settings.onShow(i.$element,i.element,i)}):t.remove().appendTo("body").stop(!0,!0).removeClass("animated "+i.settings.animationOut).addClass("noAnimation").removeClass("noAnimation").addClass("animated "+i.settings.animationIn).fadeIn(i.settings.speed,function(){e(this).one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){e(this).removeClass("animated "+i.settings.animationIn)}),i.mode="show",e.isFunction(i.settings.onShow)&&i.settings.onShow(i.$element,i.element,i),o.off("resize."+n,null,"tipsoResizeHandler")})},i.settings.delay))},hide:function(t){var i=this,o=this.win,a=this.tooltip(),r=i.settings.hideDelay;t&&(r=0,i.mode="show"),window.clearTimeout(i.timeout),i.timeout=null,i.timeout=window.setTimeout(function(){"tooltipHover"!==i.mode&&(i.ieFade||""===i.settings.animationIn||""===i.settings.animationOut?a.stop(!0,!0).fadeOut(i.settings.speed,function(){e(this).remove(),e.isFunction(i.settings.onHide)&&"show"===i.mode&&i.settings.onHide(i.$element,i.element,i),i.mode="hide",o.off("resize."+n,null,"tipsoResizeHandler")}):a.stop(!0,!0).removeClass("animated "+i.settings.animationIn).addClass("noAnimation").removeClass("noAnimation").addClass("animated "+i.settings.animationOut).one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){e(this).removeClass("animated "+i.settings.animationOut).remove(),e.isFunction(i.settings.onHide)&&"show"===i.mode&&i.settings.onHide(i.$element,i.element,i),i.mode="hide",o.off("resize."+n,null,"tipsoResizeHandler")}))},r)},close:function(){this.hide(!0)},destroy:function(){{var e=this.$element,t=this.win;this.doc}e.off("."+n),t.off("resize."+n,null,"tipsoResizeHandler"),e.removeData(n),e.removeClass("tipso_style").attr("title",this._title)},titleContent:function(){var e,t=this.$element,i=this;return e=i.settings.titleContent?i.settings.titleContent:t.data("tipso-title")},content:function(){var t,i=this.$element,o=this,a=this._title;return o.settings.ajaxContentUrl?o._ajaxContent?t=o._ajaxContent:(o._ajaxContent=t=e.ajax({type:"GET",url:o.settings.ajaxContentUrl,async:!1}).responseText,o.settings.ajaxContentBuffer>0?setTimeout(function(){o._ajaxContent=null},o.settings.ajaxContentBuffer):o._ajaxContent=null):o.settings.contentElementId?t=e("#"+o.settings.contentElementId).text():o.settings.content?t=o.settings.content:o.settings.useTitle===!0?t=a:"string"==typeof i.data("tipso")&&(t=i.data("tipso")),null!==o.settings.templateEngineFunc&&(t=o.settings.templateEngineFunc(t)),t},update:function(e,t){var i=this;return t?void(i.settings[e]=t):i.settings[e]}});var s=function(){var e=document.createElement("p").style,t=["ms","O","Moz","Webkit"];if(""===e.transition)return!0;for(;t.length;)if(t.pop()+"Transition"in e)return!0;return!1}();e[n]=e.fn[n]=function(i){var o=arguments;if(void 0===i||"object"==typeof i)return this instanceof e||e.extend(r,i),this.each(function(){e.data(this,"plugin_"+n)||e.data(this,"plugin_"+n,new t(this,i))});if("string"==typeof i&&"_"!==i[0]&&"init"!==i){var a;return this.each(function(){var r=e.data(this,"plugin_"+n);r||(r=e.data(this,"plugin_"+n,new t(this,i))),r instanceof t&&"function"==typeof r[i]&&(a=r[i].apply(r,Array.prototype.slice.call(o,1))),"destroy"===i&&e.data(this,"plugin_"+n,null)}),void 0!==a?a:this}}});var TubeBuddyTagExplorer=function(){var e=false;var t=false;var o=false;var a;var n="";var r=null;var s=null;var l;var d="";var u;var c;var p=false;var b=false;var y=false;var h;var f="weighted";var m=[];var g=["#F40000","#F87E00","#FDED01","#7FD500","#00AE00"];var v=null;var T=false;var w=null;var j=false;var Q=null;var x=false;var B=false;var k=false;var L=false;var U=[];var C="the, it is, we all, a, an, by, to, you, me, he, she, they, we, how, it, i, are, to, for, of, in, and";var A=[{country:"Argentina",code:"AR"},{country:"Australia",code:"AU"},{country:"Austria",code:"AT"},{country:"Belgium",code:"BE"},{country:"Brazil",code:"BR"},{country:"Canada",code:"CA"},{country:"Chile",code:"CL"},{country:"Colombia",code:"CO"},{country:"Czechia",code:"CZ"},{country:"Denmark",code:"DK"},{country:"Egypt",code:"EG"},{country:"Finland",code:"FI"},{country:"France",code:"FR"},{country:"Germany",code:"DE"},{country:"Greece",code:"GR"},{country:"Hong Kong",code:"HK"},{country:"Hungary",code:"HU"},{country:"India",code:"IN"},{country:"Indonesia",code:"ID"},{country:"Ireland",code:"IE"},{country:"Israel",code:"IL"},{country:"Italy",code:"IT"},{country:"Japan",code:"JP"},{country:"Kenya",code:"KE"},{country:"Malaysia",code:"MY"},{country:"Mexico",code:"MX"},{country:"Netherlands",code:"NL"},{country:"New Zealand",code:"NZ"},{country:"Nigeria",code:"NG"},{country:"Norway",code:"NO"},{country:"Philippines",code:"PH"},{country:"Poland",code:"PL"},{country:"Portugal",code:"PT"},{country:"Romania",code:"RO"},{country:"Russia",code:"RU"},{country:"Saudi Arabia",code:"SA"},{country:"Singapore",code:"SG"},{country:"South Africa",code:"ZA"},{country:"South Korea",code:"KR"},{country:"Sweden",code:"SE"},{country:"Switzerland",code:"CH"},{country:"Taiwan",code:"TW"},{country:"Thailand",code:"TH"},{country:"Turkey",code:"TR"},{country:"Ukraine",code:"UA"},{country:"United Kingdom",code:"GB"},{country:"United States",code:"US"},{country:"Vietnam",code:"VN"}];var S={videoCount:0,titles:"",tags:"",numberOfResults:0,topResult:null,topResultVideoId:null,yourChannelCount:0,totalResults:0,topChannelId:"",topChannelTitle:"",topChannelThumbnail:"",topChannelCount:0,totalViewCount:0,searchVolumeValue:0,searchVolumeName:"",difficultyValue:0,difficultyName:"",videosFetched:0,videosTotal:0,numberOfExactViews:0,numberOfExactResults:0,tagScore:null};var E=function(){var e=TBGlobal.GetYouTubeUI();if(e==="studio"){var i=location.pathname;var o=[];TBUtilities.Log(i);if(i){var o=i.substring(1).split("/");for(var a=0;a<5-o.length;a++)o.push("");if(o[0]=="video"&&o[2]=="edit"){var n=o[1];TBUtilities.Log("Studio Video Edit!");if(o[0]=="video"&&o[2]=="edit"){t=true}}else if(o[2]=="videos"&&o[3]=="upload"&&jQuery("paper-dialog.ytcp-uploads-dialog").length>0){TBUtilities.Log("Studio Beta Uploads!");if(jQuery("ytcp-uploads-extras .tags").length>0){t=true}}}}else{if(document.URL.indexOf("youtube.com/upload")>0||document.URL.indexOf("youtube.com/edit")>0||document.URL.indexOf("youtube.com/my_live_events")>0){t=true}else{t=false}}};var I=function(){var e=TBGlobal.host+"/ModuleManager/tagexplorer/tagexplorer?v="+TBGlobal.versionNumber;if(loadLocalHTML&&(TBExtension.GetType()=="chrome"||TBExtension.GetType()=="firefox")){e=chrome.extension.getURL("modules/tagexplorer.html")}else if(loadLocalHTML&&TBExtension.GetType()=="safari"){e="modules/tagexplorer.html"}TBExtension.Get(e,"CRTBLoadTagExplorerTemplate")};var G=function(e){p=false;b=false;y=false;x=false;B=false;k=false;L=false;jQuery("#tb-tag-explorer-container").show();Y();se();jQuery(".tb-tag-explorer-tag-checkbox").each(function(){jQuery(this).prop("checked",false)});if(e.trim().length>0){jQuery(".tb-tag-explorer-tag-checkbox-explore").prop("checked",true);jQuery(".tb-tag-explorer-tag-checkbox-explore").attr("data-tag-value",encodeURIComponent(e));jQuery(".tb-tag-explorer-tag-checkbox-explore").prop("disabled",false)}else{jQuery(".tb-tag-explorer-tag-checkbox-explore").prop("checked",false);jQuery("#tb-tag-explorer-tab-container").hide();jQuery("#tb-tag-explorer-tab-none").show();jQuery("#tb-tag-explorer-trending-related-container").show()}if(t){jQuery(".tb-tag-explorer-single-tag-warning").show()}else{jQuery(".tb-tag-explorer-single-tag-warning").hide()}R();u=e.toLowerCase().trim();jQuery("#tb-tag-explorer-recent-list").find('[data-tag="'+u+'"]').parent().remove();jQuery("#tb-tag-explorer-recent-list").prepend('<span class="tb-tag-explorer-recent-container"><span data-tag="'+u+'">&#187;</span> <a data-tag="'+u+'" style="margin-right:2px;padding:0px" class="tb-video-info-suggested-tag tb-tag-explorer-recent">'+TBUtilities.GetHtmlEncoded(u)+"</a></span>");jQuery("#tb-tag-explorer-input").val(u);jQuery(".tb-video-info-selected-tag").text(u);if(e==""){jQuery("#tb-tag-explorer-input").focus();return}if(jQuery("#tb-tag-explorer-recent-list").is(":empty")==false){jQuery(".tb-tag-explorer-recent-list-container").show()}jQuery("#tb-tag-explorer-action-dropup-button").show();jQuery("#tb-tag-explorer-tab-container").show();jQuery("#tb-tag-explorer-tab-none").hide();jQuery("#tb-tag-explorer-trending-related-container").hide();jQuery(".tb-video-info-selected-tag-link").attr("href","https://www.youtube.com/results?search_query="+TBUtilities.GetUrlEncoded(u));jQuery(".tb-tag-explorer-external-links").attr("href","https://www.youtube.com/results?search_query="+TBUtilities.GetUrlEncoded(u));jQuery("#tb-tag-explorer-borrowed-tab-no-results").hide();jQuery("#tb-tag-explorer-borrowed-tab-results").show();jQuery("#tb-tag-explorer-most-used-tags-loading").show();jQuery("#tb-tag-explorer-long-loading").hide();d="Start";d+="\nCID: "+TBGlobal.CurrentChannelId();d+="\nBT: "+TBExtension.GetType();d+="\nEV: "+TBExtension.GetExtensionVersion();d+="\nOS: "+TBUtilities.GetOs();d+="\nTag: "+u;d+="\nCL1: "+TBGlobal.CanAccessLevel1Tools();d+="\nUI: "+TBGlobal.GetYouTubeUI();jQuery("#tb-tag-explorer-most-used-tags").hide();jQuery("#tb-tag-explorer-top-ranking-container-loading").show();jQuery("#tb-tag-explorer-top-ranking-container").hide();jQuery("#tb-tag-explorer-keyword-score-container-loading").show();jQuery("#tb-tag-explorer-keyword-score-container").hide();jQuery(".tb-tag-explorer-most-used-tags-upgrade-img").hide();jQuery("#tb-tag-explorer-weighted-score-loading").show();jQuery("#tb-tag-explorer-weighted-score-container").hide();jQuery("#tb-tag-explorer-most-used-tags-list").empty();jQuery(".tb-tag-explorer-upgrade-container").hide();jQuery(".tb-tag-explorer-total-score-low").hide();jQuery(".tb-tag-explorer-total-score-low-list-loading").hide();jQuery(".tb-tag-explorer-total-score-low-list").hide();jQuery(".tb-tag-explorer-total-score-low-list").empty();jQuery(".tb-tag-explorer-tab-header-error").hide();TBUtilities.Log("Getting search results for tag : "+u);jQuery("#tb-tag-explorer-borrowed-tab-header").click();jQuery("#tb-tag-explorer-rising-queries").empty().append(jQuery(".tb-tag-explorer-loading-section:last")[0].outerHTML);jQuery("#tb-tag-explorer-top-queries").empty().append(jQuery(".tb-tag-explorer-loading-section:last")[0].outerHTML);jQuery("#tb-video-info-youtube-auto-suggest").empty().append(jQuery(".tb-tag-explorer-loading-section:last")[0].outerHTML);jQuery("#tb-video-info-google-auto-suggest").empty().append(jQuery(".tb-tag-explorer-loading-section:last")[0].outerHTML);jQuery("#tb-tag-explorer-top-hits").empty().append(jQuery(".tb-tag-explorer-loading-section:last")[0].outerHTML);O("youtube");M("youtube");var i='"'+u+'"';TubeBuddyYouTubeActions.GetSearchEstimatedResultCount(i).then(function(t){c=null;var i=new Object;i[u.toLowerCase()]=t;var o=TBGlobal.GetPrefCookieObject();var a={Region:"us",Tags:[],Language:"en",WeightScore:true,TagsWithExactCounts:i};if(o&&o.gl){a.Region=o.gl}if(o&&o.hl){a.Language=o.hl}var n=TBGlobal.host+TBGlobal.apiUrls.tagScoreGet;TBExtension.Post(n,JSON.stringify(a),"CRTBTagExplorerGetTagScore",null,{contentType:"application/json"});try{TBUtilities.AddAction({Data:e},TBUtilities.ActionTypes.TagExplorer_TagExplored,"tagexplorer")}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyTagExplorer] [addAction]"})}}).catch(function(e){le();var t=true;if(TBGlobal.Profile().IncognitoSearch===true){t=false}var i="https://www.youtube.com/results?search_query="+TBUtilities.GetUrlEncoded(u);TBExtension.Get(i,"CRTBTagExplorerGetYouTubeSearch",{numberOfExactViews:0,numberOfExactResults:0,page:1},{credentials:t})})};var R=function(){var e=0;var t=[];jQuery(".tb-tag-explorer-tag-checkbox").each(function(){if(jQuery(this).is(":checked")&&jQuery(this).parent().hasClass("tb-tag-explorer-tag-checkbox-hidden")==false){e++;var i=decodeURIComponent(jQuery(this).attr("data-tag-value"));if(i){t.push(i)}}});jQuery(".tb-tag-explorer-selected-count").text(e);if(e>0){jQuery("#tb-tag-explorer-action-dropup-button").attr("disabled",false);jQuery("#tb-tag-explorer-action-dropup-button").removeAttr("title")}else{jQuery("#tb-tag-explorer-action-dropup-button").attr("disabled",true);jQuery("#tb-tag-explorer-action-dropup-button").attr("title","No keyword(s) selected.")}var i="";var o=t.length;if(t.length>0){jQuery.each(t,function(e,t){if(e==o-1){i+=t}else{i+=t+", "}})}jQuery("#tb-tag-explorer-action-dropup-menu").attr("data-clipboard-text",i);return e};var P=function(){var e=[];jQuery(".tb-tag-explorer-tag-checkbox").each(function(t,i){if(jQuery(this).is(":checked")&&jQuery(this).hasClass("tb-tag-explorer-tag-checkbox-hidden")==false){var o=decodeURIComponent(jQuery(this).attr("data-tag-value"));if(o){e.push(o)}}});var t="";var i=e.length;if(e.length>0){jQuery.each(e,function(e,o){if(e==i-1){t+=o}else{t+=o+", "}})}if(l){l.destroy()}jQuery("#tb-tag-explorer-action-dropup-menu").attr("data-clipboard-text",t);if(!s){l=new ClipboardJS("#tb-tag-explorer-action-dropup-menu")}else{l=new ClipboardJS("#tb-tag-explorer-action-dropup-menu",{container:jQuery(s)[0]})}};var D=function(){jQuery("#tb-tag-explorer-most-used-tags").find(".tb-tag-explorer-tag-checkbox").each(function(){if(jQuery(this).find(".tb-tag-explorer-tag-checkbox-confirm").is(":visible")==false){jQuery(this).prop("checked",false)}});var e=500;var t=TBUtilities.GetTagCharacterCount(U);if(t>0){e=500-t}var i=[];jQuery("#tb-tag-explorer-container").find(".tb-tag-explorer-tag-checkbox").each(function(){if(jQuery(this).is(":checked")==true){var e=decodeURIComponent(jQuery(this).attr("data-tag-value"));if(e){i.push(e)}}});jQuery("#tb-tag-explorer-most-used-tags").find(".tb-tag-explorer-tag-checkbox").each(function(){if(jQuery(this).find(".tb-tag-explorer-tag-checkbox-confirm").is(":visible")==false){var t=decodeURIComponent(jQuery(this).attr("data-tag-value"));if(t){i.push(t)}var o=TBUtilities.GetTagCharacterCount(i);if(o>=e){jQuery("#tb-tag-explorer-most-used-tags").find(".tb-tag-explorer-tag-checkbox").last().prop("checked",false);return false}else{jQuery(this).prop("checked",true)}}})};var V=function(){jQuery("#tb-tag-explorer-action-dropup-menu").hide()};var _=function(){var e=jQuery("body")[0].outerHTML;var t=e.indexOf('PSUGGEST_TOKEN":"')+'PSUGGEST_TOKEN":"'.length;var i=e.indexOf('"',t);var o=e.substring(t,i);return o};var M=function(e){var t=_();switch(e){case"youtube":{if(x==false){jQuery(".tb-tag-explorer-related-keyword-tab-container-youtube-loading").show();jQuery(".tb-tag-explorer-related-keyword-tab-youtube-list").hide();jQuery(".tb-tag-explorer-related-keyword-tab-youtube-list").empty();TubeBuddyYouTubeActions.GetYouTubeAutoComplete(t,u,function(e){x=true;var t=[];t.push(u);var i=0;var o=0;jQuery.each(e,function(e,a){var n=TBUtilities.GetInArray(t,null,a);if(n==null){t.push(a);if(i==3&&!TBGlobal.CanAccessLevel1Tools()){o++}else{var r=TBUtilities.GetTubeBuddyCheckboxHtml(a,"tb-tag-explorer-tag-checkbox","data-tag-value="+encodeURIComponent(a.trim()));jQuery(".tb-tag-explorer-related-keyword-tab-youtube-list").append('<div class="tb-tag-has-external"><img class="tb-tag-explorer-tag-checkbox-confirm tb-tag-explorer-tag-checkbox-hidden" src="'+TBGlobal.host+'/images/icons/check.png" />'+r+'<a class="tb-video-info-suggested-tag tb-video-info-suggested-tag-adjusted" style="cursor:pointer">'+TBUtilities.GetHtmlEncoded(a)+'</a> <a class="tb-video-info-suggested-tag-adjusted" target="_blank" href="https://www.youtube.com/results?search_query='+TBUtilities.GetUrlEncoded(a)+'"><img src="'+TBGlobal.host+'/images/icons/external.png" /></a></div > ');i++}}});jQuery(".tb-tag-explorer-related-keyword-tab-container-youtube-loading").hide();jQuery(".tb-tag-explorer-related-keyword-tab-youtube-list").show();if(t.length==1){jQuery(".tb-tag-explorer-related-keyword-tab-youtube-list").empty();jQuery(".tb-tag-explorer-related-keyword-tab-youtube-list").append('<div class="tb-tag-explorer-related-keyword-tab-related-list-empty" style="color:#999; font-size:15px; position:relative; top:10px;">No related video searches found.<br><br>Try exploring a more general Keyword if you are looking for specific search phrases that people enter for when looking for videos online.</div>')}if(o>0){jQuery(".tb-tag-explorer-related-youtube-upgrade-img").show();jQuery(".tb-tag-explorer-related-youtube-upgrade-count").text(o+i);var a=jQuery(".tb-tag-explorer-related-keyword-tab-youtube-list").position();var n=200;var r=0;var s=a.left+n-r-10+"px";var l=130+a.top+"px";jQuery(".tb-tag-explorer-related-youtube-upgrade-container").css({position:"absolute",zIndex:5e3,left:s,top:l});jQuery(".tb-tag-explorer-related-youtube-upgrade-container").show()}})}else{jQuery(".tb-tag-explorer-related-keyword-tab-container-youtube-loading").hide();jQuery(".tb-tag-explorer-related-keyword-tab-youtube-list").show()}break}case"google":{if(B==false){jQuery(".tb-tag-explorer-related-keyword-tab-container-google-loading").show();jQuery(".tb-tag-explorer-related-keyword-tab-google-list").hide();jQuery(".tb-tag-explorer-related-keyword-tab-google-list").empty();TubeBuddyYouTubeActions.GetGoogleAutoComplete(t,u,function(e){B=true;var t=[];t.push(u);var i=0;var o=0;jQuery.each(e,function(e,a){var n=TBUtilities.GetInArray(t,null,a);if(n==null){t.push(a);if(i==3&&!TBGlobal.CanAccessLevel1Tools()){o++}else{var r=TBUtilities.GetTubeBuddyCheckboxHtml(a,"tb-tag-explorer-tag-checkbox","data-tag-value="+encodeURIComponent(a.trim()));jQuery(".tb-tag-explorer-related-keyword-tab-google-list").append('<div class="tb-tag-has-external"><img class="tb-tag-explorer-tag-checkbox-confirm tb-tag-explorer-tag-checkbox-hidden" src="'+TBGlobal.host+'/images/icons/check.png" />'+r+'<a class="tb-video-info-suggested-tag tb-video-info-suggested-tag-adjusted" style="cursor:pointer">'+TBUtilities.GetHtmlEncoded(a)+'</a> <a class="tb-video-info-suggested-tag-adjusted" target="_blank" href="https://www.google.com/search?q='+TBUtilities.GetUrlEncoded(a)+'"><img src="'+TBGlobal.host+'/images/icons/external.png" /></a></div > ');i++}}});jQuery(".tb-tag-explorer-related-keyword-tab-container-google-loading").hide();jQuery(".tb-tag-explorer-related-keyword-tab-google-list").show();if(t.length==1){jQuery(".tb-tag-explorer-related-keyword-tab-google-list").append('<div class="tb-tag-explorer-related-keyword-tab-related-list-empty" style="color:#999; font-size:15px; position:relative; top:10px;">No related web searches found.<br><br>Try exploring a more general Keyword if you are looking for specific search phrases that people enter when searching on the web (Google).</div>')}if(o>0){jQuery(".tb-tag-explorer-related-google-upgrade-img").show();jQuery(".tb-tag-explorer-related-google-upgrade-count").text(o+i);var a=jQuery(".tb-tag-explorer-related-keyword-tab-google-list").position();var n=200;var r=0;var s=a.left+n-r-10+"px";var l=130+a.top+"px";jQuery(".tb-tag-explorer-related-google-upgrade-container").css({position:"absolute",zIndex:5e3,left:s,top:l});jQuery(".tb-tag-explorer-related-google-upgrade-container").show()}})}else{jQuery(".tb-tag-explorer-related-keyword-tab-container-google-loading").hide();jQuery(".tb-tag-explorer-related-keyword-tab-google-list").show()}break}case"related":{if(k==false){jQuery(".tb-tag-explorer-related-keyword-tab-container-related-loading").show();jQuery(".tb-tag-explorer-related-keyword-tab-related-list").hide();jQuery(".tb-tag-explorer-related-keyword-tab-related-list").empty();var i=0;var o=0;var a=[];a.push("how "+u);a.push("how to "+u);a.push("why "+u);a.push("what "+u);a.push("where "+u);a.push("did "+u);a.push("can "+u);a.push("do "+u);a.push("does "+u);a.push("is "+u);var n=0;var r=[];jQuery.each(a,function(e,s){TubeBuddyYouTubeActions.GetYouTubeAutoComplete(t,s,function(e){n++;k=true;jQuery.each(e,function(e,t){var a=TBUtilities.GetInArray(r,null,t);if(a==null){r.push(t);if(i==3&&!TBGlobal.CanAccessLevel1Tools()){o++}else{var n=TBUtilities.GetTubeBuddyCheckboxHtml(t,"tb-tag-explorer-tag-checkbox","data-tag-value="+encodeURIComponent(t.trim()));jQuery(".tb-tag-explorer-related-keyword-tab-related-list").append('<div class="tb-tag-has-external"><img class="tb-tag-explorer-tag-checkbox-confirm tb-tag-explorer-tag-checkbox-hidden" src="'+TBGlobal.host+'/images/icons/check.png" />'+n+'<a class="tb-video-info-suggested-tag tb-video-info-suggested-tag-adjusted" style="cursor:pointer">'+TBUtilities.GetHtmlEncoded(t)+'</a> <a class="tb-video-info-suggested-tag-adjusted" target="_blank" href="https://www.youtube.com/results?search_query='+TBUtilities.GetUrlEncoded(t)+'"><img src="'+TBGlobal.host+'/images/icons/external.png" /></a></div > ');i++}}});jQuery(".tb-tag-explorer-related-keyword-tab-container-related-loading").hide();jQuery(".tb-tag-explorer-related-keyword-tab-related-list").show();if(n>=a.length&&jQuery(".tb-tag-explorer-related-keyword-tab-related-list").find("div").length==0){jQuery(".tb-tag-explorer-related-keyword-tab-related-list").append('<div class="tb-tag-explorer-related-keyword-tab-related-list-empty" style="color:#999; font-size:15px; position:relative; top:10px;">No related video topics found.<br><br>Please try exploring a more general Keyword if you are looking for video topic suggestions.</div>')}if(n>=a.length&&TBGlobal.CanAccessLevel1Tools()==false){if(o>0){jQuery(".tb-tag-explorer-related-topic-upgrade-img").show();jQuery(".tb-tag-explorer-related-topic-upgrade-count").text(o+i);var t=jQuery(".tb-tag-explorer-related-keyword-tab-related-list").position();var s=200;var l=0;var d=t.left+s-l-10+"px";var u=130+t.top+"px";jQuery(".tb-tag-explorer-related-topic-upgrade-container").css({position:"absolute",zIndex:5e3,left:d,top:u});jQuery(".tb-tag-explorer-related-topic-upgrade-container").show()}}})})}else{jQuery(".tb-tag-explorer-related-keyword-tab-container-related-loading").hide();jQuery(".tb-tag-explorer-related-keyword-tab-related-list").show()}break}}};var O=function(e){jQuery(".tb-tag-explorer-related-keyword-desc").removeClass("tb-tag-explorer-tab-active");jQuery(".tb-tag-explorer-related-keyword-tab-container").hide();switch(e){case"youtube":{jQuery(".tb-tag-explorer-related-keyword-tab-container-youtube").show();jQuery(".tb-tag-explorer-related-youtube-option").addClass("tb-tag-explorer-tab-active");break}case"google":{jQuery(".tb-tag-explorer-related-keyword-tab-container-google").show();jQuery(".tb-tag-explorer-related-google-option").addClass("tb-tag-explorer-tab-active");break}case"related":{jQuery(".tb-tag-explorer-related-keyword-tab-container-related").show();jQuery(".tb-tag-explorer-related-related-option").addClass("tb-tag-explorer-tab-active");break}}};var F=function(e,t){f=e;var i=0;jQuery(".tb-tag-explorer-keyword-score-weighted-desc").removeClass("tb-tag-explorer-tab-active");switch(e){case"weighted":{jQuery(".tb-tag-explorer-keyword-score-weighted-option ").addClass("tb-tag-explorer-tab-active");if(t){ee(t.WeightedScore,t.WeightedScoreRating);ye(t.Tag,t.WeightedScore);i=t.WeightedScore;jQuery(".tb-tag-explorer-unweighted-score-area").hide();jQuery(".tb-tag-explorer-weighted-score-area").show();jQuery(".tb-tag-explorer-total-score-desc").html(t.WeightedScoreDescription)}break}case"unweighted":{jQuery(".tb-tag-explorer-keyword-score-unweighted-option ").addClass("tb-tag-explorer-tab-active");if(t){ee(t.Score,t.ScoreRating);ye(t.Tag,c.Score);i=t.Score;jQuery(".tb-tag-explorer-unweighted-score-area").show();jQuery(".tb-tag-explorer-weighted-score-area").hide();jQuery(".tb-tag-explorer-total-score-desc").html(t.ScoreDescription);if(TBGlobal.CanAccessLevel1Tools()==false){jQuery(".tb-tag-explorer-weighted-score-area-chart").show();jQuery(".tb-tag-explorer-weighted-score-area-chart-label").show();jQuery(".tb-tag-explorer-weighted-prompt").hide()}else{jQuery(".tb-tag-explorer-weighted-prompt").show()}}break}}if(i<=40){jQuery(".tb-tag-explorer-total-score-warning").show()}else{jQuery(".tb-tag-explorer-total-score-warning").hide()}};var N=function(e,t,i){try{if(e.toLowerCase()!=u.toLowerCase()){_inputAutoCompleteMenuLoaded=true;var o=jQuery(".tb-tag-explorer-header-auto-complete");var a=jQuery("#tb-tag-explorer-input");var n=0;var r=o.find(".tb-tag-explorer-header-auto-complete-items:first");r.empty();jQuery.each(t,function(t,i){if(TBGlobal.CanAccessLevel1Tools()==true||TBGlobal.CanAccessLevel1Tools()==false&&n<3){n++;var o=W(i,e);var a="<div class='tb-tag-explorer-auto-complete-item' data-tag="+encodeURI(i)+"><span class='tb-tag-explorer-auto-complete-item-text tb-video-info-suggested-tag-suggestion'>"+o+"</span></div>";var s=TBUtilities.FixLocalHtml(a);r.append(s)}});var s=jQuery(a).position();var l=0;var d=0;var c=s.left+l-d+"px";var p=36+s.top+"px";o.css({position:"absolute",zIndex:1e4,left:c,top:p});if(o.is(":visible")==false){o.hide().fadeIn()}}else{Y()}}catch(e){TBUtilities.Log(e)}};var Y=function(){try{j=false;_inputAutoCompleteMenuLoaded=false;var e=jQuery(".tb-tag-explorer-header-auto-complete");e.hide()}catch(e){TBUtilities.Log(e)}};var H=function(){try{var e=jQuery(".tb-tag-explorer-auto-complete-item.tb-tag-explorer-auto-complete-item-highlight").first();if(e.length>0){jQuery("#tb-tag-explorer-input").val(e.text());G(e.text())}}catch(e){TBUtilities.Log(e)}};var z=function(e){try{j=true;var t=jQuery(".tb-tag-explorer-auto-complete-item.tb-tag-explorer-auto-complete-item-highlight");if(t.length>0){var i=null;if(e===true){i=t.nextAll(".tb-tag-explorer-auto-complete-item:first")}else{i=t.prevAll(".tb-tag-explorer-auto-complete-item:first")}jQuery(".tb-tag-explorer-auto-complete-item").removeClass("tb-tag-explorer-auto-complete-item-highlight");i.addClass("tb-tag-explorer-auto-complete-item-highlight");i.focus()}else{var o=jQuery(".tb-tag-explorer-auto-complete-item:not(.tb-tag-explorer-auto-complete-item-highlight)").first();jQuery(".tb-tag-explorer-auto-complete-item").removeClass("tb-tag-explorer-auto-complete-item-highlight");o.addClass("tb-tag-explorer-auto-complete-item-highlight");o.focus()}}catch(e){TBUtilities.Log(e)}};var W=function(e,t){var i=new RegExp(t,"g");return e.replace(i,'<span style="font-weight:normal !important">'+t+"</span>")};var q=function(){jQuery(document).on("click",".tb-tag-explorer-limit-tags",function(e){D();R()});jQuery(document).on("click",".tb-tag-explorer-related-keyword-desc",function(e){var t="youtube";if(jQuery(this).hasClass("tb-tag-explorer-related-google-option")==true){t="google"}else if(jQuery(this).hasClass("tb-tag-explorer-related-related-option")==true){t="related"}M(t);O(t)});jQuery(document).on("click",".tb-tag-explorer-keyword-score-weighted-desc",function(e){if(TBGlobal.CanAccessLevel1Tools()==true){var t="weighted";if(jQuery(this).hasClass("tb-tag-explorer-keyword-score-unweighted-option")==true){t="unweighted"}TBExtension.SetDbValue("tb-tag-explorer-weighted-option"+TBGlobal.CurrentChannelId(),t,null);F(t,c)}});jQuery(document).on("click",".tb-tag-explorer-keyword-score-weighted-disabled",function(e){TBGlobal.ShowUpgradePage("view your Weighted score",TBGlobal.limitation.tagexplorer)});jQuery(document).on("click","#tb-modal-overlay, #tb-tag-explorer-container",function(e){if(jQuery(".tb-tag-explorer-action-select").find(".tb-tag-explorer-action-dropdown").length>0||jQuery("#tb-tag-explorer-action-dropup-menu").is(":visible")){V()}});jQuery(document).on("click",".tb-tag-explorer-all-tags",function(e){jQuery("#tb-tag-explorer-most-used-tags").find(".tb-tag-explorer-tag-checkbox").each(function(){if(jQuery(this).find(".tb-tag-explorer-tag-checkbox-confirm").is(":visible")==false){jQuery(this).prop("checked",true)}});R();P()});jQuery(document).on("click",".tb-tag-explorer-none-tags",function(e){jQuery("#tb-tag-explorer-most-used-tags").find(".tb-tag-explorer-tag-checkbox").each(function(){if(jQuery(this).find(".tb-tag-explorer-tag-checkbox-confirm").is(":visible")==false){jQuery(this).prop("checked",false)}});R();P()});jQuery(document).on("change",".tb-tag-explorer-tag-checkbox",function(e){R();P()});jQuery(document).on("click",".tb-video-info-suggested-tag, .tb-video-info-suggested-tag-suggestion",function(){var e=jQuery(this).text().trim();G(e)});jQuery(document).on("click",".tb-video-info-suggested-tag-image",function(){var e=jQuery(this).attr("data-tag-name");if(e==null||e=="")return;jQuery(this).css("cursor","default");jQuery(this).attr("data-tag-name","");jQuery(this).hide("fast",function(){jQuery(this).attr("src",TBGlobal.host+"/images/icons/check.png");jQuery(this).fadeIn()});var t=a.parents(".basic-info-form-input");t.find(".video-settings-add-tag:first").val(e);t.find(".video-settings-add-tag:first").focus();t.find(".video-settings-title:first").focus();t.find(".video-settings-add-tag").trigger("blur");jQuery("#tb-layout-tag-inserted").fadeIn().delay(1e3).fadeOut()});jQuery(document).on("click","#tb-tag-explorer-insert",function(){var e=jQuery("#tb-tag-explorer-input").val();if(!e){TBUtilities.Alert("You must enter a Tag before inserting it into your tag list");return}jQuery(".video-settings-add-tag:first").val(e);jQuery(".video-settings-add-tag:first").focus();jQuery(".video-settings-title:first").focus();jQuery(".video-settings-add-tag").trigger("blur");jQuery("#tb-layout-tag-inserted").fadeIn().delay(1e3).fadeOut()});jQuery(document).on("click",".tb-tag-explorer-upgrade",function(){TBGlobal.ShowUpgradePage(null,TBGlobal.limitation.tagexplorer)});jQuery(document).on("click","#tb-tag-explorer-close, .tb-tag-explorer-closex",function(){TubeBuddyMenu.HideBackground();V();jQuery("#tb-tag-explorer-container").hide();jQuery("#tb-tag-explorer-action-dropup-button").hide()});jQuery(document).on("click",".tb-tag-explorer-custom-analysis-upgrade-link",function(){TBGlobal.ShowUpgradePage(null,TBGlobal.limitation.tagexplorer)});jQuery(document).on("click","#tb-tag-explorer-explore",function(){if(jQuery("#tb-tag-explorer-input").val()==""){TBUtilities.Alert("Enter a Keyword to explore");return}var e=jQuery("#tb-tag-explorer-input").val();jQuery(".tb-tag-explorer-tag-checkbox-explore").removeAttr("disabled");jQuery(".tb-tag-explorer-tag-checkbox-explore").prop("disabled",false);jQuery("#tb-tag-explorer-h-frame").attr("src","about:blank");jQuery("#tb-tag-explorer-m-frame").attr("src","about:blank");G(e);jQuery("#tb-tag-explorer-back").show()});jQuery(document).on("keyup","#tb-tag-explorer-input",function(e){if(e.keyCode==13){jQuery("#tb-tag-explorer-explore").trigger("click")}});jQuery(document).on("mouseover",".tb-tag-explorer-auto-complete-item",function(e,t){jQuery(".tb-tag-explorer-auto-complete-item").removeClass("tb-tag-explorer-auto-complete-item-highlight");jQuery(this).addClass("tb-tag-explorer-auto-complete-item-highlight")});jQuery(document).on("keydown","#tb-tag-explorer-input",function(e){try{clearTimeout(v);if(e.which==40||e.which==38){if(_inputAutoCompleteMenuLoaded==true){z(e.which==40)}}if(e.which==13||e.which==9){if(e.which==13&&_inputAutoCompleteMenuLoaded==true&&j==true){H();e.preventDefault();e.stopPropagation();return false}else{Y()}}if(e.which==27){Y()}v=setTimeout(function(){var t=jQuery("#tb-tag-explorer-input").val();if(_inputAutoCompleteMenuLoaded==false||t!=Q){var i=K(t);if(i===true){if(w==null){var o=jQuery("body")[0].outerHTML;var a=o.indexOf('PSUGGEST_TOKEN":"')+'PSUGGEST_TOKEN":"'.length;var n=o.indexOf('"',a);var r=o.substring(a,n);if(r.length==22){w=r}}Q=t;T=true;TubeBuddyYouTubeActions.GetYouTubeAutoComplete(w,t,function(i){if(i&&i.length>0&&t!=u&&Q==t){N(t,i,e)}else{Y()}})}else{Y()}}},250);return true}catch(e){TBUtilities.LogError(e)}});jQuery(document).on("click",".tb-tag-explorer-tab-header",function(){try{var e=jQuery(this).attr("data-tab-id");jQuery(".tb-tag-explorer-tab").hide();jQuery("#"+e).fadeIn();jQuery(".tb-tag-explorer-tab-header").removeClass("selected");jQuery(this).addClass("selected");var t=_();switch(e){case"tb-tag-explorer-trends-tab":{if(p==false){p=true;var i="https://trends.google.com/trends/embed/explore/RELATED_QUERIES?req=%7B%22comparisonItem%22%3A%5B%7B%22keyword%22%3A%22"+TBUtilities.GetUrlEncoded(u)+"%22%2C%22geo%22%3A%22%22%2C%22time%22%3A%22today%2012-m%22%7D%5D%2C%22category%22%3A0%2C%22property%22%3A%22youtube%22%7D&tz=420&forceMobileMode=false&isPreviewMode=true&eq=gprop%3Dyoutube%26q%3D"+TBUtilities.GetUrlEncoded(u)+"%26date%3Dtoday%2012-m&hl=enUS";TBExtension.Get(i,"CRTBTagExplorerGetRisingQueriesPreload")}break}case"tb-tag-explorer-historical-tab":{if(b==false){b=true;var o="https://trends.google.com/trends/embed/explore/TIMESERIES?req=%7B%22comparisonItem%22%3A%5B%7B%22keyword%22%3A%22"+TBUtilities.GetUrlEncoded(u)+"%22%2C%22geo%22%3A%22%22%2C%22time%22%3A%22today%2012-m%22%7D%5D%2C%22category%22%3A0%2C%22property%22%3A%22youtube%22%7D&tz=420&forceMobileMode=false&isPreviewMode=true&eq=gprop%3Dyoutube%26q%3D"+TBUtilities.GetUrlEncoded(u)+"%26date%3Dtoday%2012-m&hl=enUS";TBExtension.Get(o,"CRTBTagExplorerGetHistoricalPreload")}break}case"tb-tag-explorer-map-tab":{if(y==false){y=true;var a="https://trends.google.com/trends/embed/explore/GEO_MAP?req=%7B%22comparisonItem%22%3A%5B%7B%22keyword%22%3A%22"+TBUtilities.GetUrlEncoded(u)+"%22%2C%22geo%22%3A%22%22%2C%22time%22%3A%22today%2012-m%22%7D%5D%2C%22category%22%3A0%2C%22property%22%3A%22youtube%22%7D&tz=420&forceMobileMode=false&isPreviewMode=true&eq=gprop%3Dyoutube%26q%3D"+TBUtilities.GetUrlEncoded(u)+"%26date%3Dtoday%2012-m&hl=enUS";TBExtension.Get(a,"CRTBTagExplorerGetGetTablePreload")}break}}try{TBUtilities.AddAction({Data:"tabselected = "+e},TBUtilities.ActionTypes.TagExplorer_TagExplored,"tagexplorer")}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyTagTabSelected] [addAction]"})}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyTagExplorer] tb-tag-explorer-tab-header [click]"})}});jQuery(document).on("click",".tb-tag-explorer-trending-topic-explore",function(e){var t=jQuery(this).attr("data-title");jQuery("#tb-tag-explorer-input").val(t);jQuery("#tb-tag-explorer-explore").click()});jQuery(document).on("click","#tb-tag-explorer-back",function(e){jQuery("#tb-tag-explorer-tab-container").hide();jQuery("#tb-tag-explorer-trending-related-container").show();jQuery("#tb-tag-explorer-tab-none").show();jQuery("#tb-tag-explorer-back").hide();jQuery("#tb-tag-explorer-action-dropup-button").hide()});jQuery(document).on("change","#tb-tag-explorer-trending-topic-country-select",function(e){TBUtilities.CreateCookie("tb-tag-explorer-country-"+TBGlobal.CurrentChannelId(),jQuery(this).val(),365);he()});jQuery(document).on("click","#tb-tag-explorer-action-dropup-button",function(e){e.stopPropagation();if(jQuery("#tb-tag-explorer-action-dropup-menu").is(":visible")){jQuery("#tb-tag-explorer-action-dropup-menu").hide()}else{if(ue()){jQuery('.tb-tag-explorer-action-dropup-menu-item[data-option="addtovideo"]').removeClass("tb-tag-explorer-action-dropup-menu-item--disabled");jQuery('.tb-tag-explorer-action-dropup-menu-item[data-option="addtovideo"]').removeAttr("disabled");jQuery('.tb-tag-explorer-action-dropup-menu-item[data-option="addtovideo"]').removeAttr("title")}else{jQuery('.tb-tag-explorer-action-dropup-menu-item[data-option="addtovideo"]').addClass("tb-tag-explorer-action-dropup-menu-item--disabled");jQuery('.tb-tag-explorer-action-dropup-menu-item[data-option="addtovideo"]').attr("disabled",true);jQuery('.tb-tag-explorer-action-dropup-menu-item[data-option="addtovideo"]').attr("title","You can only insert this tag when you're editing one of your videos or uploading a new video. Basically, anywhere that you are adding/editing your own tags.")}if(R()>1){jQuery('.tb-tag-explorer-action-dropup-menu-item[data-option="seostudio"]').addClass("tb-tag-explorer-action-dropup-menu-item--disabled");jQuery('.tb-tag-explorer-action-dropup-menu-item[data-option="seostudio"]').attr("disabled",true);jQuery('.tb-tag-explorer-action-dropup-menu-item[data-option="seostudio"]').attr("title","You can only optimize a video for a single keyword/phrase. Please select only one keyword to proceed to SEO Studio.")}else{jQuery('.tb-tag-explorer-action-dropup-menu-item[data-option="seostudio"]').removeClass("tb-tag-explorer-action-dropup-menu-item--disabled");jQuery('.tb-tag-explorer-action-dropup-menu-item[data-option="seostudio"]').removeAttr("disabled");jQuery('.tb-tag-explorer-action-dropup-menu-item[data-option="seostudio"]').removeAttr("title")}var t=TBGlobal.host+TBGlobal.apiUrls.taglistsGetLists;TBExtension.Get(t,function(e,t,i){try{if(e){jQuery(".tb-tag-explorer-lists-container").empty();var o=JSON.parse(i);if(o.length==0){jQuery(".tb-tag-explorer-lists-container").append('<span class="tb-margin-left10">You don\'t have any tag lists</span>')}else{jQuery.each(o,function(e,t){jQuery(".tb-tag-explorer-lists-container").append('<div class="tb-tag-explorer-action-dropup-menu-item" data-option="list" data-list-id="'+t.Id+'" data-list-name="'+t.Name+'"><img src="'+TBGlobal.host+'/images/icons/menu/lists2.png" class="tb-margin-right5"/><span title="'+t.Name+'">'+TBUtilities.Truncate(t.Name,25,true)+"</span></div>")})}}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyTagExplorer] GetLists"})}},null,{contentType:"application/json",dataType:"text"});jQuery("#tb-tag-explorer-action-dropup-menu").show()}});jQuery(document).on("click",".tb-tag-explorer-action-dropup-menu-item",function(e){e.stopPropagation();if(jQuery(this).hasClass("tb-tag-explorer-action-dropup-menu-item--disabled"))return;var t=jQuery(this).attr("data-option");switch(t){case"clipboard":{P();re();R();break}case"addtovideo":{var i=[];jQuery(".tb-tag-explorer-tag-checkbox").each(function(){if(jQuery(this).is(":checked")&&jQuery(this).hasClass("tb-tag-explorer-tag-checkbox-hidden")==false){var e=decodeURIComponent(jQuery(this).attr("data-tag-value"));if(e){i.push(e)}}});var o=TBGlobal.GetYouTubeUI();switch(o){case"studio":{var a=location.pathname;var n=[];TBUtilities.Log(a);if(a){var n=a.substring(1).split("/");for(var s=0;s<5-n.length;s++)n.push("");if(n[0]=="video"&&n[2]=="edit"){TubeBuddyEditVideoStudio.AddTags(i)}else if(n[2]=="videos"&&n[3]=="upload"){TubeBuddyUploadStudio.AddTags(i)}}break}case"material":case"default":{if(document.URL.indexOf("youtube.com/edit")>0){TubeBuddyEditVideo.AddTags(i)}else if(document.URL.indexOf("youtube.com/upload")>0){TubeBuddyUpload.AddTags(jQuery(".tb-upload-tag-sorter-button"),i)}else if(document.URL.indexOf("youtube.com/my_live_events")>0){TubeBuddyLiveEventsVideo.AddTags(i)}break}}re();R();break}case"videotopicplanner":{var i=[];var l=[];jQuery(".tb-tag-explorer-tag-checkbox").each(function(){if(jQuery(this).is(":checked")&&jQuery(this).hasClass("tb-tag-explorer-tag-checkbox-hidden")==false){var e=decodeURIComponent(jQuery(this).attr("data-tag-value"));if(e){i.push(e);l.push({Title:e,SourceType:4})}}});var d=TBGlobal.host+TBGlobal.apiUrls.topicsAddVideoTopics;TBExtension.Post(d,JSON.stringify(l),"CRTBTagExplorerAddVideoTopics",null,{contentType:"application/json"});break}case"seostudio":{jQuery("#tb-tag-explorer-container").hide();var u=jQuery("#tb-tag-explorer-action-dropup-menu").attr("data-clipboard-text");if(r){TubeBuddySeoStudio.ShowSeoStudio(u,null,null,null,null,null,jQuery("#tb-tag-explorer-action-dropup-menu"),r)}else{TubeBuddySeoStudio.ShowSeoStudio(u,null,null,null,null,null,jQuery("#tb-tag-explorer-action-dropup-menu"))}break}case"newlist":{if(!r){TBUtilities.Prompt("What would you like the list name to be?",null,function(e,t){if(t.length==0){TBUtilities.Alert("Please enter a list name.");return}var i={Name:t};var o=TBGlobal.host+TBGlobal.apiUrls.taglistsAddList;TBExtension.Post(o,JSON.stringify(i),function(e,t,i){try{if(e){var o=JSON.parse(i);jQuery(".tb-tag-explorer-lists-container").append('<div class="tb-tag-explorer-action-dropup-menu-item" data-option="list" data-list-id="'+o.Id+'" data-list-name="'+o.Name+'"><img src="'+TBGlobal.host+'/images/icons/menu/lists2.png" class="tb-margin-right5"/><span title="'+o.Name+'">'+TBUtilities.Truncate(o.Name,25,true)+"</span></div>")}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyTagLists] TagListAdd"})}},null,{contentType:"application/json",dataType:"text"})},null)}else{var c=prompt("What would you like the list name to be?","");if(!c||c.length==0){TBUtilities.Alert("Please enter a list name.");return}else{var p={Name:c};var d=TBGlobal.host+TBGlobal.apiUrls.taglistsAddList;TBExtension.Post(d,JSON.stringify(p),function(e,t,i){try{if(e){var o=JSON.parse(i);jQuery(".tb-tag-explorer-lists-container").append('<div class="tb-tag-explorer-action-dropup-menu-item" data-option="list" data-list-id="'+o.Id+'" data-list-name="'+o.Name+'"><img src="'+TBGlobal.host+'/images/icons/menu/lists2.png" class="tb-margin-right5"/><span title="'+o.Name+'">'+TBUtilities.Truncate(o.Name,25,true)+"</span></div>")}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyTagLists] TagListAdd"})}},null,{contentType:"application/json",dataType:"text"})}}break}case"list":{var b=jQuery(this).attr("data-list-id");if(b){var i=[];jQuery(".tb-tag-explorer-tag-checkbox").each(function(){if(jQuery(this).is(":checked")&&jQuery(this).hasClass("tb-tag-explorer-tag-checkbox-hidden")==false){var e=decodeURIComponent(jQuery(this).attr("data-tag-value"));if(e)i.push(e)}});var p={Id:b,Tags:i};var d=TBGlobal.host+TBGlobal.apiUrls.taglistsAddTags;TBExtension.Post(d,JSON.stringify(p),"CRTBTagExplorerAddTags",null,{contentType:"application/json"})}break}}V();setTimeout(function(){se();R()},5e3)})};var X=function(){var e=0;var t=[];jQuery(".tb-tag-explorer-tag-checkbox").each(function(){if(jQuery(this).is(":checked")&&jQuery(this).hasClass("tb-tag-explorer-tag-checkbox-hidden")==false){e++;var i=decodeURIComponent(jQuery(this).attr("data-tag-value"));if(i){t.push(i)}}});jQuery(".tb-tag-explorer-selected-count").text(e);if(e>0){jQuery(".tb-tag-lists-remove").attr("disabled",false);jQuery(".tb-tag-lists-insert").attr("disabled",false)}else{jQuery(".tb-tag-lists-remove").attr("disabled",true);jQuery(".tb-tag-lists-insert").attr("disabled",true)}var i="";var o=t.length;if(t.length>0){jQuery.each(t,function(e,t){if(e==o-1){i+=t}else{i+=t+", "}})}jQuery(".tb-tag-lists-insert").attr("data-clipboard-text",i);jQuery("#tb-tag-explorer-action-dropup-menu").attr("data-clipboard-text",i);return e};var K=function(e){var t=false;if(e&&e.length>=2){t=true}return t};var J=function(e){if(e!=null){d+="\nANoN";m.push(e);S.tags=S.tags+","+e.tags.trim().toLowerCase();S.titles=S.titles+" "+e.title.trim().toLowerCase();S.totalViewCount+=e.viewCount;if(e.channelId==S.topChannelId){if(S.topChannelCount==1&&S.topResult){jQuery("#tb-tag-explorer-top-channel").text(S.topResult.channelTitle);jQuery("#tb-tag-explorer-top-channel").attr("href","https://www.youtube.com/channel/"+S.topResult.channelId);if(S.topResult&&S.topResult.channelThumbnail!=""){jQuery("#tb-tag-explorer-top-channel-thumbnail").attr("src",S.topResult.channelThumbnail)}else{jQuery("#tb-tag-explorer-top-channel-thumbnail").attr("src","https://i.ytimg.com/i/UCo33niDKpTpgwZ_dohqvylg/0.jpg")}jQuery("#tb-tag-explorer-top-channel-how-many").text("Owns 1 of "+S.totalResults+" search results.")}else{jQuery("#tb-tag-explorer-top-channel").text(e.channelTitle);jQuery("#tb-tag-explorer-top-channel").attr("href","https://www.youtube.com/channel/"+e.channelId);jQuery("#tb-tag-explorer-top-channel-how-many").text("Owns "+S.topChannelCount+" of "+S.totalResults+" search results.");var t=m.filter(function(e){return e.channelId===S.topChannelId});if(t&&t[0]&&t[0].channelThumbnail!=""){jQuery("#tb-tag-explorer-top-channel-thumbnail").attr("src",t[0].channelThumbnail)}else{jQuery("#tb-tag-explorer-top-channel-thumbnail").attr("src","https://i.ytimg.com/i/UCo33niDKpTpgwZ_dohqvylg/0.jpg")}}}}else{d+="\nANiN"}d+="\nF/T: "+S.videosFetched+" / "+S.videosTotal;if(S.videosFetched==S.videosTotal){jQuery("#tb-tag-explorer-most-used-tags-loading").hide();jQuery("#tb-tag-explorer-most-used-tags").show();jQuery("#tb-tag-explorer-top-ranking-container-loading").hide();jQuery("#tb-tag-explorer-top-ranking-container").show();jQuery("#tb-tag-explorer-borrowed-tab-no-results").hide();jQuery("#tb-tag-explorer-borrowed-tab-results").show();jQuery("#tb-tag-explorer-most-used-tags-list").show()}else{return}d+="\nTags: "+S.tags;try{var i=new Object;var o=S.tags.split(",");jQuery.each(o,function(e,t){if(t&&t.trim()!=""){if(i[t]==null)i[t]=1;else i[t]++}});var a=Object.keys(i).sort(function(e,t){return i[t]-i[e]});var n=0;if(a[0]!=null)jQuery.each(a,function(e,t){if(n==0)n=i[t]});if(S.topResult!=null&&S.topResultSet==false){S.topResultSet=true;jQuery("#tb-tag-explorer-top-video-channel").text(S.topResult.channelTitle);jQuery("#tb-tag-explorer-top-video-channel").attr("href","https://www.youtube.com/channel/"+S.topResult.channelId);jQuery("#tb-tag-explorer-top-video-title").html(S.topResult.title);jQuery("#tb-tag-explorer-top-video-title").attr("href","https://www.youtube.com/watch?v="+S.topResultVideoId);jQuery("#tb-tag-explorer-top-video-thumbnail").attr("src","https://i.ytimg.com/vi/"+S.topResultVideoId+"/mqdefault.jpg")}jQuery("#tb-tag-explorer-your-channel-thumbnail").attr("src",TBGlobal.Profile().ThumbnailUrl);jQuery("#tb-tag-explorer-your-channel").attr("href","https://www.youtube.com/channel/"+TBGlobal.CurrentChannelId());jQuery("#tb-tag-explorer-your-channel").text(TBUtilities.Truncate(TBGlobal.Profile().Title,25,false));jQuery("#tb-tag-explorer-most-used-tags-list").empty();var r=0;var s=0;jQuery.each(a,function(e,t){if(t.toLowerCase()==u.toLowerCase()){return true}else if(r==3&&!TBGlobal.CanAccessLevel1Tools()){s++}else{var o=" "+t;var a=i[t];var n=TBUtilities.GetTubeBuddyCheckboxHtml(o,"tb-tag-explorer-tag-checkbox","data-tag-value="+encodeURIComponent(o.trim()));var l="tb-single-word";if(t.trim().toString().indexOf(" ")>0)l="";jQuery("#tb-tag-explorer-most-used-tags-list").append('<div class="'+l+' tb-tag-has-external"><div style="float:left; position:relative; top:2px;"><img class="tb-tag-explorer-tag-checkbox-confirm tb-tag-explorer-tag-checkbox-hidden" src="'+TBGlobal.host+'/images/icons/check.png" />'+n+'</div><div style="float:left; line-height: 28px; width:220px"><a class="tb-video-info-suggested-tag" >'+o+'</a> <a target="_blank" href="https://www.youtube.com/results?search_query='+TBUtilities.GetUrlEncoded(o)+'"><img src="'+TBGlobal.host+'/images/icons/external.png" /></a></div><div style="clear:both"></div>');r++}})}catch(e){d+="\nEXB: "+e}};var Z=function(e){jQuery("#tb-tag-explorer-keyword-score-container-loading").hide();jQuery("#tb-tag-explorer-keyword-score-container").show();if(e.Volume&&e.Volume!=null){jQuery(".tb-tag-explorer-search-volume-amount-row").show();jQuery("#tb-tag-explorer-search-volume-amount").html(TBUtilities.FormatNumberAbbreviated(e.Volume))}else{jQuery(".tb-tag-explorer-search-volume-amount-row").hide();jQuery("#tb-tag-explorer-search-volume-amount").html("")}jQuery("#tb-tag-explorer-search-volume").text(S.searchVolumeName);jQuery("#tb-tag-explorer-search-volume").attr("title",e.SearchVolume);jQuery("#tb-tag-explorer-difficulty").text(S.difficultyName);jQuery("#tb-tag-explorer-difficulty").attr("title",e.Competition);var t=TBUtilities.FixLocalHtml("url({PLUGIN_FILE_ROOT}/images/icons/caret-left.png)");if(jQuery("#tb-tag-explorer-competition-chart").highcharts()){jQuery("#tb-tag-explorer-competition-chart").highcharts().destroy()}var i=100-e.Competition;jQuery("#tb-tag-explorer-competition-chart").highcharts({chart:{inverted:true,type:"scatter",margin:[4,4,4,4]},title:{text:null},tooltip:{enabled:false},credits:{enabled:false},yAxis:{gridLineColor:"transparent",min:0,max:100,opposite:true,labels:{enabled:false},title:{text:null},plotBands:[{from:0,to:20,color:g[0]},{from:20,to:40,color:g[1]},{from:40,to:60,color:g[2]},{from:60,to:80,color:g[3]},{from:80,to:100,color:g[4]}]},xAxis:{labels:{enabled:false},tickLength:0,min:0,max:1,minorGridLineWidth:0,lineColor:"transparent",minorTickLength:0,tickLength:0,reversed:true},series:[{data:[i],animation:true,showInLegend:false,color:"#000000",dataLabels:{enabled:false,style:{color:"black"}},marker:{symbol:t},states:{hover:{enabled:false}}}]});if(e.Competition<=20){S.competitionName="Excellent"}else if(e.Competition<=40){S.competitionName="Very Good"}else if(e.Competition<=60){S.competitionName="Good"}else if(e.Competition<=80){S.competitionName="Fair"}else{S.competitionName="Poor"}jQuery("#tb-tag-explorer-unweighted-competition").text(S.competitionName);var o=20;if(e.SearchVolume<=20){S.searchVolumeName="Poor"}else if(e.SearchVolume<=40){S.searchVolumeName="Fair"}else if(e.SearchVolume<=60){S.searchVolumeName="Good"}else if(e.SearchVolume<=80){S.searchVolumeName="Very Good"}else{S.searchVolumeName="Excellent"}jQuery("#tb-tag-explorer-search-volume").text(S.searchVolumeName);jQuery("#tb-tag-explorer-search-volume").attr("title",e.SearchVolume);if(jQuery("#tb-tag-explorer-search-volume-chart").highcharts()){jQuery("#tb-tag-explorer-search-volume-chart").highcharts().destroy()}jQuery("#tb-tag-explorer-search-volume-chart").highcharts({chart:{inverted:true,type:"scatter",margin:[4,4,4,4]},title:{text:null},tooltip:{enabled:false},credits:{enabled:false},yAxis:{gridLineColor:"transparent",min:0,max:100,opposite:true,labels:{enabled:false},title:{text:null},plotBands:[{from:0,to:20,color:g[0]},{from:20,to:40,color:g[1]},{from:40,to:60,color:g[2]},{from:60,to:80,color:g[3]},{from:80,to:100,color:g[4]}]},xAxis:{labels:{enabled:false},tickLength:0,min:0,max:1,lineWidth:0,minorGridLineWidth:0,lineColor:"transparent",minorTickLength:0,tickLength:0},series:[{data:[e.SearchVolume],animation:true,showInLegend:false,color:"#000000",dataLabels:{enabled:false,style:{color:"black"}},marker:{symbol:t},states:{hover:{enabled:false}}}]})};var ee=function(e,t){var e=Math.round(e);jQuery("#tb-tag-explorer-total-score-label").text(t);jQuery("#tb-tag-explorer-total-score").text(e+"/100");if(e<=20){jQuery("#tb-tag-explorer-total-score-label").css("color",g[0])}else if(e>20&&e<40){jQuery("#tb-tag-explorer-total-score-label").css("color",g[1])}else if(e>=40&&e<60){jQuery("#tb-tag-explorer-total-score-label").css("color",g[2])}else if(e>=60&&e<80){jQuery("#tb-tag-explorer-total-score-label").css("color",g[3])}else if(e>=80){jQuery("#tb-tag-explorer-total-score-label").css("color",g[4])}var i=["#0D0D0D","#8e8e8e"];if(jQuery("#tb-tag-explorer-score-chart").highcharts()){var o=jQuery("#tb-tag-explorer-score-chart").highcharts();o.series[0].data[0].update(e)}else{jQuery("#tb-tag-explorer-score-chart").highcharts({chart:{renderTo:"continer",type:"gauge",backgroundColor:"none",margin:[0,0,0,0]},tooltip:{enabled:false},colors:[i[0],i[1]],credits:{enabled:false},title:{text:"",style:{fontFamily:"arial,helvetica,sans-serif",color:i[1],fontWeight:"bold",fontSize:"24px"}},legend:{enabled:false},pane:[{startAngle:-90,endAngle:90,background:null,size:"150%",center:["50%","90%"]}],yAxis:[{min:0,max:100,lineColor:"transparent",tickWidth:2,tickLength:12,tickColor:"transparent",minorTickColor:"transparent",labels:{enabled:false},plotBands:[{from:0,to:20,color:g[0],innerRadius:"50%",outerRadius:"100%"},{from:20,to:40,color:g[1],innerRadius:"50%",outerRadius:"100%"},{from:40,to:60,color:g[2],innerRadius:"50%",outerRadius:"100%"},{from:60,to:80,color:g[3],innerRadius:"50%",outerRadius:"100%"},{from:80,to:100,color:g[4],innerRadius:"50%",outerRadius:"100%"}],pane:0}],plotOptions:{gauge:{dial:{radius:"100%",baseWidth:8,baseLength:3,rearLength:0,labels:{enabled:false}},pivot:{radius:3,backgroundColor:i[1]},showInLegend:false}},series:[{name:"Rank",data:[e],dial:{backgroundColor:i[0]},yAxis:0,dataLabels:{enabled:false,x:0,y:0,color:i[0],borderWidth:0,borderRadius:7,backgroundColor:"#ffffff",padding:1,style:{fontSize:"20px",fontWeight:"bold",lineHeight:"40px"}},states:{hover:{enabled:false}}}]})}};var te=function(){if(c!=null&&L==true){jQuery("#tb-tag-explorer-weighted-score-loading").hide();jQuery("#tb-tag-explorer-weighted-score-container").show()}if(TBGlobal.CanAccessLevel1Tools()==false){var e=jQuery(".tb-tag-explorer-weighted-views:first");var t=e.position();var i=t.left+30+"px";var o=t.top+50+"px";jQuery(".tb-tag-explorer-custom-analysis-upgrade-container").css({position:"absolute",zIndex:5e3,left:i,top:o});jQuery(".tb-tag-explorer-custom-analysis-upgrade-container").show()}};var ie=function(e){jQuery(".tb-tag-explorer-weighted-channel-img").attr("src",TBGlobal.Profile().ThumbnailUrl);if(TBGlobal.CanAccessLevel1Tools()==false){e.WeightedScore=60;e.MedianViews=2e4;e.MedianChannelViews=32e3;e.MedianSubscribers=14e3;e.ChannelSubscribers=15e3}oe(e);ae(e)};var oe=function(e){try{var t=TBUtilities.FixLocalHtml("url({PLUGIN_FILE_ROOT}/images/icons/caret-left.png)");if(jQuery("#tb-tag-explorer-weighted-competition-chart").highcharts()){jQuery("#tb-tag-explorer-weighted-competition-chart").highcharts().destroy()}if(TBGlobal.CanAccessLevel1Tools()==true){var i=100-e.WeightedCompetition;jQuery("#tb-tag-explorer-weighted-competition-chart").highcharts({chart:{inverted:true,type:"scatter",margin:[4,4,4,4]},title:{text:null},tooltip:{enabled:false},credits:{enabled:false},yAxis:{gridLineColor:"transparent",min:0,max:100,opposite:true,labels:{enabled:false},title:{text:null},plotBands:[{from:0,to:20,color:g[0]},{from:20,to:40,color:g[1]},{from:40,to:60,color:g[2]},{from:60,to:80,color:g[3]},{from:80,to:100,color:g[4]}]},xAxis:{labels:{enabled:false},tickLength:0,min:0,max:1,lineWidth:0,minorGridLineWidth:0,lineColor:"transparent",minorTickLength:0,tickLength:0},series:[{data:[i],animation:true,showInLegend:false,color:"#000000",dataLabels:{enabled:false,style:{color:"black"}},marker:{symbol:t},states:{hover:{enabled:false}}}]});var o="";if(i<=20){o="Poor"}else if(i<=40){o="Fair"}else if(i<=60){o="Good"}else if(i<=80){o="Very Good"}else{o="Excellent"}jQuery("#tb-tag-weighted-competition").text(o)}}catch(e){TBUtilities.LogError(e)}};var ae=function(e){if(jQuery(".tb-tag-explorer-weighted-views").highcharts()){jQuery(".tb-tag-explorer-weighted-views").highcharts().destroy()}var t=TBUtilities.FixLocalHtml("{PLUGIN_FILE_ROOT}/images/icons/target.png");jQuery(".tb-tag-explorer-weighted-views").highcharts({chart:{type:"column",style:{fontFamily:"CircularStd-Book"},marginBottom:30,marginTop:10,backgroundColor:"rgba(255, 255, 255, 0.0)"},title:{text:""},xAxis:{categories:["Avg.","Target","Your Channel"],crosshair:false,labels:{useHTML:true,formatter:function(){if(this.value=="Your Channel")return'<img data-tbtooltip="Average (median) views for your last 5 videos" class="tb-tag-explorer-weighted-channel-img" src="'+TBGlobal.Profile().ThumbnailUrl+'" style="height: 20px; vertical-align: middle" />';else if(this.value=="Avg.")return this.value;else if(this.value=="Target")return'<span class="tb-tooltip" data-tbtooltip="Lowest video view count found in top ranking videos"><img  class="tb-tag-explorer-weighted-target" src="'+t+'" /></span>'}},lineWidth:0,minorGridLineWidth:0,lineColor:"transparent",minorTickLength:0,tickLength:0,minPadding:0,maxPadding:0},yAxis:{min:0,title:{text:"Views"},gridLineWidth:1,gridLineDashStyle:"dash"},tooltip:{enabled:false,formatter:function(){return'<div class="tb-tag-explorer-chart-tooltip"><span style="font-size:12px">'+this.key+"</span><br><span>"+this.series.name+":</span><b>"+TBUtilities.FormatNumberAbbreviated(this.y)+"</b></div>"}},plotOptions:{column:{dataLabels:{enabled:true,crop:false,color:"#666666",overflow:"none",formatter:function(){return TBUtilities.FormatNumberAbbreviated(this.y)}},minPointLength:2,pointPadding:.2,borderWidth:0},series:{borderRadius:2}},series:[{name:"Median Views",data:[{y:e.MedianViews,color:"#CDCDCD"},{y:e.LowestViews,color:"#00AE00"},{y:e.MedianChannelViews,color:"#4A90E2"}]}],legend:{enabled:false},credits:{enabled:false}});jQuery('[data-tbtooltip!=""]').qtip({content:{attr:"data-tbtooltip"},style:{classes:"qtip-youtube-tubebuddy"}})};var ne=function(e){jQuery(".tb-tag-explorer-search-result-keyword-count-container").show();var t=TBUtilities.FixLocalHtml("url({PLUGIN_FILE_ROOT}/images/icons/caret-left.png)");if(jQuery("#tb-tag-explorer-keyword-count-chart").highcharts()){jQuery("#tb-tag-explorer-keyword-count-chart").highcharts().destroy()}if(e>=100){e=100}var i=100-e;var o="";if(i<=20){o="Poor"}else if(i<=40){o="Fair"}else if(i<=60){o="Good"}else if(i<=80){o="Very Good"}else{o="Excellent"}jQuery(".tb-tag-explorer-keyword-count").text(o);jQuery("#tb-tag-explorer-keyword-count-chart").highcharts({chart:{inverted:true,type:"scatter",margin:[4,4,4,4]},title:{text:null},tooltip:{enabled:false},credits:{enabled:false},yAxis:{gridLineColor:"transparent",min:0,max:100,opposite:true,labels:{enabled:false},title:{text:null},plotBands:[{from:0,to:20,color:g[0]},{from:20,to:40,color:g[1]},{from:40,to:60,color:g[2]},{from:60,to:80,color:g[3]},{from:80,to:100,color:g[4]}]},xAxis:{labels:{enabled:false},tickLength:0,min:0,max:1,minorGridLineWidth:0,lineColor:"transparent",minorTickLength:0,tickLength:0,reversed:true},series:[{data:[i],animation:true,showInLegend:false,color:"#000000",dataLabels:{enabled:false,style:{color:"black"}},marker:{symbol:t},states:{hover:{enabled:false}}}]})};var re=function(){jQuery(".tb-tag-explorer-tag-checkbox").each(function(){if(jQuery(this).is(":checked")){jQuery(this).closest(".tb-checkbox").addClass("tb-tag-explorer-tag-checkbox-hidden");jQuery(this).closest(".tb-checkbox").siblings(".tb-tag-explorer-tag-checkbox-confirm").removeClass("tb-tag-explorer-tag-checkbox-hidden")}})};var se=function(){jQuery(".tb-tag-explorer-tag-checkbox").each(function(){jQuery(this).closest(".tb-checkbox").removeClass("tb-tag-explorer-tag-checkbox-hidden");jQuery(this).closest(".tb-checkbox").siblings(".tb-tag-explorer-tag-checkbox-confirm").addClass("tb-tag-explorer-tag-checkbox-hidden")})};var le=function(){jQuery(".tb-tag-explorer-tab-header-error").show()};var de=function(){var e=jQuery("#tb-tag-explorer-trending-topic-country-select").empty();A.forEach(function(t){e.append('<option value="'+t.code+'">'+t.country+"</option>")})};var ue=function(){var e=document.location.href;return e.indexOf("/edit")>-1||e.indexOf("youtube.com/upload")>-1||e.indexOf("upload?")>0&&e.indexOf("studio.youtube.com")>0&&jQuery("paper-dialog.ytcp-uploads-dialog#dialog").length>0};var ce=function(){jQuery(document.body).on("CRTBTagExplorerAddTags",function(e,t){try{if(t.success){re();R()}else{TBUtilities.Alert("There was an error copying tag(s) to your list.  Please make sure the list is still active and try again.")}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyTagLists] CRTBTagListAdd"})}});jQuery(document.body).on("CRTBTagExplorerAddVideoTopics",function(e,t){try{if(t.success){TBUtilities.Log(t);if(t.response.indexOf("With")>-1){TBUtilities.Alert(t.response)}else{TBUtilities.Alert("Keywords were successfully saved as Video Topics.<br><Br>Click Video Topic Planner from the main TubeBuddy menu to find them.")}}else{TBUtilities.Alert("There was an error saving Video Topics.")}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyTagLists] CRTBTagExplorerAddVideoTopics"})}});jQuery(document.body).on("CRTBTagExplorerAddList",function(e,t){try{if(t.success){var i=jQuery.parseJSON(t.response)}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyTagLists] CRTBTagListAdd"})}});jQuery(document.body).on("CRTBTagExplorerGetLists",function(e,t){try{if(t.success){jQuery(".tb-tag-explorer-lists-container").empty();var i=jQuery.parseJSON(t.response);if(i.length==0){jQuery(".tb-tag-explorer-lists-container").append('<span class="tb-margin-left10">You don\'t have any tag lists</span>')}else{var o="";jQuery.each(i,function(e,t){o+='<div class="tb-tag-explorer-action-dropdown-action-option" data-option="list" data-list-id="'+t.Id+'" data-list-name="'+t.Name+'" style="margin-left: 5px; margin-bottom:4px; margin-top:2px; padding:3px 4px 1px 14px; font-size: 13px;font-weight: normal;vertical-align: middle; line-height:18px;"><img src="'+TBGlobal.host+'/images/icons/menu/lists2.png" style="height:15px; position:relative; left:-5px;" /><span title="'+t.Name+'" style="position:relative; top:-3px;">'+TBUtilities.Truncate(t.Name,25,true)+"</span></div>"});jQuery(".tb-tag-explorer-lists-container").append(o)}}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyTagExplorer] CRTBTagExplorerGetLists"})}});jQuery(document.body).on("CRTBTagExplorerGetVideoPage",function(e,t){try{d+="\nVR: "+t.success;S.videosFetched++;if(t.success){var i=TBGlobal.GetYouTubeUI();d+="\nytUI1: "+i;if(i=="default"&&t.response.indexOf('window["ytInitialPlayerResponse"]')>-1)i="material";d+="\nytUI2: "+i;switch(i){case"studio":case"material":{var o="";try{var a=t.response.indexOf('window["ytInitialData"] =');if(a!=-1){var n=TBUtilities.ParseResponseContextFromHtml(t.response);o=n.contents.twoColumnWatchNextResults.results.results.contents[1].videoSecondaryInfoRenderer.owner.videoOwnerRenderer.thumbnail.thumbnails["0"].url}}catch(e){TBUtilities.Log(e)}var r;var s;var l;var a=t.response.indexOf('window["ytInitialPlayerResponse"] = ');if(a!=-1){try{var n=TBUtilities.ParsePlayerResponseFromHtml(t.response);var u="";if(n.videoDetails.keywords&&n.videoDetails.keywords.length>0){u=n.videoDetails.keywords.join(",")}var c={videoId:n.videoDetails.videoId,title:n.videoDetails.title,tags:u,channelTitle:n.videoDetails.author,channelId:n.videoDetails.channelId,channelThumbnail:o,viewCount:parseInt(n.videoDetails.viewCount)};if(S.topResultVideoId==c.videoId){S.topResult=c}J(c)}catch(e){TBUtilities.Log("exception "+e);d+="\nEX03: "+e;J(null)}}else{d+="\nNR: true";TBUtilities.Log("no response");J(null)}break}case"default":{var p=t.response;var b=p.indexOf('<meta name="title"');b=p.indexOf('content="',b)+'content="'.length;var y=p.indexOf('"',b);var h=p.substring(b,y);var f=p.indexOf('"keywords":"')+'"keywords":"'.length;var m=p.indexOf('"',f);var g=p.substring(f,m);var v=jQuery("#watch7-user-header",p).find(".yt-thumb-square:first").find("img:first").attr("data-thumb");var T=jQuery("#watch7-user-header",p).find("a:first").attr("data-ytid");var w=jQuery("#watch7-user-header",p).find(".yt-user-info:first").find("a:first").text();var j=jQuery(".watch-view-count",p).html();if(j==null)j=0;j=TBUtilities.ReplaceAll(j," ","");j=TBUtilities.ReplaceAll(j,",","");j=TBUtilities.ReplaceAll(j,".","");j=TBUtilities.ReplaceAll(j,"&nbsp;","");var Q=parseInt(j);if(isNaN(Q))if(j.indexOf("301")>0)Q=301;else Q=0;var c={videoId:t.data.videoId,title:h,tags:g,channelTitle:w,channelId:T,channelThumbnail:v,viewCount:Q};if(S.topResultVideoId==c.videoId)S.topResult=c;J(c);break}}}}catch(e){d+="\nEX04: "+e;TBUtilities.LogError({Exception:e,Location:"[TubeBuddyTagExplorer] CRTBTagExplorerGetVideoPage"});J(null)}});jQuery(document.body).on("CRTBTagExplorerGetYouTubeSearch",function(e,t){try{d+="\nRS: "+t.success;var i=new Object;if(t.data&&t.data.topChannelHash){i=t.data.topChannelHash}if(t.success){if(t.data.page==1){m=[];S={videoCount:0,titles:"",tags:"",numberOfResults:0,topResult:null,topResultVideoId:null,topResultSet:false,yourChannelCount:0,totalResults:0,topChannelId:"",topChannelTitle:"",topChannelThumbnail:"",topChannelCount:0,totalViewCount:0,searchVolumeValue:0,searchVolumeName:"",difficultyValue:0,difficultyName:"",videosFetched:0,videosTotal:0,numberOfExactResults:t.data.numberOfExactResults,numberOfExactViews:t.data.numberOfExactViews,resultNum:0,videoIds:[]};jQuery("#tb-tag-explorer-top-hits").empty();jQuery("#tb-tag-explorer-top-hits").scrollTop(0)}var o=TBGlobal.GetYouTubeUI();if(o=="default"&&t.response.indexOf('window["ytInitialData"]')>-1)o="material";switch(o){case"studio":case"material":{var a=t.response.indexOf('window["ytInitialData"] =');if(a!=-1){var n=TBUtilities.ParseResponseContextFromHtml(t.response);S.numberOfResults=parseInt(n.estimatedResults);jQuery(".tb-tag-explorer-search-result-count").text(TBUtilities.FormatNumberAbbreviated(S.numberOfResults));var r=[];var s=TBUtilities.GetVideoSearchCollectionIndex(n.contents.twoColumnSearchResultsRenderer.primaryContents.sectionListRenderer.contents);if(s!=null){jQuery.each(n.contents.twoColumnSearchResultsRenderer.primaryContents.sectionListRenderer.contents[s].itemSectionRenderer.contents,function(e,t){if(t.videoRenderer){S.resultNum++;var i=t.videoRenderer.videoId;if(S.videoIds.indexOf(i)==-1){var o="";var a="";var n="";var s="https://www.youtube.com/watch?v="+i;if(t.videoRenderer.longBylineText&&t.videoRenderer.longBylineText.runs.length>0){try{o=t.videoRenderer.longBylineText.runs["0"].navigationEndpoint.browseEndpoint.browseId;a=t.videoRenderer.longBylineText.runs["0"].text;n="https://www.youtube.com/channel/"+o;if(o==TBGlobal.CurrentChannelId()){S.yourChannelCount++}r.push(o)}catch(e){TBUtilities.LogError(e)}}S.totalResults++;if(S.topResultVideoId==null)S.topResultVideoId=i;S.videosTotal++;var l="https://www.youtube.com/watch?v="+i;TBExtension.Get(l,"CRTBTagExplorerGetVideoPage",{videoId:i});var d=t.videoRenderer.thumbnail.thumbnails[0].url;var c="";if(t.videoRenderer.title.simpleText){c=t.videoRenderer.title.simpleText}else{if(t.videoRenderer.title.runs){c=t.videoRenderer.title.runs[0].text}}var p="";if(t.videoRenderer.viewCountText&&t.videoRenderer.viewCountText.simpleText){p=t.videoRenderer.viewCountText.simpleText}else{if(t.videoRenderer.viewCountText&&t.videoRenderer.viewCountText.runs){p=t.videoRenderer.viewCountText.runs[0].text}else{p="0"}}var b="";if(t.videoRenderer.descriptionSnippet&&t.videoRenderer.descriptionSnippet.runs){for(var y=0;y<t.videoRenderer.descriptionSnippet.runs.length;y++){b+=t.videoRenderer.descriptionSnippet.runs[y].text}}if(t.videoRenderer.descriptionSnippet&&t.videoRenderer.descriptionSnippet.simpleText){b=t.videoRenderer.descriptionSnippet.simpleText}var h=jQuery("#tb-tag-explorer-video-template").html();var f=isNaN(parseInt(p.replace(/\D/g,"")))?0:parseInt(p.replace(/\D/g,""));var m=TBUtilities.FormatNumberAbbreviated(f)+" views";var g=h.formatTemplate(i,s,c,m,a,n,b,S.resultNum);g=TBUtilities.HighlightText(u.trim(),g);var v=pe(u,C);if(v.length>1){for(var y=0;y<v.length;y++){TBUtilities.Log("inner: "+v[y]);g=TBUtilities.HighlightText(v[y],g,"tb-tag-explorer-highlight-light")}}jQuery("#tb-tag-explorer-top-hits").append(g);S.videoIds.push(i)}}else if(t.channelRenderer){S.resultNum++;S.totalResults++;var o=t.channelRenderer.channelId;if(o==TBGlobal.CurrentChannelId()){S.yourChannelCount++}r.push(o);var n="";var a="";var T="";if(t.channelRenderer.shortBylineText.runs){n=t.channelRenderer.shortBylineText.runs[0].navigationEndpoint.commandMetadata.webCommandMetadata.url;a=t.channelRenderer.shortBylineText.runs[0].text;T=t.channelRenderer.thumbnail.thumbnails[0].url}var h=jQuery("#tb-tag-explorer-channel-template").html();var g=h.formatTemplate(o,T,n,a,S.resultNum);jQuery("#tb-tag-explorer-top-hits").append(g)}if(S.resultNum>=30){return false}})}jQuery("#tb-tag-explorer-your-channel-how-many").text(" Owns "+S.yourChannelCount+" of "+S.totalResults+" search results");jQuery.each(r,function(e,t){if(t){if(t.trim()!=""){if(i[t]==null)i[t]=1;else i[t]++}}});var l=Object.keys(i).sort(function(e,t){return i[t]-i[e]});var c=null;if(l[0]!=null)jQuery.each(l,function(e,t){if(c==null)c=t});S.topChannelId=c;S.topChannelCount=i[c]}jQuery("#tb-tag-explorer-top-hits").find(".tb-tag-explorer-video-result-channel-link").find("span").removeClass("tb-tag-explorer-highlight");break}case"default":{var p=DOMPurify.sanitize(t.response,DOMPurifyConfig);jQuery("#tb-tag-explorer-search-result-count").text(jQuery(".num-results",p).text());var b=jQuery(".num-results",p).html();if(!b)b="";b=b.replace(/\D/g,"");S.numberOfResults=parseInt(b);if(S.numberOfResults>0){var r=[];var p=DOMPurify.sanitize(t.response,DOMPurifyConfig);jQuery(".item-section",p).find("li > div").each(function(){if(S.resultNum>=30){return false}if(jQuery(this).hasClass("spell-correction"))return;S.totalResults++;jQuery(this).find("a").attr("target","_blank");jQuery(this).find(".yt-uix-menu-trigger").remove();var e=jQuery(this)[0].outerHTML;e=TBUtilities.ReplaceAll(e,"yt-uix-sessionlink","");e=TBUtilities.ReplaceAll(e,"spf-link","");e=TBUtilities.ReplaceAll(e,"yt-uix-tile-link","");jQuery("#tb-tag-explorer-top-hits").append(e+"<br />");var t=jQuery(this).find(".yt-lockup-byline").find("a:first").attr("data-ytid");if(t==TBGlobal.CurrentChannelId())S.yourChannelCount++;r.push(t);var i=jQuery(this).find("h3 > a:first");if(i!=null){var o=i.attr("href");if(o==null)o="";if(o.indexOf("watch?")>0){var a=o.indexOf("v=")+2;var n=o.substring(a,a+11);if(S.topResultVideoId==null)S.topResultVideoId=n;S.videosTotal++;var s="https://www.youtube.com/watch?v="+n;TBExtension.Get(s,"CRTBTagExplorerGetVideoPage",{videoId:n});d+="\nGV: "+n}}});jQuery("#tb-tag-explorer-your-channel-how-many").text(" Owns "+S.yourChannelCount+" of "+S.totalResults+" search results");var i=new Object;jQuery.each(r,function(e,t){if(t){if(t.trim()!=""){if(i[t]==null)i[t]=1;else i[t]++}}});var l=Object.keys(i).sort(function(e,t){return i[t]-i[e]});var c=null;if(l[0]!=null)jQuery.each(l,function(e,t){if(c==null)c=t});S.topChannelId=c;S.topChannelCount=i[c];break}}}}else{le()}if(S.totalResults==0){jQuery("#tb-tag-explorer-most-used-tags-loading").hide();jQuery("#tb-tag-explorer-most-used-tags").show();jQuery("#tb-tag-explorer-top-ranking-container-loading").hide();jQuery("#tb-tag-explorer-top-ranking-container").show();jQuery("#tb-tag-explorer-most-used-tags-list").hide();jQuery("#tb-tag-explorer-borrowed-tab-no-results").show();jQuery("#tb-tag-explorer-borrowed-tab-results").show()}}catch(e){d+="\nEX02: "+e;TBUtilities.LogError({Exception:e,Location:"[TubeBuddyTagExplorer] CRTBTagExplorerGetYouTubeSearch"})}finally{if(t.data.page==1){var y="https://www.youtube.com/results?search_query="+TBUtilities.GetUrlEncoded(u)+"&page=2";TBExtension.Get(y,"CRTBTagExplorerGetYouTubeSearch",{numberOfExactViews:0,numberOfExactResults:0,page:2,topChannelHash:i})}else{var h=jQuery("#tb-tag-explorer-top-hits").find(".tb-highlight").length;jQuery(".tb-tag-explorer-search-result-keyword-count").text(TBUtilities.FormatNumberWithCommas(h));var f=be();TBUtilities.Log("strength: "+f);ne(f);L=true;te()}}});jQuery(document.body).on("CRTBTagExplorerGetHistoricalPreload",function(e,t){try{if(t.success){var i=t.response;var o=i.indexOf("token\\x22:\\x22")+"token\\x22:\\x22".length;var a=i.indexOf("\\x22",o);var n=i.substring(o,a);var r=i.indexOf("value\\x22:\\x22")+"value\\x22:\\x22".length;var s=i.indexOf("\\x22",r);var l=i.substring(r,s);var d=new Date;var u=d.getFullYear()+"-"+(d.getMonth()+1).toString().padLeft(2,"0")+"-"+d.getDate().toString().padLeft(2,"0");var c=d.getFullYear()-1+"-"+(d.getMonth()+1).toString().padLeft(2,"0")+"-"+d.getDate().toString().padLeft(2,"0");var p=new Date;p.setDate(p.getDate()-366);var b=p.getFullYear()+"-"+(p.getMonth()+1).toString().padLeft(2,"0")+"-"+p.getDate().toString().padLeft(2,"0");var y=d.getFullYear()-2+"-"+(d.getMonth()+1).toString().padLeft(2,"0")+"-"+d.getDate().toString().padLeft(2,"0");var h="https://trends.google.com/trends/api/widgetdata/multiline?req=%7B%22time%22:%22"+c+"+"+u+"%22,%22resolution%22:%22WEEK%22,%22locale%22:%22en-US%22,%22comparisonItem%22:%5B%7B%22geo%22:%7B%7D,%22complexKeywordsRestriction%22:%7B%22keyword%22:%5B%7B%22type%22:%22BROAD%22,%22value%22:%22"+l+"%22%7D%5D%7D%7D%5D,%22requestOptions%22:%7B%22property%22:%22youtube%22,%22backend%22:%22IZG%22,%22category%22:0%7D%7D&token="+n+"&tz=420";TBExtension.Get(h,"CRTBTagExplorerGetHistorical")}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyTagExplorer] CRTBTagExplorerGetHistoricalPreload"})}});jQuery(document.body).on("CRTBTagExplorerGetHistorical",function(e,t){if(o)return;jQuery("#tb-video-info-historical-container-none").hide();jQuery("#tb-video-info-historical-container").show();jQuery("#tb-video-info-historical-container-apiquota").hide();jQuery("#tb-tag-explorer-h-frame").attr("src","https://trends.google.com/trends/embed/explore/TIMESERIES?req=%7B%22comparisonItem%22%3A%5B%7B%22keyword%22%3A%22"+TBUtilities.GetUrlEncoded(u)+"%22%2C%22geo%22%3A%22%22%2C%22time%22%3A%22today%2012-m%22%7D%5D%2C%22category%22%3A0%2C%22property%22%3A%22youtube%22%7D&tz=420&forceMobileMode=false&isPreviewMode=true&eq=gprop%3Dyoutube%26q%3D"+TBUtilities.GetUrlEncoded(u)+"%26date%3Dtoday%2012-m&hl=enUS");try{if(t.success){if(t.response.toLowerCase().indexOf("enough search volume")>0){jQuery("#tb-video-info-historical-container-none").show();jQuery("#tb-video-info-historical-container").hide()}else if(t.response.toLowerCase().indexOf("error")>0){jQuery("#tb-video-info-historical-container-apiquota").show();jQuery("#tb-video-info-historical-container-none").hide();jQuery("#tb-video-info-historical-container").hide()}}else{jQuery("#tb-video-info-historical-container-none").show();jQuery("#tb-video-info-historical-container").hide()}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyTagExplorer] CRTBTagExplorerGetHistorical"})}});jQuery(document.body).on("CRTBTagExplorerGetGetTablePreload",function(e,t){try{if(t.success){var i=t.response;var o=i.indexOf("token\\x22:\\x22")+"token\\x22:\\x22".length;var a=i.indexOf("\\x22",o);var n=i.substring(o,a);var r=i.indexOf("value\\x22:\\x22")+"value\\x22:\\x22".length;var s=i.indexOf("\\x22",r);var l=i.substring(r,s);var d=new Date;var u=d.getFullYear()+"-"+(d.getMonth()+1).toString().padLeft(2,"0")+"-"+d.getDate().toString().padLeft(2,"0");var c=d.getFullYear()-1+"-"+(d.getMonth()+1).toString().padLeft(2,"0")+"-"+d.getDate().toString().padLeft(2,"0");var p=new Date;p.setDate(p.getDate()-366);var b=p.getFullYear()+"-"+(p.getMonth()+1).toString().padLeft(2,"0")+"-"+p.getDate().toString().padLeft(2,"0");var y=d.getFullYear()-2+"-"+(d.getMonth()+1).toString().padLeft(2,"0")+"-"+d.getDate().toString().padLeft(2,"0");var h="https://trends.google.com/trends/api/widgetdata/comparedgeo?req=%7B%22geo%22:%7B%7D,%22comparisonItem%22:%5B%7B%22time%22:%22"+c+"+"+u+"%22,%22complexKeywordsRestriction%22:%7B%22keyword%22:%5B%7B%22type%22:%22BROAD%22,%22value%22:%22"+l+"%22%7D%5D%7D%7D%5D,%22resolution%22:%22COUNTRY%22,%22locale%22:%22en-US%22,%22requestOptions%22:%7B%22property%22:%22youtube%22,%22backend%22:%22IZG%22,%22category%22:0%7D%7D&token="+n;TBExtension.Get(h,"CRTBTagExplorerGetGetTable")}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyTagExplorer] CRTBTagExplorerGetRisingQueries"})}});jQuery(document.body).on("CRTBTagExplorerGetGetTable",function(e,t){if(o)return;jQuery("#tb-tag-explorer-map-data-container").empty();jQuery("#tb-video-info-map-container-none").hide();jQuery("#tb-video-info-map-container").show();jQuery("#tb-video-info-map-container-apiquota").hide();jQuery("#tb-tag-explorer-m-frame").attr("src","https://trends.google.com/trends/embed/explore/GEO_MAP?req=%7B%22comparisonItem%22%3A%5B%7B%22keyword%22%3A%22"+TBUtilities.GetUrlEncoded(u)+"%22%2C%22geo%22%3A%22%22%2C%22time%22%3A%22today%2012-m%22%7D%5D%2C%22category%22%3A0%2C%22property%22%3A%22youtube%22%7D&tz=420&forceMobileMode=false&isPreviewMode=true&eq=gprop%3Dyoutube%26q%3D"+TBUtilities.GetUrlEncoded(u)+"%26date%3Dtoday%2012-m&hl=enUS");try{if(t.success){if(t.response.toLowerCase().indexOf("enough search volume")>0){jQuery("#tb-video-info-map-container-none").show();jQuery("#tb-tag-explorer-map-data-container").hide();jQuery("#tb-video-info-map-container").hide()}else if(t.response.toLowerCase().indexOf("error")>0){jQuery("#tb-video-info-map-container-none").hide();jQuery("#tb-tag-explorer-map-data-container").hide();jQuery("#tb-video-info-map-container").hide();jQuery("#tb-video-info-map-container-apiquota").show()}else{jQuery("#tb-tag-explorer-map-data-container").append('<div style="border-bottom:dashed 1px #ccc; color:#999; text-align:center; padding-right:4px; padding-bottom:2px; margin-bottom:3px;">Search Volume Index</div>');var i=JSON.parse(t.response.substring(t.response.indexOf("{")));jQuery.each(i.default.geoMapData,function(e,t){jQuery("#tb-tag-explorer-map-data-container").append("<div><span>"+t.geoName+'</span> <div style="float:right; background-color:red; display:inline-block; color:white; font-size:12px; font-weight:bold; text-align:right; height:13px; width:'+parseInt(t.value)/100*70+"px; opacity:"+parseInt(t.value)/100+';"  ><span style="position:relative; top:-2px; left:-2px;">'+t.value+"</span></div>")})}}else{jQuery("#tb-tag-explorer-map-data-container").append('<span style="color:#999; font-size:13px; position:relative; top:10px;">Not enough search volume to show results.<br>Try exploring a more broad Tag.<br>Google restricts this data. If you check this frequently and it\'s not returning results check back in 15 minutes.</span>');jQuery("#tb-video-info-map-container-none").show();jQuery("#tb-tag-explorer-map-data-container").hide();jQuery("#tb-video-info-map-container").hide()}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyTagExplorer] CRTBTagExplorerGetGetTable"})}});jQuery(document.body).on("CRTBTagExplorerGetRisingQueriesPreload",function(e,t){try{if(t.success){var i=t.response;var o=i.indexOf("token\\x22:\\x22")+"token\\x22:\\x22".length;var a=i.indexOf("\\x22",o);var n=i.substring(o,a);var r=i.indexOf("value\\x22:\\x22")+"value\\x22:\\x22".length;var s=i.indexOf("\\x22",r);var l=i.substring(r,s);var d=new Date;var u=d.getFullYear()+"-"+(d.getMonth()+1).toString().padLeft(2,"0")+"-"+d.getDate().toString().padLeft(2,"0");var c=new Date;c.setDate(c.getDate()-1);var p=d.getFullYear()-1+"-"+(d.getMonth()+1).toString().padLeft(2,"0")+"-"+d.getDate().toString().padLeft(2,"0");var b=new Date;b.setDate(b.getDate()-366);var y=b.getFullYear()+"-"+(b.getMonth()+1).toString().padLeft(2,"0")+"-"+b.getDate().toString().padLeft(2,"0");var h=c.getFullYear()-2+"-"+(c.getMonth()+1).toString().padLeft(2,"0")+"-"+c.getDate().toString().padLeft(2,"0");var f="https://trends.google.com/trends/api/widgetdata/relatedsearches?req=%7B%22restriction%22:%7B%22geo%22:%7B%7D,%22time%22:%22"+p+"+"+u+"%22,%22originalTimeRangeForExploreUrl%22:%22today+12-m%22,%22complexKeywordsRestriction%22:%7B%22keyword%22:%5B%7B%22type%22:%22BROAD%22,%22value%22:%22"+l+"%22%7D%5D%7D%7D,%22keywordType%22:%22QUERY%22,%22metric%22:%5B%22TOP%22,%22RISING%22%5D,%22trendinessSettings%22:%7B%22compareTime%22:%22"+h+"+"+y+"%22%7D,%22requestOptions%22:%7B%22property%22:%22youtube%22,%22backend%22:%22IZG%22,%22category%22:0%7D,%22language%22:%22en%22%7D&token="+n;TBExtension.Get(f,"CRTBTagExplorerGetRisingQueries")}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyTagExplorer] CRTBTagExplorerGetRisingQueries"})}});jQuery(document.body).on("CRTBTagExplorerGetRisingQueries",function(e,t){jQuery("#tb-tag-explorer-rising-queries").empty();jQuery("#tb-tag-explorer-top-queries").empty();if(o)return;jQuery("#tb-tag-explorer-top-queries-container").show();jQuery("#tb-tag-explorer-top-queries-apiquota").hide();try{if(t.success){var i=JSON.parse(t.response.substring(t.response.indexOf("{")));if(i.default.rankedList[1].rankedKeyword.length==0){jQuery("#tb-tag-explorer-rising-queries").append('<span style="color:#999; font-size:13px; position:relative; top:10px;">Not enough search volume to show results.<Br>Try exploring a more broad Tag.<br>Google restricts this data. If you check this frequently and it\'s not returning results check back in 15 minutes.</span>');jQuery("#tb-tag-explorer-top-queries").append('<span style="color:#999; font-size:13px; position:relative; top:10px;">Not enough search volume to show results.<Br>Try exploring a more broad Tag.<br>Google restricts this data. If you check this frequently and it\'s not returning results check back in 15 minutes.</span></span>')}else if(t.response.toLowerCase().indexOf("error")>0){jQuery("#tb-tag-explorer-top-queries-container").hide();jQuery("#tb-tag-explorer-top-queries-apiquota").show()}else{var a=0;var n=0;jQuery.each(i.default.rankedList[1].rankedKeyword,function(e,t){if(a==3&&!TBGlobal.CanAccessLevel1Tools()){n++}else{var i=TBUtilities.GetTubeBuddyCheckboxHtml(t.query,"tb-tag-explorer-tag-checkbox","data-tag-value="+encodeURIComponent(t.query));jQuery("#tb-tag-explorer-rising-queries").append('<div class="tb-tag-has-external"><img class="tb-tag-explorer-tag-checkbox-confirm tb-tag-explorer-tag-checkbox-hidden" src="'+TBGlobal.host+'/images/icons/check.png" />'+i+'<a class= "tb-video-info-suggested-tag tb-video-info-suggested-tag-adjusted"> '+t.query+'</a><a class="tb-video-info-suggested-tag-adjusted" target="_blank" href="https://www.youtube.com/results?search_query='+TBUtilities.GetUrlEncoded(t.query)+'"><img class="tb-margin-left3" src="'+TBGlobal.host+'/images/icons/external.png" /></a> <div style="float:right;  color:#333; font-size:12px; font-weight:bold; text-align:right;">'+t.formattedValue+"</div>");a++}});if(n>0){jQuery(".tb-tag-explorer-rising-queries-upgrade-count").text(n+a);var r=jQuery("#tb-tag-explorer-rising-queries").position();var s=200;var l=0;var d=r.left+s-l+25+"px";var u=150+r.top+"px";jQuery(".tb-tag-explorer-rising-queries-upgrade-container").css({position:"absolute",zIndex:5e3,left:d,top:u});jQuery(".tb-tag-explorer-rising-queries-upgrade-container").show()}a=0;n=0;jQuery.each(i.default.rankedList[0].rankedKeyword,function(e,t){if(a==3&&!TBGlobal.CanAccessLevel1Tools()){n++}else{var i=TBUtilities.GetTubeBuddyCheckboxHtml(t.query,"tb-tag-explorer-tag-checkbox","data-tag-value="+encodeURIComponent(t.query));jQuery("#tb-tag-explorer-top-queries").append('<div class="tb-tag-has-external"><img class="tb-tag-explorer-tag-checkbox-confirm tb-tag-explorer-tag-checkbox-hidden" src="'+TBGlobal.host+'/images/icons/check.png" />'+i+'<a class="tb-video-info-suggested-tag tb-video-info-suggested-tag-adjusted">'+t.query+'</a> <a class="tb-video-info-suggested-tag-adjusted" target="_blank" href="https://www.youtube.com/results?search_query='+TBUtilities.GetUrlEncoded(t.query)+'"><img src="'+TBGlobal.host+'/images/icons/external.png" /></a> <div style="border-radius: 2px; float:right; background-color:#4A90E2; display:inline-block; color:white; font-size:12px; font-weight:bold; text-align:right; height:15px; width:'+parseInt(t.value)/100*70+"px; opacity:"+parseInt(t.value)/100+';"  ><span class="tb-tag-explorer-bar-percent" style="position:relative; top:-4px; left:-2px;">'+t.formattedValue+"</span></div>");a++}});if(n>0){jQuery(".tb-tag-explorer-top-queries-upgrade-count").text(n+a);var r=jQuery("#tb-tag-explorer-top-queries").position();var s=200;var l=0;var d=r.left+s-l+25+"px";var u=150+r.top+"px";jQuery(".tb-tag-explorer-top-queries-upgrade-container").css({position:"absolute",zIndex:5e3,left:d,top:u});jQuery(".tb-tag-explorer-top-queries-upgrade-container").show()}}}else{jQuery("#tb-tag-explorer-rising-queries").append('<span style="color:#999; font-size:13px; position:relative; top:10px;">Not enough search volume to show results.<Br>Try exploring a more broad Tag.<br>Google restricts this data. If you check this frequently and it\'s not returning results check back in 15 minutes.</span>')}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyTagExplorer] CRTBTagExplorerGetRisingQueries"})}});jQuery(document.body).on("CRTBLoadTagExplorerTemplate",function(e,t){try{if(t.success){if(jQuery("#tb-tag-explorer-container").length>0){jQuery("#tb-tag-explorer-container").remove()}t.response=TBUtilities.FixLocalHtml(DOMPurify.sanitize(t.response,DOMPurifyConfig));if(r){r.append(t.response)}else{jQuery("body").append(t.response)}if(!TBGlobal.Profile().IsPaidLicense){$("#tb-tag-explorer-total-results-label").hide();$(".tb-tag-explorer-search-result-count-area").hide();$("#tb-tag-explorer-search-results-tab-results").hide()}E();fe(n)}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyTagExplorer] CRTBLoadTagExplorerTemplate"})}});jQuery(document.body).on("CRTBTagExplorerGetTagScore",function(e,t){try{if(t.success){var i=jQuery.parseJSON(t.response);if(i.length>0&&i[0].Score!=null){c=i[0];TBUtilities.Log(c);Z(c);ie(c);if(TBGlobal.CanAccessLevel1Tools()==true){F(f,c)}else{F("unweighted",c)}Y();jQuery(".tb-tag-explorer-header-characters").hide();if(c.Tag!==u.toLowerCase()){jQuery("#tb-tag-explorer-input").val(c.Tag);jQuery(".tb-video-info-selected-tag").text(c.Tag);jQuery(".tb-tag-explorer-header-characters").show()}}}else{c=null;if(t.response===430){TBUtilities.Alert("Sorry, due to YouTube API restrictions you've reached the daily limit of 500 keywords.  Please come back in 24 hours.")}else if(TBGlobal.CanAccessLevel1Tools()==false&&t.response==429){TBGlobal.ShowUpgradePage("retrieve any more keyword scores","Pro")}}}catch(e){c=null;TBUtilities.LogError({Exception:e,Location:"[TubeBuddyTagExplorer] CRTBLoadTagExplorerTemplate"})}finally{var o=true;if(TBGlobal.Profile().IncognitoSearch===true){o=false}var a="https://www.youtube.com/results?search_query="+TBUtilities.GetUrlEncoded(u);TBExtension.Get(a,"CRTBTagExplorerGetYouTubeSearch",{numberOfExactViews:0,numberOfExactResults:0,page:1},{credentials:o})}});jQuery(document.body).on("CRTBTopicGeneratorHotTrends",function(e,t){TBUtilities.Log("CRTBTopicGeneratorHotTrends");TBUtilities.Log(t);try{if(t.success){var o=new Array;var a=jQuery(jQuery.parseXML(t.response));a.find("item").each(function(){var e=jQuery(this);var t={title:e.find("title").text(),link:e.find("link").text(),description:e.find("description").text(),pubDate:e.find("pubDate").text(),picture:e.filterNode("ht:picture").text(),approxtraffic:e.filterNode("ht:approx_traffic").text(),newsItemTitle:e.filterNode("ht:news_item_title").text()};o.push(t)});jQuery("#tb-tag-explorer-trending-list-loading").hide();jQuery("#tb-tag-explorer-trending-list").empty();var n="";for(i=0;i<o.length;i++){var r=jQuery("#tb-tag-explorer-trending-template").html();rowTemplate=r.formatTemplate(o[i].title,o[i].link,o[i].picture,o[i].approxtraffic,o[i].newsItemTitle);n+=rowTemplate}jQuery("#tb-tag-explorer-trending-list").append(n);jQuery("#tb-tag-explorer-trending-list").show()}else{jQuery("#tb-tag-explorer-trending-related-container").hide()}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyTopicGenerator] CRTBTopicGeneratorHotTrends"})}})};var pe=function(e,t){var i=[];try{var o=e.match(/\w+/g),a={},n,r;t=t.split(",");for(r=0;r<t.length;r++){a[t[r].trim()]=true}if(o){for(r=0;r<o.length;r++){n=o[r].trim().toLowerCase();if(!a[n]){i.push(n)}}}}catch(e){TBUtilities.LogError(e)}return i};var be=function(){var e=0;TBUtilities.Log("Checking Strength");var t=jQuery("#tb-tag-explorer-top-hits").text();TBUtilities.Log("Start: "+t.length);e+=TBUtilities.CountMatches(t,u,true,true,false);TBUtilities.Log("M1: "+e);var i=u.split(" ");TBUtilities.Log("Words: "+i);TBUtilities.Log("Words Length: "+i.length);if(i.length>1){for(var o=0;o<i.length;o++){var a=TBUtilities.CountMatches(t,i[o],true,true,false);TBUtilities.Log("wordMatches word: "+i[o]);TBUtilities.Log("wordMatches count: "+a);e+=a/(i.length*i.length*.75);TBUtilities.Log("matches: "+e)}}TBUtilities.Log("Final Score: "+e);return parseInt(e)};var ye=function(e,t){var t=Math.round(t);var i=jQuery("#tb-tag-explorer-recent-list").find('a[data-tag="'+e+'"]');if(i){var o=i.parent().find(".tb-tag-explorer-recent-list-score");var a=i.parent().first();if(o.length==0){a.append('<span title="keyword score" class="tb-tag-explorer-recent-list-score"> '+t+"</span>")}else{o.text(t)}}};var he=function(){jQuery("#tb-topic-generator-trending-list-loading").show();jQuery("#tb-topic-generator-trending-list").hide();var e=TBUtilities.GetCookie("CONSENT");var t=A.map(function(e){return e.code});var i=TBUtilities.GetCookie("tb-tag-explorer-country-"+TBGlobal.CurrentChannelId());var o="US";if(i){o=i}else if(e){var a=e.split("+")[1].slice(0,2);if(t.indexOf(a))o=a}jQuery(document).ready(function(){jQuery("#tb-tag-explorer-trending-topic-country-select").val(o)});var n="https://trends.google.com/trends/trendingsearches/daily/rss?geo="+o;TBExtension.Get(n,"CRTBTopicGeneratorHotTrends")};var fe=function(){if(TBGlobal.CanAccessLevel1Tools()==true){TBExtension.GetDbValue("tb-tag-explorer-weighted-option"+TBGlobal.CurrentChannelId(),function(e,t){if(t){F(t)}else{F("weighted")}})}else{jQuery(".tb-tag-explorer-keyword-score-unweighted-option").addClass("tb-tag-explorer-tab-active");jQuery(".tb-tag-explorer-keyword-score-weighted-option").addClass("tb-tag-explorer-keyword-score-weighted-disabled")}jQuery("#tb-tag-explorer-back").hide();G(n);he();de();jQuery('[data-tbtooltip!=""]').qtip({content:{attr:"data-tbtooltip"},style:{classes:"qtip-youtube-tubebuddy"}})};return{ShowTagExplorer:function(t,i,o,l,d){a=i;n=t?t:"";if(o&&o.length>0){U=o}if(TBGlobal.IsAuthenticated()){if(l){r=l}else{r=null}if(d){s=d}else{s=null}if(!e){if(TBExtension.GetType()==="firefox"){window.requestAnimationFrame=window.requestAnimationFrame.bind(window)}ce();q();I();e=true}else{I()}}},GetScoreColors:function(){return g},GetScore:function(){return c}}}();var TubeBuddyTwitterFeed=function(){var e=false;var t;var i;var o=false;var a=function(){console.log("TwitterFeed.loadHtml");var e=TBGlobal.host+"/ModuleManager/twitterfeed/twitterfeed?v="+TBGlobal.versionNumber;if(loadLocalHTML&&(TBExtension.GetType()==="chrome"||TBExtension.GetType()==="firefox")){e=chrome.extension.getURL("modules/twitterfeed.html")}else if(loadLocalHTML&&TBExtension.GetType()==="safari"){e="modules/twitterfeed.html"}TBExtension.Get(e,"CRTBLoadTwitterFeedTemplate")};var n=function(){jQuery(".tb-twitter-loading").slideDown();TBExtension.Get(TBGlobal.host+TBGlobal.apiUrls.twitterGetMentions+"?twitterId="+i.Id,"CRTBTwitterFeedData")};var r=function(){setTimeout(function(){jQuery(".tb-twitter-main-icon").css("display","inline-block")},1e3);if(TBGlobal.Profile().TwitterAccounts!==null&&TBGlobal.Profile().TwitterAccounts.length>0){jQuery.each(TBGlobal.Profile().TwitterAccounts,function(e,t){var i=jQuery(".tb-twitter-handle-template:last")[0].outerHTML;if(i.length>0){i=TBUtilities.ReplaceAll(i,"#TWITTER_ID#",t.Id);i=TBUtilities.ReplaceAll(i,"#SCREEN_NAME#",t.ScreenName);i=TBUtilities.ReplaceAll(i,"#THUMBNAIL_URL#",t.ThumbnailUrl);jQuery(".tb-twitter-account").append(i);setTimeout(function(){(function(){var e=document.querySelectorAll(".tb-twitter-btn"),t=function(t){Array.prototype.forEach.call(e,function(e){t.call(this,e)})},i=function(e){e.preventDefault();e.stopPropagation();t(function(e){e.classList.remove("dropdown-open")});this.classList.toggle("dropdown-open")},o=function(){t(function(e){e.classList.remove("dropdown-open")})};t(function(e){e.addEventListener("touchend",function(e){i.call(this,e)});e.addEventListener("click",function(e){i.call(this,e)})});document.addEventListener("touchend",function(){o()});document.addEventListener("click",function(){o()})})()},1e3)}else{}});jQuery(".tb-twitter-account").append('<li class="tb-switch-accounts-li"><a class="tb-switch-accounts" href="'+TBGlobal.host+"/socialaccounts/twitteroauthredirect?redirectUrl="+encodeURIComponent(window.location)+'" target="_blank"><i class="fas fa-cog"></i> Manage Accounts</a></li>');i=TBGlobal.Profile().TwitterAccounts[0];TBUtilities.Log(i);jQuery(".tb-twitter-btn").append('<img src="'+i.ThumbnailUrl+'" /> @'+i.ScreenName);TBUtilities.Log("ID: "+i.Id);if(i.DoFetchOnLoad==true&&TBGlobal.Profile().IsLoggedIn===true){i.DoFetchOnLoad=false;n()}if(TBGlobal.Profile().IsLoggedIn===false){jQuery(".tb-twitter-message").hide()}}else{if(TBGlobal.Profile().IsLoggedIn===true){jQuery(".tb-twitter-notification").html(jQuery(".tb-twitter-account-link:last")[0].outerHTML);jQuery(".tb-twitter-link-button").attr("href",TBGlobal.host+"/socialaccounts/twitteroauthredirect?redirectUrl="+encodeURIComponent(window.location))}else{var e=jstz.determine_timezone();var t=e.timezone;if(t!="undefined"){t.ambiguity_check()}var o=t.utc_offset;jQuery(".tb-twitter-notification").html(jQuery(".tb-twitter-account-login:last")[0].outerHTML);jQuery(".tb-twitter-login-button").attr("href",TBGlobal.host+"/oauth/AuthRedirectLogin/?channelid="+TBGlobal.CurrentChannelId()+"&redirectUrl="+encodeURIComponent(window.location)+"&timeZoneOffset="+encodeURIComponent(o)+"&via=extension&channelId="+TBGlobal.CurrentChannelId())}jQuery(".tb-switch-accounts").hide();jQuery(".tb-twitter-notification").show()}};var s=function(){jQuery(".tb-twitter-notification").empty();var e=0;jQuery.each(t,function(t,o){var a=jQuery(".tb-twitter-entry-template:last")[0].outerHTML;if(a.length>0){a=TBUtilities.ReplaceAll(a,"#THUMBNAIL_URL#",o.AuthorProfileImageUrl);a=TBUtilities.ReplaceAll(a,"#NAME#",o.AuthorName);a=TBUtilities.ReplaceAll(a,"#HANDLE#",o.AuthorHandle);a=TBUtilities.ReplaceAll(a,"#TEXT#",o.TextAsHtml);a=TBUtilities.ReplaceAll(a,"#ID#",o.Id);a=TBUtilities.ReplaceAll(a,"#FILTER#",o.Filter);a=TBUtilities.ReplaceAll(a,"#CREATED_DATE#",o.CreatedDateFriendly);a=TBUtilities.ReplaceAll(a,"#ACCOUNT_AVATAR#",i.ThumbnailUrl);if(o.Images&&o.Images.length>0){a=TBUtilities.ReplaceAll(a,"#IMAGE_DISPLAY#","");a=TBUtilities.ReplaceAll(a,"#IMAGE_URL#",o.Images[0])}else{a=TBUtilities.ReplaceAll(a,"#IMAGE_DISPLAY#","hidden")}if(o.IsUnRead){a=TBUtilities.ReplaceAll(a,"#UNREAD#","tb-twitter-mention-unread");e++}else a=TBUtilities.ReplaceAll(a,"#UNREAD#","hidden");if(o.IsRetweeted)a=TBUtilities.ReplaceAll(a,"#RETWEETED#","selected");else a=TBUtilities.ReplaceAll(a,"#RETWEETED#","");if(o.IsFavorited)a=TBUtilities.ReplaceAll(a,"#FAVORITED#","selected");else a=TBUtilities.ReplaceAll(a,"#FAVORITED#","");if(o.RetweetCount>0)a=TBUtilities.ReplaceAll(a,"#RETWEET_COUNT#",o.RetweetCount);else a=TBUtilities.ReplaceAll(a,"#RETWEET_COUNT#","");if(o.FavoriteCount>0)a=TBUtilities.ReplaceAll(a,"#FAVORITE_COUNT#",o.FavoriteCount);else a=TBUtilities.ReplaceAll(a,"#FAVORITE_COUNT#","");jQuery(".tb-twitter-notification").append(a)}});if(e>0){jQuery(".tb-twitter-main-icon-notice").show();if(e>99)jQuery(".tb-twitter-main-icon-notice-value").text("99");else jQuery(".tb-twitter-main-icon-notice-value").text(e)}else{jQuery(".tb-twitter-main-icon-notice").hide()}};var l=function(){jQuery(document).on("click",".tb-twitter-main-icon",function(e){TBUtilities.Log("_isLoaded "+o);jQuery(".tb-twitter-app").show("slow");if(TBGlobal.Profile().IsLoggedIn===false){jQuery(".tb-twitter-message").hide()}if(!o&&TBGlobal.Profile().TwitterAccounts.length>0&&TBGlobal.Profile().IsLoggedIn===true){n();setTimeout(function(){TBExtension.Get(TBGlobal.host+TBGlobal.apiUrls.twitterReadMentions+"?twitterId="+i.Id,"CRTBTwitterReadMentions")},5e3)}e.stopPropagation()});jQuery(document).on("click"," #content, #container",function(e){jQuery(".tb-twitter-app").hide()});jQuery(document).on("click",".tb-twitter-handle-template",function(e){var t=jQuery(this).attr("data-tweet-id");i=TBUtilities.GetInArray(TBGlobal.Profile().TwitterAccounts,"Id",t);jQuery(".tb-twitter-btn").empty();jQuery(".tb-twitter-btn").append('<img style="height:25px; border-radius:50%; margin-right:5px;" src="'+i.ThumbnailUrl+'" /> @'+i.ScreenName);n()});jQuery(document).on("focus",".tb-twitter-reply-box",function(){jQuery(".tb-emoji-toggle").hide();jQuery(this).before('<span class="tb-emoji-toggle"><i class="material-icons">sentiment_very_satisfied</i></span>')});jQuery(document).on("click",".tb-twitter-refresh",function(){n()});jQuery(document).on("click",".tb-icon-star",function(e){var t=jQuery(this).attr("data-tweet-id");var o=jQuery(this).hasClass("selected");var a=jQuery.param({SocialAccountId:i.Id,TweetId:t});if(o)TBExtension.Post(TBGlobal.host+TBGlobal.apiUrls.twitterUnFavorite,a,"TBLayoutTwitterFavorite",null,{contentType:"application/x-www-form-urlencoded; charset=UTF-8"});else TBExtension.Post(TBGlobal.host+TBGlobal.apiUrls.twitterFavorite,a,"TBLayoutTwitterFavorite",null,{contentType:"application/x-www-form-urlencoded; charset=UTF-8"});if(!o)jQuery(this).addClass("selected");else jQuery(this).removeClass("selected")});jQuery(document).on("click",".tb-icon-retweet",function(e){var t=jQuery(this).attr("data-tweet-id");var o=jQuery(this).hasClass("selected");var a=jQuery.param({SocialAccountId:i.Id,TweetId:t});if(o)TBExtension.Post(TBGlobal.host+TBGlobal.apiUrls.twitterRemoveRetweet,a,"TBLayoutTwitterReTweet",{contentType:"application/x-www-form-urlencoded; charset=UTF-8"});else TBExtension.Post(TBGlobal.host+TBGlobal.apiUrls.twitterRetweet,a,"TBLayoutTwitterReTweet",{contentType:"application/x-www-form-urlencoded; charset=UTF-8"});if(!o)jQuery(this).addClass("selected");else jQuery(this).removeClass("selected")});jQuery(document).on("click",".tb-submitReply",function(e){var t=jQuery(this).attr("data-tweet-id");var o=jQuery(this).attr("data-tweet-screenname");var a=jQuery("#reply-text-"+t).val();if(!a){alertify.alert("Please enter a Message");return}var n=jQuery.param({SocialAccountId:i.Id,TweetId:t,Message:a,ScreenName:o});TBExtension.Post(TBGlobal.host+TBGlobal.apiUrls.twitterReply,n,"TBLayoutTwitterReply",{Id:t},{contentType:"application/x-www-form-urlencoded; charset=UTF-8"})});jQuery(document).on("click",".tb-icon-mail-reply",function(e){var t=jQuery(this).attr("data-tweet-id");jQuery("#reply-"+t).slideDown("fast")});jQuery(document).on("focusin",".tb-textarea textarea",function(e){jQuery(this).addClass("tb-focus");jQuery(".tb-addTweet").addClass("tb-change")});jQuery(document).on("click",".tb-closeTweet",function(e){var t=jQuery(this).attr("data-tweet-id");jQuery(".tb-textarea textarea").removeClass("tb-focus");jQuery(".tb-addTweet").removeClass("tb-change");jQuery("#reply-"+t).slideUp("fast")})};var d=function(){jQuery(document.body).on("TBLayoutTwitterReply",function(e,t){try{if(t.success){var i=JSON.parse(t.response);TBUtilities.Log(e);TBUtilities.Log(t);jQuery("#reply-success-link-"+t.data.Id).attr("href",i.Url);jQuery("#reply-"+t.data.Id).hide();jQuery("#reply-success-"+t.data.Id).show()}else{}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyTwitterFeed] CRTBLoadTwitterFeedTemplate"})}});jQuery(document.body).on("CRTBLoadTwitterFeedTemplate",function(e,t){try{if(t.success){t.response=TBUtilities.FixLocalHtml(DOMPurify.sanitize(t.response,DOMPurifyConfig));jQuery("body").append(t.response);r()}else{}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyTwitterFeed] CRTBLoadTwitterFeedTemplate"})}});jQuery(document.body).on("CRTBTwitterFeedData",function(e,i){try{console.log("TwitterFeed.CRTBTwitterFeedData Loaded");if(i.success){o=true;console.log("TwitterFeed.CRTBTwitterFeedData Parsing Data");t=JSON.parse(i.response);s()}else{}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyTwitterFeed] CRTBLoadTwitterFeedTemplate"})}jQuery(".tb-twitter-loading").hide();jQuery(".tb-twitter-notification").fadeIn()})};return{Initialize:function(){console.log("TwitterFeed.Initialize");if(TBGlobal.IsAuthenticated()){if(!e){l();d();a();e=true}}}}}();var TubeBuddyBestTimeToPublish=function(){var e;var t;var i=false;var o;var a;var n;var r=function(e){var t=(new Date).getTimezoneOffset();var i=e?TBGlobal.host+"/api/besttimetopublish/calculate":TBGlobal.host+"/api/besttimetopublish/getdata";TBExtension.Get(i+"?offset="+t,"CRTBBestTimeToPublishGetData")};var s=function(){var e=TBGlobal.host+"/ModuleManager/besttimetopublish?v="+TBGlobal.versionNumber;if(loadLocalHTML&&(TBExtension.GetType()=="chrome"||TBExtension.GetType()=="firefox")){e=chrome.extension.getURL("modules/besttimetopublish.html")}else if(loadLocalHTML&&TBExtension.GetType()==="safari"){e="modules/besttimetopublish.html"}TBExtension.Get(e,"CRTBLoadBestTimeToPublishTemplate")};var l=function(){try{TBUtilities.Log("Populating views chart.");e=false;var t=$("#tb-views-type").val();var i="Views";switch(t){case"both":i="Subscribed & not subscribed views";break;case"subscribed":i="Subscribed views";break;case"notSubscribed":i="Not subscribed views";break}var n={chart:{type:"column"},title:null,subtitle:null,xAxis:{categories:["Sun","Mon","Tue","Wed","Thur","Fri","Sat"],crosshair:true},yAxis:{min:0,title:null},tooltip:{headerFormat:'<span style="font-size:10px">{point.key}</span><table>',pointFormat:'<tr><td style="color:{series.color};padding:0">{series.name}: </td>'+'<td style="padding:0"><b>{point.y:.0f}</b></td></tr>',footerFormat:"</table>",shared:true,useHTML:true},plotOptions:{column:{pointPadding:.2,borderWidth:0}},credits:{enabled:false},series:[]};var r={showInLegend:false,name:"Views",data:[]};var s=Math.max.apply(Math,o.DailyViews.map(function(e){switch(t){case"both":return e.Views;case"subscribed":return e.SubscriberViews;case"notSubscribed":return e.Views-e.SubscriberViews>0?e.Views-e.SubscriberViews:0}}));var l=0;var d=false;$.each(o.DailyViews,function(e,i){var o=0;switch(t){case"both":o=i.Views;break;case"subscribed":o=i.SubscriberViews;break;case"notSubscribed":o=i.Views-i.SubscriberViews;break}if(o===s&&!d){l++;d=true;r.data.push({y:o,color:"#00FF00"});a=i.Day}else r.data.push(o)});if(l>1)e=true;n.series.push(r);$("#viewsChart").highcharts(n);$("#tb-comments-day").val(-1);c();TBUtilities.Log("Populated views chart.")}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyBestTimeToPublish] populateViewsChart"})}};var d=function(){TBUtilities.Log("Populating comments chart.");try{t=false;var e={chart:{type:"column"},title:null,subtitle:null,xAxis:{categories:["12 AM","1 AM","2 AM","3 AM","4 AM","5 AM","6 AM","7 AM","8 AM","9 AM","10 AM","11 AM","12 PM","1 PM","2 PM","3 PM","4 PM","5 PM","6 PM","7 PM","8 PM","9 PM","10 PM","11 PM"],crosshair:true},yAxis:{min:0,title:null},tooltip:{headerFormat:'<span style="font-size:10px">{point.key}</span><table>',pointFormat:'<tr><td style="color:{series.color};padding:0">{series.name}: </td>'+'<td style="padding:0"><b>{point.y:.0f}</b></td></tr>',footerFormat:"</table>",shared:true,useHTML:true},plotOptions:{column:{pointPadding:.2,borderWidth:0}},credits:{enabled:false},series:[]};var i={showInLegend:false,name:"Comments",data:[]};var a=jQuery("#tb-comments-day").val();var r=[];if(a>-1){r=jQuery.grep(o.HourlyComments,function(e){var t=e.Day==a;return t})}else{jQuery.each(o.HourlyComments,function(e,t){if(r.length>t.Hour&&r[t.Hour]){r[t.Hour].Comments+=t.Comments}else{r[t.Hour]=jQuery.extend({},t)}})}var s=0;var l=Math.max.apply(Math,r.map(function(e){return e.Comments}));var d=false;$.each(r,function(e,t){if(t.Comments===l&&!d){s++;d=true;i.data.push({y:t.Comments,color:"#00FF00"});n=e}else i.data.push(t.Comments)});if(s>1)t=true;e.series.push(i);$("#commentsChart").highcharts(e);c();TBUtilities.Log("Populated comments chart.")}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyBestTimeToPublish] populateCommentsChart"})}};var u=function(e){switch(e){case 0:return"Sunday";case 1:return"Monday";case 2:return"Tuesday";case 3:return"Wednesday";case 4:return"Thursday";case 5:return"Friday";case 6:return"Saturday"}};var c=function(){TBUtilities.Log("Populating summary data.");var e="";switch(n){case 0:e="Midnight";break;case 12:e="Noon";break;default:if(n<12)e=n+":00 AM";else e=parseInt(n)-12+":00 PM"}$("#tb-best-time-to-publish-day-value").text(u(a));$("#tb-best-time-to-publish-hour-value").text(e);var t=/\((.*)\)/.exec((new Date).toString());var i=t.length>1?t[1]:"";TBUtilities.Log("Populated summary data.")};var p=function(){jQuery(document).on("click","#tb-best-time-to-publish-close, .tb-best-time-to-publish-closex",function(){TubeBuddyMenu.HideBackground();jQuery("#tb-best-time-to-publish-container").hide()});jQuery(document).on("click","#tb-best-time-to-publish-calculate",function(){try{TBUtilities.AddAction(null,TBUtilities.ActionTypes.BestTimeToPublish_Calculate,"besttimetopublish")}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyBTPcalculate] [addAction]"})}jQuery("#tb-best-time-to-publish-no-data").hide();jQuery("#tb-best-time-to-publish-loading").show();jQuery("#tb-best-time-to-publish-loading-label").text("Calculating...");r(true)});jQuery(document).on("click","#tb-best-time-to-publish-re-calculate",function(){try{TBUtilities.AddAction(null,TBUtilities.ActionTypes.BestTimeToPublish_Calculate,"besttimetopublish")}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyBTPcalculate] [addAction]"})}if(!TBGlobal.CanAccessLevel1Tools()){TBGlobal.ShowUpgradePage("Sorry, you cannot re-calculate your Best Time to Publish unless you upgrade your TubeBuddy License.",TBGlobal.limitation.bestTimeToPublish);return}jQuery("#tb-best-time-to-publish-no-data").hide();jQuery("#tb-best-time-to-publish-loading").show();jQuery("#tb-best-time-to-publish-data").hide();jQuery("#tb-best-time-to-publish-loading-label").text("Re-Calculating...");r(true)});jQuery(document).on("click","#tb-missing-token-oauth-relink",function(){var e=jstz.determine_timezone();var t=e.timezone;if(t!=="undefined"){t.ambiguity_check()}var i=t.utc_offset;var o="";if(TBGlobal.Profile()!==null)o="&agencyid="+encodeURIComponent(TBGlobal.Profile().AgencyId);if(o===null)o="";var a=TBGlobal.host+"/oauth/AuthRedirect?channelid="+TBGlobal.CurrentChannelId()+"&redirectUrl="+encodeURIComponent(window.location)+"&timeZoneOffset="+encodeURIComponent(i)+o;window.location=a});jQuery(document).on("change","#tb-views-type",function(){l()});jQuery(document).on("change","#tb-comments-day",function(){d()})};var b=function(){jQuery(document.body).on("CRTBLoadBestTimeToPublishTemplate",function(e,t){try{if(t.success){TBUtilities.Log("Loading Best Time to Publish template.");t.response=TBUtilities.FixLocalHtml(DOMPurify.sanitize(t.response,DOMPurifyConfig));jQuery("body").append(t.response);y()}else{TBUtilities.Log("Failure loading Best Time to Publish template.");TBUtilities.LogError({Exception:JSON.stringify(t),Location:"[TubeBuddyBestTimeToPublish] CRTBLoadBestTimeToPublishTemplate"})}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyBestTimeToPublish] CRTBLoadBestTimeToPublishTemplate"})}});jQuery(document.body).on("CRTBBestTimeToPublishGetData",function(e,t){try{TBUtilities.Log("TubeBuddyBestTimeToPublish - CRTBBestTimeToPublishGetData");TBUtilities.Log(t);jQuery("#tb-best-time-to-publish-loading").hide();if(t.success){var i=JSON.parse(t.response);TBUtilities.Log(i);if(i.HasData){o=i;l();d();jQuery("#tb-best-time-to-publish-re-calculate").show();jQuery("#tb-best-time-to-publish-data").show()}else jQuery("#tb-best-time-to-publish-no-data").show()}else if(t.httpErrorCode===501){jQuery("#tb-best-time-to-publish-need-scope").show()}else{TBUtilities.Log("Failure loading Best Time to Publish data.");TBUtilities.LogError({Exception:JSON.stringify(t),Location:"[TubeBuddyBestTimeToPublish] CRTBBestTimeToPublishGetData"})}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyBestTimeToPublish] CRTBBestTimeToPublishGetData"})}})};var y=function(){if(i){jQuery("#tb-best-time-to-publish-container").show()}else{TBUtilities.Alert("Still loading, please try again in a few seconds.")}};return{ShowBestTimeToPublish:function(){if(TBGlobal.IsAuthenticated()){if(!i){b();p();s();i=true}else{y()}}}}}();var TubeBuddySubscribersList=function(){var e=false;var t=true;var o=[];var a=[];var n={channelId:"",name:""};var r={interval:null,button:null,timeSet:null};var s={interval:null,waitingForLoad:false,startRowCount:0};var l={autoAdvance:false};var d=function(){try{h();var e=TBUtilities.GetCookie("tb-auto-advance");if(e!=null&&e=="true"){l.autoAdvance=true;jQuery(".tb-compose-message-auto-advance-checkbox").attr("checked","checked")}jQuery(".send-button-info").each(function(){var e=jQuery(this).attr("data-channel-id");var t=TBUtilities.GetInArray(o,null,e);if(t==null)o.push(e)});var t=TBGlobal.host+"/api/contacthistory/GetRecentForChannels";var i={ChannelIds:o,ProfileRedirectIds:null,ContactType:1,CampaignId:null,YouTubeChannelId:TBGlobal.CurrentChannelId()};TBExtension.Post(t,jQuery.param(i),"CRSubscriberListLoadContactHistory",null,{contentType:"application/x-www-form-urlencoded; charset=UTF-8"})}catch(e){TBUtilities.LogError({Exception:e,Location:"[subscriberList] loadData"})}};var u=function(){var e=TBGlobal.host+"/ModuleManager/subscribersList?v="+TBGlobal.versionNumber;if(loadLocalHTML&&(TBExtension.GetType()=="chrome"||TBExtension.GetType()=="firefox")){e=chrome.extension.getURL("modules/subscriberslist.html")}else if(loadLocalHTML&&TBExtension.GetType()=="safari"){e="modules/subscriberslist.html"}TBExtension.Get(e,"CRTBLoadSubscribersListTemplate")};var c=function(){TBGlobal.AddProfileUpdateListener(b);jQuery(document).on("click",".subscribers-load-more-button",function(){try{if(!s.waitingForLoad){s.startRowCount=jQuery(".channel-msg-button").length;s.waitingForLoad=true;s.interval=setInterval(function(){g()},500)}}catch(e){TBUtilities.LogError({Exception:e,Location:"[subscriberList] [click] .load-more-text"})}});jQuery(document).on("click",".tb-compose-message-add-message-template-button",function(){jQuery("#msg-dialog").hide();TBUtilities.Alert("Please refresh this page after you have finished creating your Canned Responses in order for the new ones to show up.",function(){jQuery("#msg-dialog").show()});var e=window.open(TBGlobal.host+"/channel/cannedresponses/"+TBGlobal.CurrentChannelId(),"_blank");e.focus()});jQuery(document).on("click",".tb-compose-message-message-template-button-name",function(){try{var e=jQuery(this).attr("data-msg");var t=jQuery(this).parent().parent().parent().parent().parent().find(".yt-user-name").text().trim();e=TBUtilities.ReplaceAll(e,"{N}",t);e=TBUtilities.ReplaceAll(e,"{n}",t);jQuery(".compose-message").fadeOut("fast",function(){jQuery(".compose-message").val(e);jQuery(".compose-message").fadeIn("fast")});TBUtilities.AddAction(null,TBUtilities.ActionTypes.CannedResponses_Use,"cannedresponses","cannedresponses")}catch(e){TBUtilities.LogError({Exception:e,Location:"[subscriberList] [click] .tb-compose-message-message-template-button-name"})}});jQuery(document).on("click",".tb-contact-status-sent, .tb-contact-status-not-sent",function(){try{var e=jQuery(this).attr("data-status")==="sent";var t=jQuery(this).attr("data-channel-id");var i={YouTubeChannelId:TBGlobal.CurrentChannelId(),ContactType:1,ChannelId:t};var o=jQuery.param(i);var n="";var r=TBUtilities.GetInArray(a,"ChannelId",t);if(e){jQuery(this).parent().html(jQuery(".tb-contact-status-not-sent:last").clone().attr("data-channel-id",t)[0].outerHTML);n=TBGlobal.host+"/api/contacthistory/remove";r.DateContacted=null}else{jQuery(this).parent().html(jQuery(".tb-contact-status-sent:last").clone().attr("data-channel-id",t)[0].outerHTML);n=TBGlobal.host+"/api/contacthistory/add";r.DateContacted=new Date}TBExtension.Post(n,o,null,null,{contentType:"application/x-www-form-urlencoded; charset=UTF-8"});y()}catch(e){TBUtilities.LogError({Exception:e,Location:"[subscriberList] [click]  .tb-contact-status-sent, .tb-contact-status-not-sent"})}});jQuery(document).on("click",".send-button-info",function(){try{n.channelId=jQuery(this).attr("data-channel-id");TBYouTubeApi.GetChannelDetails(n.channelId,"statistics",f);n.name=jQuery(this).parent().parent().find(".description-text:first").text()}catch(e){TBUtilities.LogError({Exception:e,Location:"[subscriberList] [click] .send-button-info"})}});jQuery(document).on("change",".tb-compose-message-auto-advance-checkbox",function(){try{l.autoAdvance=jQuery(this).is(":checked");TBUtilities.CreateCookie("tb-auto-advance",jQuery(this).is(":checked"))}catch(e){TBUtilities.LogError({Exception:e,Location:"[subscriberList] [change] .tb-compose-message-auto-advance-checkbox"})}});jQuery(document).on("click",".tb-compose-message-next-button",function(){try{var e=false;jQuery(".send-button-info").each(function(){if(e){jQuery(this).find("button")[0].click();return false}if(jQuery(this).attr("data-channel-id")==n.channelId){e=true}})}catch(e){TBUtilities.LogError({Exception:e,Location:"[subscriberList] [click] .tb-compose-message-next-button"})}});jQuery(document).on("click",".tb-compose-message-prev-button",function(){try{var e=false;var t=null;jQuery(".send-button-info").each(function(){if(jQuery(this).attr("data-channel-id")==n.channelId){t.click();return false}else{t=jQuery(this).find("button")[0]}})}catch(e){TBUtilities.LogError({Exception:e,Location:"[subscriberList] [click] .tb-compose-message-prev-button"})}});jQuery(document).on("click",".tb-social-find-button",function(){try{var e=jQuery("#tb-compose-message-siteTemplate").html();var t=jQuery("#tb-compose-message-facebookTemplate").html();var o=jQuery("#tb-compose-message-twitterTemplate").html();var a=jQuery("#tb-compose-message-instagramTemplate").html();jQuery(this).html('<img style="height: 15px;" src="'+TBGlobal.host+'/images/general/loading1.gif" />');var n=jQuery(this).attr("data-ytid");var r="https://www.youtube.com/channel/"+n;if(n.length!=24){r="https://www.youtube.com/user/"+n}TubeBuddyYouTubeActions.GetChannelInfoFromAboutPage(r,function(r){jQuery('.td-subscriber-table-social-cell[data-channel-id="'+n+'"]').empty();if(r==null||r!=null&&r.socialProfiles.length==0){jQuery(this).find(".about-channel-link-text").text("");jQuery('.td-subscriber-table-social-cell[data-channel-id="'+n+'"]:first').append('<span style="font-size:11px; color:#999;">none</span>')}else{for(i=0;i<r.socialProfiles.length;i++){var s="";var l=r.socialProfiles[i];if(l.url!==undefined&&l.url.indexOf("twitter.com")!==-1){s=o.formatTemplate(l.url)}else if(l.url!==undefined&&l.url.indexOf("facebook.com")!==-1&&l.url.indexOf("youtube.com")===-1){s=t.formatTemplate(l.url)}else if(l.url!==undefined&&l.url.indexOf("instagram.com")!==-1){s=a.formatTemplate(l.url)}else{s=e.formatTemplate(l.url)}jQuery('.td-subscriber-table-social-cell[data-channel-id="'+n+'"]:first').append(s)}}});TBUtilities.AddAction(null,TBUtilities.ActionTypes.SubscriberOutreach_ViewSocial,"subscriberoutreach")}catch(e){TBUtilities.LogError({Exception:e,Location:"[subscriberList] [click] .tb-social-find-button"})}});jQuery(document).on("click",".yt-dialog-send",function(){try{if(l.autoAdvance){r.button=null;var e=false;jQuery(".send-button-info").each(function(){if(e){r.button=jQuery(this).find("button")[0];return false}if(jQuery(this).attr("data-channel-id")==n.channelId){e=true}});if(r.button!=null){r.timeSet=new Date;clearInterval(r.interval);r.interval=setInterval(function(){m()},250)}}var t=TBUtilities.GetInArray(a,"ChannelId",n.channelId);if(t){t.DateContacted=new Date;var i={YouTubeChannelId:TBGlobal.CurrentChannelId(),ContactType:1,ChannelId:n.channelId};var o=jQuery.param(i);var s=TBGlobal.host+"/api/contacthistory/add";TBExtension.Post(s,o,null,null,{contentType:"application/x-www-form-urlencoded; charset=UTF-8"});y()}else TBUtilities.Log("Debug info. contactHistory.length: "+a.length+" channelId: "+n.channelId+" Location: [subscriberList] [click] .yt-dialog-send")}catch(e){TBUtilities.LogError({Exception:e,Location:"[subscriberList] [click] .yt-dialog-send"})}})};var p=function(){jQuery(document.body).on("CRTBLoadSubscribersListTemplate",function(e,t){if(t.success){t.response=TBUtilities.FixLocalHtml(DOMPurify.sanitize(t.response,DOMPurifyConfig));jQuery("body").append(t.response);v()}else{}});jQuery(document.body).on("CRSubscribersListAddMessage",function(e,t){});jQuery(document.body).on("CRSubscribersListDeleteMessage",function(e,t){});jQuery(document.body).on("CRSubscriberListLoadContactHistory",function(e,t){try{if(t.success){a=JSON.parse(t.response);y()}else{}}catch(e){TBUtilities.LogError({Exception:e,Location:"[subscriberList] CRSubscriberListLoadContactHistory"})}});jQuery(document.body).on("CRSubscriberListGetAboutPage",function(e,t){try{var i=t.response;var o=t.data.channelId;jQuery('.td-subscriber-table-social-cell[data-channel-id="'+o+'"]').empty();try{var a=jQuery(".about-description:first",i).html();var n=TBUtilities.GetEmailsWithinString(a);if(n.length>0){jQuery.each(n,function(e,t){jQuery('.td-subscriber-table-social-cell[data-channel-id="'+o+'"]:first').append(jQuery(".tb-social-email-icon:last").clone().attr("href","mailto: "+t)[0].outerHTML)})}}catch(e){}if(jQuery(".about-metadata-container",i).find(".channel-links-item").length==0){jQuery(this).find(".about-channel-link-text").text("");jQuery('.td-subscriber-table-social-cell[data-channel-id="'+o+'"]:first').append('<span style="font-size:11px; color:#999;">none</span>')}else{jQuery(".about-metadata-container",i).find(".channel-links-item").each(function(e){jQuery(this).find(".about-channel-link-text").text("");jQuery('.td-subscriber-table-social-cell[data-channel-id="'+o+'"]:first').append(jQuery(this)[0].outerHTML.replace("<li ","<span ").replace("</li","</span"))})}}catch(e){TBUtilities.LogError({Exception:e,Location:"[subscriberList] CRSubscriberListGetAboutPage"})}})};var b=function(){h()};var y=function(){try{jQuery(".subscribers-table-container").find("tr").each(function(){var e=jQuery(this)[0].outerHTML;var t=e.indexOf('data-channel-external-id="')+'data-channel-external-id="'.length;var i=e.substr(t,24);if(i.substring(0,2)!="UC")return;var o=TBUtilities.GetInArray(a,"ChannelId",i);if(o==null||o.DateContacted==null){jQuery(this).find(".td-subscriber-table-status-cell").html(jQuery(".tb-contact-status-not-sent:last").clone().attr("data-channel-id",i)[0].outerHTML)}else{jQuery(this).find(".td-subscriber-table-status-cell").html(jQuery(".tb-contact-status-sent:last").clone().attr("data-channel-id",i).attr("title","LAST CONTACTED: "+new Date(o.DateContacted))[0].outerHTML)}})}catch(e){TBUtilities.LogError({Exception:e,Location:"[subscriberList] populateContactHistories"})}};var h=function(){try{jQuery(".tb-compose-message-message-templates-container:first").find(".tb-compose-message-message-template-button").remove();jQuery.each(TBGlobal.Profile().Campaigns,function(e,t){var i=jQuery(".tb-compose-message-message-template-button:last").clone();i.find("a:first").text(t.Name).attr("data-msg",t.Template).attr("data-id",t.Id);jQuery(".tb-compose-message-message-templates-container:first").prepend(i[0].outerHTML)});jQuery(".tb-compose-message-templates-count").text(TBGlobal.Profile().Campaigns.length)}catch(e){TBUtilities.LogError({Exception:e,Location:"[subscriberList] populateCampaigns"})}};var f=function(e){try{jQuery(".tb-compose-message-stats-views").text(e.Statistics.ViewCount);jQuery(".tb-compose-message-stats-uploads").text(e.Statistics.VideoCount);if(e.Statistics.hiddenSubscriberCount)jQuery(".tb-compose-message-stats-subscribers").text("N/A");else jQuery(".tb-compose-message-stats-subscribers").text(e.Statistics.SubscriberCount);jQuery(".tb-compose-message-stats-uploads").attr("href","https://www.youtube.com/channel/"+e.Id+"/videos");jQuery(".yt-user-name").html('<a target="_blank" href="https://www.youtube.com/channel/'+e.Id+'">'+n.name+"</a>");var t=TBUtilities.GetInArray(a,"ChannelId",e.Id);if(t&&t.DateContacted!=null){jQuery(".tb-compose-message-stats-status:first").html(jQuery(".tb-contact-status-sent:last").clone().attr("data-channel-id",e.Id)[0].outerHTML)}else{jQuery(".tb-compose-message-stats-status:first").html(jQuery(".tb-contact-status-not-sent:last").clone().attr("data-channel-id",e.Id)[0].outerHTML)}}catch(e){TBUtilities.LogError({Exception:e,Location:"[subscriberList] gotSubscriberStatistics"})}};var m=function(){if(jQuery(".yt-channel-msg-dialog:first").hasClass("hid")){clearInterval(r.interval);r.button.click()}if(new Date-r.timeSet>3e3){clearInterval(r.interval)}};var g=function(){var e=jQuery(".channel-msg-button").length;if(e>s.startRowCount){s.waitingForLoad=false;v();clearInterval(s.interval)}};var v=function(){try{if(t){jQuery("thead").find("td.subscriber-count").after(jQuery(".td-subscriber-table-social-header")[0].outerHTML)}jQuery("tbody").find("tr").each(function(){var e=jQuery(this).find(".td-subscriber-table-social-cell").length==0&&jQuery(this).find(".td-subscriber-table-social-header").length==0;if(e){jQuery(this).find("td.subscriber-count").after(jQuery(".td-subscriber-table-social-cell:last")[0].outerHTML);var t=jQuery(this).find("a:first").attr("href");if(t){var i=t.split("/");var o=i.pop()||i.pop();jQuery(this).find(".tb-social-find-button:first").attr("data-ytid",o);jQuery(this).find("td").attr("data-channel-id",o)}}});s.startRowCount=jQuery(".channel-msg-button").length;jQuery(".tb-logo-tiny").fadeIn();d();t=false}catch(e){TBUtilities.LogError({Exception:e,Location:"[subscriberList] populateContent"})}};return{Initialize:function(){if(TBGlobal.IsAuthenticated()){if(!e){p();u();c();e=true}else{v()}}}}}();var TubeBuddySubscribersExport=function(){var e=false;var t={queueSize:4,queueSpeed:400,fetchTimeout:5e3};var o={none:0,running:1,stopped:2,complete:3,error:4};var a={statusType:0,startTime:null,waiting:[],interval:null,cleanUpInterval:null,syncStartTime:null,refreshSubscribersNeededCount:0,refreshSubscribersCompleted:0,processing2:[],completed2:[]};var n=function(){this.id="";this.facebookId="";this.displayName="";this.url="";this.email="";this.phone="";this.website="";this.gender="";this.profileNotFound=false;this.isComplete=false;this.subscriberId="";this.startFetchTime=null};var r=function(){this.googlePlusId="";this.url="";this.id="";this.email="";this.phone="";this.website="";this.gender="";this.birthday="";this.profileNotFound=false;this.isComplete=false;this.subscriberId="";this.startFetchTime=null};var s=function(){this.id="";this.url="";this.twitterId="";this.displayName="";this.handle="";this.followersCount=0;this.followingCount=0;this.website="";this.profileNotFound=false;this.isComplete=false;this.subscriberId="";this.startFetchTime=null};var l=function(){try{jQuery(".creator-subheader-content").append(jQuery(".tb-export-subscribers-button:last")[0].outerHTML);if(TBGlobal.CanAccessLevel1Tools()){jQuery("#tb-subscribers-export-upgrade-note").hide()}jQuery(".tb-export-subscribers-download").attr("href",TBGlobal.host+"/youtubechannel/getexport?id="+TBGlobal.CurrentChannelId()+"&offset="+(new Date).getTimezoneOffset())}catch(e){TBUtilities.LogError({Exception:e,Location:"[subscriberExport] [populateContent] "})}};var d=function(){try{var e=TBGlobal.host+"/ModuleManager/subscribersexport?v="+TBGlobal.versionNumber;if(loadLocalHTML&&(TBExtension.GetType()=="chrome"||TBExtension.GetType()=="firefox")){e=chrome.extension.getURL("modules/subscribersexport.html")}else if(loadLocalHTML&&TBExtension.GetType()=="safari"){e="modules/subscribersexport.html"}TBExtension.Get(e,"CRTBLoadSubscribersExportTemplate")}catch(e){TBUtilities.LogError({Exception:e,Location:"[subscriberExport] [loadHtml] "})}};var u=function(){jQuery(document).on("click",".tb-subscribers-export-upgrade-link",function(){try{TBGlobal.ShowUpgradePage("export more than 40 subscribers",TBGlobal.limitation.subscriberexport)}catch(e){TBUtilities.LogError({Exception:e,Location:"[subscriberExport] [click] .tb-subscribers-export-upgrade-link, .tb-export-subscribers-modal-close "})}});jQuery(document).on("click",".tb-export-subscribers-button",function(){try{var e="#tb-export-subscribers-modal";var t=jQuery(e).outerHeight();var i=jQuery(e).outerWidth();TubeBuddyMenu.ShowBackgroundSticky();jQuery(e).css({display:"block",opacity:0,"margin-left":-(i/2)+"px"});jQuery(e).fadeTo(200,1)}catch(e){TBUtilities.LogError({Exception:e,Location:"[subscriberExport] [click] .tb-export-subscribers-button "})}});jQuery(document).on("click",".tb-export-subscribers-modal-cancel, .tb-export-subscribers-modal-close, .tb-export-subscribers-closex",function(){jQuery("#tb-export-subscribers-modal").hide();TubeBuddyMenu.HideBackground()});jQuery(document).on("click",".tb-export-subscribers-modal-stop-export",function(){jQuery(this).fadeOut("slow");p(o.stopped)});jQuery(document).on("click",".tb-export-subscribers-continue",function(){jQuery("#tb-export-subscribers-detail").hide();jQuery("#tb-export-subscribers-sync").fadeIn();jQuery(".tb-export-subscribers-continue").hide()});jQuery(document).on("click",".tb-export-subscribers-sync",function(){jQuery("#tb-subscriber-export-sync-option").hide();jQuery("#tb-subscriber-export-sync-status").show();a.syncStartTime=new Date;a.interval=setInterval(w,1e3);var e=TBGlobal.host+TBGlobal.apiUrls.youtubeChannelSyncSubscribers;TBExtension.Get(e,"CRTBSubscribersSyncSubscribers",null)});jQuery(document).on("click",".tb-export-subscribers-skip",function(){a.interval=setInterval(w,1e3);var e=TBGlobal.host+TBGlobal.apiUrls.youtubeChannelGetSubscribersRequiringRefreshCount;TBExtension.Get(e,"CRTBSubscribersYoutubeChannelGetSubscribersRequiringRefreshCount",null)})};var c=function(){if(a.refreshSubscribersCompleted>=a.refreshSubscribersNeededCount){p(o.complete)}else{var e=TBGlobal.host+TBGlobal.apiUrls.youtubeChannelGetSubscribersRequiringRefresh+"?take="+t.queueSize;TBExtension.Get(e,"CRTBSubscribersYoutubeChannelGetSubscribersRequiringRefresh")}};var p=function(e){try{a.statusType=e;jQuery(".tb-export-subscribers-status-section").hide();jQuery(".tb-export-subscribers-status-footer").hide();jQuery(".tb-export-subscribers-modal-stop-export").hide();jQuery(".tb-export-subscribers-modal-cancel").text("close");if(!TBGlobal.CanAccessLevel1Tools)jQuery(".tb-sub-export-limit-warning").show();switch(a.statusType){case o.complete:jQuery("#tb-export-subscribers-status-complete").show();break;case o.error:jQuery("#tb-export-subscribers-status-error").show();break;case o.stopped:jQuery("#tb-export-subscribers-status-stopped").show();break}a.statusType=e;w();clearInterval(a.interval);clearInterval(a.cleanUpInterval)}catch(e){}};var b=function(){jQuery(document.body).on("CRTBPostSubscriberUpdated",function(e,t){TBUtilities.RemoveFromArray(a.processing2,"YouTubeChannelId",t.data);a.refreshSubscribersCompleted++;jQuery("#tb-export-subscribers-processing-details").text(a.processing2.length);jQuery("#tb-export-subscribers-completed-details").text(TBUtilities.FormatNumberWithCommas(a.refreshSubscribersCompleted));jQuery("#tb-export-subscribers-remaining-details").text(TBUtilities.FormatNumberWithCommas(a.refreshSubscribersNeededCount-a.refreshSubscribersCompleted));jQuery("#tb-export-subscribers-total-details").text(TBUtilities.FormatNumberWithCommas(a.refreshSubscribersNeededCount));if(a.processing2.length==0){TBUtilities.Log("Fetch next page");c()}});jQuery(document.body).on("CRGetSubscriberExportStatistics",function(e,t){try{if(t.success){a.stats=JSON.parse(t.response);if(a.stats.HasSynced){jQuery(".tb-export-subscribers-skip").show();jQuery(".tb-export-subscribers-skip-disabled").hide()}else{jQuery(".tb-export-subscribers-skip").hide();jQuery(".tb-export-subscribers-skip-disabled").show()}if(a.stats.EstimatedSyncTime=="unknown")jQuery("#tb-subscriber-export-estimate-container").hide();jQuery("#tb-subscriber-export-estimate").text(a.stats.EstimatedSyncTime)}else{TBUtilities.AddDebug("ERROR: CRGetSubscriberExportStatistics")}}catch(e){TBUtilities.LogError({Exception:e,Location:"[subscriberExport] [CRGetSubscriberExportStatistics] "})}});jQuery(document.body).on("CRTBSubscribersSyncSubscribers",function(e,t){try{if(t.success){var i=TBGlobal.host+TBGlobal.apiUrls.youtubeChannelGetSubscribersRequiringRefreshCount;TBExtension.Get(i,"CRTBSubscribersYoutubeChannelGetSubscribersRequiringRefreshCount",null)}else{TBUtilities.AddDebug("ERROR: CRTBSubscribersSyncSubscribers")}}catch(e){TBUtilities.LogError({Exception:e,Location:"[subscriberExport] [CRTBSubscribersSyncSubscribers] "})}});jQuery(document.body).on("CRTBSubscribersYoutubeChannelGetSubscribersRequiringRefreshCount",function(e,t){try{if(t.success){jQuery("#tb-subscriber-export-sync-status").hide();jQuery("#tb-export-subscribers-status").show();jQuery("#tb-export-subscribers-sync").hide();a.startTime=new Date;a.statusType=o.running;a.cleanUpInterval=setInterval(Q,5e3);a.refreshSubscribersNeededCount=parseInt(t.response);if(a.refreshSubscribersNeededCount>0){c()}else{p(o.complete)}}else{TBUtilities.AddDebug("ERROR: CRTBSubscribersYoutubeChannelGetSubscribersRequiringRefreshCount: "+t.response)}}catch(e){TBUtilities.LogError({Exception:e,Location:"[subscriberExport] [CRTBSubscribersYoutubeChannelGetSubscribersRequiringRefreshCount] "})}});jQuery(document.body).on("CRTBSubscribersYoutubeChannelGetSubscribersRequiringRefresh",function(e,i){try{if(i.success){var n=JSON.parse(i.response);if(n.length==0){p(o.complete)}else{TBUtilities.Log(n);jQuery("#tb-export-subscribers-status-stop-processing").fadeIn();a.statusType=o.running;a.processing2=[];var r=1;jQuery.each(n,function(e,i){i.linkedFacebooks=[];i.linkedTwitters=[];i.linkedGooglePluses=[];i.isComplete=false;a.processing2.push(i);setTimeout(j,t.queueSpeed*r++,i)})}}else{TBUtilities.AddDebug("ERROR: CRTBSubscribersYoutubeChannelGetSubscribersRequiringRefresh")}}catch(e){TBUtilities.LogError({Exception:e,Location:"[subscriberExport] [CRTBSubscribersYoutubeChannelGetSubscribersRequiringRefreshCount] "})}});jQuery(document.body).on("CRTBLoadSubscribersExportTemplate",function(e,t){try{if(t.success){t.response=TBUtilities.FixLocalHtml(DOMPurify.sanitize(t.response,DOMPurifyConfig));jQuery("body").append(t.response);var i=TBGlobal.host+TBGlobal.apiUrls.youtubeChannelGetExportStatistics;TBExtension.Get(i,"CRGetSubscriberExportStatistics");l()}else{}}catch(e){TBUtilities.LogError({Exception:e,Location:"[subscriberExport] [CRTBLoadSubscribersExportTemplate] "})}});jQuery(document.body).on("CRSubscriberExportGetAboutPage2",function(e,t){try{if(t.success){var i=t.response;var o=TBUtilities.GetInArray(a.processing2,"YouTubeChannelId",t.data);if(o!=null){o.startFetchTime=new Date;TBYouTubeApi.GetChannelDetails(o.YouTubeChannelId,null,T);var l=jQuery(".about-description:first",i).html();var d=TBUtilities.GetEmailsWithinString(l);if(d!=null&&d.length>0)o.YouTubePublicEmail=d[0];jQuery(".about-metadata",i).find(".about-channel-link").each(function(e){var t=jQuery(this).attr("href");if(t.indexOf("facebook.com")>0){var i=new n;i.url=t;i.id=TBUtilities.CreateGuid();i.subscriberId=o.Id;o.linkedFacebooks.push(i)}else if(t.indexOf("twitter.com")>0){var a=new s;a.id=TBUtilities.CreateGuid();a.url=t;a.subscriberId=o.Id;o.linkedTwitters.push(a)}else if(t.indexOf("plus.google.com")>0){var l=new r;l.id=TBUtilities.CreateGuid();l.url=t;l.subscriberId=o.Id;o.linkedGooglePluses.push(l)}});if(o.linkedFacebooks.length>0)y(o,o.linkedFacebooks[0]);if(o.linkedTwitters.length>0)h(o,o.linkedTwitters[0]);if(o.linkedGooglePluses.length>0)f(o,o.linkedGooglePluses[0]);m(o)}}else{TBUtilities.Log("Error in GetAbout Page");var o=TBUtilities.GetInArray(a.processing2,"YouTubeChannelId",t.data);TBUtilities.Log(o);o.startFetchTime=new Date;o.isComplete=true;m(o)}}catch(e){TBUtilities.LogError({Exception:e,Location:"[subscriberExport] [CRSubscriberExportGetAboutPage2] "+debug})}});jQuery(document.body).on("CRSubscribersExportGetTwitterProfile",function(e,t){try{var i=TBUtilities.GetInArray(a.processing2,"Id",t.data.subscriberId);var o=TBUtilities.GetInArray(i.linkedTwitters,"id",t.data.id);var n=t.response;try{if(t.success){var r=TBUtilities.ReplaceAll(jQuery(".ProfileNav-item--followers",n).find(".ProfileNav-value:first").text(),",","");var s=TBUtilities.ReplaceAll(jQuery(".ProfileNav-item--following",n).find(".ProfileNav-value:first").text(),",","");var l=jQuery(".ProfileNav:first",n).attr("data-user-id");var d=jQuery(".ProfileHeaderCard-nameLink:first",n).text();var u=jQuery(".ProfileHeaderCard-screenname:first",n).find("span:first").text();var c=jQuery(".ProfileHeaderCard-urlText:first",n).find("a:first").attr("title");o.followersCount=r;o.followingCount=s;o.displayName=d;o.handle=u;o.twitterId=l;if(c!=null)o.website=c}else{o.profileNotFound=true}}catch(e){o.profileNotFound=true}o.isComplete=true;m(i)}catch(e){TBUtilities.LogError({Exception:e,Location:"[subscriberExport] [CRSubscribersExportGetTwitterProfile] "})}});jQuery(document.body).on("CRSubscribersExportGetFacebookProfile",function(e,t){try{var i=TBUtilities.GetInArray(a.processing2,"Id",t.data.subscriberId);var o=TBUtilities.GetInArray(i.linkedFacebooks,"id",t.data.id);var n=t.response;try{if(t.success){var r=n.indexOf("PagesAboutTabController_")+"PagesAboutTabController_".length;if(r>50){var s=n.indexOf('"',r);o.facebookId=n.substring(r,s)}else{r=n.indexOf('data-profileid="')+'data-profileid="'.length;if(r>50){var s=n.indexOf('"',r);o.facebookId=n.substring(r,s)}else{o.profileNotFound=true}}if(n.indexOf(">Gender<")>0&&n.indexOf(">Male<")>0)o.gender="Male";else if(n.indexOf(">Gender<")>0&&n.indexOf(">Female<")>0)o.gender="Female";n=TBUtilities.ReplaceAll(n,"\x3c!--","");n=TBUtilities.ReplaceAll(n,"--\x3e","");jQuery(".hidden_elem",n).each(function(e){var t=jQuery(this).html();if(t.indexOf(">Page Info<")>0){jQuery(".fbSettingsList:first li",n).each(function(e){jQuery(this).find("div").each(function(e){if(jQuery(this).html().trim()==="Website"){var t=jQuery(this).parent().parent().find("a:first").text();o.website=t}if(jQuery(this).html().trim()==="Email"){var i=jQuery(this).parent().parent().find("a:first").text();o.email=i}if(jQuery(this).html().trim()==="Phone"){var a=jQuery(this).parent().parent().find("div:nth-child(2)").find("div:nth-child(1)").text();o.phone=a}if(jQuery(this).html().trim()==="Impressum"){var n=jQuery(this).parent().parent().find("div:nth-child(2)").find("div:nth-child(1)").text();var r=extractEmailsFromString(n);if(o.email==""&&r.length>0)o.email=r[0]}})})}if(n.indexOf(">Contact Info<")>0){jQuery("th",n).each(function(e){if(jQuery(this).html().trim()==="Website"){var t=jQuery(this).parent().find("a:first").text();o.website=t;return false}})}})}else{o.profileNotFound=true}}catch(e){o.profileNotFound=true}o.isComplete=true;m(i)}catch(e){TBUtilities.LogError({Exception:e,Location:"[subscriberExport] [CRSubscribersExportGetFacebookProfile] "})}});jQuery(document.body).on("CRSubscribersExportGetGooglePlusProfile",function(e,t){try{var i=TBUtilities.GetInArray(a.processing2,"Id",t.data.subscriberId);var o=TBUtilities.GetInArray(i.linkedGooglePluses,"id",t.data.id);var n=t.response;try{if(t.success){jQuery("td",n).each(function(e){if(jQuery(this).html().trim()==="Phone"){var t=jQuery(this).parent().find("div:first").text();o.phone=t}if(jQuery(this).html().trim()==="Email"){var i=jQuery(this).parent().find("span:first").text();o.email=i}if(jQuery(this).html().trim()==="Mobile"){var a=jQuery(this).parent().find("div:first").text();if(o.phone=="")o.phone=a}});jQuery("div",n).each(function(e){if(jQuery(this).html().trim()==="Website"){var t=jQuery(this).parent().find("a:first").text();o.website=t;return false}if(jQuery(this).html().trim()==="Gender"){var i=jQuery(this).parent().find("div:nth-child(2)").text();o.gender=i;return false}if(jQuery(this).html().trim()==="Birthday"){var a=jQuery(this).parent().find("div:nth-child(2)").text();o.birthday=a;return false}})}else{o.profileNotFound=true}}catch(e){o.profileNotFound=true}o.isComplete=true;m(i)}catch(e){}})};var y=function(e,t){try{TBUtilities.Log("[fetchFacebookData] Starting Facebook Url: "+t.url);var i=t.url;i=i.replace("http://","https://");if(i.indexOf("?")>0)i=i.substring(0,i.indexOf("?"));if(i.indexOf("/pages/")>0)i=i+"?sk=info&tab=page_info";else i=i+"/info?tab=page_info";t.startFetchTime=new Date;TBUtilities.Log("[fetchFacebookData] Clean Facebook Url: "+i);TBExtension.Get(i,"CRSubscribersExportGetFacebookProfile",t)}catch(e){TBUtilities.LogError({Exception:e,Location:"[subscriberExport] [fetchFacebookData] "})}};var h=function(e,t){try{TBUtilities.Log("[fetchTwitterData] Clean Twitter Url: "+t.url);var i=t.url.replace("www.","");i=t.url.replace("http://","https://");if(i.indexOf("?")>0)i=i.substring(0,i.indexOf("?"));t.startFetchTime=new Date;TBUtilities.Log("[fetchTwitterData] Clean Twitter Url: "+i);TBExtension.Get(i,"CRSubscribersExportGetTwitterProfile",t)}catch(e){TBUtilities.LogError({Exception:e,Location:"[subscriberExport] [fetchTwitterData] "})}};var f=function(e,t){try{TBUtilities.Log("[fetchGooglePlusData] Starting Google+ Url: "+t.url);var i=t.url;if(i.indexOf("u/0/b/")>0){i=i.replace("u/0/b/","");if(i.indexOf("/+")>0)i=i.substring(0,i.indexOf("/+"))}if(i.lastIndexOf("/")>-1)t.googlePlusId=i.substring(i.lastIndexOf("/")+1);i=i+"/about";t.startFetchTime=new Date;TBUtilities.Log("[fetchGooglePlusData] Clean Google+ Url: "+i);TBExtension.Get(i,"CRSubscribersExportGetGooglePlusProfile",t)}catch(e){TBUtilities.LogError({Exception:e,Location:"[subscriberExport] [fetchGooglePlusData] "})}};var m=function(e){try{var n;if(!e.isComplete){return false}if(e.linkedFacebooks.length>0){if(new Date-e.linkedFacebooks[0].startFetchTime<t.fetchTimeout)return false;if(!e.linkedFacebooks[0].isComplete)return false}if(e.linkedTwitters.length>0){for(i=0;i<e.linkedTwitters.length;i++){if(new Date-e.linkedTwitters[i].startFetchTime>t.fetchTimeout)continue;if(!e.linkedTwitters[i].isComplete)return;break}}if(e.linkedGooglePluses.length>0){for(i=0;i<e.linkedGooglePluses.length;i++){if(new Date-e.linkedGooglePluses[i].startFetchTime>t.fetchTimeout)continue;if(!e.linkedGooglePluses[i].isComplete)return false;break}}if(a.statusType==o.running)v(e)}catch(e){TBUtilities.LogError({Exception:e,Location:"[subscriberExport] [checkForComplete2] "})}};var g=function(e){try{if(a.statusType!=o.running)return;a.statusType=e;jQuery(".tb-export-subscribers-status-section").hide();jQuery(".tb-export-subscribers-status-footer").hide();switch(a.statusType){case o.complete:jQuery("#tb-export-subscribers-status-complete").fadeIn();break;case o.error:jQuery("#tb-export-subscribers-status-error").fadeIn();break;case o.stopped:jQuery("#tb-export-subscribers-status-stopped").fadeIn();break}a.statusType=e;if(!TBGlobal.CanAccessLevel1Tools()){jQuery("#tb-export-subscribers-status-purchase-required").fadeIn()}w();clearInterval(a.interval);clearInterval(a.cleanUpInterval);writeCSV()}catch(e){TBUtilities.LogError({Exception:e,Location:"[subscriberExport] [allDone] "})}};var v=function(e){try{if(e.linkedTwitters.length>0){e.TwitterId=e.linkedTwitters[0].twitterId;e.TwitterHandle=e.linkedTwitters[0].handle;e.TwitterDisplayName=e.linkedTwitters[0].displayName;e.TwitterHandle=e.linkedTwitters[0].handle;e.TwitterProfileUrl=e.linkedTwitters[0].url;e.TwitterFollowerCount=e.linkedTwitters[0].followersCount;e.TwitterFollowingCount=e.linkedTwitters[0].followingCount;e.TwitterProfileUrl=e.linkedTwitters[0].url;e.TwitterWebsite=e.linkedTwitters[0].website;if(e.linkedTwitters[0].profileNotFound)e.TwitterStatus="NotFound";else e.TwitterStatus="Good"}if(e.linkedFacebooks.length>0){e.FacebookId=e.linkedFacebooks[0].facebookId;e.FacebookDisplayName=e.linkedFacebooks[0].displayName;e.FacebookProfileUrl=e.linkedFacebooks[0].url;e.FacebookEmail=e.linkedFacebooks[0].email;e.FacebookGender=e.linkedFacebooks[0].gender;e.FacebookPhone=e.linkedFacebooks[0].phone;e.FacebookWebsite=e.linkedFacebooks[0].website;if(e.linkedFacebooks[0].profileNotFound)e.FacebookStatus="NotFound";else e.FacebookStatus="Good"}if(e.linkedGooglePluses.length>0){e.GooglePlusId=e.linkedGooglePluses[0].googlePlusId;e.GooglePlusProfileUrl=e.linkedGooglePluses[0].url;e.GooglePlusEmail=e.linkedGooglePluses[0].email;e.GooglePlusDisplayName=e.linkedGooglePluses[0].url;e.GooglePlusPhone=e.linkedGooglePluses[0].gender;e.GooglePlusWebsite=e.linkedGooglePluses[0].phone;e.GooglePlusGender=e.linkedGooglePluses[0].website;e.GooglePlusBirthday=e.linkedGooglePluses[0].website;if(e.linkedGooglePluses[0].profileNotFound)e.GooglePlusStatus="NotFound";else e.GooglePlusStatus="Good"}var t=TBGlobal.host+TBGlobal.apiUrls.youtubeChannelUpdateSubscriber;TBExtension.Post(t,jQuery.param(e),"CRTBPostSubscriberUpdated",e.YouTubeChannelId,{contentType:"application/x-www-form-urlencoded; charset=UTF-8"})}catch(e){TBUtilities.LogError({Exception:e,Location:"[subscriberExport] [subscriberCompleted2] "})}};var T=function(e){try{if(e!=null){var t=TBUtilities.GetInArray(a.processing2,"YouTubeChannelId",e.Id);if(!t){TBUtilities.AddDebug("gotProfile but not in processing2! : "+e.Id)}else{t.YouTubeVideoViewsCount=parseInt(e.Statistics.ViewCount);t.YouTubeSubscribersCount=parseInt(e.Statistics.SubscriberCount);t.YouTubeUploadsCount=parseInt(e.Statistics.VideoCount);t.isComplete=true;m(t)}}}catch(e){TBUtilities.LogError({Exception:e,Location:"[subscriberExport] [gotYouTubeProfile2] "})}};var w=function(){try{if(a.refreshSubscribersNeededCount>0){jQuery("#tb-export-subscribers-processing-details").text(a.processing2.length);jQuery("#tb-export-subscribers-completed-details").text(TBUtilities.FormatNumberWithCommas(a.refreshSubscribersCompleted));if(a.refreshSubscribersNeededCount-a.refreshSubscribersCompleted<0)jQuery("#tb-export-subscribers-remaining-details").text("0");else jQuery("#tb-export-subscribers-remaining-details").text(TBUtilities.FormatNumberWithCommas(a.refreshSubscribersNeededCount-a.refreshSubscribersCompleted))}else{jQuery("#tb-export-subscribers-processing-details").text("0");jQuery("#tb-export-subscribers-completed-details").text("0");jQuery("#tb-export-subscribers-remaining-details").text("0");jQuery("#tb-export-subscribers-total-details").text("0")}if(a.startTime){var e=parseInt(Math.floor(new Date-a.startTime)/1e3);if(e<60)jQuery("#tb-export-subscribers-elapsed-time").text(e+"s");else{var t=Math.floor(e/60);e=e-t*60;jQuery("#tb-export-subscribers-elapsed-time").text(t+"m "+e+"s")}}if(a.syncStartTime){var e=parseInt(Math.floor(new Date-a.syncStartTime)/1e3);if(e<60)jQuery("#tb-subscriber-export-sync-elapsed-time").text(e+"s");else{var t=Math.floor(e/60);e=e-t*60;jQuery("#tb-subscriber-export-sync-elapsed-time").text(t+"m "+e+"s")}}}catch(e){TBUtilities.LogError({Exception:e,Location:"[subscriberExport] [updateStatusWindow] "})}};var j=function(e){w();var t="https://www.youtube.com/channel/"+e.YouTubeChannelId+"/about";TBExtension.Get(t,"CRSubscriberExportGetAboutPage2",e.YouTubeChannelId)};var Q=function(){for(var e=0;e<a.processing2.length;e++)m(a.processing2[e])};return{Initialize:function(){if(TBGlobal.IsAuthenticated()){if(!e){b();d();u();e=true}else{l()}}},GetSubscribersCallback:function(e,t){getSubscribersCallback(e,t)}}}();var TubeBuddyVideosList=function(){var e=false;var t="";var i=false;var o="";var a="";var n=false;var r=false;var s=false;var l=null;var d=function(){var e=TBGlobal.host+"/ModuleManager/videoslist?v="+TBGlobal.versionNumber;if(loadLocalHTML&&(TBExtension.GetType()=="chrome"||TBExtension.GetType()=="firefox")){e=chrome.extension.getURL("modules/videoslist.html")}else if(loadLocalHTML&&TBExtension.GetType()=="safari"){e="modules/videoslist.html"}TBExtension.Get(e,"CRTBLoadVideosListTemplate")};var u=function(){var e=jQuery("#tb-videos-new-tab-template").html();jQuery(".edit-expand-menu-button").find('li[role="menuitem"]').find("span").each(function(t){var i=jQuery(this).attr("href");if(i){jQuery(this).removeAttr("onclick");jQuery(this).removeAttr("href");jQuery(this).attr("data-href",i);jQuery(this).addClass("tb-edit-menu-button");var o=e.formatTemplate(i);jQuery(this).html(jQuery(this).html()+o)}})};var c=function(){var e=jQuery(".ng-hide").length;if(e!=null&&e>0){clearInterval(l);d();return}};var p=function(e){t=e;var i=TBGlobal.host+TBGlobal.apiUrls.youTubeVideosGetVideoStatus+"?videoId="+e;TBExtension.Get(i,"CRTBVideoListLoadVideoStatus",{videoId:e})};var b=function(e){try{if(e){jQuery('[data-video-container-id="'+t+'"]').find(".tb-videos-list-card-count").text("("+e.feature_templates.length+")")}else{jQuery("[data-video-container-id="+t+"]").find(".tb-videos-list-card-count").text("(0)")}}catch(e){}};var y=function(e){if(e){jQuery(".tb-video-list-video-overview:visible").remove()}else{jQuery(".tb-video-list-video-overview").hide();jQuery(".tb-videos-bulk-dropdown-template").addClass("tb-hid")}};var h=function(e){jQuery(".tb-video-list-playlists-container").html('<span class="tb-spinner"></span> Loading Playlists...');TBExtension.Get("https://www.youtube.com/edit?o=U&video_id="+e,"CRTBLoadVideosListEditPage",{videoId:e})};var f=function(){var e=jQuery("#vm-myvideos-search-box").val().indexOf("video_id:")>-1;if(!e&&o){jQuery("#vm-myvideos-search-box").val((jQuery("#vm-myvideos-search-box").val()+" video_id:{"+o+"}").trim());var t=new Event("change");jQuery("#vm-myvideos-search-box")[0].dispatchEvent(t)}};var m=function(){var e=new MutationObserver(function(e){var t=jQuery("#masthead-appbar");if(t.css("display")!=="none"){jQuery(".tb-videos-bulk-list-dropdown").hide()}else{jQuery(".tb-videos-bulk-list-dropdown").show()}});var r=document.querySelector("#masthead-appbar");e.observe(r,{attributes:true});jQuery(document).on("click",".tb-edit-menu-button",function(e){var t=jQuery(this).attr("data-href");if(t){window.location.href=t}});jQuery(document).on("click",".tb-videoslist-tab-notes-tab",function(e){var t=jQuery(this).attr("data-id");if(jQuery("[data-notes-loaded-id="+t+"]").length>0)return;$(".tb-videoslist-notes-loaded").hide();$(".tb-videoslist-notes-loading").show();if(TBExtension.GetType()!="firefox"){jQuery("[data-notes-id="+t+"]").wysiwyg({controls:{subscript:{visible:false},superscript:{visible:false},undo:{visible:false},redo:{visible:false},insertHorizontalRule:{visible:false},createLink:{visible:false},unLink:{visible:false},insertImage:{visible:false},h1:{visible:false},h2:{visible:false},h3:{visible:false},html:{visible:false},removeFormat:{visible:false},insertTable:{visible:false},code:{visible:false}},iFrameClass:"tb-videoslist-generator-editor",css:"https://www.tubebuddy.com/assets/js/jquery-emoji-picker/tb.css"});jQuery("[data-notes-id="+t+"]").wysiwyg("clear")}else{jQuery("[data-notes-id="+t+"]").val("")}var i=TBGlobal.host+TBGlobal.apiUrls.youTubeVideosGetUserNotes+"/?videoId="+t;TBExtension.Get(i,"CRVideosListGetUserNotes",{videoid:t})});jQuery(document).on("mouseenter",".tb-edit-menu-button",function(e){var t=jQuery(this).find(".tb-videos-new-tab-button img");if(t&&t.length>=1){var i=TBGlobal.host+"/images/icons/external-white-small.png";t.attr("src",i)}});jQuery(document).on("mouseleave",".tb-edit-menu-button",function(e){var t=jQuery(this).find(".tb-videos-new-tab-button img");if(t&&t.length>=1){var i=TBGlobal.host+"/images/icons/external.png";t.attr("src",i)}});jQuery(document).on("click",".tb-videos-new-tab-button",function(e){e.stopPropagation();var t=jQuery(this).attr("href");if(t){if(TBExtension.GetType()=="firefox"){var i=window.open(t,"_blank")}else{var i=window.open("about:blank","_blank");i.location=t}}return false});jQuery(document).on("click",".tb-video-list-menu-item-url",function(e){e.preventDefault();e.stopPropagation();var t=jQuery(this).find(".tb-videos-list-tool").attr("data-url");if(t){if(TBExtension.GetType()=="firefox"){var i=window.open(t,"_blank")}else{var i=window.open("about:blank","_blank");i.location=t}}});jQuery(document).on("click","#page",function(){y()});jQuery(document).on("click",".tb-videoslist-tab-header",function(){jQuery(this).parent().find(".tb-videoslist-tab-header, .tb-tab-icon-selected").removeClass("selected tb-selected tb-tab-icon-selected");jQuery(this).addClass("selected tb-selected");jQuery(this).find(".tb-tab-icon").addClass("tb-tab-icon-selected");jQuery(this).parent().parent().find(".tb-videoslist-tab-container").hide();jQuery(this).parent().parent().find("#"+jQuery(this).attr("data-tab-id")).show();var e=jQuery(this).attr("data-id");jQuery(this).closest("div").find(".tb-videos-list-info-video-id").val(e);jQuery(this).closest("div").find(".tb-videos-list-info-video-link").val("https://youtu.be/"+e);jQuery(".tb-video-id-copy").attr("data-clipboard-text",e);var t=new ClipboardJS(".tb-video-id-copy");jQuery(".tb-video-link-copy").attr("data-clipboard-text","https://youtu.be/"+e);var i=new ClipboardJS(".tb-video-link-copy");if(jQuery(this).parent().parent().find(".tb-video-list-playlists-container").html().trim().length==0)h(e)});jQuery(document).on("click",".tb-videos-bulk-list-dropdown",function(e){jQuery(".tb-videos-bulk-dropdown-template").removeClass("tb-hid");e.stopPropagation()});jQuery(document).on("click","#tb-videoslist-generate-uploadchecklist",function(e){var t=jQuery(this).attr("data-id");jQuery("#tb-videoslist-generate-uploadchecklist-loading").show();jQuery("#tb-videoslist-generate-uploadchecklist").prop("disabled",true);jQuery("#tb-videoslist-generate-uploadchecklist").attr("disabled","disabled")});jQuery(document).on("click","#tb-videoslist-run-launchpad-checkup",function(e){var t=jQuery(this).attr("data-id");jQuery("#tb-videoslist-run-launchpad-checkup-loading").show();jQuery("#tb-videoslist-run-launchpad-checkup").prop("disabled",true);jQuery("#tb-videoslist-run-launchpad-checkup").attr("disabled","disabled")});jQuery(document).on("click","#tb-videoslist-launchpad-tab-header",function(e){var i=jQuery("[data-video-container-id='"+t+"']");jQuery(i).find(".tb-videoslist-launchpad-loading").show();jQuery(i).find(".tb-videoslist-launchpad-loaded").hide();jQuery(i).find(".tb-videoslist-launchpad-opportunities-nodata").hide();jQuery(i).find(".tb-videoslist-launchpad-opportunities-hasdata").hide();jQuery(i).find(".tb-videoslist-launchpad-checklist-nodata").hide();jQuery(i).find(".tb-videoslist-launchpad-checklist-hasdata").hide();jQuery(i).find(".tb-videoslist-launchpad-bestpractices-nodata").hide();jQuery(i).find(".tb-videoslist-launchpad-bestpractices-hasdata").hide();var o=TBGlobal.host+TBGlobal.apiUrls.launchPadGetVideoSummary+"?videoid="+t;TBExtension.Get(o,"CRTBVideoListGetLaunchPadSummary")});jQuery(document).on("change",".tb-videolist-create-uploadchecklist",function(){jQuery("#tb-videolist-generating-checklist").show();jQuery(".tb-videolist-create-uploadchecklist").hide();var e=TBGlobal.host+TBGlobal.apiUrls.launchPadCreateChecklist+"/"+t;TBExtension.Get(e,"CRTBVideoListCreateChecklist",{videoId:videoId})});jQuery(document).on("change",".tb-videos-list-comment-filters",function(){if(jQuery(this).val()=="filter")return;var e=window.open("https://studio.youtube.com/video/"+t+"/comments/inbox?utm_campaign=upgrade&utm_medium=redirect&utm_source=%2Fcomments&filter=%5B%5D","_blank");var i=window.open("https://www.youtube.com/comments?filter="+t+"&tbfilter="+jQuery(this).val(),"_blank");jQuery(this).val("filter")});jQuery(document).on("click",".tb-videos-list-dropdown",function(e){y();var t=jQuery(this).attr("data-id");var i=jQuery(this).attr("data-title");var o=jQuery(this).attr("data-is-draft");var a=o!="true"?"https://img.youtube.com/vi/"+t+"/mqdefault.jpg":jQuery(this).attr("data-thumbnail");var n=jQuery(this).attr("data-views");if(jQuery(this).closest("li").find(".tb-video-list-video-overview").length==0){var r=jQuery("#tb-videos-list-dropdown-template").html();var s=r.formatTemplate(t,i,a,n,o);jQuery(this).closest("li").append(s);p(t)}else{}jQuery(this).closest("li").find(".tb-video-list-video-overview").show();e.stopPropagation()});jQuery(document).on("click",".tb-video-list-video-overview",function(e){e.stopPropagation()});jQuery(document).on("click",".tb-video-list-dropdown-promote",function(){var e=jQuery(this).attr("data-title");var t=jQuery(this).attr("data-id");var i=jQuery(this).attr("data-is-draft");var o=i!="true"?"https://img.youtube.com/vi/"+t+"/mqdefault.jpg":jQuery(this).attr("data-thumbnail");TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyV2VPromote.Show(t,e,o);y(true)});jQuery(document).on("click",".tb-video-list-dropdown-twitter-post",function(e){var t=jQuery(this).attr("data-title");var i=jQuery(this).attr("data-id");var o=jQuery(this).attr("data-is-draft");var a=o!="true"?"https://img.youtube.com/vi/"+i+"/mqdefault.jpg":jQuery(this).attr("data-thumbnail");TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyTwitterPost.Show(i,t,a);y(true)});jQuery(document).on("click",".tb-video-list-dropdown-social-monitor",function(){var e=jQuery(this).attr("data-title");var t=jQuery(this).attr("data-id");var i=jQuery(this).attr("data-is-draft");var o=i!="true"?"https://img.youtube.com/vi/"+t+"/mqdefault.jpg":jQuery(this).attr("data-thumbnail");TubeBuddyMenu.ShowBackgroundSticky();TubeBuddySocialMonitor.Show(t,e,o);y(true)});jQuery(document).on("click",".tb-video-list-dropdown-transcriptions",function(){var e=jQuery(this).attr("data-title");var t=jQuery(this).attr("data-id");var i=jQuery(this).attr("data-is-draft");var o=i!="true"?"https://img.youtube.com/vi/"+t+"/mqdefault.jpg":jQuery(this).attr("data-thumbnail");TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyTranscriptions.Show(t,e,o);y(true)});jQuery(document).on("click",".tb-video-list-dropdown-copy-cards",function(){var e=jQuery(this).attr("data-title");var t=jQuery(this).attr("data-id");var i=jQuery(this).attr("data-is-draft");var o=i!="true"?"https://img.youtube.com/vi/"+t+"/mqdefault.jpg":jQuery(this).attr("data-thumbnail");TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyCards.Show(t,e,o);y(true)});jQuery(document).on("click",".tb-video-list-dropdown-copy-endscreens",function(){var e=jQuery(this).attr("data-title");var t=jQuery(this).attr("data-id");var i=jQuery(this).attr("data-is-draft");var o=i!="true"?"https://img.youtube.com/vi/"+t+"/mqdefault.jpg":jQuery(this).attr("data-thumbnail");TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyEndScreens.Show(t,e,o);y(true)});jQuery(document).on("click",".tb-video-list-dropdown-embed",function(){var e=jQuery(this).attr("data-title");var t=jQuery(this).attr("data-id");var i=jQuery(this).attr("data-is-draft");var o=i!="true"?"https://img.youtube.com/vi/"+t+"/mqdefault.jpg":jQuery(this).attr("data-thumbnail");TBUtilities.AddAction({VideoId:t},TBUtilities.ActionTypes.AdvancedVideoEmbedding_Use,"advancedvideoembedding");TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyEmbed.ShowForVideo(t,e,o);y(true)});jQuery(document).on("click",".tb-video-list-dropdown-share-tracker",function(){var e=jQuery(this).attr("data-title");var t=jQuery(this).attr("data-id");var i=jQuery(this).attr("data-is-draft");var o=i!="true"?"https://img.youtube.com/vi/"+t+"/mqdefault.jpg":jQuery(this).attr("data-thumbnail");TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyShareTracker.ShowForVideo(t,e,o);y(true)});jQuery(document).on("click",".tb-video-list-dropdown-search-ranking",function(){var e=jQuery(this).attr("data-title");var t=jQuery(this).attr("data-id");var i=jQuery(this).attr("data-is-draft");var o=i!="true"?"https://img.youtube.com/vi/"+t+"/mqdefault.jpg":jQuery(this).attr("data-thumbnail");TubeBuddyMenu.ShowBackgroundSticky();TubeBuddySearchRanking.Show(t,o,e);y(true)});jQuery(document).on("click",".tb-video-list-dropdown-find-and-replace",function(){TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyFindAndReplace.Show();y(true)});jQuery(document).on("click",".tb-video-list-dropdown-bulk-thumbnail",function(){TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyBulkThumbnail.Show();y(true)});jQuery(document).on("click",".tb-video-list-dropdown-delete-cards",function(){TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyCards.ShowDelete();y(true)});jQuery(document).on("click",".tb-video-list-dropdown-bulkcopy-cards",function(){TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyBulkCopySelect.Show("TubeBuddyCards");y(true)});jQuery(document).on("click",".tb-video-list-dropdown-bulkcopy-endscreens",function(){TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyBulkCopySelect.Show("tubebuddyendscreens");y(true)});jQuery(document).on("click",".tb-video-list-dropdown-bulkupdate-endscreens",function(){TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyEndScreenUpdate.Show();y(true)});jQuery(document).on("click",".tb-video-list-dropdown-bulkupdate-endscreens",function(){TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyEndScreenUpdate.Show();y(true)});jQuery(document).on("click",".tb-video-list-dropdown-bulkdelete-endscreens",function(){TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyEndScreens.ShowDelete();y(true)});jQuery(document).on("click",".tb-video-list-dropdown-thumbnail-creator",function(){var e=jQuery(this).attr("data-title");var t=jQuery(this).attr("data-id");var i=jQuery(this).attr("data-is-draft");var o=i!="true"?"https://img.youtube.com/vi/"+t+"/mqdefault.jpg":jQuery(this).attr("data-thumbnail");var a=jQuery(this).attr("data-views");TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyThumbnailCreator.Show(t,e,o,"",a);y(true)});jQuery(document).on("click",".tb-video-list-dropdown-gif-generator",function(){var e=jQuery(this).attr("data-title");var t=jQuery(this).attr("data-id");var i="https://img.youtube.com/vi/"+t+"/mqdefault.jpg";TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyGifGenerator.Show(t,e,i);y(true)});jQuery(document).on("click",".vm-search-container, #vm-search-container",function(e){if(!i&&n){i=true;TBExtension.Get("https://www.youtube.com/view_all_playlists?sf=name&vmo=title_asc&sa=0","CRTBVideosListGetPlaylists")}});jQuery(document).on("click",".tb-video-list-dropdown-pick-a-winner",function(){var e=jQuery(this).attr("data-title");var t=jQuery(this).attr("data-id");var i=jQuery(this).attr("data-is-draft");var o=i!="true"?"https://img.youtube.com/vi/"+t+"/mqdefault.jpg":jQuery(this).attr("data-thumbnail");TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyPickAWinner.Show(t,o,e);y(true)});jQuery(document).on("click",".tb-video-list-dropdown-ab-test",function(){var e=encodeURI(jQuery(this).attr("data-title"));var t=encodeURI(jQuery(this).attr("data-id"));var i=jQuery(this).attr("data-is-draft");var o=i!="true"?encodeURI("https://img.youtube.com/vi/"+t+"/mqdefault.jpg"):jQuery(this).attr("data-thumbnail");y(true);window.open(TBGlobal.host+"/channel/abtestcreate/"+TBGlobal.CurrentChannelId()+"?videoid="+t+"&videotitle="+e+"&videothumbnail="+o,"_blank")});jQuery(document).on("click",".tb-video-list-dropdown-export-comments",function(){var e=jQuery(this).attr("data-id");TBUtilities.Confirm("Are you sure you want to export all comments (1,000 max) from this video to a CSV file?\n\nThis process can take up to 2 MINUTES to complete based on how many comments you have (so be patient).",function(){if(!TBGlobal.CanAccessLevel3Tools()){TBGlobal.ShowUpgradePage("export video comments",TBGlobal.limitation.exportComments);return false}var t=TBGlobal.host+"/youtubechannel/ExportVideoComments?channelId="+TBGlobal.CurrentChannelId()+"&videoId="+e;var i=window.open(t,"_blank");i.focus()},null)});jQuery(document).on("click",".tb-video-list-dropdown-export-to-facebook",function(){var e=jQuery(this).attr("data-title");var t=jQuery(this).attr("data-id");var i=jQuery(this).attr("data-is-draft");var o=i!="true"?"https://img.youtube.com/vi/"+t+"/mqdefault.jpg":jQuery(this).attr("data-thumbnail");TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyCopyToFacebook.Show(t,o,e);y(true)});jQuery(document).on("click",".tb-video-list-dropdown-sunset-video",function(){var e=jQuery(this).attr("data-id");var t=jQuery(this).attr("data-title");var i=jQuery(this).attr("data-is-draft");var o=i!="true"?"https://img.youtube.com/vi/"+e+"/mqdefault.jpg":jQuery(this).attr("data-thumbnail");TubeBuddyMenu.ShowBackgroundSticky();TubeBuddySunsetVideo.Show(e,t,o);y(true)});jQuery(document).on("click",".tb-video-list-dropdown-golive-video",function(){var e=jQuery(this).attr("data-id");var t=jQuery(this).attr("data-title");var i=jQuery(this).attr("data-is-draft");var o=i!="true"?"https://img.youtube.com/vi/"+e+"/mqdefault.jpg":jQuery(this).attr("data-thumbnail");TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyGoLiveVideo.Show(e,t,o);y(true)});jQuery(document).on("click",".tb-video-list-dropdown-video-updated-video",function(){var e=jQuery(this).attr("data-id");var t=jQuery(this).attr("data-title");var i=jQuery(this).attr("data-is-draft");var o=i!="true"?"https://img.youtube.com/vi/"+e+"/mqdefault.jpg":jQuery(this).attr("data-thumbnail");TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyScheduledMetaUpdates.Show(e,t,o);y(true)});jQuery(document).on("change",".tb-videoslist-playlists-select",function(){var e=jQuery(this).val();if(e!="select"&&!jQuery(this).attr("data-video-id-list")){jQuery(".tb-videoslist-playlist-loading").show();a=e;TBExtension.Get("https://www.youtube.com/playlist?list="+e,"CRTBVideosListGetPlaylist")}else{a="";o=""}});jQuery(document).on("click",".tb-video-list-cards-update",function(){TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyCardsUpdate.Show()});jQuery(document).on("click",".tb-backup-backup-button",function(){TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyBackup.Show()});jQuery(document).on("mousedown","#submit-search-button",function(e){f()});jQuery(document).on("keydown","#advanced-search-dropdown input",function(e){var t=e.charCode?e.charCode:e.keyCode?e.keyCode:0;if(t==13){f()}});jQuery(document).on("click",".tb-videoslist-save-notes",function(){var e=jQuery(this).attr("data-id");var t=TBExtension.GetType()=="firefox"?jQuery("[data-notes-id="+e+"]").val():jQuery("[data-notes-id="+e+"]").wysiwyg("getContent");var i=jQuery.param({Id:e,UserNotes:t});var o=TBGlobal.host+TBGlobal.apiUrls.youTubeVideosSaveUserNotes;TBExtension.Post(o,i,"CRVideosListSaveUserNotes",null,{contentType:"application/x-www-form-urlencoded; charset=UTF-8"})});jQuery(document).on("click",".tb-bulk-menu-item-annotation-audit",function(){TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyAnnotationAudit.Show()});jQuery(document).on("click",".tb-video-list-dropdown-apply-card-templates",function(){var e=jQuery(this).attr("data-id");var t=jQuery(this).attr("data-title");var i=jQuery(this).attr("data-is-draft");var o=i!="true"?"https://img.youtube.com/vi/"+e+"/mqdefault.jpg":jQuery(this).attr("data-thumbnail");TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyCardTemplates.Show(e,t,o);y(true)});jQuery(document).on("click",".tb-video-list-dropdown-apply-endscreen-templates",function(){var e=jQuery(this).attr("data-id");var t=jQuery(this).attr("data-title");var i=jQuery(this).attr("data-is-draft");var o=i!="true"?"https://img.youtube.com/vi/"+e+"/mqdefault.jpg":jQuery(this).attr("data-thumbnail");TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyEndScreenTemplates.Show(e,t,o);y(true)});jQuery(document).on("click",".tb-video-id-copy",function(){jQuery(".tb-video-id-copy").text("Copied");window.setTimeout(function(){jQuery(".tb-video-id-copy").text("Copy")},1500)});jQuery(document).on("click",".tb-video-link-copy",function(){jQuery(".tb-video-link-copy").text("Copied");window.setTimeout(function(){jQuery(".tb-video-link-copy").text("Copy")},1500)});jQuery(document).on("click",".tb-videos-list-playlist-copy",function(){jQuery(this).text("Copied");window.setTimeout(function(){jQuery(".tb-videos-list-playlist-copy").text("Copy")},1500)})};var g=function(){jQuery(".edit-expand-menu-button").each(function(){var e=jQuery(this).closest(".vm-video-item-content-primary");var t=e.find(".vm-video-title-content").text().trim();var i=e.find(".yt-thumb-clip img:first").attr("src");var o=e.find("input:first").attr("value");var a=e.parent().find(".vm-video-item-content-secondary").find(".vm-video-side-view-count").text().trim();var n=e.parent().find(".vm-video-privacy-draft-badge").length>0||e.parent().find(".vm-private").filter(":visible").length>0;jQuery(".tb-videos-list-dropdown:last").find("li").attr("data-title",t).attr("data-thumbnail",i).attr("data-id",o).attr("data-views",parseInt(a)).attr("data-is-draft",n);jQuery(this).after(jQuery(".tb-videos-list-dropdown:last")[0].outerHTML)});jQuery(".tb-videos-list-dropdown").each(function(){var e=jQuery(this).closest("li").find("input:first").attr("value");var t=jQuery(this).closest("li").find(".vm-video-title-content").text().trim();var i=jQuery(this).closest("li").find(".yt-thumb-clip img:first").attr("src");var o=jQuery(this).closest("li").find(".vm-video-side-view-count").text().trim();var a=jQuery(this).closest(".vm-video-item-content").find(".vm-video-privacy-draft-badge").length>0||jQuery(this).closest(".vm-video-item-content").find(".vm-private").filter(":visible").length>0;jQuery(this).attr("data-id",e);jQuery(this).attr("data-title",t);jQuery(this).attr("data-thumbnail",i);jQuery(this).attr("data-views",parseInt(o));jQuery(this).attr("data-is-draft",a)});jQuery("[data-card-class=add-to-widget-clickcard]").after(jQuery(".tb-videos-bulk-list-dropdown:last")[0].outerHTML);jQuery(".tb-videos-bulk-list-dropdown").after(jQuery(".tb-videos-bulk-dropdown-template:first")[0].outerHTML);jQuery("#advanced-search-dropdown").prepend(jQuery(".tb-advanced-text-input-playlist:first")[0].outerHTML);if(document.location.href.indexOf("tbplylst")>-1){jQuery(".advanced-search-id").val("");jQuery("#vm-myvideos-search-box").val("")}if(jQuery("#advanced-search-dropdown").is(":visible")){if(!i){i=true;TBExtension.Get("https://www.youtube.com/view_all_playlists?sf=name&vmo=title_asc&sa=0","CRTBVideosListGetPlaylists")}}};var v=function(e){};var T=function(){jQuery(document.body).on("CRTBVideoListGetLaunchPadSummary",function(e,i){try{var o=jQuery("[data-video-container-id='"+t+"']");TBUtilities.Log("CRTBVideoListGetLaunchPadSummary Result: "+i);jQuery(o).find(".tb-videoslist-launchpad-loading").hide();jQuery(o).find(".tb-videoslist-launchpad-loaded").show();var a=JSON.parse(i.response);var n;if(a.Processed==true){jQuery(o).find(".tb-videoslist-launchpad-videosummary").text("Manage this Video in Launch Pad");n=TBGlobal.host+"/launchpad/video/"+t}else{jQuery(o).find(".tb-videoslist-launchpad-videosummary").text("Add Video to Launch Pad");n=TBGlobal.host+"/launchpad/processvideo?videoid="+t+"&channelid="+TBGlobal.CurrentChannelId()+"&c=false&b=true&o=true&type=1"}jQuery(o).find(".tb-videoslist-launchpad-videosummary").prop("href",n);if(a.BestPracticPercentComplete!="NA"){jQuery(o).find(".tb-videoslist-launchpad-bestpractices-hasdata").show();jQuery(o).find(".tb-videoslist-launchpad-bestpractices-nodata").hide();jQuery(o).find(".tb-videoslist-launchpad-bestpractices-remaining").text(a.BestPracticRemaining);jQuery(o).find(".tb-videoslist-launchpad-bestpractices-remaining").attr("href",n+"?tab=bestpractices");jQuery(o).find(".tb-videoslist-launchpad-bestpractices-percentComplete").text(a.BestPracticPercentComplete)}else{jQuery(o).find(".tb-videoslist-launchpad-bestpractices-nodata").show();jQuery(o).find(".tb-videoslist-launchpad-bestpractices-hasdata").hide()}if(a.ChecklistPercentComplete!="NA"){jQuery(o).find(".tb-videoslist-launchpad-checklist-hasdata").show();jQuery(o).find(".tb-videoslist-launchpad-checklist-nodata").hide();jQuery(o).find(".tb-videoslist-launchpad-checklist-remaining").text(a.ChecklistRemaining);jQuery(o).find(".tb-videoslist-launchpad-checklist-remaining").attr("href",n+"?tab=checklist");jQuery(o).find(".tb-videoslist-launchpad-checklist-percentComplete").text(a.ChecklistPercentComplete)}else{jQuery(o).find(".tb-videoslist-launchpad-checklist-nodata").show();jQuery(o).find(".tb-videoslist-launchpad-checklist-hasdata").hide()}if(a.OpportunityPercentComplete!="NA"){jQuery(o).find(".tb-videoslist-launchpad-opportunities-hasdata").show();jQuery(o).find(".tb-videoslist-launchpad-opportunities-nodata").hide();jQuery(o).find(".tb-videoslist-launchpad-opportunities-remaining").text(a.OpportunityRemaining);jQuery(o).find(".tb-videoslist-launchpad-opportunities-remaining").attr("href",n+"?tab=opportunities");jQuery(o).find(".tb-videoslist-launchpad-opportunities-percentComplete").text(a.OpportunityPercentComplete)}else{jQuery(o).find(".tb-videoslist-launchpad-opportunities-nodata").show();jQuery(o).find(".tb-videoslist-launchpad-opportunities-hasdata").hide()}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyVideoList] CRTBVideoListGetLaunchPadSummary"})}});jQuery(document.body).on("CRVideosListGetUserNotes",function(e,t){try{if(t.success){var i=null;if(t.response){i=TBUtilities.ReplaceAll(t.response,'"',"");if(i=="null")i=""}else{i=""}jQuery(".tb-videoslist-notes-loading").hide();if(TBExtension.GetType()=="firefox"){jQuery("#tb-videoslist-video-notes").show()}else{jQuery("[data-notes-id="+t.data.videoid+"]").wysiwyg("setContent",i)}jQuery("[data-notes-id="+t.data.videoid+"]").val(i);jQuery(".tb-videoslist-notes-loaded").show();jQuery("[data-notes-id="+t.data.videoid+"]").attr("data-notes-loaded-id",t.data.videoid)}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyEditVideos] CREditVideoGetUserNotes"})}});jQuery(document.body).on("CRVideosListSaveUserNotes",function(e,t){jQuery(".tb-videoslist-notes-saved").show().delay(2e3).fadeOut()});jQuery(document.body).on("CRTBVideosListGetPlaylist",function(e,t){TBUtilities.Log("CRTBVideosListGetPlaylist");TBUtilities.Log(t);if(t.success){var i=TBGlobal.GetYouTubeUI();if(t.response.indexOf('window["ytInitialData"] = {"responseContext"')>-1){i="material"}var a="";switch(i){case"default":{var n=DOMPurify.sanitize(t.response,DOMPurifyConfig);jQuery(".pl-video",n).each(function(e){var t=jQuery(this).attr("data-video-id");if(a)a+=" ";if(t.indexOf("-")>0||t.indexOf("_")>0)a+='"'+t+'"';else a+=t;TBUtilities.Log(t)});break}case"studio":case"material":{var r=w(t.response);if(r.contents.twoColumnBrowseResultsRenderer.tabs["0"]){try{jQuery.each(r.contents.twoColumnBrowseResultsRenderer.tabs["0"].tabRenderer.content.sectionListRenderer.contents["0"].itemSectionRenderer.contents["0"].playlistVideoListRenderer.contents,function(e,t){if(t.playlistVideoRenderer){var i=t.playlistVideoRenderer.videoId;if(a)a+=" ";if(i.indexOf("-")>0||i.indexOf("_")>0)a+='"'+i+'"';else a+=i;TBUtilities.Log(i)}})}catch(e){}}break}}TBUtilities.Log(a);jQuery(".tb-videoslist-playlist-loading").hide();o=a+" tbplylst"}});jQuery(document.body).on("CRTBVideosListGetPlaylists",function(e,t){if(t.success){var i=DOMPurify.sanitize(t.response,DOMPurifyConfig);jQuery(".vm-video-title-text",i).each(function(e){var t=jQuery(this).text();var i=jQuery(this).attr("href").toString().replace("/playlist?list=","");jQuery(".tb-videoslist-playlists-select").append('<option value="'+i+'">'+t+"</option>")});jQuery(".tb-videoslist-playlists-select-loading").hide();jQuery(".tb-videoslist-playlists-select").show()}else{}});jQuery(document.body).on("CRTBLoadVideosListTemplate",function(e,t){if(t.success){t.response=TBUtilities.FixLocalHtml(DOMPurify.sanitize(t.response,DOMPurifyConfig));jQuery("body").append(t.response);g();u();n=true}else{}});jQuery(document.body).on("CRTBLoadVideosListEditPage",function(e,t){if(t.success){var i=t.response.indexOf("{'X-YouTube-Identity-Token': \"")+"{'X-YouTube-Identity-Token': \"".length;var o=t.response.indexOf('"',i+2);var a=t.response.substring(i,o);var n={video_ids:t.data.videoId,session_token:a,src_playlist_id:""};TBExtension.Post("https://www.youtube.com/addto_ajax?action_get_dropdown=1&hide_watch_later=true&feature=edit",jQuery.param(n),"CRTBLoadVideosListPlaylistData",{videoId:t.data.videoId},{contentType:"application/x-www-form-urlencoded; charset=UTF-8"})}else{}});jQuery(document.body).on("CRTBLoadVideosListPlaylistData",function(e,t){var i=false;if(t.success){$(".tb-video-list-playlists-container").empty();var o=t.data.videoId;var a=DOMPurify.sanitize(t.response,DOMPurifyConfig);jQuery(a).find("li").each(function(){var e=jQuery(this).find(".playlist-name:first").html();var t=jQuery(this).find("button:first").attr("aria-checked");var a=jQuery(this).attr("data-full-list-id");if(t=="checked"){$(".tb-video-list-playlists-container").append('<div style="padding:0 0 10px"><b>Playlist Link - "'+e+'"</b><br /> <input class="tb-material-input" style="width:50% !important;" type="text" value="https://www.youtube.com/watch?v='+o+"&list="+a+'" readonly/><button id="tb-videos-list-playlist-copy-'+a+'" class="tb-btn-blue tb-videos-list-playlist-copy" data-clipboard-text="https://www.youtube.com/watch?v='+o+"&list="+a+'" >Copy</button></div>');i=true;new ClipboardJS("#tb-videos-list-playlist-copy-"+a)}});if(!i){$(".tb-video-list-playlists-container").append('<div style="padding:15px 0 10px 5px; color:coral;">This video was not found in any of your Playlists.</div>')}}else{}});jQuery(document.body).on("CRTBVideoListLoadVideoStatus",function(e,t){var i=jQuery("div[data-video-container-id='"+t.data.videoId+"']");jQuery(i).find(".tb-videos-list-notes").hide();jQuery(i).find(".tb-videos-list-thumbnail-generated-date").text("");jQuery(i).find(".tb-videos-list-thumbnail-generated").hide();jQuery(i).find(".tb-videos-list-is-card-template").hide();jQuery(i).find(".tb-videos-list-is-annotation-template").hide();jQuery(i).find(".tb-videos-list-facebook-date").text("");jQuery(i).find(".tb-videos-list-view-facebook").attr("href","");jQuery(i).find(".tb-videos-list-facebook").hide();jQuery(i).find(".tb-videos-list-golive-date").text("");jQuery(i).find(".tb-videos-list-golive").hide();jQuery(i).find(".tb-videos-list-wentlive-date").text("");jQuery(i).find(".tb-videos-list-wentlive").hide();jQuery(i).find(".tb-videos-list-sunset-date").text("");jQuery(i).find(".tb-videos-list-sunset").hide();jQuery(i).find(".tb-videos-list-sunsetted-date").text("");jQuery(i).find(".tb-videos-list-sunsetted").hide();jQuery(i).find(".tb-videos-list-share-tracker-items").hide();if(t.success){var o=JSON.parse(t.response);if(o.DateThumbnailGeneratedLocal){jQuery(i).find(".tb-videos-list-thumbnail-generated-date").text(o.DateThumbnailGeneratedLocal);jQuery(i).find(".tb-videos-list-thumbnail-generated").show();jQuery(i).find(".tb-videos-list-notes").show()}if(o.IsCardTemplate){jQuery(i).find(".tb-videos-list-is-card-template").show();jQuery(i).find(".tb-videos-list-notes").show()}if(o.DateFacebookPostedLocal){jQuery(i).find(".tb-videos-list-facebook-date").text(o.DateFacebookPostedLocal);jQuery(i).find(".tb-videos-list-facebook").show();jQuery(i).find(".tb-videos-list-notes").show();if(!o.FacebookExternalAccountId)jQuery(i).find(".tb-videos-list-view-facebook").hide();else{jQuery(i).find(".tb-videos-list-view-facebook").show();jQuery(i).find(".tb-videos-list-view-facebook").attr("href","https://www.facebook.com/"+o.FacebookExternalAccountId+"/videos/"+o.FacebookVideoId)}}if(o.ScheduledGoLiveLocal){jQuery(i).find(".tb-videos-list-golive-date").text(o.ScheduledGoLiveLocal);jQuery(i).find(".tb-videos-list-golive").show();jQuery(i).find(".tb-videos-list-notes").show()}if(o.DateWentLiveLocal){jQuery(i).find(".tb-videos-list-wentlive-date").text(o.DateWentLiveLocal);jQuery(i).find(".tb-videos-list-wentlive").show();jQuery(i).find(".tb-videos-list-notes").show()}if(o.DateSunsetLocal){jQuery(i).find(".tb-videos-list-sunset-date").text(o.DateSunsetLocal);jQuery(i).find(".tb-videos-list-sunset").show();jQuery(i).find(".tb-videos-list-notes").show()}if(o.DateSunsettedLocal){jQuery(i).find(".tb-videos-list-sunsetted-date").text(o.DateSunsettedLocal);jQuery(i).find(".tb-videos-list-sunsetted").show();jQuery(i).find(".tb-videos-list-notes").show()}if(o.SharedWithNetworks!=null){jQuery(i).find(".tb-videos-list-share-tracker-items").show();jQuery.each(o.SharedWithNetworks,function(e,t){jQuery(i).find(".tb-videos-list-share-tracker-items-list").append('<img src="'+TBGlobal.host+"/images/icons/social/"+t+'.png" style="height:12px;" /> ')});jQuery(i).find(".tb-videos-list-notes").show()}if(o.DateScheduledMetaUpdate){jQuery(i).find(".tb-videos-list-scheduledmetaupdate-date").text(o.DateScheduledMetaUpdateLocal);jQuery(i).find(".tb-videos-list-scheduledmetaupdate").show();jQuery(i).find(".tb-videos-list-notes").show()}if(o.DateScheduledMetaUpdated){jQuery(i).find(".tb-videos-list-scheduledmetaupdated-date").text(o.DateScheduledMetaUpdatedLocal);jQuery(i).find(".tb-videos-list-scheduledmetaupdated").show();jQuery(i).find(".tb-videos-list-notes").show()}}else{}});jQuery(document.body).on("CRTBVideosListDownloadUrl",function(e,t){var i="";for(var o in t.additionalInfo.headers){i+="\n"+o+": "+t.additionalInfo.headers[o]}})};var w=function(e){var t=e.indexOf('window["ytInitialData"] = ');t=t+26;var i=e.substring(t,e.length);var o=i.indexOf("};")+1;var i=i.substring(0,o);var a=jQuery.parseJSON(i);return a};return{Initialize:function(){if(TBGlobal.IsAuthenticated()){if(!e){T();m();e=true}l=setInterval(c,100)}}}}();var TubeBuddyV2VPromote=function(){var e=false;var t="-~-~~-~~~-~~-~-";var i="  ";var o=" --~--";var a={step:1,selectedVideo:{id:"",title:"",thumbnail:""},promoteFeaturedContent:{enabled:true,message:""},promoteBulkDescriptionUpdate:{enabled:true,message:"",active:false,index:0,videoList:[],position:"end"},promoteRelatedVideos:{enabled:true},failedVideoIds:[],isStopped:false,notMine:false,channelVideoCount:0};var n=function(){var e=TBGlobal.host+"/ModuleManager/v2vpromotion?v="+TBGlobal.versionNumber;if(loadLocalHTML&&(TBExtension.GetType()=="chrome"||TBExtension.GetType()=="firefox")){e=chrome.extension.getURL("modules/v2vpromotion.html")}else if(loadLocalHTML&&TBExtension.GetType()=="safari"){e="modules/v2vpromotion.html"}TBExtension.Get(e,"CRTBLoadPromoteTemplate")};var r=function(){try{TBUtilities.Log("Preparing Dialog");jQuery("#tb-v2v-promote-header-image").attr("src",a.selectedVideo.thumbnail);jQuery("#tb-v2v-promote-featured-thumbnail").attr("src",a.selectedVideo.thumbnail);jQuery("#tb-v2v-promote-description-text").val('Please watch: "'+a.selectedVideo.title+'" \nhttps://www.youtube.com/watch?v='+a.selectedVideo.id);jQuery(".tb-v2v-promote-video-title").text(a.selectedVideo.title);jQuery("#tb-vid2vid-thumbnail").attr("src",a.selectedVideo.thumbnail);jQuery("#tb-vid2vid-video-link").text(a.selectedVideo.title);jQuery("#tb-vid2vid-video-link").attr("href","https://www.youtube.com/watch?v="+a.selectedVideo.id);jQuery("#tb-v2v-promote-methods-container").hide();jQuery("#tb-v2v-promote-bulk-description-updates-container").hide();jQuery("#tb-v2v-promote-featured-content-container").hide();jQuery("#tb-v2v-promote-cancel").text("Cancel");jQuery("#tb-v2v-promote-kickoff").hide();jQuery("#tb-v2v-promote-continue").show();jQuery("#tb-v2v-promote-summary-container").hide();jQuery("#tb-v2v-promote-featured-video-status-complete").hide();jQuery("#tb-v2v-promote-featured-video-status-processing").hide();jQuery("#tb-v2v-promote-bulk-descriptions-status-complete").hide();jQuery("#tb-v2v-promote-bulk-descriptions-status-processing").hide();jQuery("#tb-v2v-promote-success").hide();jQuery("#tb-v2v-promote-container").fadeIn();jQuery("#tb-v2v-promote-methods-container").fadeIn();if(a.notMine){jQuery("#tb-v2v-promote-select-invideo").prop("checked",false);jQuery("#tb-v2v-promote-select-invideo").prop("disabled",true);jQuery("#tb-v2v-promote-select-invideo-no").show();jQuery("#tb-v2v-promote-select-invideo-disabled").css("color","#aaa")}jQuery("#tb-v2v-promote-select-invideo").prop("checked",false)}catch(e){TBUtilities.LogError({Exception:e,Location:"[V2VPromote] prepareDialog"})}};var s=function(){jQuery(document).on("click","#tb-v2v-promote-cancel, .tb-module-close",function(){try{TubeBuddyMenu.HideBackground();jQuery("#tb-v2v-promote-container").hide();jQuery("#tb-v2v-promote-back").hide();a.step=1}catch(e){TBUtilities.LogError({Exception:e,Location:"[V2VPromote] [click] tb-v2v-promote-cancel"})}});jQuery(document).on("click","#tb-v2v-promote-stop",function(){try{a.isStopped=true;jQuery("#tb-v2v-promote-cancel").show();jQuery("#tb-v2v-promote-cancel").text("Close");jQuery("#tb-v2v-promote-stop").hide();jQuery("#tb-v2v-promote-featured-video-status-processing").hide();jQuery("#tb-v2v-promote-bulk-descriptions-status-processing").hide()}catch(e){TBUtilities.LogError({Exception:e,Location:"[V2VPromote] [click] tb-v2v-promote-stop"})}});jQuery(document).on("click","#tb-v2v-promote-kickoff",function(){try{jQuery("#tb-v2v-promote-kickoff").hide();jQuery("#tb-v2v-promote-back").hide();jQuery("#tb-v2v-promote-cancel").hide();jQuery("#tb-v2v-promote-stop").fadeIn();if(a.promoteFeaturedContent.enabled){l()}else if(a.promoteBulkDescriptionUpdate.enabled){d()}try{if(a.promoteFeaturedContent.enabled)TBUtilities.AddAction(null,TBUtilities.ActionTypes.FeaturedVideoPromotions_Promote,"featuredvideopromotions");if(a.promoteBulkDescriptionUpdate.enabled)TBUtilities.AddAction({VideoCount:a.promoteBulkDescriptionUpdate.videoList.length},TBUtilities.ActionTypes.DescriptionPromotion_Promote,"descriptionpromotion")}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyPromotion] [addAction]"})}}catch(e){TBUtilities.LogError({Exception:e,Location:"[V2VPromote] [click] tb-v2v-promote-kickoff"})}});jQuery(document).on("click","#tb-v2v-promote-back",function(){try{switch(a.step){case 3:if(!a.promoteFeaturedContent.enabled)a.step--;break;case 4:if(!a.promoteBulkDescriptionUpdate.enabled)a.step--;break}a.step--;b()}catch(e){TBUtilities.LogError({Exception:e,Location:"[V2VPromote] [click] tb-v2v-promote-back"})}});jQuery(document).on("click","#tb-v2v-promote-continue",function(){try{switch(a.step){case 1:a.promoteBulkDescriptionUpdate.enabled=jQuery("#tb-v2v-promote-select-description").is(":checked");a.promoteFeaturedContent.enabled=jQuery("#tb-v2v-promote-select-invideo").is(":checked");if(!a.promoteBulkDescriptionUpdate.enabled&&!a.promoteFeaturedContent.enabled){TBUtilities.Alert("You must select at least 1 type of promotion.");return};if(!a.promoteFeaturedContent.enabled){jQuery("#tb-v2v-promote-featured-video-status").text("(skipped)");jQuery("#tb-v2v-promote-featured-video-status").css("color","#777");a.step++}else{jQuery("#tb-v2v-promote-featured-video-status").text("Ready");jQuery("#tb-v2v-promote-featured-video-status").css("color","green")}if(!a.promoteBulkDescriptionUpdate.enabled){jQuery("#tb-v2v-promote-bulk-descriptions-status").text("(skipped)");jQuery("#tb-v2v-promote-bulk-descriptions-status").css("color","#777")}else{jQuery("#tb-v2v-promote-bulk-descriptions-status").text("Ready");jQuery("#tb-v2v-promote-bulk-descriptions-status").css("color","green")}break;case 2:a.promoteFeaturedContent.message=jQuery("#tb-v2v-promote-invideo-message").val();if(!a.promoteBulkDescriptionUpdate.enabled){a.step++}break;case 3:a.promoteBulkDescriptionUpdate.message=jQuery("#tb-v2v-promote-description-text").val();if(jQuery("#tb-v2v-description-start").is(":checked")){a.promoteBulkDescriptionUpdate.position="start";jQuery(".tb-v2v-remove-confirm").hide()}else if(jQuery("#tb-v2v-description-remove").is(":checked")){a.promoteBulkDescriptionUpdate.position="remove";jQuery(".tb-v2v-remove-confirm").show()}else{a.promoteBulkDescriptionUpdate.position="end";jQuery(".tb-v2v-remove-confirm").hide()}break}a.step++;b()}catch(e){TBUtilities.LogError({Exception:e,Location:"[V2VPromote] [click] tb-v2v-promote-continue"})}})};var l=function(){try{jQuery("#tb-v2v-promote-featured-video-status").html("Processing");jQuery("#tb-v2v-promote-featured-video-status").css("color","green");jQuery("#tb-v2v-promote-featured-video-status-processing").fadeIn();TBExtension.Get("https://www.youtube.com/featured_content","CRTBPostCreateVideo")}catch(e){TBUtilities.LogError({Exception:e,Location:"[V2VPromote] startFeaturedContent"})}};var d=function(){try{jQuery("#tb-v2v-promote-bulk-descriptions-status").html("Loading your videos");jQuery("#tb-v2v-promote-bulk-descriptions-status").css("color","green");jQuery("#tb-v2v-promote-bulk-descriptions-status-processing").fadeIn();TBYouTubeApi.GetChannelVideos(TBGlobal.CurrentChannelId(),null,c)}catch(e){TBUtilities.LogError({Exception:e,Location:"[V2VPromote] startBulkDescriptionUpdates"})}};var u=function(e){try{if(!e){jQuery("#tb-v2v-promote-success").fadeIn()}jQuery("#tb-v2v-promote-cancel").show();jQuery("#tb-v2v-promote-cancel").text("Close");jQuery("#tb-v2v-promote-stop").hide();if(a.failedVideoIds.length>0){var t="The following videos failed to update the description:\n";jQuery.each(a.failedVideoIds,function(e,i){t+="https://www.youtube.com/watch?v="+i+"\n"});jQuery("#tb-v2v-failures").val(t);jQuery("#tb-v2v-failures").show()}}catch(e){TBUtilities.LogError({Exception:e,Location:"[V2VPromote] promotionDone"})}};var c=function(e){try{TBUtilities.Log("gotVideos");a.promoteBulkDescriptionUpdate.videoList=e;a.promoteBulkDescriptionUpdate.active=true;a.promoteBulkDescriptionUpdate.index=0;a.failedVideoIds=[];p()}catch(e){TBUtilities.LogError({Exception:e,Location:"[V2VPromote] gotVideos"})}};var p=function(){try{if(a.isStopped){jQuery("#tb-v2v-promote-bulk-descriptions-status").css("color","red");jQuery("#tb-v2v-promote-bulk-descriptions-status").text(jQuery("#tb-v2v-promote-bulk-descriptions-status").text()+" [STOPPED]");u(true);return}var e=a.promoteBulkDescriptionUpdate.videoList.length;jQuery(".tv-v2v-upgrade").attr("href","https://www.tubebuddy.com/account/upgrade?id="+TBGlobal.CurrentChannelId());if(!TBGlobal.CanAccessLevel1Tools()&&a.promoteBulkDescriptionUpdate.videoList.length>250){jQuery("#tb-v2v-promote-toomany-free").show();e=250}else if(a.promoteBulkDescriptionUpdate.videoList.length>5e3){jQuery("#tb-v2v-promote-toomany-paid").show();e=5e3}if(a.promoteBulkDescriptionUpdate.index>=e){jQuery("#tb-v2v-promote-bulk-descriptions-status").text("Complete");jQuery("#tb-v2v-promote-bulk-descriptions-status-complete").show();jQuery("#tb-v2v-promote-bulk-descriptions-status-processing").hide();u(false);return}jQuery("#tb-v2v-promote-bulk-descriptions-status").text("Processing Video "+(a.promoteBulkDescriptionUpdate.index+1)+" of "+e);var n=a.promoteBulkDescriptionUpdate.videoList[a.promoteBulkDescriptionUpdate.index].snippet.resourceId.videoId;if(a.isStopped){jQuery("#tb-v2v-promote-bulk-descriptions-status").css("color","red");jQuery("#tb-v2v-promote-bulk-descriptions-status").text(jQuery("#tb-v2v-promote-bulk-descriptions-status").text()+" [STOPPED]");u(true);return}var r=a.promoteBulkDescriptionUpdate.videoList[a.promoteBulkDescriptionUpdate.index].snippet.description.indexOf(t);if(r>=0){var s=a.promoteBulkDescriptionUpdate.videoList[a.promoteBulkDescriptionUpdate.index].snippet.description.lastIndexOf(t);var l="";var d="";if(s>0&&s!=r){l=a.promoteBulkDescriptionUpdate.videoList[a.promoteBulkDescriptionUpdate.index].snippet.description.substring(0,r);d=a.promoteBulkDescriptionUpdate.videoList[a.promoteBulkDescriptionUpdate.index].snippet.description.substring(s+t.length,a.promoteBulkDescriptionUpdate.videoList[a.promoteBulkDescriptionUpdate.index].snippet.description.length)}else{d=a.promoteBulkDescriptionUpdate.videoList[a.promoteBulkDescriptionUpdate.index].snippet.description.substring(r+t.length,a.promoteBulkDescriptionUpdate.videoList[a.promoteBulkDescriptionUpdate.index].snippet.description.length)}a.promoteBulkDescriptionUpdate.videoList[a.promoteBulkDescriptionUpdate.index].snippet.description=l+d}r=a.promoteBulkDescriptionUpdate.videoList[a.promoteBulkDescriptionUpdate.index].snippet.description.indexOf(i);if(r>=0){var l="";var d="";d=a.promoteBulkDescriptionUpdate.videoList[a.promoteBulkDescriptionUpdate.index].snippet.description.substring(r+i.length,a.promoteBulkDescriptionUpdate.videoList[a.promoteBulkDescriptionUpdate.index].snippet.description.length);a.promoteBulkDescriptionUpdate.videoList[a.promoteBulkDescriptionUpdate.index].snippet.description=l+d}r=a.promoteBulkDescriptionUpdate.videoList[a.promoteBulkDescriptionUpdate.index].snippet.description.indexOf(o);if(r>=0){var l="";var d="";d=a.promoteBulkDescriptionUpdate.videoList[a.promoteBulkDescriptionUpdate.index].snippet.description.substring(r+o.length,a.promoteBulkDescriptionUpdate.videoList[a.promoteBulkDescriptionUpdate.index].snippet.description.length);a.promoteBulkDescriptionUpdate.videoList[a.promoteBulkDescriptionUpdate.index].snippet.description=l+d}var c=a.promoteBulkDescriptionUpdate.videoList[a.promoteBulkDescriptionUpdate.index].snippet.description;if(a.promoteBulkDescriptionUpdate.videoList[a.promoteBulkDescriptionUpdate.index].snippet.resourceId.videoId!=a.selectedVideo.id){if(a.promoteBulkDescriptionUpdate.position=="end"){c=a.promoteBulkDescriptionUpdate.videoList[a.promoteBulkDescriptionUpdate.index].snippet.description.trim()+"\n\n"+t+"\n"+a.promoteBulkDescriptionUpdate.message+"\n"+t}else if(a.promoteBulkDescriptionUpdate.position=="start"){c=a.promoteBulkDescriptionUpdate.message+o+"\n"+a.promoteBulkDescriptionUpdate.videoList[a.promoteBulkDescriptionUpdate.index].snippet.description.trim()}}var p="";var b={VideoId:a.promoteBulkDescriptionUpdate.videoList[a.promoteBulkDescriptionUpdate.index].snippet.resourceId.videoId,Description:c,Title:null};p=jQuery.param(b);var y=TBGlobal.host+"/api/youtubevideos/UpdateVideoMetadata";TBExtension.Post(y,p,"CTTBV2VEditVideo",null,{contentType:"application/x-www-form-urlencoded; charset=UTF-8"})}catch(e){TBUtilities.LogError({Exception:e,Location:"[V2VPromote] updateNextVideoDescription"})}};var b=function(){try{jQuery("#tb-v2v-promote-methods-container").hide();jQuery("#tb-v2v-promote-bulk-description-updates-container").hide();jQuery("#tb-v2v-promote-featured-content-container").hide();jQuery("#tb-v2v-promote-summary-container").hide();jQuery("#tb-v2v-promote-kickoff").hide();jQuery("#tb-v2v-promote-continue").show();switch(a.step){case 1:jQuery("#tb-v2v-promote-back").hide();jQuery("#tb-v2v-promote-methods-container").fadeIn();break;case 2:jQuery("#tb-v2v-promote-back").fadeIn();jQuery("#tb-v2v-promote-featured-content-container").fadeIn();break;case 3:jQuery("#tb-v2v-promote-back").fadeIn();jQuery("#tb-v2v-promote-bulk-description-updates-container").fadeIn();break;case 4:jQuery("#tb-v2v-promote-back").fadeIn();jQuery("#tb-v2v-promote-summary-container").fadeIn();jQuery("#tb-v2v-promote-kickoff").show();jQuery("#tb-v2v-promote-continue").hide();break}}catch(e){TBUtilities.LogError({Exception:e,Location:"[V2VPromote] showCurrentStep"})}};var y=function(){jQuery(document.body).on("CTTBV2VEditVideo",function(e,t){try{if(a.isStopped){jQuery("#tb-v2v-promote-bulk-descriptions-status").css("color","red");jQuery("#tb-v2v-promote-bulk-descriptions-status").text(jQuery("#tb-v2v-promote-bulk-descriptions-status").text()+" [STOPPED]");u(true);return}a.promoteBulkDescriptionUpdate.index++;p()}catch(e){TBUtilities.LogError({Exception:e,Location:"[V2VPromote] CRTBPromotePostEditUrl"})}});jQuery(document.body).on("CRTBLoadPromoteTemplate",function(e,t){try{if(t.success){t.response=TBUtilities.FixLocalHtml(DOMPurify.sanitize(t.response,DOMPurifyConfig));jQuery("body").append(t.response);h()}}catch(e){TBUtilities.LogError({Exception:e,Location:"[V2VPromote] CRTBLoadPromoteTemplate"})}});jQuery(document.body).on("CRTBPostCreateVideo",function(e,t){try{if(a.isStopped){jQuery("#tb-v2v-promote-featured-video-status").css("color","red");jQuery("#tb-v2v-promote-featured-video-status").text(jQuery("#tb-v2v-promote-featured-video-status").text()+" [STOPPED]");u(true);return}if(t.success){var i=TBUtilities.GetSessionToken(t.response);var o={type:"video",encrypted_video_id:a.selectedVideo.id,timing:"end",start_time:"00:01",smart_timing:1,custom_message:a.promoteFeaturedContent.message,session_token:i};var n=jQuery.param(o);TBExtension.Post("https://www.youtube.com/featured_content?action_save=1",n,"CRTBPostUpdateInVideoProgramming",null,{contentType:"application/x-www-form-urlencoded; charset=UTF-8"})}else{}}catch(e){TBUtilities.LogError({Exception:e,Location:"[V2VPromote] CRTBPostCreateVideo"})}});jQuery(document.body).on("CRTBPostUpdateInVideoProgramming",function(e,t){try{if(a.isStopped){jQuery("#tb-v2v-promote-featured-video-status").css("color","red");jQuery("#tb-v2v-promote-featured-video-status").text(jQuery("#tb-v2v-promote-featured-video-status").text()+" [STOPPED]");u(true);return}if(t.success){jQuery("#tb-v2v-promote-featured-video-status").text("Complete");jQuery("#tb-v2v-promote-featured-video-status-complete").show();jQuery("#tb-v2v-promote-featured-video-status-processing").hide();if(a.promoteBulkDescriptionUpdate.enabled){d()}else{u(false)}}else{}}catch(e){TBUtilities.LogError({Exception:e,Location:"[V2VPromote] CRTBPostUpdateInVideoProgramming"})}})};var h=function(){try{r()}catch(e){TBUtilities.LogError({Exception:e,Location:"[V2VPromote] show"})}};return{Show:function(t,i,o,r){if(TBGlobal.IsAuthenticated()){a.selectedVideo.id=t;a.selectedVideo.title=i;a.selectedVideo.thumbnail=o;a.notMine=r==true;if(!e){y();n();s();e=true}else{h()}}}}}();var TubeBuddyAnnotations=function(){var e=false;var t={method:3,specificVideoIds:[],specificVideos:[],playlistId:"",search:"",videoEntity:null,selectedVideo:{},annotations:[],selectedAnnotations:[],videos:[],isDeleteOnly:false,destinationVideos:[],currentVideo:null,isStopped:false,annotationIdsToDelete:[],totalDestinationVideos:0,isAutoSelect:false,hasFinished:false,errorCount:0,successCount:0,channelVideoCount:0,fromBulkSelectMenu:false};var i={deleteAll:false,deleteUrl:"",deleteText:"",deleteWebsite:false,deleteFundraising:false,deleteMerchandice:false,deleteVideOrPlaylist:false,deleteChannel:false,includePartialMatches:false,includePartialTextMatches:false};var o=function(){try{if(t.selectedVideo.id!=""&&!t.isDeleteOnly)TBYouTubeApi.GetVideoDetails(t.selectedVideo.id,null,n)}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyAnnotations] [loadData]"})}};var a=function(){var e=TBGlobal.host+"/ModuleManager/annotations/annotations?v="+TBGlobal.versionNumber;if(loadLocalHTML&&(TBExtension.GetType()=="chrome"||TBExtension.GetType()=="firefox")){e=chrome.extension.getURL("modules/annotations.html")}else if(loadLocalHTML&&TBExtension.GetType()=="safari"){e="modules/annotations.html"}TBExtension.Get(e,"CRTBLoadAnnotationsTemplate")};var n=function(e){var i="";if(t.currentVideo!=null)i+="Video: "+t.currentVideo.id;if(!e)i+=" - Failed to get video details (A)";try{t.videoEntity=e;t.duration=new timelord(e.contentDetails.duration);t.totalVideoMiliseconds=t.duration.ticks();v()}catch(e){i+=" [Error: "+e.message+"]";jQuery("#tb-annotations-progress-container").html(jQuery("#tb-annotations-progress-container").html()+" Failed Details &rarr;");f(t.currentVideo.id,i)}};var r=function(e){try{t.currentVideo.contentDetails=e.contentDetails;var i="https://www.youtube.com/my_videos_annotate?feature=vm&v="+t.currentVideo.id;jQuery("#tb-annotations-progress-container").html(jQuery("#tb-annotations-progress-container").html()+" Got Details &rarr;");TBExtension.Get(i,"CRTBLoadAnnotationsGetList")}catch(e){jQuery("#tb-annotations-progress-container").html(jQuery("#tb-annotations-progress-container").html()+" Failed Details &rarr;");f(t.currentVideo.id,"Failed to get video details (B)")}};var s=function(){jQuery(document).on("click","#tb-annotations-back-bulk",function(){TubeBuddyMenu.HideBackground();jQuery("#tb-annotations-container").hide();t.step=1;TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyBulkCopySelect.Show("TubeBuddyAnnotations")});jQuery(document).on("click","#tb-annotations-error-copy-container",function(){jQuery(this).attr("src","https://www.tubebuddy.com/images/icons/check.png");window.setTimeout(function(){jQuery("#tb-annotations-error-copy").attr("src","https://www.tubebuddy.com/images/icons/copy.png")},1500)});jQuery(document).on("click","#tb-annotations-onlyLoadFirstPage",function(e){if(jQuery(this).is(":checked")){jQuery("#tb-annotations-onlyLoadFirstPage-number").prop("disabled",false)}else{jQuery("#tb-annotations-onlyLoadFirstPage-number").prop("disabled",true)}});jQuery(document).on("click",".tb-annotations-default-setting",function(e){e.stopPropagation()});jQuery(document).on("click change","#tb-annotations-delete-text-option, #tb-annotations-delete-link-option, #tb-annotations-delete-all-option",function(){if(jQuery("#tb-annotations-delete-link-option").is(":checked"))jQuery("#tb-annotations-delete-partial-matches-container").fadeIn();else jQuery("#tb-annotations-delete-partial-matches-container").fadeOut();if(jQuery("#tb-annotations-delete-text-option").is(":checked"))jQuery("#tb-annotations-delete-partial-matches-container-text").fadeIn();else jQuery("#tb-annotations-delete-partial-matches-container-text").fadeOut()});jQuery(document).on("click","#tb-annotations-select-all-annotations",function(e){jQuery(".tb-annotations-annotations-item").each(function(){var e=jQuery(this).attr("data-index");var i=TBUtilities.GetInArray(t.selectedAnnotations,"index",e);if(i==null){jQuery(this).trigger("click")}})});jQuery(document).on("click","#tb-annotations-select-none-annotations",function(e){jQuery(".tb-annotations-annotations-item").each(function(){var e=jQuery(this).attr("data-index");var i=TBUtilities.GetInArray(t.selectedAnnotations,"index",e);if(i!=null){jQuery(this).trigger("click")}})});jQuery(document).on("change",".tb-annotations-filter",function(){jQuery(".tb-annotations-destination-row").show();switch(jQuery(this).val()){case"all":break;case"public":jQuery('.tb-annotations-destination-row[data-privacy="private"]').hide();jQuery('.tb-annotations-destination-row[data-privacy="unlisted"]').hide();break;case"unlisted":jQuery('.tb-annotations-destination-row[data-privacy="public"]').hide();jQuery('.tb-annotations-destination-row[data-privacy="private"]').hide();break;case"private":jQuery('.tb-annotations-destination-row[data-privacy="public"]').hide();jQuery('.tb-annotations-destination-row[data-privacy="unlisted"]').hide();break;case"publicunlisted":jQuery('.tb-annotations-destination-row[data-privacy="private"]').hide();break;case"privateunlisted":jQuery('.tb-annotations-destination-row[data-privacy="public"]').hide();break}jQuery("#tb-annotations-destination-selected-count").text(jQuery("#tb-annotations-destination-list").find(".tb-annotations-checkbox-include").filter(":visible").filter(":checked").length)});jQuery(document).on("click","#tb-annotations-close, #tb-annotations-cancel, .tb-annotations-closex",function(){try{TubeBuddyMenu.HideBackground();jQuery("#tb-annotations-container").hide();t.step=1}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyAnnotations] [click] tb-annotations-close"})}});jQuery(document).on("click","#tb-annotations-method-ids, #tb-annotations-method-playlist, #tb-annotations-method-search, #tb-annotations-method-full",function(e){t.method=parseInt(jQuery(this).attr("data-method"));switch(t.method){case 0:jQuery("#tb-annotations-input-ids").removeAttr("disabled","disabled");jQuery("#tb-annotations-input-playlist").attr("disabled","disabled");jQuery("#tb-annotations-input-search").attr("disabled","disabled");break;case 1:jQuery("#tb-annotations-input-ids").attr("disabled","disabled");jQuery("#tb-annotations-input-playlist").removeAttr("disabled","disabled");jQuery("#tb-annotations-input-search").attr("disabled","disabled");break;case 2:jQuery("#tb-annotations-input-ids").attr("disabled","disabled");jQuery("#tb-annotations-input-playlist").attr("disabled","disabled");jQuery("#tb-annotations-input-search").removeAttr("disabled","disabled");break;case 3:jQuery("#tb-annotations-input-ids").attr("disabled","disabled");jQuery("#tb-annotations-input-playlist").attr("disabled","disabled");jQuery("#tb-annotations-input-search").attr("disabled","disabled");break}});jQuery(document).on("change keypress keyup paste keydown blur","#tb-annotations-input-playlist",function(e){t.playlistId="";var i=jQuery(this).val().trim();i=TBUtilities.ReplaceAll(i,'"',"");if(i.length==0){jQuery("#tb-annotations-input-playlist-status").hide();return}if(i.indexOf("list=")>0){i=i.substring(i.indexOf("list=")+5)}if(i.length!=18&&i.length!=34||i.substring(0,2)!="PL"){jQuery("#tb-annotations-input-playlist-status").text("Invalid Playlist Id");jQuery("#tb-annotations-input-playlist-status").css("color","red")}else{jQuery("#tb-annotations-input-playlist-status").text("Valid Playlist Id");jQuery("#tb-annotations-input-playlist-status").css("color","green");t.playlistId=i}jQuery("#tb-annotations-input-playlist-status").show()});jQuery(document).on("change keypress keyup paste keydown blur","#tb-annotations-input-search",function(e){t.search=jQuery(this).val().trim()});jQuery(document).on("change keypress keyup paste keydown blur","#tb-annotations-input-ids",function(e){var i=jQuery(this).val().trim();i=TBUtilities.ReplaceAll(i,'"',"");if(i.length==0){jQuery("#tb-annotations-input-ids-status").hide();return}jQuery("#tb-annotations-input-ids-status").show();t.specificVideoIds=[];if(i.indexOf(",")>-1){t.specificVideoIds=i.split(",")}else{t.specificVideoIds=i.split(" ")}for(var o=0;o<t.specificVideoIds.length;o++){t.specificVideoIds[o]=t.specificVideoIds[o].trim();t.specificVideoIds[o]=t.specificVideoIds[o].replace("https://www.youtube.com/watch?v=","");t.specificVideoIds[o]=t.specificVideoIds[o].replace("https://youtu.be/","");if(t.specificVideoIds[o].length!=11){t.specificVideoIds.splice(o,1);o--}}if(t.specificVideoIds.length==0){jQuery("#tb-annotations-input-ids-status").text("No videos detected");jQuery("#tb-annotations-input-ids-status").css("color","red")}else if(t.specificVideoIds.length==1){jQuery("#tb-annotations-input-ids-status").text("1 video detected");jQuery("#tb-annotations-input-ids-status").css("color","green");jQuery("#tb-annotations-method-ids").prop("checked",true);jQuery("#tb-annotations-method-ids").trigger("click")}else{jQuery("#tb-annotations-input-ids-status").text(t.specificVideoIds.length+" videos detected");jQuery("#tb-annotations-input-ids-status").css("color","green");jQuery("#tb-annotations-method-ids").prop("checked",true);jQuery("#tb-annotations-method-ids").trigger("click")}});jQuery(document).on("click",".tb-annotations-checkbox-include",function(){try{if(jQuery(this).is(":checked")){if(!TBGlobal.CanAccessLevel2Tools()&&jQuery("#tb-annotations-destination-list").find(".tb-annotations-checkbox-include").filter(":visible").filter(":checked").length>1){jQuery(this).prop("checked",false);if(t.isDeleteOnly)TBGlobal.ShowUpgradePage("Sorry, you cannot delete annotations in bulk (more than 1 video at a time) unless you upgrade your TubeBuddy License.",TBGlobal.limitation.deleteAnnotations);else TBGlobal.ShowUpgradePage("Sorry, you cannot copy annotations in bulk (more than 1 video at a time) unless you upgrade your TubeBuddy License.",TBGlobal.limitation.annotations);return}jQuery(this).closest(".tb-annotations-destination-row").addClass("tb-annotations-destination-row-selected")}else{jQuery(this).closest(".tb-annotations-destination-row").removeClass("tb-annotations-destination-row-selected")}jQuery("#tb-annotations-copy-destination-count").text(jQuery("#tb-annotations-destination-list").find(".tb-annotations-checkbox-include").filter(":visible").filter(":checked").length);jQuery("#tb-annotations-destination-selected-count").text(jQuery("#tb-annotations-destination-list").find(".tb-annotations-checkbox-include").filter(":visible").filter(":checked").length);if(jQuery("#tb-annotations-copy-destination-count").text()=="1")jQuery("#tb-annotations-copy-destination-count-s").hide();else jQuery("#tb-annotations-copy-destination-count-s").show()}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyAnnotations] [click] tb-annotations-checkbox-include"})}});jQuery(document).on("click","#tb-annotations-select-all-checkboxes",function(){if(!TBGlobal.CanAccessLevel2Tools()&&t.videos.length>1){if(t.isDeleteOnly)TBGlobal.ShowUpgradePage("Sorry, you cannot delete annotations in bulk (more than 1 video at a time) unless you upgrade your TubeBuddy License.",TBGlobal.limitation.deleteAnnotations);else TBGlobal.ShowUpgradePage("Sorry, you cannot copy annotations in bulk (more than 1 video at a time) unless you upgrade your TubeBuddy License.",TBGlobal.limitation.annotations);return}jQuery(".tb-annotations-checkbox-include").prop("checked",true);jQuery(".tb-annotations-destination-row").addClass("tb-annotations-destination-row-selected");jQuery("#tb-annotations-copy-destination-count").text(jQuery("#tb-annotations-destination-list").find(".tb-annotations-checkbox-include").filter(":visible").filter(":checked").length);jQuery("#tb-annotations-destination-selected-count").text(jQuery("#tb-annotations-destination-list").find(".tb-annotations-checkbox-include").filter(":visible").filter(":checked").length);if(jQuery("#tb-annotations-copy-destination-count").text()=="1")jQuery("#tb-annotations-copy-destination-count-s").hide();else jQuery("#tb-annotations-copy-destination-count-s").show()});jQuery(document).on("click","#tb-annotations-select-no-checkboxes",function(){jQuery(".tb-annotations-checkbox-include").prop("checked",false);jQuery(".tb-annotations-destination-row").removeClass("tb-annotations-destination-row-selected");jQuery("#tb-annotations-copy-destination-count").text(jQuery("#tb-annotations-destination-list").find(".tb-annotations-checkbox-include").filter(":visible").filter(":checked").length);jQuery("#tb-annotations-destination-selected-count").text(jQuery("#tb-annotations-destination-list").find(".tb-annotations-checkbox-include").filter(":visible").filter(":checked").length);if(jQuery("#tb-annotations-copy-destination-count").text()=="1")jQuery("#tb-annotations-copy-destination-count-s").hide();else jQuery("#tb-annotations-copy-destination-count-s").show()});jQuery(document).on("click","#tb-annotations-expand-all",function(){jQuery(".tb-annotations-annotations-item-customize").html("Customize &#9650;");jQuery(".tb-annotations-annotations-item-options").slideDown()});jQuery(document).on("click","#tb-annotations-collapse-all",function(){jQuery(".tb-annotations-annotations-item-customize").html("Customize &#9660;");jQuery(".tb-annotations-annotations-item-options").slideUp()});jQuery(document).on("click",".tb-annotations-annotations-item-customize",function(){try{var e=jQuery(this).attr("data-video-id");if(jQuery(this).parent().find(".tb-annotations-annotations-item-options").css("display")=="none"){jQuery(this).html("Customize &#9650;");jQuery(this).parent().find(".tb-annotations-annotations-item-options").slideDown()}else{jQuery(this).html("Customize &#9660;");jQuery(this).parent().find(".tb-annotations-annotations-item-options").slideUp()}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyAnnotations] [click] tb-annotations-annotations-item-customize"})}});jQuery(document).on("click","#tb-annotations-stop",function(){t.isStopped=true;jQuery("#tb-annotations-stop").hide();jQuery("#tb-annotations-close").show();jQuery("#tb-annotations-working").hide();jQuery("#tb-annotations-stopped").show()});jQuery(document).on("click","#tb-annotations-kickoff",function(){if(!jQuery("#tb-annotations-confirm-checkbox").is(":checked")){if(t.isDeleteOnly)TBUtilities.Alert("Please check the box confirming that you want to Delete all annotations");else TBUtilities.Alert("Please check the box confirming that you want to copy the annotations");return}if(!TBGlobal.CanAccessLevel2Tools()&&t.destinationVideos.length>1){if(t.isDeleteOnly)TBGlobal.ShowUpgradePage("Sorry, you cannot delete annotations in bulk (more than 1 video at a time) unless you upgrade your TubeBuddy License.",TBGlobal.limitation.deleteAnnotations);else TBGlobal.ShowUpgradePage("Sorry, you cannot copy annotations in bulk (more than 1 video at a time) unless you upgrade your TubeBuddy License",TBGlobal.limitation.annotations);return}t.step=4;jQuery("#tb-annotations-status").show();jQuery("#tb-annotations-confirm").hide();jQuery("#tb-annotations-stop").show();jQuery("#tb-annotations-cancel").hide();jQuery("#tb-annotations-back").hide();jQuery("#tb-annotations-kickoff").hide();jQuery("#tb-annotations-continue").hide();c()});jQuery(document).on("click","#tb-annotations-continue, #tb-annotations-kickoff",function(){try{if(t.step==1){if(t.selectedAnnotations.length==0&&!t.isDeleteOnly){TBUtilities.Alert("You must select at least 1 Annotation to copy");return}jQuery("#tb-annotations-back-bulk").hide();if(t.isDeleteOnly){i.deleteAll=true;i.deleteText="";i.deleteUrl="";if(jQuery("#tb-annotations-delete-link-option").is(":checked")){i.deleteAll=false;i.deleteUrl=jQuery("#tb-delete-annotations-url").val();if(i.deleteUrl)i.deleteUrl=i.deleteUrl.trim();i.includePartialMatches=jQuery("#tb-annotations-delete-partial-matches").is(":checked");if(!i.deleteUrl){TBUtilities.Alert("You must enter a URL");return}else if(i.deleteUrl.length<3){TBUtilities.Alert("It does not look like you entered a valid URL");return}}else if(jQuery("#tb-annotations-delete-text-option").is(":checked")){i.deleteAll=false;i.deleteText=jQuery("#tb-delete-annotations-text").val();if(i.deleteText)i.deleteText=i.deleteText.trim();i.includePartialTextMatches=jQuery("#tb-annotations-delete-partial-matches-text").is(":checked");if(!i.deleteText){TBUtilities.Alert("You must enter Text");return}else if(i.deleteText.length<3){TBUtilities.Alert("Please enter a longer Text");return}}}TBUtilities.Log("Annotation count: "+t.selectedAnnotations.length);jQuery("#tb-annotations-loading-videos").show();jQuery("#tb-annotations-destination-list").hide();jQuery("#tb-delete-annotations-options").hide();jQuery("#tb-annotations-source").hide();jQuery("#tb-annotations-method").show();jQuery("#tb-annotations-back").show();jQuery("#tb-annotations-continue").show();jQuery("#tb-annotations-continue").removeAttr("disabled");t.step=2}else if(t.step==2){switch(parseInt(t.method)){case 0:if(t.specificVideoIds.length==0){jQuery("#tb-annotations-input-ids-status").css("color","red");jQuery("#tb-annotations-input-ids-status").text("No videos detected");jQuery("#tb-annotations-input-ids-status").show();TBUtilities.Alert("You must enter a list of 1 or more valid Video IDs (or change you selection method above)");return}if(!TBGlobal.CanAccessLevel2Tools()&&t.specificVideoIds.length>1){if(t.isDeleteOnly)TBGlobal.ShowUpgradePage("Sorry, you cannot delete annotations in bulk (more than 1 video at a time) unless you upgrade your TubeBuddy License.",TBGlobal.limitation.deleteAnnotations);else TBGlobal.ShowUpgradePage("Sorry, you cannot copy annotations in bulk (more than 1 video at a time) unless you upgrade your TubeBuddy License",TBGlobal.limitation.annotations);return}TBUtilities.Log("Video Selection Method: Video IDs "+JSON.stringify(t.specificVideoIds));l();break;case 1:if(t.playlistId==""){jQuery("#tb-annotations-input-playlist-status").css("color","red");jQuery("#tb-annotations-input-playlist-status").text("Invalid Playlist Id");jQuery("#tb-annotations-input-playlist-status").show();TBUtilities.Alert("You must enter a valid Playlist ID (or change you selection method above)");return}TBUtilities.Log("Video Selection Method: Playlist ["+t.playlistId+"]");TBYouTubeApi.GetPlaylistVideos(t.playlistId,null,g,m);break;case 2:if(t.search==""){TBUtilities.Alert("You must enter a Search Term (or change you selection method above)");return}TBUtilities.Log("Video Selection Method: Search ["+t.search+"]");jQuery("#tb-annotations-destination").show();TBYouTubeApi.GetChannelVideosSearch(t.search,null,g,m);break;case 3:TBUtilities.Log("Video Selection Method: All");var e=null;if(jQuery("#tb-annotations-onlyLoadFirstPage").is(":checked")){var o=/^\+?\d+$/.test(jQuery("#tb-annotations-onlyLoadFirstPage-number").val());if(o==false){TBUtilities.Alert("Please enter a valid number for the number of videos to load");return}e=parseInt(jQuery("#tb-annotations-onlyLoadFirstPage-number").val());if(e<=0){TBUtilities.Alert("Please enter a valid number for the number of videos to load");return}}TBYouTubeApi.GetChannelVideos(TBGlobal.CurrentChannelId(),null,g,m,e,null,t.selectedVideo.id);break}jQuery("#tb-annotations-method").hide();jQuery("#tb-annotations-destination").show();jQuery("#tb-annotations-destination-list").hide();jQuery("#tb-annotations-loading-videos").show();t.step=3}else if(t.step==3){if(jQuery("#tb-annotations-delete-existing").is(":checked")){TBUtilities.Log("Yes, Deleting Existing Annotations");jQuery("#tb-annotations-delete-existing-warning").show()}else{TBUtilities.Log("No, Not Deleting Existing Annotations");jQuery("#tb-annotations-delete-existing-warning").hide()}t.destinationVideos=[];if(t.isAutoSelect){jQuery.each(t.videos,function(e,i){t.destinationVideos.push(i)})}else{if(jQuery(".tb-annotations-checkbox-include").filter(":visible").filter(":checked").length==0&&t.destinationVideos.length==0){if(t.isDeleteOnly)TBUtilities.Alert("Please select at least 1 video to Delete All Annotations from.");else TBUtilities.Alert("Please select at least 1 video to copy the annotations to.");return}jQuery(".tb-annotations-checkbox-include").filter(":visible").filter(":checked").each(function(){if(jQuery(this).is(":checked")){var e=jQuery(this).attr("data-video-id");jQuery.each(t.videos,function(i,o){if(o.id==e){t.destinationVideos.push(o)}})}})}jQuery("#tb-annotations-queue-list").empty();jQuery("#tb-annotations-completed-list").empty();if(t.isDeleteOnly){if(i.deleteAll)jQuery("#tb-annotations-delete-existing-warning").html("WARNING: You have chosen to automatically delete all existing Annotations from <b>"+t.destinationVideos.length+"</b> Video(s)");else{if(i.deleteUrl){if(i.includePartialMatches)jQuery("#tb-annotations-delete-existing-warning").html('WARNING: You have chosen to automatically delete all existing Annotations that contain the URL: "'+i.deleteUrl+'" [INCLUDING PARTIAL MATCHES] from <b>'+t.destinationVideos.length+"</b> Video(s)");else jQuery("#tb-annotations-delete-existing-warning").html('WARNING: You have chosen to automatically delete all existing Annotations that contain the URL: "'+i.deleteUrl+'" from <b>'+t.destinationVideos.length+"</b> Video(s)")}else{if(i.includePartialMatches)jQuery("#tb-annotations-delete-existing-warning").html('WARNING: You have chosen to automatically delete all existing Annotations whose Text contains: "'+i.deleteText+'" [INCLUDING PARTIAL MATCHES] from <b>'+t.destinationVideos.length+"</b> Video(s)");else jQuery("#tb-annotations-delete-existing-warning").html('WARNING: You have chosen to automatically delete all existing Annotations whose Text contains: "'+i.deleteText+'" from <b>'+t.destinationVideos.length+"</b> Video(s)")}}}jQuery("#tb-annotations-copy-destination-count").text(t.destinationVideos.length);jQuery("#tb-annotations-destination-selected-count").text(t.destinationVideos.length);if(jQuery("#tb-annotations-copy-destination-count").text()=="1")jQuery("#tb-annotations-copy-destination-count-s").hide();else jQuery("#tb-annotations-copy-destination-count-s").show();jQuery("#tb-annotations-method").hide();jQuery("#tb-annotations-confirm-checkbox").prop("checked",false);t.step=4;jQuery("#tb-annotations-destination").hide();jQuery("#tb-annotations-confirm").show();jQuery("#tb-annotations-kickoff").show();jQuery("#tb-annotations-continue").hide()}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyAnnotations] [click] #tb-annotations-continue, #tb-annotations-kickoff"})}});jQuery(document).on("click","#tb-annotations-back",function(){if(t.step==2){if(t.isDeleteOnly)jQuery("#tb-delete-annotations-options").show();else jQuery("#tb-annotations-source").show();jQuery("#tb-annotations-method").hide();jQuery("#tb-annotations-back").hide();t.step=1}else if(t.step==3||t.step==4&&t.isAutoSelect){t.step=2;jQuery("#tb-annotations-destination").hide();jQuery("#tb-annotations-method").show();jQuery("#tb-annotations-confirm").hide();t.specificVideoIds.length=0;t.specificVideos.length=0;jQuery("#tb-annotations-input-ids").val("");jQuery("#tb-annotations-input-ids-status").hide()}else if(t.step==4){t.step=3;jQuery("#tb-annotations-destination").show();jQuery("#tb-annotations-confirm").hide();jQuery("#tb-annotations-kickoff").hide();jQuery("#tb-annotations-continue").show();d}});jQuery(document).on("click",".tb-annotations-annotations-item",function(){try{var e=jQuery(this).attr("data-index");var i=TBUtilities.GetInArray(t.selectedAnnotations,"index",e);if(i==null){var o=TBUtilities.GetInArray(t.annotations,"index",e);t.selectedAnnotations.push(o);jQuery(this).addClass("tb-annotations-annotations-item-selected")}else{TBUtilities.RemoveFromArray(t.selectedAnnotations,"index",e);jQuery(this).removeClass("tb-annotations-annotations-item-selected")}jQuery("#tb-annotations-selected-count").text(t.selectedAnnotations.length);jQuery("#tb-annotations-copy-count").text(t.selectedAnnotations.length);if(t.selectedAnnotations.length==1)jQuery("#tb-annotations-copy-count-s").hide();else jQuery("#tb-annotations-copy-count-s").show();if(t.selectedAnnotations.length==0){jQuery("#tb-annotations-continue").attr("disabled","disabled");jQuery("#tb-annotations-continue").attr("data-tooltip-text","Select at least 1 Annotation to Copy")}else{jQuery("#tb-annotations-continue").removeAttr("disabled");jQuery("#tb-annotations-continue").attr("data-tooltip-text","Continue to next step")}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyAnnotations] [click] tb-annotations-annotations-item"})}})};var l=function(){var e=t.specificVideoIds[0];t.specificVideoIds.splice(0,1);TBYouTubeApi.GetVideoDetails(e,"contentDetails, snippet, id",u)};var u=function(e){if(e!=null)t.specificVideos.push(e);if(t.specificVideoIds.length>0){l()}else{g(t.specificVideos)}};var c=function(){try{t.totalDestinationVideos=t.destinationVideos.length;t.hasFinished=false;t.errorCount=0;t.successCount=0;jQuery("#tb-annotations-queue-list2").empty();jQuery("#tb-annotations-completed-list2").empty();jQuery("#tb-annotations-error-list2").empty();jQuery("#tb-annotations-error-list2").hide();jQuery("#tb-annotations-error-none-list2").show();jQuery("#tb-annotations-working").show();jQuery("#tb-annotations-done").hide();jQuery("#tb-annotations-stopped").hide();try{if(t.isDeleteOnly)TBUtilities.AddAction({VideoCount:t.destinationVideos.length,Data:"method = "+t.method},TBUtilities.ActionTypes.BulkDeleteAnnotations_Delete,"bulkdeleteannotations");else TBUtilities.AddAction({VideoCount:t.totalDestinationVideos,AnnotationCount:t.selectedAnnotations.length,Data:"method = "+t.method},TBUtilities.ActionTypes.BulkCopyAnnotations_Copy,"bulkcopyannotations")}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyAnnotations] [addAction]"})}h();p()}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyAnnotations] [startProcessing]"})}};var p=function(){jQuery("#tb-annotations-queue-list2").empty();jQuery("#tb-annotations-queue-complete-list2").hide();var e=0;jQuery.each(t.destinationVideos,function(t,i){var o=jQuery(".tb-annotations-processing-template2:last")[0].outerHTML;o=o.replace("#THUMBNAILURL#",i.snippet.thumbnails.default.url);o=TBUtilities.ReplaceAll(o,"#VIDEOID#",i.id);o=o.replace("#VIDEOTITLE#",i.snippet.title);o=o.replace("#HREF#","https://www.youtube.com/watch?v="+i.id);o=o.replace("display: none","display:block");jQuery("#tb-annotations-queue-list2").prepend(o);e++;if(e==3)return false});if(e==0){jQuery("#tb-annotations-queue-complete-list2").show();jQuery("#tb-annotations-queue-list2").hide()}else{jQuery("#tb-annotations-queue-list2").show()}};var b=function(e){var i=jQuery(".tb-annotations-processed-success:last")[0].outerHTML;i=TBUtilities.ReplaceAll(i,"#VIDEOID#",e.id);i=i.replace("#VIDEOTITLE#",e.snippet.title);i=i.replace("#HREF#","https://www.youtube.com/my_videos_annotate?feature=vm&v="+e.id);i=i.replace("display:none","display:block");jQuery("#tb-annotations-completed-list2").prepend(i);jQuery("#tb-annotations-completed-none-list2").hide();jQuery("#tb-annotations-completed-list2").show();t.successCount++;jQuery("#tb-annotations-completed-list2-count").text(TBUtilities.FormatNumberWithCommas(t.successCount))};var y=function(e){try{jQuery("#tb-annotations-error-copy-container").show();var i=jQuery("#tb-annotations-error-copy").attr("data-clipboard-text");var o=[];if(i!=""){o=i.split(",");if(o.indexOf(e.id)==-1){o.push(e.id)}}else{o.push(e.id)}jQuery("#tb-annotations-error-copy").attr("data-clipboard-text",o.join(","))}catch(e){}var a=jQuery(".tb-annotations-processed-error:last")[0].outerHTML;a=TBUtilities.ReplaceAll(a,"#VIDEOID#",e.id);a=a.replace("#VIDEOTITLE#",e.snippet.title);a=a.replace("#ERROR#",e.error);a=a.replace("#HREF#","https://www.youtube.com/my_videos_annotate?feature=vm&v="+e.id);a=a.replace("display:none","display:block");jQuery("#tb-annotations-error-list2").prepend(a);jQuery("#tb-annotations-error-list2").show();jQuery("#tb-annotations-error-none-list2").hide();t.errorCount++;jQuery("#tb-annotations-error-list2-count").text(TBUtilities.FormatNumberWithCommas(t.errorCount))};var h=function(){try{jQuery("#tb-annotations-progress-container").html("Start &rarr;");if(t.isStopped)return;if(t.destinationVideos.length==0&&!t.hasFinished){t.hasFinished=true;jQuery("#tb-annotations-status-count").text(t.totalDestinationVideos+" of "+t.totalDestinationVideos);jQuery("#tb-annotations-progress-container").hide();if(t.currentVideo){if(!t.currentVideo.error)b(t.currentVideo);else y(t.currentVideo)}p();jQuery("#tb-annotations-working").hide();jQuery("#tb-annotations-done").show();jQuery("#tb-annotations-stop").hide();jQuery("#tb-annotations-close").text("Close");jQuery("#tb-annotations-close").show();return}var e=t.destinationVideos[0].id;if(t.currentVideo){if(!t.currentVideo.error)b(t.currentVideo);else y(t.currentVideo)}var i=TBUtilities.RemoveFromArray(t.destinationVideos,"id",e)[0];t.currentVideo=i;jQuery("#tb-annotations-status-count").text(t.totalDestinationVideos-t.destinationVideos.length+" of "+t.totalDestinationVideos);jQuery("#tb-annotations-progress-container").html(jQuery("#tb-annotations-progress-container").html()+' Id: <a style="font-weight:normal" target="_blank" href="https://www.youtube.com/watch?v='+e+'">'+e+"</a> &rarr;");p();if(jQuery("#tb-annotations-delete-existing").is(":checked")||t.isDeleteOnly){var o="https://www.youtube.com/annotations_auth/read2?video_id="+e;TBUtilities.Log("Fetching Annotations Url for Deleting: "+e);jQuery("#tb-annotations-progress-container").html(jQuery("#tb-annotations-progress-container").html()+" Delete &rarr;");TBExtension.Get(o,"CRTBLoadAnnotationsForVideoDelete",{videoId:e});return}TBUtilities.Log("Getting Video Details for: "+i.id);jQuery("#tb-annotations-progress-container").html(jQuery("#tb-annotations-progress-container").html()+" Get Details &rarr;");TBYouTubeApi.GetVideoDetails(t.currentVideo.id,null,r)}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyAnnotations] [processNextVideo]"});jQuery("#tb-annotations-progress-container").html(jQuery("#tb-annotations-progress-container").html()+"Error: "+e.message);TBUtilities.Alert('Sorry, there was an error: "'+e.message+'"');jQuery("#tb-annotations-stop").trigger("click")}};var f=function(e,i){t.currentVideo.error=i;h()};var m=function(e){if(e.totalCount-e.loaded>50){jQuery("#tb-annotations-loading-count").attr("data-auto-count",e.loaded);var t=e.totalCount;if(jQuery("#tb-annotations-onlyLoadFirstPage").is(":checked")){t=parseInt(jQuery("#tb-annotations-onlyLoadFirstPage-number").val())}jQuery("#tb-annotations-loading-count-total").text(t);TBUtilities.AutoIncrementCount(jQuery("#tb-annotations-loading-count"))}else{jQuery("#tb-annotations-rendering").show();jQuery("#tb-annotations-loading-count-container").hide()}};var g=function(e){try{if(e==null){if(t.method==0)TBUtilities.Alert("No valid Video IDs found");else if(t.method==1)TBUtilities.Alert("Invalid Playlist Id or no videos found in playlist");else if(t.method==2)TBUtilities.Alert("No videos matching your search");else if(t.method==3)TBUtilities.Alert("No videos found or failed to load. Try again.");jQuery("#tb-annotations-back").trigger("click");return}else if(e.length==0){if(t.method==0)TBUtilities.Alert("No valid Video IDs found");else if(t.method==1)TBUtilities.Alert("Invalid Playlist Id or no videos found in playlist");else if(t.method==2)TBUtilities.Alert("No videos matching your search");else if(t.method==3)TBUtilities.Alert("No videos found or failed to load. Try again.");jQuery("#tb-annotations-back").trigger("click");return}t.videos=[];jQuery("#tb-annotations-destination-list").empty();t.isAutoSelect=e.length>750;if(t.isAutoSelect){jQuery.each(e,function(e,i){var o=false;if(i.id==t.selectedVideo.id)o=true;if(i.snippet.resourceId!=null)if(i.snippet.resourceId.videoId==t.selectedVideo.id)o=true;if(i.id.videoId!=null){i.id=i.id.videoId}if(!o){if(i.snippet.resourceId!=null)i.id=i.snippet.resourceId.videoId;if(i.snippet!=null&&i.snippet.title=="Deleted video"&&i.snippet.thumbnails==null)return;t.videos.push(i)}});jQuery("#tb-annotations-continue").trigger("click")}else{jQuery.each(e,function(e,i){var o=false;if(i.id==t.selectedVideo.id)o=true;if(i.snippet.resourceId!=null)if(i.snippet.resourceId.videoId==t.selectedVideo.id)o=true;if(i.id.videoId!=null){i.id=i.id.videoId}if(!o){if(i.snippet.resourceId!=null)i.id=i.snippet.resourceId.videoId;if(i.snippet!=null&&i.snippet.title=="Deleted video"&&i.snippet.thumbnails==null)return;t.videos.push(i);var a=jQuery(".tb-annotations-destination-row:last")[0].outerHTML;a=a.replace("#VIDEOTITLE#",i.snippet.title);a=TBUtilities.ReplaceAll(a,"#VIDEOID#",i.id);a=a.replace("#VIDEOTHUMBNAIL#",i.snippet.thumbnails.default.url);if(i.status)a=a.replace("#PRIVACY#",i.status.privacy);if(t.isDeleteOnly){a=TBUtilities.ReplaceAll(a,"#CUSTOMDISPLAY#","display:none;");jQuery("#tb-annotations-expandcollapse-containers").hide()}else{a=TBUtilities.ReplaceAll(a,"#CUSTOMDISPLAY#","");jQuery("#tb-annotations-expandcollapse-containers").show()}var n="";jQuery.each(t.selectedAnnotations,function(e,o){var a;if(o.ref!=null&&o.ref!=""){for(var r=0;r<t.annotations.length;r++){var s=t.annotations[r];if(s.id==o.ref)a=s}}var l=jQuery(".tb-annotations-destination-option-row:last")[0].outerHTML;var d=jQuery("textarea[data-annotation-default-id="+o.id+"]").val();if(d==null&&a!=null)d=jQuery("textarea[data-annotation-default-id="+a.id+"]").val();l=l.replace("#OPTIONTEXT#",d);l=l.replace("#TYPETHUMBNAIL#",TBGlobal.host+"/images/icons/annotations/"+o.style+".png");l=l.replace("#TYPENAME#",o.display);l=TBUtilities.ReplaceAll(l,"#ANNOTATIONID#",o.id);l=TBUtilities.ReplaceAll(l,"#VIDEOID#",i.id);if(o.url!=null&&o.url!=""){var u=jQuery("input[data-annotation-default-id="+o.id+"]").val();l=l.replace("#SHOWLINK#","");l=l.replace("#LINK#",u);l=TBUtilities.ReplaceAll(l,"#ANNOTATIONLINKID#",o.id)}else if(o.ref!=null&&o.ref!=""){if(a!=null&&a.url!=null&&a.url!=""){var c=jQuery("input[data-annotation-default-id="+a.id+"]").val();l=TBUtilities.ReplaceAll(l,"#ANNOTATIONLINKID#",a.id);l=l.replace("#SHOWLINK#","");l=l.replace("#LINK#",c)}else{l=l.replace("#SHOWLINK#","display:none")}}else{l=l.replace("#SHOWLINK#","display:none")}n+=l});a=a.replace("#OPTIONS#",n);jQuery("#tb-annotations-destination-list").append(a)}});if(t.method==0||t.method==1)jQuery("#tb-annotations-select-all-checkboxes").trigger("click");jQuery("#tb-annotations-destination").show();jQuery("#tb-annotations-method").hide();jQuery("#tb-annotations-destination-list").show();jQuery("#tb-annotations-loading-videos").hide()}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyAnnotations] [gotVideoList]"})}};var v=function(){var e="https://www.youtube.com/annotations_auth/read2?video_id="+t.selectedVideo.id;TBExtension.Get(e,"CRTBLoadAnnotationsForVideo")};var T=function(){jQuery(document.body).on("CRTBLoadAnnotationsDeleteAll",function(e,i){var o="[Start]";try{if(i.success){var a="";var n=i.response.match(/"auth_token": "(\S+)"/);if(n!==null)a=n[1];else{var r=i.response.indexOf('"auth_token":"')+'"auth_token":"'.length;var s=i.response.indexOf('"',r);a=i.response.substring(r,s)}var l='<?xml version="1.0" encoding="UTF-8" ?><document>';l+='<requestHeader video_id="'+i.data.videoId+'"/>';l+='<authenticationHeader video_id="'+i.data.videoId+'" '+'auth_token="'+a+'"/>';l+="<deletedItems>";jQuery.each(t.annotationIdsToDelete,function(e,t){l+='<deletedItem id="'+t.id+'" author="'+t.author+'" />'});l+="</deletedItems>";l+="</document>";var d="https://www.youtube.com/annotations_auth/update2";TBUtilities.Log("XML TO DELETE ALL (below)");TBUtilities.Log(l);jQuery("#tb-annotations-progress-container").html(jQuery("#tb-annotations-progress-container").html()+" Submit &rarr;");TBExtension.Post(d,l,"CRTBLoadAnnotationsUpdatePostDeleteAll",{xml:l})}else{f(i.data.videoId,"deleting all existing annotations failed (A)")}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyAnnotations] CRTBLoadAnnotationsDeleteAll"+o});f(i.data.videoId,"deleting all existing annotations failed (B)")}});jQuery(document.body).on("CRTBLoadAnnotationsGetList",function(e,i){var o="[Start]";TBUtilities.Log("Start Processing Video:"+t.currentVideo.id);try{if(i.success){var a="";var n=i.response.match(/"auth_token": "(\S+)"/);if(n!==null)a=n[1];else{var r=i.response.indexOf('"auth_token":"')+'"auth_token":"'.length;var s=i.response.indexOf('"',r);a=i.response.substring(r,s);if(a.indexOf("html")>=0){TBUtilities.Log("NO AUTH TOKEN FULL HTML: "+i.response)}}TBUtilities.Log("Auth Token: "+a);var l='<?xml version="1.0" encoding="UTF-8" ?><document>';l+='<requestHeader video_id="'+t.currentVideo.id+'"/>';l+='<authenticationHeader video_id="'+t.currentVideo.id+'" '+'auth_token="'+a+'"/>';l+="<updatedItems>";var d=new timelord(t.currentVideo.contentDetails.duration);var u=d.ticks();jQuery.each(t.selectedAnnotations,function(e,i){i.fullXML=i.fullXMLOriginal;TBUtilities.Log("--- Starting Annotation XML ---");TBUtilities.Log(i.fullXML);TBUtilities.Log("-StartTime: "+JSON.stringify(i.startTime));if(i.refTimeUpdated==null){i.refTimeUpdated=false;TBUtilities.Log("YES REF NULL")}else{TBUtilities.Log("NO NOT NULL - "+i.refTimeUpdated)}if(i.ref!=""&&i.ref!=null&&(i.startTime=="never"||i.endTime=="0:00.000")){for(var o=0;o<t.annotations.length;o++){var a=t.annotations[o];if(a.id==i.ref){i.startTime=a.startTime;i.endTime=a.endTime;i.totalTimeMiliseconds=a.totalTimeMiliseconds;i.distanceFromEnd=a.distanceFromEnd;i.dockAtEnd=a.dockAtEnd;i.dockAtStart=a.dockAtStart;i.refTimeUpdated=true;TBUtilities.Log("-Is Ref New Start Time: "+JSON.stringify(i.startTime))}}}var n=[];var r=0;var s=[];var d=0;var c=0;var p=0;var b=new TimeSpan(0,0,0,0);var y=new TimeSpan(0,0,0,0);TBUtilities.Log("timeSpanToEnd_0: "+b);if(i.startTime!="never"&&i.startTime!="0:00.000"){TBUtilities.Log("item.startTime: "+i.startTime);n=i.startTime.split(".");r=parseInt(n[1]);s=n[0].split(":");d=0;c=0;p=0;if(s.length==3){d=parseInt(s[0]);c=parseInt(s[1]);p=parseInt(s[2])}else{c=parseInt(s[0]);p=parseInt(s[1])}b=new TimeSpan(r,p,c,d);TBUtilities.Log("item.timeSpanToStart: "+b);n=i.endTime.split(".");r=parseInt(n[1]);s=n[0].split(":");d=0;c=0;p=0;if(s.length==3){d=parseInt(s[0]);c=parseInt(s[1]);p=parseInt(s[2])}else{c=parseInt(s[0]);p=parseInt(s[1])}y=new TimeSpan(r,p,c,d);TBUtilities.Log("timeSpanToEnd_a: "+y);i.totalTimeMiliseconds=y.totalMilliseconds()-b.totalMilliseconds();TBUtilities.Log("-item.totalTimeMiliseconds: "+i.totalTimeMiliseconds);TBUtilities.Log("-thisVideoTotalMiliseconds: "+u);if(b.totalMilliseconds()>u){y=new TimeSpan(u,0,0);TBUtilities.Log("timeSpanToEnd_b: "+b);var h=u-i.totalTimeMiliseconds;if(h<0)h=0;TBUtilities.Log("-Starts After Video Ends. New Start Time: "+h);b=new TimeSpan(h,0,0)}else if(y.totalMilliseconds()>u){TBUtilities.Log("-Ending After Video Ends. Adjusting to fit end.");y=new TimeSpan(u,0,0);TBUtilities.Log("timeSpanToEnd_c: "+b)}if(i.dockAtEnd==true){TBUtilities.Log("-Yes, is Docked to the End.");var f=u-i.distanceFromEnd;y=new TimeSpan(f,0,0,0,0);TBUtilities.Log("timeSpanToEnd_d: "+b);var m=f-i.totalTimeMiliseconds;if(!m||m<0)m=0;b=new TimeSpan(m,0,0,0,0);TBUtilities.Log("-> New Time to Start: "+b);TBUtilities.Log("-> New Time to end: "+f)}if(i.dockAtStart==true){TBUtilities.Log("-Yes, is Docked to the Start..");TBUtilities.Log(i);TBUtilities.Log("-> New Time to start: "+v);if(i.ref!=null&&i!=""){for(var o=0;o<t.annotations.length;o++){var a=t.annotations[o];if(a.id==i.ref){var g=a.startTimeTimeMiliseconds;b=new TimeSpan(g,0,0,0,0);TBUtilities.Log("Inside Ref StartTime")}}}else{TBUtilities.Log("Outside Ref StartTime");var v=i.startTimeTimeMiliseconds;b=new TimeSpan(v,0,0,0,0)}}if(i.refTimeUpdated!=true){TBUtilities.Log("-Reference Time was not updated");TBUtilities.Log(i.fullXML);var T=i.fullXML;var w=T.indexOf(' t="')+4;var j=T.indexOf('"',w);var Q=i.fullXML.substring(0,w);TBUtilities.Log("timeSpanToStart: "+b);Q+=b.hours()+":"+b.minutes()+":"+b.seconds()+"."+b.milliseconds();Q+=i.fullXML.substring(j,i.fullXML.length);TBUtilities.Log("-> Inserting Start: "+JSON.stringify(b));var x=Q.indexOf(' t="',j)+4;var B=Q.indexOf('"',x);i.fullXML=Q.substring(0,x);TBUtilities.Log("timeSpanToEnd: "+b);var k=y.hours()+":"+y.minutes()+":"+y.seconds()+"."+y.milliseconds();i.fullXML+=k;i.fullXML+=Q.substring(B,Q.length);TBUtilities.Log("-> Inserting End(a): "+k)}}else if(i.dockAtEnd==true){TBUtilities.Log("-Yes, is Docked to the End(else).");TBUtilities.Log("thisVideoTotalMiliseconds: "+u);TBUtilities.Log("");y=new TimeSpan(u,0,0,0,0);TBUtilities.Log("timeSpanToEnd_d(a): "+y);i.totalTimeMiliseconds=y.totalMilliseconds()-b.totalMilliseconds()}else{n=i.endTime.split(".");r=parseInt(n[1]);s=n[0].split(":");d=0;c=0;p=0;if(s.length==3){d=parseInt(s[0]);c=parseInt(s[1]);p=parseInt(s[2])}else{c=parseInt(s[0]);p=parseInt(s[1])}y=new TimeSpan(r,p,c,d);TBUtilities.Log("timeSpanToEnd_c: "+y);i.totalTimeMiliseconds=y.totalMilliseconds()-b.totalMilliseconds()}var L=t.isAutoSelect?jQuery("textarea[data-annotation-default-id="+i.id+"]").val():jQuery("textarea[data-video-id="+t.currentVideo.id+"][data-annotation-id="+i.id+"]").val();L=TBUtilities.GetXmlEncoded(L);TBUtilities.Log("-- newText: "+L+" ---");i.fullXML=i.fullXML.replace("<TEXT>"+TBUtilities.GetHtmlEncoded(i.text)+"</TEXT>","<TEXT>"+L+"</TEXT>");if(jQuery("input[data-video-id="+t.currentVideo.id+"][data-annotation-id="+i.id+"]").length>0||t.isAutoSelect&&jQuery("input[data-annotation-default-id="+i.id+"]").length>0){var U=t.isAutoSelect?jQuery("input[data-annotation-default-id="+i.id+"]").val():jQuery("input[data-video-id="+t.currentVideo.id+"][data-annotation-id="+i.id+"]").val();if(U&&U!=undefined&&U!="undefined"){TBUtilities.Log("---- URL REPLACE"+U+" ---");i.fullXML=i.fullXML.replace(i.url,U);i.fullXML=i.fullXML.replace(TBUtilities.ReplaceAll(i.url,"&","&amp;"),TBUtilities.ReplaceAll(U,"&","&amp;"))}}else{}if(i.ref!=null&&i!=""){i.fullXML=i.fullXML.replace("<segment>",'<segment spaceRelative="'+i.ref.trim()+'">')}if(i.ref!=null&&i!=""){for(var o=0;o<t.annotations.length;o++){var a=t.annotations[o];if(a.id==i.ref){referenceItem=a;l+='<annotation author="'+referenceItem.author+'" id="'+referenceItem.id+'" type="'+referenceItem.type+'" style="'+referenceItem.style+'">';referenceItem.fullXML=referenceItem.fullXML.replace('movingRegion type="rect"','movingRegion type="rect" pattern="fixed"');referenceItem.fullXML=referenceItem.fullXML.replace('pattern="fixed" pattern="fixed"','pattern="fixed"');if(jQuery("input[data-video-id="+t.currentVideo.id+"][data-annotation-id="+referenceItem.id+"]").length>0||t.isAutoSelect&&jQuery("input[data-annotation-default-id="+referenceItem.id+"]").length>0){var C=t.isAutoSelect?jQuery("input[data-annotation-default-id="+referenceItem.id+"]").val():jQuery("input[data-video-id="+t.currentVideo.id+"][data-annotation-id="+referenceItem.id+"]").val();referenceItem.fullXML=referenceItem.fullXML.replace(referenceItem.url,C)}else{}if(i.refTimeUpdated==true){TBUtilities.Log("-Yes, Reference Time was updated");var T=referenceItem.fullXML;var w=T.indexOf(' t="')+4;var j=T.indexOf('"',w);var Q=referenceItem.fullXML.substring(0,w);Q+=b.hours()+":"+b.minutes()+":"+b.seconds()+"."+b.milliseconds();Q+=referenceItem.fullXML.substring(j,referenceItem.fullXML.length);TBUtilities.Log("-> Inserting Start: "+JSON.stringify(b));var x=Q.indexOf(' t="',j)+4;var B=Q.indexOf('"',x);referenceItem.fullXML=Q.substring(0,x);var k=y.hours()+":"+y.minutes()+":"+y.seconds()+"."+y.milliseconds();referenceItem.fullXML+=k;referenceItem.fullXML+=Q.substring(B,Q.length);TBUtilities.Log("-> Inserting End(b): "+k)}l+=referenceItem.fullXML;l+="</annotation>";break}}}l+='<annotation author="'+i.author+'" id="'+i.id+'" type="'+i.type+'" style="'+i.style+'">';l+=i.fullXML;l+="</annotation>";TBUtilities.Log("--- Ending Annotation XML ---");TBUtilities.Log(i.fullXML)});l+="</updatedItems>";l+="</document>";TBUtilities.Log("--- Before Replace ---");TBUtilities.Log(l);l=TBUtilities.ReplaceAll(l,"spacerelative=","spaceRelative=");l=TBUtilities.ReplaceAll(l,"></rectRegion>","/>");l=TBUtilities.ReplaceAll(l,"highlightwidth","highlightWidth");if(l.indexOf('borderAlpha="0.0"')>0){l=TBUtilities.ReplaceAll(l,'borderAlpha="0.0"','borderAlpha="0"')}TBUtilities.Log("--- FINAL  XML ---");TBUtilities.Log(l);var c="https://www.youtube.com/annotations_auth/update2";TBExtension.Post(c,l,"CRTBLoadAnnotationsUpdatePost",{xml:l});jQuery("#tb-annotations-progress-container").html(jQuery("#tb-annotations-progress-container").html()+" Update &rarr;")}else{jQuery("#tb-annotations-progress-container").html(jQuery("#tb-annotations-progress-container").html()+" Update Failed &rarr;");f(t.currentVideo.id,"failed loading list of annotations (A)")}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyAnnotations] CRTBLoadAnnotationsGetList"+TBGlobal.UserDebugCode()});jQuery("#tb-annotations-progress-container").html(jQuery("#tb-annotations-progress-container").html()+" Update Exception &rarr;");f(t.currentVideo.id,"failed loading list of annotations (B)")}});jQuery(document.body).on("CRTBLoadAnnotationsUpdatePostDeleteAll",function(e,i){TBUtilities.Log("Response from CRTBLoadAnnotationsUpdatePostDeleteAll: "+JSON.stringify(i));try{if(i.success){var o="https://www.youtube.com/annotations_auth/publish2";TBExtension.Post(o,i.data.xml,"CRTBAnnotationsPublishPostDeleteAll",{xml:i.data.xml});jQuery("#tb-annotations-progress-container").html(jQuery("#tb-annotations-progress-container").html()+" Publish &rarr;")}else{i.location="CRTBLoadAnnotationsUpdatePostDeleteAll";TBUtilities.LogError("Unable to bulk copy annotations. Details: "+JSON.stringify(i));jQuery("#tb-annotations-progress-container").html(jQuery("#tb-annotations-progress-container").html()+" Publish Fail &rarr;");f(t.currentVideo.id,"failed deleting all annotations (C)")}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyAnnotations] CRTBLoadAnnotationsUpdatePostDeleteAll"});jQuery("#tb-annotations-progress-container").html(jQuery("#tb-annotations-progress-container").html()+" Publish Exception &rarr;");f(t.currentVideo.id,"failed deleting all annotations (D)")}});jQuery(document.body).on("CRTBLoadAnnotationsUpdatePost",function(e,i){try{if(i.success){var o="https://www.youtube.com/annotations_auth/publish2";TBExtension.Post(o,i.data.xml,"CRTBLoadAnnotationsPublishPost")}else{i.location="CRTBLoadAnnotationsUpdatePost";TBUtilities.LogError("Unable to bulk copy annotations. Details: "+JSON.stringify(i));f(t.currentVideo.id,"failed updating annotation [Private or Removed video?] (A)")}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyAnnotations] CRTBLoadAnnotationsUpdatePost"});f(t.currentVideo.id,"failed updating annotation (B)")}});jQuery(document.body).on("CRTBAnnotationsPublishPostDeleteAll",function(e,i){TBUtilities.Log("Response from CRTBAnnotationsPublishPostDeleteAll: "+JSON.stringify(i));try{if(i.success){jQuery("#tb-annotations-progress-container").html(jQuery("#tb-annotations-progress-container").html()+" Success &rarr;")}else{i.location="CRTBLoadAnnotationsPublishPostDeleteAll";TBUtilities.LogError("Unable to bulk copy annotations. Details: "+JSON.stringify(i));f(t.currentVideo.id,"failed deleting all annotations (E)");return}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyAnnotations] CRTBAnnotationsPublishPostDeleteAll"});f(t.currentVideo.id,"failed deleting all annotations (F)");return}TBYouTubeApi.GetVideoDetails(t.currentVideo.id,null,r)});jQuery(document.body).on("CRTBLoadAnnotationsPublishPost",function(e,i){try{if(i.success){h()}else{i.location="CRTBLoadAnnotationsPublishPost";TBUtilities.LogError("Unable to bulk copy annotations. Details: "+JSON.stringify(i));f(t.currentVideo.id,"failed updating annotation (E)")}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyAnnotations] CRTBLoadAnnotationsPublishPost"});f(t.currentVideo.id,"failed updating annotation (F)")}});jQuery(document.body).on("CRTBLoadAnnotationsTemplate",function(e,t){try{if(t.success){t.response=TBUtilities.FixLocalHtml(DOMPurify.sanitize(t.response,DOMPurifyConfig));jQuery("body").append(t.response)}else{}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyAnnotations] CRTBLoadAnnotationsTemplate"})}});jQuery(document.body).on("CRTBLoadAnnotationsForVideoDelete",function(e,o){var a="";try{if(o.success){t.annotationIdsToDelete=[];var n=DOMPurify.sanitize(o.response,DOMPurifyConfig);jQuery(n).find("annotation").each(function(){var e=jQuery(this).attr("id");var o=jQuery(this).attr("author");if(o==null)o="";if(e.indexOf("channel:")==-1&&e.indexOf("video:")==-1){if(i.deleteAll){t.annotationIdsToDelete.push({id:e,author:o})}else{TBUtilities.Log("An Annotation");var a=jQuery(this).find("text").length>0;var n=jQuery(this).find("url").length>0;TBUtilities.Log("hasText: "+a+", hasUrl: "+n);if(a){TBUtilities.Log("Text: "+jQuery(this).find("text").html())}if(n&&i.deleteUrl){var r=jQuery(this).find("url").attr("value");TBUtilities.Log("bulkDeleteOptions.includePartialMatches: "+i.includePartialMatches);var s=TBUtilities.CountMatches(r,i.deleteUrl,true,!i.includePartialMatches);TBUtilities.Log("url matches: "+s);if(s>0)t.annotationIdsToDelete.push({id:e,author:o})}if(a&&i.deleteText){var l=jQuery(this).find("text").html();TBUtilities.Log("bulkDeleteOptions.includePartialTextMatches: "+i.includePartialTextMatches);var s=TBUtilities.CountMatches(l,i.deleteText,true,false,!i.includePartialTextMatches);TBUtilities.Log("text matches: "+s);if(s>0)t.annotationIdsToDelete.push({id:e,author:o})}TBUtilities.Log(jQuery(this)[0].outerHTML)}}else TBUtilities.Log('Skipping annotation because of "channel: or video:"')});if(t.annotationIdsToDelete.length==0){TBUtilities.Log("No annotations found to delete: "+t.currentVideo.id);jQuery("#tb-annotations-progress-container").html(jQuery("#tb-annotations-progress-container").html()+" None &rarr;");TBYouTubeApi.GetVideoDetails(t.currentVideo.id,null,r)}else{TBUtilities.Log("Fetching annotations webpage for: "+o.data.videoId+" to delete all");var s="https://www.youtube.com/my_videos_annotate?feature=vm&v="+o.data.videoId;jQuery("#tb-annotations-progress-container").html(jQuery("#tb-annotations-progress-container").html()+" All &rarr;");TBExtension.Get(s,"CRTBLoadAnnotationsDeleteAll",{videoId:o.data.videoId})}}else{TBUtilities.Log("First Annotations URL failed for:"+o.data.videoId);if(o.data!=null&&o.data.secondTry!=null){TBYouTubeApi.GetVideoDetails(t.currentVideo.id,null,r);jQuery("#tb-annotations-progress-container").html(jQuery("#tb-annotations-progress-container").html()+" Get V1 &rarr;");TBUtilities.Log("2nd Annotations URL failed for:"+t.currentVideo.id)}else{TBUtilities.Log("Fetching 2nd Annotations URL for:"+o.data.videoId);var l="https://www.youtube.com/annotations_invideo?features=1&legacy=1&video_id="+o.data.videoId;jQuery("#tb-annotations-progress-container").html(jQuery("#tb-annotations-progress-container").html()+" Get V2 &rarr;");TBExtension.Get(l,"CRTBLoadAnnotationsForVideoDelete",{secondTry:true,videoId:o.data.videoId})}}}catch(e){TBUtilities.Log("Video Failed:"+t.currentVideo.id+" [EXCEPTION: "+e.message+"]");e.resultData=o;TBUtilities.LogError({Exception:e,Location:"[TubeBuddyAnnotations] CRTBLoadAnnotationsForVideoDelete"+a});f(t.currentVideo.id,"failed to load annotation for delete (A)")}});jQuery(document.body).on("CRTBLoadAnnotationsForVideo",function(e,i){var o="";try{if(i.success){t.annotations=[];jQuery("#tb-annotations-list").html("");var a=0;TBUtilities.Log("Annotation XML: "+i.response);var n=DOMPurify.sanitize(i.response,DOMPurifyConfig);jQuery(n).find("annotation").each(function(){o+="0";var e=jQuery(this).attr("type");if(e=="card"||e=="drawer"){return true}var i={};i.id=jQuery(this).attr("id");i.author=jQuery(this).attr("author");if(i.author==null)i.author="";i.index=a;a=a+1;i.type=jQuery(this).attr("type");i.style=jQuery(this).attr("style");i.log_data=jQuery(this).attr("log_data");i.logable=jQuery(this).attr("logable");i.text=jQuery(this).find("TEXT").text();i.ref=jQuery(this).find("condition").attr("ref");i.url=jQuery(this).find("url").attr("value");i.dockAtStart=false;i.dockAtEnd=false;if(i.url==null)i.url=jQuery(this).find("action").find("url").attr("value");TBUtilities.Log("Item Style: "+i.style);switch(i.style){case"anchored":i.display="Speech Bubble";break;case"popup":i.display="Note";break;case"title":i.display="Title";break;case"highlightText":case"highlighttext":i.display="Spotlight";break;case"label":i.display="Label";break;default:i.display="Spotlight Text";break}o+="[Display: "+i.display+"]";i.startTime=jQuery(this).find("movingRegion rectRegion:nth-child(1)").attr("t");if(!i.startTime){i.startTime=jQuery(this).find("movingRegion anchoredRegion:nth-child(1)").attr("t")}if(!i.startTime){i.startTime="never"}var n=[];var r="";var s=[];var l=0;var d=0;var u=0;TBUtilities.Log("item.startTime(2): "+i.startTime);if(i.startTime!="never"&&i.startTime!="0:00.000"){n=i.startTime.split(".");r=parseInt(n[1]);s=n[0].split(":");l=0;d=0;u=0;if(s.length==3){l=parseInt(s[0]);d=parseInt(s[1]);u=parseInt(s[2])}else{d=parseInt(s[0]);u=parseInt(s[1])}TBUtilities.Log(r+"-"+u+"-"+d+"-"+l);i.startTimeTimeSpan=new TimeSpan(r,u,d,l);TBUtilities.Log("item.startTimeTimeSpan: "+i.startTimeTimeSpan);i.startTimeTimeMiliseconds=i.startTimeTimeSpan.totalMilliseconds();TBUtilities.Log("item.startTimeTimeMiliseconds: "+i.startTimeTimeMiliseconds);i.dockAtStart=i.startTimeTimeMiliseconds<t.totalVideoMiliseconds*.15}i.endTime=jQuery(this).find("movingRegion rectRegion:nth-child(2)").attr("t");if(!i.endTime)i.endTime=jQuery(this).find("movingRegion anchoredRegion:nth-child(2)").attr("t");if(!i.endTime)i.endTime="never";TBUtilities.Log("item.endTime: "+i.endTime);var n=[];var r="";var s=[];var l=0;var d=0;var u=0;TBUtilities.Log("Add StartTime: "+i.startTime);if(i.startTime!="never"&&i.startTime!="0:00.000"){n=i.startTime.split(".");r=parseInt(n[1]);s=n[0].split(":");l=0;d=0;u=0;if(s.length==3){l=parseInt(s[0]);d=parseInt(s[1]);u=parseInt(s[2])}else{d=parseInt(s[0]);u=parseInt(s[1])}TBUtilities.Log(r+"-"+u+"-"+d+"-"+l);i.startTimeTimeSpan=new TimeSpan(r,u,d,l);TBUtilities.Log("item.startTimeTimeSpan: "+i.startTimeTimeSpan);i.startTimeTimeMiliseconds=i.startTimeTimeSpan.totalMilliseconds();TBUtilities.Log("item.startTimeTimeMiliseconds: "+i.startTimeTimeMiliseconds);i.dockAtStart=i.startTimeTimeMiliseconds<t.totalVideoMiliseconds*.15}if(i.endTime!="never"&&i.endTime!="0:00.000"){n=i.endTime.split(".");r=parseInt(n[1]);s=n[0].split(":");l=0;d=0;u=0;if(s.length==3){l=parseInt(s[0]);d=parseInt(s[1]);u=parseInt(s[2])}else{d=parseInt(s[0]);u=parseInt(s[1])}i.endTimeTimeSpan=new TimeSpan(r,u,d,l);i.endTimeTimeMiliseconds=i.endTimeTimeSpan.totalMilliseconds();i.dockAtEnd=i.endTimeTimeMiliseconds>t.totalVideoMiliseconds*.85;i.distanceFromEnd=t.totalVideoMiliseconds-i.endTimeTimeMiliseconds;if(i.distanceFromEnd<0)i.distanceFromEnd=0}if(i.startTimeTimeMiliseconds!=null){if(i.endTimeTimeMiliseconds!=null)i.totalTimeMiliseconds=i.endTimeTimeMiliseconds-i.startTimeTimeMiliseconds;else i.totalTimeMiliseconds=t.totalVideoMiliseconds-i.startTimeTimeMiliseconds}else if(i.endTimeTimeMiliseconds!=null){i.totalTimeMiliseconds=i.endTimeTimeMiliseconds}i.fullXML=jQuery(this).html();i.fullXML=TBUtilities.ReplaceAll(i.fullXML,"highlightfontcolor","highlightFontColor");i.fullXML=TBUtilities.ReplaceAll(i.fullXML,"textsize","textSize");i.fullXML=TBUtilities.ReplaceAll(i.fullXML,"fgcolor","fgColor");i.fullXML=TBUtilities.ReplaceAll(i.fullXML,"borderalpha","borderAlpha");i.fullXML=TBUtilities.ReplaceAll(i.fullXML,"spacerelative","spaceRelative");i.fullXML=TBUtilities.ReplaceAll(i.fullXML,"bgalpha","bgAlpha");i.fullXML=TBUtilities.ReplaceAll(i.fullXML,"bgcolor","bgColor");i.fullXML=TBUtilities.ReplaceAll(i.fullXML,"anchoredregion","anchoredRegion");i.fullXML=TBUtilities.ReplaceAll(i.fullXML,"movingregion","movingRegion");i.fullXML=TBUtilities.ReplaceAll(i.fullXML,"rectregion","rectRegion");if(i.fullXML.indexOf('"></padding>')>0||i.fullXML.indexOf(" ></padding>")>0)i.fullXML=TBUtilities.ReplaceAll(i.fullXML,"></padding>","/>");if(i.fullXML.indexOf('"></appearance>')>0||i.fullXML.indexOf(" ></appearance>")>0)i.fullXML=TBUtilities.ReplaceAll(i.fullXML,"></appearance>","/>");i.fullXML=TBUtilities.ReplaceAll(i.fullXML,"</text>","</TEXT>");i.fullXML=TBUtilities.ReplaceAll(i.fullXML,"<text>","<TEXT>");i.fullXML=TBUtilities.ReplaceAll(i.fullXML,"></condition>","/>");if(i.fullXML.indexOf('"></appearance>')>0||i.fullXML.indexOf(" ></appearance>")>0)i.fullXML=TBUtilities.ReplaceAll(i.fullXML,"></appearance>","/>");i.fullXML=TBUtilities.ReplaceAll(i.fullXML,"></rectregion>","/>");i.fullXMLOriginal=i.fullXML;i.videoId=t.selectedVideo.id;TBUtilities.Log("Item Type: "+i.type);if(i.type!="branding"&&i.type!="promotion"&&i.type!="card"&&i.type!="drawer")t.annotations.push(i)});o+="[Outloop]";var r=t.annotations.length;for(var s=0;s<r;s++){var l=t.annotations[s];switch(l.display){case"Speech Bubble":case"Note":case"Title":case"Label":o+="[TopSwitch]";if(l.url!=null)jQuery("#tb-annotations-list").append('<div class="tb-annotations-annotations-item" data-index="'+l.index+'" style="margin-bottom:10px;"><div style="border-bottom:solid 1px #ccc; padding-bottom:5px;"><img style="position:relative; top:2px;" src="'+TBGlobal.host+"/images/icons/annotations/"+l.style+'.png" /> <b style="font-size:16px">'+l.display+'</b></div><span style="position:relative; top:-17px; font-weight:bold">Text:</span> <textarea style="font-size:11px;  margin-top:5px; color:#444;height:26px; padding:1px; width:240px;" class="tb-annotations-default-setting" data-annotation-default-id="'+l.id+'">'+l.text+'</textarea><div style="width: 280px; max-width: 280px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; position:relative; top:-3px;"><b>Link:</b> <input class="tb-annotations-default-setting" type="text" style="font-size:11px; height:13px; padding:1px; width:240px; color:#444;" data-annotation-default-id="'+l.id+'" value="'+l.url+'" /></div><b>Time:</b> <i>'+l.startTime+" to "+l.endTime+"</i></div>");else jQuery("#tb-annotations-list").append('<div class="tb-annotations-annotations-item" data-index="'+l.index+'" style="margin-bottom:10px;"><div style="border-bottom:solid 1px #ccc; padding-bottom:5px;"><img style="position:relative; top:2px;" src="'+TBGlobal.host+"/images/icons/annotations/"+l.style+'.png" /> <b style="font-size:16px">'+l.display+'</b></div><span style="position:relative; top:-17px; font-weight:bold">Text:</span> <textarea style="font-size:11px;  margin-top:5px; color:#444;height:26px; padding:1px; width:240px;" class="tb-annotations-default-setting" data-annotation-default-id="'+l.id+'">'+l.text+"</textarea><br /><b>Link:</b> (none)</div>");break;case"Spotlight":o+="[SpotSwitch]";var d;for(var u=0;u<r;u++){var c=t.annotations[u];if(c.id==t.annotations[s].ref)d=c}if(d!=null){if(d.url!=null)jQuery("#tb-annotations-list").append('<div class="tb-annotations-annotations-item" data-index="'+l.index+'" style="margin-bottom:10px;"><div style="border-bottom:solid 1px #ccc; padding-bottom:5px;"><img style="position:relative; top:2px;" src="'+TBGlobal.host+"/images/icons/annotations/"+l.style+'.png" /> <b style="font-size:16px">'+l.display+'</b></div><span style="position:relative; top:-17px; font-weight:bold">Text:</span> <textarea style="font-size:11px;  margin-top:5px; color:#444;height:26px; padding:1px; width:240px;" class="tb-annotations-default-setting" data-annotation-default-id="'+l.id+'">'+l.text+'</textarea><div style="width: 280px; max-width: 280px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; position:relative; top:-3px;"><b>Link:</b> <input class="tb-annotations-default-setting" type="text" style="font-size:11px; height:13px; padding:1px; width:240px; color:#444;" data-annotation-default-id="'+d.id+'" value="'+d.url+'" /></div><b>Time:</b> <i>'+d.startTime+" to "+d.endTime+"</i></div>");else jQuery("#tb-annotations-list").append('<div class="tb-annotations-annotations-item" data-index="'+l.index+'" style="margin-bottom:10px;"><div style="border-bottom:solid 1px #ccc; padding-bottom:5px;"><img style="position:relative; top:2px;" src="'+TBGlobal.host+"/images/icons/annotations/"+l.style+'.png" /> <b style="font-size:16px">'+l.display+'</b></div><span style="position:relative; top:-17px; font-weight:bold">Text:</span> <textarea style="font-size:11px;  margin-top:5px; color:#444;height:26px; padding:1px; width:240px;" class="tb-annotations-default-setting" data-annotation-default-id="'+l.id+'">'+l.text+"</textarea><br ><b>Time:</b> <i>"+d.startTime+" to "+d.endTime+"</i><br />Link: (none)</div>")}else{if(l.url!=null)jQuery("#tb-annotations-list").append('<div class="tb-annotations-annotations-item" data-index="'+l.index+'" style="margin-bottom:10px;"><div style="border-bottom:solid 1px #ccc; padding-bottom:5px;"><img style="position:relative; top:2px;" src="'+TBGlobal.host+"/images/icons/annotations/"+l.style+'.png" /> <b style="font-size:16px">'+l.display+'</b></div><span style="position:relative; top:-17px; font-weight:bold">Text:</span> <textarea style="font-size:11px;  margin-top:5px; color:#444;height:26px; padding:1px; width:240px;" class="tb-annotations-default-setting" data-annotation-default-id="'+l.id+'">'+l.text+'</textarea><div style="width: 280px; max-width: 280px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; position:relative; top:-3px;"><b>Link:</b> <input class="tb-annotations-default-setting" type="text" style="font-size:11px; height:13px; padding:1px; width:240px; color:#444;" data-annotation-default-id="'+l.id+'" value="'+l.url+'" /></div><b>Time:</b> <i>'+l.startTime+" to "+l.endTime+"</i></div>");else jQuery("#tb-annotations-list").append('<div class="tb-annotations-annotations-item" data-index="'+l.index+'" style="margin-bottom:10px;"><div style="border-bottom:solid 1px #ccc; padding-bottom:5px;"><img style="position:relative; top:2px;" src="'+TBGlobal.host+"/images/icons/annotations/"+l.style+'.png" /> <b style="font-size:16px">'+l.display+'</b></div><span style="position:relative; top:-17px; font-weight:bold">Text:</span> <textarea  style="font-size:11px;  margin-top:5px; color:#444;height:26px; padding:1px; width:240px;" class="tb-annotations-default-setting" data-annotation-default-id="'+l.id+'">'+l.text+"</textarea><br ><b>Time:</b> <i>"+l.startTime+" to "+l.endTime+"</i><br />(none)</div>")}break;case"Spotlight Text":var p=false;for(var u=0;u<r;u++){var c=t.annotations[u];if(c.ref==t.annotations[s].id)p=true}if(!p){if(l.url!=null)jQuery("#tb-annotations-list").append('<div class="tb-annotations-annotations-item" data-index="'+l.index+'" style="margin-bottom:10px;"><img style="position:relative; top:2px;" src="'+TBGlobal.host+"/images/icons/annotations/"+l.style+'.png" /> <b style="font-size:16px">'+l.display+"</b><br/>Text: <i>"+l.text+"</i><br >Time: <i>"+l.startTime+" to "+l.endTime+'</i><div style="width: 280px; max-width: 280px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">Link: <a href="'+l.url+'" target="_blank">'+l.url+"</a></div></div>");else jQuery("#tb-annotations-list").append('<div class="tb-annotations-annotations-item" data-index="'+l.index+'" style="margin-bottom:10px;"><img style="position:relative; top:2px;" src="'+TBGlobal.host+"/images/icons/annotations/"+l.style+'.png" /> <b style="font-size:16px">'+l.display+"</b><br/>Text: <i>"+l.text+"</i><br >Time: <i>"+l.startTime+" to "+l.endTime+"</i><br />(none)</div>")}break}}o+="[Done]";jQuery("#tb-annotations-fetching").hide();if(a==0){jQuery("#tb-annotations-none").show();jQuery("#tb-annotations-cancel").hide();jQuery("#tb-annotations-continue").hide();jQuery("#tb-annotations-close").show()}else{jQuery("#tb-annotations-has").show();jQuery("#tb-annotations-cancel").show();jQuery("#tb-annotations-continue").show();jQuery("#tb-annotations-close").hide()}}else{if(i.data!=null&&i.data.secondTry!=null){jQuery("#tb-annotations-none").show();jQuery("#tb-annotations-cancel").hide();jQuery("#tb-annotations-continue").hide();jQuery("#tb-annotations-close").show();jQuery("#tb-annotations-fetching").hide()}else{var b="https://www.youtube.com/annotations_invideo?features=1&legacy=1&video_id="+t.selectedVideo.id;TBExtension.Get(b,"CRTBLoadAnnotationsForVideo",{secondTry:true})}}}catch(e){e.resultData=i;TBUtilities.LogError({Exception:e,Location:"[TubeBuddyAnnotations] CRTBLoadAnnotationsForVideo"+o})}})};var w=function(){try{jQuery("#tb-annotations-back-bulk").hide();if(t.fromBulkSelectMenu==true){jQuery("#tb-annotations-back-bulk").show()}jQuery("#tb-annotations-error-copy-container").hide();jQuery("#tb-annotations-error-copy").prop("data-clipboard-text","");var e=new ClipboardJS("#tb-annotations-error-copy");jQuery("#tb-annotations-selected-count").text("0");jQuery("#tb-annotations-destination-selected-count").text("0");if(t.isDeleteOnly){jQuery("#tb-annotations-thumbnail").hide();jQuery("#tb-annotations-title").hide()}else{jQuery("#tb-annotations-thumbnail").attr("src",t.selectedVideo.thumbnail);jQuery("#tb-annotations-title").text(t.selectedVideo.title);jQuery("#tb-annotations-title").attr("href","https://www.youtube.com/watch?v="+t.selectedVideo.id);jQuery("#tb-annotations-thumbnail").show();jQuery("#tb-annotations-title").show()}jQuery("#tb-annotations-onlyLoadFirstPage-number").prop("disabled",true);jQuery("#tb-annotations-onlyLoadFirstPage").prop("checked",false);jQuery("#tb-annotations-method").hide();jQuery("#tb-annotations-status").hide();jQuery("#tb-annotations-confirm").hide();jQuery("#tb-annotations-bulk-description-updates-container").hide();jQuery("#tb-annotations-featured-content-container").hide();jQuery("#tb-annotations-cancel").text("Cancel");jQuery("#tb-annotations-kickoff").hide();jQuery("#tb-annotations-summary-container").hide();jQuery("#tb-annotations-featured-video-status-complete").hide();jQuery("#tb-annotations-featured-video-status-processing").hide();jQuery("#tb-annotations-bulk-descriptions-status-complete").hide();jQuery("#tb-annotations-bulk-descriptions-status-processing").hide();jQuery("#tb-annotations-success").hide();jQuery("#tb-annotations-back").hide();jQuery("#tb-annotations-container").fadeIn();jQuery("#tb-annotations-methods-container").fadeIn();jQuery("#tb-annotations-none").hide();jQuery("#tb-annotations-has").hide();jQuery("#tb-annotations-destination").hide();jQuery("#tb-annotations-source").show();if(!t.isDeleteOnly){jQuery("#tb-annotations-continue").attr("disabled","disabled");jQuery("#tb-delete-annotations-options").hide()}else{jQuery("#tb-delete-annotations-options").show()}jQuery("#tb-annotations-input-ids").val("");jQuery("#tb-annotations-input-ids-status").text("");jQuery("#tb-annotations-method-full").prop("checked","checked")}catch(e){TBUtilities.LogError({Exception:e,Location:"[V2VPromote] prepareDialog"})}};return{Initialize:function(){if(TBGlobal.IsAuthenticated()){if(!e){T();a();s();e=true}else{}}},Show:function(e,i,a,n){TBGlobal.ClearUserDebugInfo();TBUtilities.Log("Opening Annotations");TBUtilities.Log("Id: https://www.youtube.com/watch?v="+e);TBUtilities.Log("title: "+i);t.isDeleteOnly=false;t.videoEntity=null;t.annotations=[];t.selectedAnnotations=[];t.videos=[];t.destinationVideos=[];t.currentVideo=null;t.isAutoSelect=false;t.selectedVideo.id=e;t.selectedVideo.title=i;t.selectedVideo.thumbnail=a;t.step=1;t.specificVideoIds.length=0;t.specificVideos.length=0;t.fromBulkSelectMenu=n;t.method=3;o();w();jQuery(".tb-annotations-filter").val("all");jQuery("#tb-annotations-step-2-title").text("Which videos do you want to copy the selected Annotation(s) to?");jQuery("#tb-annotations-what-videos2").text("Which videos do you want to copy the selected Annotation(s) to?");jQuery("#tb-annotations-additional-options-containers").show();jQuery("#tb-annotations-delete-existing").prop("checked",false);jQuery("#tb-annotations-header-image").hide();jQuery("#tb-annotations-confirm-statement").show();jQuery("#tb-annoations-confirm-text").text("copying");jQuery("#tb-annotations-kickoff").text("Start Copying!");jQuery("#tb-annotations-delete-existing-warning").text("WARNING: You have chosen to automatically delete all existing annotations from the destination videos before copying new annotations to them.");jQuery("#tb-annotations-title-block").text("Bulk Copy Annotations");jQuery("#tb-annotations-help-link").attr("href",TBGlobal.host+"/tools?tool=bulkcopyannotations")},ShowDelete:function(){TBGlobal.ClearUserDebugInfo();TBUtilities.Log("Opening DeleteAnnotations");t.isDeleteOnly=true;t.videoEntity=null;t.annotations=[];t.selectedAnnotations=[];t.videos=[];t.destinationVideos=[];t.currentVideo=null;t.isAutoSelect=false;t.selectedVideo.id="";t.selectedVideo.title="";t.selectedVideo.thumbnail="";t.step=1;o();w();jQuery("#tb-annotations-source").hide();jQuery("#tb-annotations-continue").show();jQuery("#tb-annotations-step-2-title").text("Which videos do you want to Delete  Annotations from?");jQuery("#tb-annotations-what-videos2").text("Which videos do you want to Delete ALL Annotations from?");jQuery("#tb-annotations-additional-options-containers").hide();jQuery("#tb-annotations-delete-existing").prop("checked",true);jQuery("#tb-annotations-confirm-statement").hide();jQuery("#tb-annoations-confirm-text").text("delete");jQuery("#tb-annotations-kickoff").text("Start Deleting!");jQuery("#tb-annotations-title-block").text("Bulk Delete Annotations");jQuery("#tb-annotations-continue").removeAttr("disabled");jQuery("#tb-annotations-help-link").attr("href",TBGlobal.host+"/tools?tool=bulkdeleteannotations")}}}();var TubeBuddyCards=function(){var e=false;var t=null;var i=2200;var o=2200;var a={method:3,specificVideoIds:[],specificVideos:[],validPlaylistIds:[],playlistId:"",search:"",selectedVideo:{},cards:[],selectedCards:[],videos:[],destinationVideos:[],currentVideo:null,isStopped:false,cardIdsToDelete:[],isDeleteOnly:false,totalDestinationVideos:0,videosWithDeletedCards:[],hasFinished:false,errorCount:0,successCount:0,fromBulkSelectMenu:false,channelVideoCount:0,imageConversionDic:{}};var n={deleteAll:false,deleteUrl:"",deleteText:"",deleteWebsite:false,deleteFundraising:false,deleteMerchandice:false,deleteVideOrPlaylist:false,deleteChannel:false,includePartialMatches:false,includePartialTextMatches:false};var r=function(){try{if(!a.isDeleteOnly){TBGlobal.AddUserDebugInfo("TubeBuddyCards - Loading Video Details");TBYouTubeApi.GetVideoDetails(a.selectedVideo.id,null,l)}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyCards] [loadData]"})}};var s=function(){var e=TBGlobal.host+"/ModuleManager/cards/cards?v="+TBGlobal.versionNumber;if(loadLocalHTML&&(TBExtension.GetType()=="chrome"||TBExtension.GetType()=="firefox")){e=chrome.extension.getURL("modules/cards.html")}else if(loadLocalHTML&&TBExtension.GetType()=="safari"){e="modules/cards.html"}TBExtension.Get(e,"CRTBLoadCardsTemplate")};var l=function(e){try{TBGlobal.AddUserDebugInfo("TubeBuddyCards - selectedVideoDetailsCallback");a.duration=new timelord(e.contentDetails.duration);a.totalVideoMiliseconds=a.duration.ticks();k()}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyCards] [api callback] selectedVideoDetailsCallback"})}};var d=function(e){var t="Video: "+a.currentVideo.id;if(!e)t="Failed to get video details!";try{a.currentVideo.contentDetails=e.contentDetails;var i=new timelord(e.contentDetails.duration);u(e,i.ticks());jQuery("#tb-cards-progress-container").html(jQuery("#tb-cards-progress-container").html()+" Got Details &#707;")}catch(e){t+=" [Error: "+e.message+"]";jQuery("#tb-cards-progress-container").html(jQuery("#tb-cards-progress-container").html()+" Failed Details &#707;");Q(a.currentVideo.id,t)}};var u=function(e,o){if(t==null){t=TBUtilities.GetSessionToken(document.documentElement.innerHTML)}var n=0;var r=0;jQuery.each(a.selectedCards,function(s,l){r++;var d=jQuery("div[data-video-id='"+e.id+"'][data-card-default-id='"+l.key+"']");var u=jQuery.extend({},l);b(u,d,e.id);p(u,a.totalVideoMiliseconds,o);var c=i*r;setTimeout(function(){n++;if(n==a.selectedCards.length)TubeBuddyYouTubeActions.CopyCard(a.currentVideo.id,u,t,TubeBuddyCards.ProcessNextVideo);else TubeBuddyYouTubeActions.CopyCard(a.currentVideo.id,u,t,TubeBuddyCards.CheckForErrors)},c)});jQuery("#tb-cards-progress-container").html(jQuery("#tb-cards-progress-container").html()+" Copy ("+a.selectedCards.length+") &#707;")};var c=function(e){jQuery("#tb-cards-progress-container").show();jQuery("#tb-cards-progress-container").html(jQuery("#tb-cards-progress-container").html()+" Delete");if(t==null){t=TBUtilities.GetSessionToken(document.documentElement.innerHTML)}a.videosWithDeletedCards.push(e);TBUtilities.Log("Session token ="+t);if(n.deleteAll||a.isDeleteOnly==false&&jQuery("#tb-cards-delete-existing").is(":checked"))TubeBuddyYouTubeActions.DeleteAllCards(e,t,TubeBuddyCards.DeleteAllCardsCallBack);else if(n.deleteUrl)TubeBuddyYouTubeActions.DeleteAllCardsWithUrl(e,t,n.deleteUrl,TubeBuddyCards.DeleteAllCardsCallBack,n.includePartialMatches);else if(n.deleteText)TubeBuddyYouTubeActions.DeleteAllCardsWithText(e,t,n.deleteText,TubeBuddyCards.DeleteAllCardsCallBack,n.includePartialTextMatches)};var p=function(e,t,i){TBUtilities.Log("TubeBuddyCards - start ms ="+e.start_ms);TBUtilities.Log("TubeBuddyCards - sourceVideoMiliseconds ="+t);TBUtilities.Log("TubeBuddyCards - destinationVideoMiliseconds ="+i);var o=e.start_ms>t*.85;var a=t-e.start_ms;if(a<1e3)a=1e3;if(o){e.start_ms=i-a;TBUtilities.Log("TubeBuddyCards - dock at end = true, new start_ms ="+e.start_ms)}if(e.start_ms>i){e.start_ms=i-1e3;TBUtilities.Log("TubeBuddyCards - start ms is greater than video length, adjusting to ="+e.start_ms)}};var b=function(e,t,i){TBUtilities.Log("copyFromTemplateToCard before");TBUtilities.Log(e);switch(e.type){case"product":case"associated":{e.title=jQuery(t).find(".tb-cards-associated-title").val();e.custom_message=jQuery(t).find(".tb-cards-associated-custom-message").val();e.target_url=jQuery(t).find(".tb-cards-associated-target-url").val();e.teaser_text=jQuery(t).find(".tb-cards-associated-teaser").val();TBUtilities.Log("In Associated");TBUtilities.Log("VideoId: "+i);TBUtilities.Log("card.target_url Pre: "+e.target_url);if(i){try{if(jQuery(".tb-cards-placeholders").is(":checked")){TBUtilities.Log("Doing placeholder replace");e.target_url=TBUtilities.ReplaceAll(e.target_url,"((youtubevideoid))",i,true);e.target_url=TBUtilities.ReplaceAll(e.target_url,"{videoid}",i,true)}}catch(e){console.log(e)}}TBUtilities.Log("card.target_url Post: "+e.target_url);if(e.image_url&&a.imageConversionDic[e.image_url]){e.imagefile=a.imageConversionDic[e.image_url]}break}case"fundraising":{e.title=jQuery(t).find(".tb-cards-fundraising-title").val();e.custom_message=jQuery(t).find(".tb-cards-fundraising-custom-message").val();e.target_url=jQuery(t).find(".tb-cards-fundraising-target-url").val();e.teaser_text=jQuery(t).find(".tb-cards-fundraising-teaser").val();if(i){try{if(jQuery(".tb-card-templates-placeholders").is(":checked")){TBUtilities.Log("Doing placeholder replace");e.target_url=TBUtilities.ReplaceAll(e.target_url,"((youtubevideoid))",i,true);e.target_url=TBUtilities.ReplaceAll(e.target_url,"{videoid}",i,true)}}catch(e){console.log(e)}}if(e.image_url&&a.imageConversionDic[e.image_url]){e.imagefile=a.imageConversionDic[e.image_url]}break}case"video":{e.target_url=jQuery(t).find(".tb-cards-video-url").val();e.custom_message=jQuery(t).find(".tb-cards-video-custom-message").val();e.teaser_text=jQuery(t).find(".tb-cards-video-teaser").val();break}case"playlist":{e.target_url=jQuery(t).find(".tb-cards-playlist-url").val();e.custom_message=jQuery(t).find(".tb-cards-playlist-custom-message").val();e.teaser_text=jQuery(t).find(".tb-cards-playlist-teaser").val();break}case"merch":{e.title=jQuery(t).find(".tb-cards-merch-title").val();e.custom_message=jQuery(t).find(".tb-cards-merch-custom-message").val();e.target_url=jQuery(t).find(".tb-cards-merch-target-url").val();e.teaser_text=jQuery(t).find(".tb-cards-merch-teaser").val();if(i){try{if(jQuery(".tb-card-templates-placeholders").is(":checked")){TBUtilities.Log("Doing placeholder replace");e.target_url=TBUtilities.ReplaceAll(e.target_url,"((youtubevideoid))",i,true);e.target_url=TBUtilities.ReplaceAll(e.target_url,"{videoid}",i,true)}}catch(e){console.log(ex)}}if(e.image_url&&a.imageConversionDic[e.image_url]){e.imagefile=a.imageConversionDic[e.image_url]}break}case"tip":{break}case"collaborator":{e.title=jQuery(t).find(".tb-cards-collaborator-title").val();e.custom_message=jQuery(t).find(".tb-cards-collaborator-custom-message").val();e.channel_url=jQuery(t).find(".tb-cards-collaborator-channelurl").val();e.teaser_text=jQuery(t).find(".tb-cards-collaborator-teaser").val();break}case"poll":{e.title=jQuery(t).find(".tb-cards-poll-title").val();e.teaser_text=jQuery(t).find(".tb-cards-poll-teaser").val();var o=new Array;jQuery(t).find(".tb-cards-poll-choice").each(function(){var e=jQuery(this).val();o.push(e)});e.choices=o;break}}TBUtilities.Log("copyFromTemplateToCard after");TBUtilities.Log(e)};var y=function(e,t,i,o){TBUtilities.Log("TubeBuddyCards - deleteAllCardsCallBack cards from video + "+t+" success = "+e);if(e){jQuery("#tb-cards-progress-container").html(jQuery("#tb-cards-progress-container").html()+" Del Success &#707;");j()}else{if(!o)o+="?";jQuery("#tb-cards-progress-container").html(jQuery("#tb-cards-progress-container").html()+" Del Fail &#707;");Q(t,"VideoId: "+t+" - Error deleting all cards ("+o+")")}};var h=function(){jQuery(document).on("click","#tb-cards-back-bulk",function(){jQuery(".tb-module-embed-video").hide();TubeBuddyMenu.HideBackground();jQuery("#tb-cards-container").hide();a.step=1;TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyBulkCopySelect.Show("TubeBuddyCards")});jQuery(document).on("change",".tb-cards-placeholders",function(){var e=jQuery(this).is(":checked");if(e&&!TBGlobal.CanAccessLevel3Tools()){jQuery(this).prop("checked",false);TBGlobal.ShowUpgradePage("use Placeholders","legend");return}});jQuery(document).on("click","#tb-cards-error-copy-container",function(){jQuery("#tb-cards-error-copy-container").find("span").text("Copied");window.setTimeout(function(){jQuery("#tb-cards-error-copy-container").find("span").text("Copy video ids")},1500)});jQuery(document).on("click",".tb-cards-default-setting",function(e){e.stopPropagation()});jQuery(document).on("click","#tb-cards-onlyLoadFirstPage",function(e){if(jQuery(this).is(":checked")){jQuery("#tb-cards-onlyLoadFirstPage-number").prop("disabled",false)}else{jQuery("#tb-cards-onlyLoadFirstPage-number").prop("disabled",true)}});jQuery(document).on("click","#tb-cards-select-all-cards",function(e){TBUtilities.Log("TubeBuddyCards - tb-cards-select-all-cards clicked");jQuery(".tb-cards-cards-item").each(function(){var e=jQuery(this).attr("data-card-default-id");var t=TBUtilities.GetInArray(a.selectedCards,"key",e);if(t==null){jQuery(this).trigger("click")}})});jQuery(document).on("click","#tb-cards-select-none-cards",function(e){jQuery(".tb-cards-cards-item").each(function(){var e=jQuery(this).attr("data-card-default-id");var t=TBUtilities.GetInArray(a.selectedCards,"key",e);if(t!=null){jQuery(this).trigger("click")}})});jQuery(document).on("change",".tb-cards-filter",function(){TBUtilities.Log("TubeBuddyCards - tb-cards-filter clicked");jQuery(".tb-cards-destination-row").show();switch(jQuery(this).val()){case"all":break;case"public":jQuery('.tb-cards-destination-row[data-privacy="private"]').hide();jQuery('.tb-cards-destination-row[data-privacy="unlisted"]').hide();break;case"unlisted":jQuery('.tb-cards-destination-row[data-privacy="public"]').hide();jQuery('.tb-cards-destination-row[data-privacy="private"]').hide();break;case"private":jQuery('.tb-cards-destination-row[data-privacy="public"]').hide();jQuery('.tb-cards-destination-row[data-privacy="unlisted"]').hide();break;case"publicunlisted":jQuery('.tb-cards-destination-row[data-privacy="private"]').hide();break;case"privateunlisted":jQuery('.tb-cards-destination-row[data-privacy="public"]').hide();break}jQuery("#tb-cards-destination-selected-count").text(jQuery("#tb-cards-destination-list").find(".tb-cards-destination-row-selected").filter(":visible").length);jQuery("#tb-cards-destination-total-count").text(jQuery("#tb-cards-destination-list").find(".tb-cards-destination-row").filter(":visible").length)});jQuery(document).on("click","#tb-cards-close, .tb-cards-closex, .tb-module-close",function(){try{TubeBuddyMenu.HideBackground();jQuery("#tb-cards-container").hide();a.step=1}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyCards] [click] tb-cards-close"})}});jQuery(document).on("click","#tb-cards-method-ids, #tb-cards-method-playlist, #tb-cards-method-search, #tb-cards-method-full",function(e){a.method=parseInt(jQuery(this).attr("data-method"));TBUtilities.Log("TubeBuddyCards - tb-cards-method-ids, #tb-cards-method-playlist, #tb-cards-method-search, #tb-cards-method-full clicked");TBUtilities.Log("TubeBuddyCards - data-method "+a.method);jQuery(".tb-playlist-select-manual-id-invalid").hide();var t=jQuery("#tb-cards-input-playlist").playlistSelect().data("plugin_playlistSelect");switch(a.method){case 0:jQuery("#tb-cards-input-ids").removeAttr("disabled","disabled");t.disable();a.playlistId="";jQuery("#tb-cards-input-playlist").attr("disabled","disabled");jQuery("#tb-cards-input-search").attr("disabled","disabled");break;case 1:jQuery("#tb-cards-input-ids").attr("disabled","disabled");jQuery("#tb-cards-input-playlist").removeAttr("disabled","disabled");jQuery("#tb-cards-input-search").attr("disabled","disabled");a.specificVideoIds.length=0;a.specificVideos.length=0;t.enable();t.showDropDown();break;case 2:jQuery("#tb-cards-input-ids").attr("disabled","disabled");t.disable();jQuery("#tb-cards-input-playlist").attr("disabled","disabled");a.specificVideoIds.length=0;a.specificVideos.length=0;a.playlistId="";jQuery("#tb-cards-input-search").removeAttr("disabled","disabled");break;case 3:jQuery("#tb-cards-input-ids").attr("disabled","disabled");jQuery("#tb-cards-input-playlist").attr("disabled","disabled");jQuery("#tb-cards-input-search").attr("disabled","disabled");a.specificVideoIds.length=0;a.specificVideos.length=0;a.playlistId="";t.disable();break}});jQuery(document).on("change keypress keyup paste keydown blur","#tb-cards-input-playlist",function(e){a.playlistId="";var t=jQuery(this).val().trim();t=TBUtilities.ReplaceAll(t,'"',"");if(t.length==0){jQuery("#tb-cards-input-playlist-status").hide();return}if(t.indexOf("list=")>0){t=t.substring(t.indexOf("list=")+5)}if(t.length!=18&&t.length!=34||t.substring(0,2)!="PL"){jQuery("#tb-cards-input-playlist-status").text("Invalid Playlist Id");jQuery("#tb-cards-input-playlist-status").css("color","red")}else{jQuery("#tb-cards-input-playlist-status").text("Valid Playlist Id");jQuery("#tb-cards-input-playlist-status").css("color","green");a.playlistId=t}jQuery("#tb-cards-input-playlist-status").show()});jQuery(document).on("change keypress keyup paste keydown blur","#tb-cards-input-search",function(e){a.search=jQuery(this).val().trim()});jQuery(document).on("change keypress keyup paste keydown blur","#tb-cards-input-ids",function(e){var t=jQuery(this).val().trim();t=TBUtilities.ReplaceAll(t,'"',"");if(t.length==0){jQuery("#tb-cards-input-ids-status").hide();return}jQuery("#tb-cards-input-ids-status").show();a.specificVideoIds=[];if(t.indexOf(",")>-1){a.specificVideoIds=t.split(",")}else{a.specificVideoIds=t.split(" ")}for(var i=0;i<a.specificVideoIds.length;i++){a.specificVideoIds[i]=a.specificVideoIds[i].trim();a.specificVideoIds[i]=a.specificVideoIds[i].replace("https://www.youtube.com/watch?v=","");a.specificVideoIds[i]=a.specificVideoIds[i].replace("https://youtu.be/","");if(a.specificVideoIds[i].length!=11){a.specificVideoIds.splice(i,1);i--}}if(a.specificVideoIds.length==0){jQuery("#tb-cards-input-ids-status").text("No videos detected");jQuery("#tb-cards-input-ids-status").css("color","red")}else if(a.specificVideoIds.length==1){jQuery("#tb-cards-input-ids-status").text("1 video detected");jQuery("#tb-cards-input-ids-status").css("color","green");jQuery("#tb-cards-method-ids").prop("checked",true);jQuery("#tb-cards-method-ids").trigger("click")}else{jQuery("#tb-cards-input-ids-status").text(a.specificVideoIds.length+" videos detected");jQuery("#tb-cards-input-ids-status").css("color","green");jQuery("#tb-cards-method-ids").prop("checked",true);jQuery("#tb-cards-method-ids").trigger("click")}});jQuery(document).on("click",".tb-cards-destination-row",function(){try{if(!jQuery(this).hasClass("tb-cards-destination-row-selected")){if(!TBGlobal.CanAccessLevel2Tools()&&jQuery("#tb-cards-destination-list").find(".tb-cards-destination-row-selected").filter(":visible").length>1){if(a.isDeleteOnly)TBGlobal.ShowUpgradePage("delete cards in bulk (more than 1 video at a time)","bulkdeletecards");else TBGlobal.ShowUpgradePage("copy cards in bulk (more than 1 video at a time)","bulkcopycards");return}jQuery(this).closest(".tb-cards-destination-row").addClass("tb-cards-destination-row-selected")}else{jQuery(this).closest(".tb-cards-destination-row").removeClass("tb-cards-destination-row-selected")}var e=jQuery("#tb-cards-destination-list").find(".tb-cards-destination-row-selected").filter(":visible").length;jQuery("#tb-cards-copy-destination-count").text(e);jQuery("#tb-cards-destination-selected-count").text(e);jQuery("#tb-cards-destination-total-count").text(jQuery("#tb-cards-destination-list").find(".tb-cards-destination-row").filter(":visible").length);if(jQuery("#tb-cards-copy-destination-count").text()=="1")jQuery("#tb-cards-copy-destination-count-s").hide();else jQuery("#tb-cards-copy-destination-count-s").show()}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyCards] [click] tb-cards-destination-row-selected"})}});jQuery(document).on("click","#tb-cards-select-all-checkboxes",function(){if(!TBGlobal.CanAccessLevel2Tools()&&a.videos.length>1){if(a.isDeleteOnly)TBGlobal.ShowUpgradePage("delete cards in bulk (more than 1 video at a time)","bulkdeletecards");else TBGlobal.ShowUpgradePage("copy cards in bulk (more than 1 video at a time)","bulkcopycards");return}jQuery(".tb-cards-destination-row").addClass("tb-cards-destination-row-selected");var e=jQuery("#tb-cards-destination-list").find(".tb-cards-destination-row-selected").filter(":visible").length;jQuery("#tb-cards-copy-destination-count").text(e);jQuery("#tb-cards-destination-selected-count").text(e);jQuery("#tb-cards-destination-total-count").text(jQuery("#tb-cards-destination-list").find(".tb-cards-destination-row").filter(":visible").length);if(jQuery("#tb-cards-copy-destination-count").text()=="1")jQuery("#tb-cards-copy-destination-count-s").hide();else jQuery("#tb-cards-copy-destination-count-s").show()});jQuery(document).on("click","#tb-cards-select-no-checkboxes",function(){jQuery(".tb-cards-destination-row").removeClass("tb-cards-destination-row-selected");var e=jQuery("#tb-cards-destination-list").find(".tb-cards-destination-row-selected").filter(":visible").length;jQuery("#tb-cards-copy-destination-count").text(e);jQuery("#tb-cards-destination-selected-count").text(e);jQuery("#tb-cards-destination-total-count").text(jQuery("#tb-cards-destination-list").find(".tb-cards-destination-row").filter(":visible").length);if(jQuery("#tb-cards-copy-destination-count").text()=="1")jQuery("#tb-cards-copy-destination-count-s").hide();else jQuery("#tb-cards-copy-destination-count-s").show()});jQuery(document).on("click",".tb-cards-destination-row input",function(e){e.stopPropagation()});jQuery(document).on("click","#tb-cards-expand-all",function(){jQuery(".tb-cards-cards-item-customize").html("Customize &#9650;");jQuery(".tb-cards-cards-item-options").slideDown()});jQuery(document).on("click","#tb-cards-collapse-all",function(){jQuery(".tb-cards-cards-item-customize").html("Customize &#9660;");jQuery(".tb-cards-cards-item-options").slideUp()});jQuery(document).on("click",".tb-cards-cards-item-customize",function(e){e.stopPropagation();try{var t=jQuery(this).attr("data-video-id");if(jQuery(this).parent().parent().find(".tb-cards-cards-item-options").css("display")=="none"){jQuery(this).html("Customize &#9650;");jQuery(this).parent().parent().find(".tb-cards-cards-item-options").slideDown()}else{jQuery(this).html("Customize &#9660;");jQuery(this).parent().parent().find(".tb-cards-cards-item-options").slideUp()}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyCards] [click] tb-cards-cards-item-customize"})}});jQuery(document).on("click","#tb-cards-stop",function(){a.isStopped=true;jQuery("#tb-cards-stop").hide();jQuery("#tb-cards-done-close").show();jQuery("#tb-cards-working").hide();jQuery("#tb-cards-stopped").show()});jQuery(document).on("click","#playlist-select-type-manual",function(){var e=jQuery(this).parents(".playlistSelect").find(".playlistSelectMutliSelectListItem").children("input");e.each(function(e,t){a.validPlaylistIds.push(jQuery(t).val())})});jQuery(document).on("keyup",".playlistSelectManualIds",function(){var e=jQuery(this).val();if(a.validPlaylistIds.indexOf(e)==-1){jQuery(".tb-playlist-select-manual-id-invalid").show()}else{jQuery(".tb-playlist-select-manual-id-invalid").hide()}});jQuery(document).on("click",".playlistSelectTypeList",function(){jQuery(".tb-playlist-select-manual-id-invalid").hide()});jQuery(document).on("click","#tb-cards-kickoff",function(){if(!jQuery("#tb-cards-confirm-checkbox").is(":checked")){if(a.isDeleteOnly)TBUtilities.Alert("Please check the box confirming that you want to Delete all cards");else TBUtilities.Alert("Please check the box confirming that you want to copy the cards");return}a.step=4;jQuery("#tb-cards-title-block").text("Bulk Copy Cards - Processing");if(a.isDeleteOnly)jQuery("#tb-cards-title-block").text("Bulk Delete Cards - Processing");jQuery("#tb-cards-status").show();jQuery("#tb-cards-confirm").hide();jQuery("#tb-cards-stop").show();jQuery("#tb-cards-back").hide();jQuery("#tb-cards-kickoff").hide();jQuery("#tb-cards-continue").hide();g()});jQuery(document).on("click change","#tb-cards-delete-text-option, #tb-cards-delete-link-option, #tb-cards-delete-all-option",function(){if(jQuery("#tb-cards-delete-link-option").is(":checked"))jQuery("#tb-cards-delete-partial-matches-container").fadeIn();else jQuery("#tb-cards-delete-partial-matches-container").fadeOut();if(jQuery("#tb-cards-delete-text-option").is(":checked"))jQuery("#tb-cards-delete-partial-matches-container-text").fadeIn();else jQuery("#tb-cards-delete-partial-matches-container-text").fadeOut()});jQuery(document).on("click","#tb-cards-continue, #tb-cards-kickoff",function(){try{TBUtilities.Log("TubeBuddyCards - tb-cards-continue, #tb-cards-kickoff clicked ");jQuery("#tb-cards-error-copy-container").attr("data-clipboard-text","");if(a.step==1){if(a.selectedCards.length==0&&!a.isDeleteOnly){TBUtilities.Alert("You must select at least 1 card to copy");return}jQuery("#tb-cards-back-bulk").hide();if(a.isDeleteOnly){n.deleteAll=true;n.deleteText="";n.deleteUrl="";if(jQuery("#tb-cards-delete-link-option").is(":checked")){n.deleteAll=false;n.deleteUrl=jQuery("#tb-delete-url").val().trim();n.includePartialMatches=jQuery("#tb-cards-delete-partial-matches").is(":checked");if(!n.deleteUrl){TBUtilities.Alert("You must enter a URL");return}else if(n.deleteUrl.length<=3){TBUtilities.Alert("It does not look like you entered a valid URL");return}}else if(jQuery("#tb-cards-delete-text-option").is(":checked")){n.deleteAll=false;n.deleteText=jQuery("#tb-delete-text").val().trim();n.includePartialTextMatches=jQuery("#tb-cards-delete-partial-matches-text").is(":checked");if(!n.deleteText){TBUtilities.Alert("You must enter a Title/Message/Teaser Text to match");return}else if(n.deleteText.length<3){TBUtilities.Alert("It does not look like you entered a longer Text to match");return}}}jQuery("#tb-cards-loading-videos").show();jQuery("#tb-cards-destination-list").hide();jQuery("#tb-delete-options").hide();jQuery("#tb-cards-source").hide();jQuery("#tb-cards-method").show();if(a.fromBulkSelectMenu==true){jQuery("#tb-cards-title-block").text("Bulk Copy Cards - Step 3")}else{jQuery("#tb-cards-title-block").text("Bulk Copy Cards - Step 2")}if(a.isDeleteOnly)jQuery("#tb-cards-title-block").text("Bulk Delete Cards - Step 2");jQuery("#tb-cards-back").show();TBUtilities.Log("TubeBuddyCards - Number of cards selected = "+a.selectedCards.length);$.each(a.selectedCards,function(e,t){var i=jQuery("div[data-card-default-id='"+t.key+"']").first();b(t,i)});a.step=2}else if(a.step==2){if(a.selectedCards.length==0&&!a.isDeleteOnly){TBUtilities.Alert("You must select at least 1 card to copy")}if(a.fromBulkSelectMenu==true){jQuery("#tb-cards-title-block").text("Bulk Copy Cards - Step 4")}else{jQuery("#tb-cards-title-block").text("Bulk Copy Cards - Step 3")}if(a.isDeleteOnly)jQuery("#tb-cards-title-block").text("Bulk Delete Cards - Step 3");jQuery("#tb-cards-destination-selected-count").text(jQuery("#tb-cards-destination-list").find(".tb-cards-destination-row-selected").filter(":visible").length);jQuery(".tb-cards-destination-row").removeClass("tb-cards-destination-row-selected");switch(parseInt(a.method)){case 0:if(a.specificVideoIds.length==0){jQuery("#tb-cards-input-ids-status").css("color","red");jQuery("#tb-cards-input-ids-status").text("No videos detected");jQuery("#tb-cards-input-ids-status").show();TBUtilities.Alert("You must enter a list of 1 or more valid Video IDs (or change you selection method above)");return}if(!TBGlobal.CanAccessLevel2Tools()&&a.specificVideoIds.length>1){if(a.isDeleteOnly)TBGlobal.ShowUpgradePage("delete cards in bulk (more than 1 video at a time)","bulkdeletecards");else TBGlobal.ShowUpgradePage("copy cards in bulk (more than 1 video at a time)","bulkcopycards");return}TBGlobal.AddUserDebugInfo("TubeBuddyCards - Video Selection Method: Video IDs "+JSON.stringify(a.specificVideoIds));f();break;case 1:var e=jQuery("#tb-cards-input-playlist").playlistSelect().data("plugin_playlistSelect");var t=e.getSelectedPlaylistIds();if(t.length>0){a.playlistId=t.join(",")}if(t.length>=2){TBUtilities.Alert("Please select only one playlist");return}if(a.playlistId==""){jQuery("#tb-cards-input-playlist-status").css("color","red");jQuery("#tb-cards-input-playlist-status").text("Invalid Playlist Id");jQuery("#tb-cards-input-playlist-status").show();TBUtilities.Alert("You must enter a valid Playlist ID (or change you selection method above)");return}TBGlobal.AddUserDebugInfo("TubeBuddyCards - Video Selection Method: Playlist ["+a.playlistId+"]");TBYouTubeApi.GetPlaylistVideos(a.playlistId,null,B,x);break;case 2:if(a.search==""){TBUtilities.Alert("You must enter a Search Term (or change you selection method above)");return}TBGlobal.AddUserDebugInfo("TubeBuddyCards - Video Selection Method: Search ["+a.search+"]");jQuery("#tb-cards-destination").show();TBYouTubeApi.GetChannelVideosSearch(a.search,null,B,x);break;case 3:TBGlobal.AddUserDebugInfo("TubeBuddyCards - Video Selection Method: All");var i=null;if(jQuery("#tb-cards-onlyLoadFirstPage").is(":checked")){var o=/^\+?\d+$/.test(jQuery("#tb-cards-onlyLoadFirstPage-number").val());if(o==false){TBUtilities.Alert("Please enter a valid number for the number of videos to load");return}i=parseInt(jQuery("#tb-cards-onlyLoadFirstPage-number").val());if(i<=0){TBUtilities.Alert("Please enter a valid number for the number of videos to load");return}}TBYouTubeApi.GetChannelVideos(TBGlobal.CurrentChannelId(),null,B,x,i,null,a.selectedVideo.id);break}jQuery("#tb-cards-method").hide();jQuery("#tb-cards-destination").show();jQuery("#tb-cards-destination-list").hide();jQuery("#tb-cards-loading-videos").show();a.step=3}else if(a.step==3){if(jQuery("#tb-cards-delete-existing").is(":checked")){TBGlobal.AddUserDebugInfo("TubeBuddyCards - Yes, Deleting Existing Cards");jQuery("#tb-cards-delete-existing-warning").show()}else{TBGlobal.AddUserDebugInfo("TubeBuddyCards - No, Not Deleting Existing Cards");jQuery("#tb-cards-delete-existing-warning").hide()}if(jQuery(".tb-cards-destination-row-selected").filter(":visible").length==0&&a.destinationVideos.length==0){if(a.isDeleteOnly)TBUtilities.Alert("Please select at least 1 video to Delete All Cards from.");else TBUtilities.Alert("Please select at least 1 video to copy the cards to.");return}jQuery("#tb-cards-title-block").text("Bulk Copy Cards - Processing");if(a.isDeleteOnly)jQuery("#tb-cards-title-block").text("Bulk Delete Cards - Processing");a.destinationVideos=[];jQuery(".tb-cards-destination-row-selected").filter(":visible").each(function(){var e=jQuery(this).find(".tb-cards-cards-item-options").attr("data-video-id");jQuery.each(a.videos,function(t,i){if(i.id==e){a.destinationVideos.push(i);TBGlobal.AddUserDebugInfo("TubeBuddyCards - Selected Destination Video: https://www.youtube.com/watch?v="+e)}})});jQuery("#tb-cards-queue-list").empty();jQuery("#tb-cards-completed-list").empty();jQuery("#tb-cards-queue-list2").empty();jQuery("#tb-cards-completed-list2").empty();jQuery("#tb-cards-error-list2").empty();if(a.isDeleteOnly){if(n.deleteAll)jQuery("#tb-cards-delete-existing-warning").html("<b>WARNING:</b> You have chosen to automatically delete all existing Cards from <b>"+a.destinationVideos.length+"</b> Video(s)");else{if(n.deleteUrl){if(n.includePartialMatches)jQuery("#tb-cards-delete-existing-warning").html('<b>WARNING:</b> You have chosen to automatically delete all existing Cards that contain the URL: "'+n.deleteUrl+'" [INCLUDING PARTIAL MATCHES] from <b>'+a.destinationVideos.length+"</b> Video(s)");else jQuery("#tb-cards-delete-existing-warning").html('<b>WARNING:</b> You have chosen to automatically delete all existing Cards that contain the URL: "'+n.deleteUrl+'" from <b>'+a.destinationVideos.length+"</b> Video(s)")}else if(n.deleteText){if(n.includePartialTextMatches)jQuery("#tb-cards-delete-existing-warning").html('<b>WARNING:</b> You have chosen to automatically delete all existing Cards that have a Title or Tester Text matching: "'+n.deleteText+'" [INCLUDING PARTIAL MATCHES] from <b>'+a.destinationVideos.length+"</b> Video(s)");else jQuery("#tb-cards-delete-existing-warning").html('<b>WARNING:</b> You have chosen to automatically delete all existing Cards that Title or Tester Text: "'+n.deleteText+'" from <b>'+a.destinationVideos.length+"</b> Video(s)")}}}jQuery("#tb-cards-copy-destination-count").text(a.destinationVideos.length);jQuery("#tb-cards-destination-selected-count").text(a.destinationVideos.length);if(jQuery("#tb-cards-copy-destination-count").text()=="1")jQuery("#tb-cards-copy-destination-count-s").hide();else jQuery("#tb-cards-copy-destination-count-s").show();jQuery("#tb-cards-method").hide();jQuery("#tb-cards-confirm-checkbox").prop("checked",false);a.step=4;jQuery("#tb-cards-destination").hide();if(a.fromBulkSelectMenu==true){jQuery("#tb-cards-title-block").text("Bulk Copy Cards - Step 5")}else{jQuery("#tb-cards-title-block").text("Bulk Copy Cards - Step 4")}if(a.isDeleteOnly)jQuery("#tb-cards-title-block").text("Bulk Delete Cards - Step 4");jQuery("#tb-cards-confirm").show();jQuery("#tb-cards-kickoff").show();jQuery("#tb-cards-continue").hide();if(a.destinationVideos.length>=2e3){jQuery("#tb-cards-2k-warning").show()}else{jQuery("#tb-cards-2k-warning").hide()}}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyCards] [click] #tb-cards-continue, #tb-cards-kickoff"})}});jQuery(document).on("click","#tb-cards-back",function(){TBUtilities.Log(a);if(a.step==2){if(a.isDeleteOnly){jQuery("#tb-delete-options").show();jQuery("#tb-cards-title-block").text("Bulk Delete Cards - Step 1")}else{jQuery("#tb-cards-source").show();if(a.fromBulkSelectMenu==true){jQuery("#tb-cards-back-bulk").show();jQuery("#tb-cards-title-block").text("Bulk Copy Cards - Step 2")}else{jQuery("#tb-cards-title-block").text("Bulk Copy Cards - Step 1")}}jQuery("#tb-cards-method").hide();jQuery("#tb-cards-back").hide();a.step=1}else if(a.step==3){a.step=2;jQuery("#tb-cards-destination").hide();jQuery("#tb-cards-method").show();if(a.fromBulkSelectMenu==true){jQuery("#tb-cards-title-block").text("Bulk Copy Cards - Step 3")}else{jQuery("#tb-cards-title-block").text("Bulk Copy Cards - Step 2")}if(a.isDeleteOnly)jQuery("#tb-cards-title-block").text("Bulk Delete Cards - Step 2");a.specificVideoIds.length=0;a.specificVideos.length=0;jQuery("#tb-cards-input-ids").val("");jQuery("#tb-cards-input-ids-status").hide()}else if(a.step==4){a.step=3;if(a.fromBulkSelectMenu==true){jQuery("#tb-cards-title-block").text("Bulk Copy Cards - Step 4")}else{jQuery("#tb-cards-title-block").text("Bulk Copy Cards - Step 3")}if(a.isDeleteOnly)jQuery("#tb-cards-title-block").text("Bulk Delete Cards - Step 3");jQuery("#tb-cards-destination").show();jQuery("#tb-cards-confirm").hide();jQuery("#tb-cards-kickoff").hide();jQuery("#tb-cards-continue").show();jQuery("#tb-cards-destination-selected-count").text(jQuery("#tb-cards-destination-list").find(".tb-cards-destination-row-selected").filter(":visible").length)}});jQuery(document).on("click",".tb-cards-cards-item",function(){try{var e=jQuery(this).attr("data-card-default-id");TBUtilities.Log("TubeBuddyCards - card clicked, id = "+e);var t=TBUtilities.GetInArray(a.selectedCards,"key",e);if(t==null){var i=TBUtilities.GetInArray(a.cards,"key",e);a.selectedCards.push(i);jQuery(this).addClass("tb-cards-cards-item-selected");jQuery(this).find(".tb-card-item-inner").addClass("tb-card-item-inner-selected")}else{TBUtilities.RemoveFromArray(a.selectedCards,"key",e);jQuery(this).removeClass("tb-cards-cards-item-selected");jQuery(this).find(".tb-card-item-inner").removeClass("tb-card-item-inner-selected")}jQuery("#tb-cards-selected-count").text(a.selectedCards.length);jQuery("#tb-cards-total-count").text(a.cards.length);jQuery("#tb-cards-copy-count").text(a.selectedCards.length);if(a.selectedCards.length==1)jQuery("#tb-cards-copy-count-s").hide();else jQuery("#tb-cards-copy-count-s").show();if(a.selectedCards.length==0){jQuery("#tb-cards-continue").attr("data-tooltip-text","Select at least 1 Card to Copy")}else{jQuery("#tb-cards-continue").removeAttr("disabled");jQuery("#tb-cards-continue").attr("data-tooltip-text","Continue to next step")}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyCards] [click] tb-cards-cards-item"})}})};var f=function(){var e=a.specificVideoIds[0];a.specificVideoIds.splice(0,1);TBYouTubeApi.GetVideoDetails(e,"contentDetails, snippet, id",m)};var m=function(e){if(e!=null)a.specificVideos.push(e);if(a.specificVideoIds.length>0){f()}else{B(a.specificVideos)}};var g=function(){try{a.totalDestinationVideos=a.destinationVideos.length;a.hasFinished=false;a.errorCount=0;a.successCount=0;jQuery("#tb-cards-queue-list").empty();jQuery("#tb-cards-completed-list").empty();jQuery("#tb-cards-queue-list2").empty();jQuery("#tb-cards-completed-list2").empty();jQuery("#tb-cards-error-list2").empty();jQuery("#tb-cards-error-list2").hide();jQuery("#tb-cards-error-none-list2").show();jQuery("#tb-cards-working").show();jQuery("#tb-cards-done").hide();jQuery("#tb-cards-stopped").hide();jQuery.each(a.selectedCards,function(e,t){switch(t.type){case"fundraising":case"merch":case"product":case"associated":{if(t.image_url){if(!a.imageConversionDic[t.image_url]){a.imageConversionDic[t.image_url]=null}}break}}});try{if(a.isDeleteOnly)TBUtilities.AddAction({VideoCount:a.destinationVideos.length,Data:"method = "+a.method},TBUtilities.ActionTypes.BulkDeleteCards_Delete,"bulkdeletecards");else TBUtilities.AddAction({VideoCount:a.destinationVideos.length,CardCount:a.selectedCards.length,Data:"method = "+a.method},TBUtilities.ActionTypes.BulkCopyCards_Copy,"bulkcopycards")}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyCards] [addAction]"})}if(Object.keys(a.imageConversionDic).length>0){for(key in a.imageConversionDic){var e=TBGlobal.host+TBGlobal.apiUrls.imageGetBytes+"?url="+encodeURIComponent(key);TBExtension.Get(e,"CRTBGetImageBytes",{Url:key})}}else{j();v()}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyCards] [startProcessing]"})}};var v=function(){jQuery("#tb-cards-queue-list2").empty();jQuery("#tb-cards-queue-complete-list2").hide();var e=0;jQuery.each(a.destinationVideos,function(t,i){var o=jQuery(".tb-cards-processing-template2:last")[0].outerHTML;o=o.replace("#THUMBNAILURL#",i.snippet.thumbnails.default.url);o=TBUtilities.ReplaceAll(o,"#VIDEOID#",i.id);o=o.replace("#VIDEOTITLE#",i.snippet.title);o=o.replace("#HREF#","https://www.youtube.com/watch?v="+i.id);o=o.replace("display: none","display:flex");jQuery("#tb-cards-queue-list2").prepend(o);e++;if(e==3)return false});if(e==0){jQuery("#tb-cards-queue-complete-list2").show();jQuery("#tb-cards-queue-list2").hide()}else{jQuery("#tb-cards-queue-list2").show()}};var T=function(e){var t=jQuery(".tb-cards-processed-success:last")[0].outerHTML;t=t.replace("#THUMBNAILURL#",e.snippet.thumbnails.default.url);t=TBUtilities.ReplaceAll(t,"#VIDEOID#",e.id);t=t.replace("#VIDEOTITLE#",e.snippet.title);t=t.replace("#HREF#","https://www.youtube.com/cards?video_referrer=watch&v="+e.id);t=t.replace("display:none","display:flex");jQuery("#tb-cards-completed-list2").prepend(t);jQuery("#tb-cards-completed-none-list2").hide();jQuery("#tb-cards-completed-list2").show();a.successCount++;jQuery("#tb-cards-completed-list2-count").text(TBUtilities.FormatNumberWithCommas(a.successCount))};var w=function(e){try{jQuery("#tb-cards-error-copy-container").show();var t=jQuery("#tb-cards-error-copy-container").attr("data-clipboard-text");var i=[];if(t!=""){i=t.split(",");if(i.indexOf(e.id)==-1){i.push(e.id)}}else{i.push(e.id)}jQuery("#tb-cards-error-copy-container").attr("data-clipboard-text",i.join(","))}catch(e){}var o=jQuery(".tb-cards-processed-error:last")[0].outerHTML;o=o.replace("#THUMBNAILURL#",e.snippet.thumbnails.default.url);o=TBUtilities.ReplaceAll(o,"#VIDEOID#",e.id);o=o.replace("#VIDEOTITLE#",e.snippet.title);o=o.replace("#ERROR#",e.error);o=o.replace("#HREF#","https://www.youtube.com/cards?video_referrer=watch&v="+e.id);o=o.replace("display:none","display:block");jQuery("#tb-cards-error-list2").prepend(o);jQuery("#tb-cards-error-list2").show();jQuery("#tb-cards-error-none-list2").hide();a.errorCount++;jQuery("#tb-cards-error-list2-count").text(TBUtilities.FormatNumberWithCommas(a.errorCount))};var j=function(){try{TBUtilities.Log("TubeBuddyCards - next video");jQuery("#tb-cards-progress-container").html("Start &#707;");if(a.isStopped)return;if(a.destinationVideos.length==0&&!a.hasFinished){a.hasFinished=true;jQuery("#tb-cards-status-count").html("<b>"+a.totalDestinationVideos+"</b> of <b>"+a.totalDestinationVideos+"</b> videos complete");jQuery("#tb-cards-progress-container").hide();if(a.currentVideo){if(!a.currentVideo.error)T(a.currentVideo);else w(a.currentVideo)}v();jQuery("#tb-cards-working").hide();jQuery("#tb-cards-done").show();jQuery("#tb-cards-stop").hide();jQuery("#tb-cards-done-close").show();return}var e=a.destinationVideos[0].id;if(jQuery("#tb-cards-delete-existing").is(":checked")&&!a.isDeleteOnly){if(a.videosWithDeletedCards.indexOf(e)==-1){c(e);return}}if(a.currentVideo){if(!a.currentVideo.error)T(a.currentVideo);else w(a.currentVideo)}var t=TBUtilities.RemoveFromArray(a.destinationVideos,"id",e)[0];a.currentVideo=t;jQuery("#tb-cards-status-count").html("<b>"+parseInt(a.totalDestinationVideos-a.destinationVideos.length)+"</b> of <b>"+a.totalDestinationVideos+"</b> videos complete");jQuery("#tb-cards-progress-container").html(jQuery("#tb-cards-progress-container").html()+' Id: <a style="font-weight:normal" target="_blank" href="https://www.youtube.com/watch?v='+e+'">'+e+"</a> &#707;");v();TBGlobal.AddUserDebugInfo("TubeBuddyCards - Getting Video Details for: "+t.id);if(!a.isDeleteOnly)TBYouTubeApi.GetVideoDetails(a.currentVideo.id,null,d);else c(e)}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyCards] [processNextVideo]"});jQuery("#tb-cards-progress-container").html(jQuery("#tb-cards-progress-container").html()+"Error: "+e.message);TBUtilities.Alert('Sorry, there was an error: "'+e.message+'"');jQuery("#tb-cards-stop").trigger("click")}};var Q=function(e,t){a.currentVideo.error=t;j()};var x=function(e){if(e.totalCount-e.loaded>50){jQuery("#tb-cards-loading-count").attr("data-auto-count",e.loaded);var t=e.totalCount;if(jQuery("#tb-cards-onlyLoadFirstPage").is(":checked")){t=parseInt(jQuery("#tb-cards-onlyLoadFirstPage-number").val())}jQuery("#tb-cards-loading-count-total").text(t);TBUtilities.AutoIncrementCount(jQuery("#tb-cards-loading-count"))}else{jQuery("#tb-cards-rendering").show();jQuery("#tb-cards-loading-count-container").hide()}};var B=function(e){try{if(e==null){if(a.method==0)TBUtilities.Alert("No valid Video IDs found");else if(a.method==1)TBUtilities.Alert("Invalid Playlist Id or no videos found in playlist");else if(a.method==2)TBUtilities.Alert("No videos matching your search");else if(a.method==3)TBUtilities.Alert("No videos found or failed to load. Try again.");jQuery("#tb-cards-back").trigger("click");return}else if(e.length==0){if(a.method==0)TBUtilities.Alert("No valid Video IDs found");else if(a.method==1)TBUtilities.Alert("Invalid Playlist Id or no videos found in playlist");else if(a.method==2)TBUtilities.Alert("No videos matching your search");else if(a.method==3)TBUtilities.Alert("No videos found or failed to load. Try again.");jQuery("#tb-cards-back").trigger("click");return}a.videos=[];jQuery("#tb-cards-destination-list").empty();var t=jQuery(".tb-cards-destination-row:last")[0].outerHTML;var i=jQuery(".tb-cards-destination-option-associated-row:last")[0].outerHTML;var o=jQuery(".tb-cards-destination-option-fundraising-row:last")[0].outerHTML;var n=jQuery(".tb-cards-destination-option-video-row:last")[0].outerHTML;var r=jQuery(".tb-cards-destination-option-playlist-row:last")[0].outerHTML;var s=jQuery(".tb-cards-destination-option-merch-row:last")[0].outerHTML;var l=jQuery(".tb-cards-destination-option-tip-row:last")[0].outerHTML;var d=jQuery(".tb-cards-destination-option-collaborator-row")[0].outerHTML;var u=jQuery(".tb-cards-destination-option-poll-row")[0].outerHTML;jQuery.each(e,function(e,c){var p=false;if(c.id==a.selectedVideo.id)p=true;if(c.snippet.resourceId!=null)if(c.snippet.resourceId.videoId==a.selectedVideo.id)p=true;if(c.id.videoId!=null){c.id=c.id.videoId}if(!p){if(c.snippet.resourceId!=null)c.id=c.snippet.resourceId.videoId;if(c.snippet!=null&&c.snippet.title=="Deleted video"&&c.snippet.thumbnails==null)return;a.videos.push(c);var b=t;var y=c.snippet.thumbnails.thumbnailMedium?c.snippet.thumbnails.thumbnailMedium:c.snippet.thumbnails.thumbnailDefault;b=b.replace("#VIDEOTITLE#",c.snippet.title);b=TBUtilities.ReplaceAll(b,"#VIDEOID#",c.id);b=b.replace("#VIDEOTHUMBNAIL#",y);if(c.status)b=b.replace("#PRIVACY#",c.status.privacy);if(a.isDeleteOnly){b=TBUtilities.ReplaceAll(b,"#CUSTOMDISPLAY#","display:none;");jQuery("#tb-cards-expandcollapse-containers").hide()}else{b=TBUtilities.ReplaceAll(b,"#CUSTOMDISPLAY#","");jQuery("#tb-cards-expandcollapse-containers").show()}var h="";jQuery.each(a.selectedCards,function(e,t){var a=null;switch(t.type){case"product":case"associated":{a=i;a=a.replace("#TITLE#",t.title);a=a.replace("#CALL#",t.custom_message);a=a.replace("#LINK#",t.target_url);a=a.replace("#VIDEOID#",c.id);a=a.replace("#TEASER#",t.teaser_text);a=a.replace("#DATA-CARD-DEFAULT-ID#",t.key);break}case"fundraising":{a=o;a=a.replace("#TITLE#",t.title);a=a.replace("#CALL#",t.custom_message);a=a.replace("#LINK#",t.target_url);a=a.replace("#VIDEOID#",c.id);a=a.replace("#TEASER#",t.teaser_text);a=a.replace("#DATA-CARD-DEFAULT-ID#",t.key);break}case"video":{a=n;a=a.replace("#LINK#",t.target_url);a=a.replace("#VIDEOID#",c.id);a=a.replace("#DATA-CARD-DEFAULT-ID#",t.key);a=a.replace("#CALL#",t.custom_message);a=a.replace("#TEASER#",t.teaser_text);break}case"playlist":{a=r;a=a.replace("#LINK#",t.target_url);a=a.replace("#VIDEOID#",c.id);a=a.replace("#DATA-CARD-DEFAULT-ID#",t.key);a=a.replace("#CALL#",t.custom_message);a=a.replace("#TEASER#",t.teaser_text);break}case"merch":{a=s;a=a.replace("#TITLE#",t.title);a=a.replace("#CALL#",t.custom_message);a=a.replace("#LINK#",t.target_url);a=a.replace("#VIDEOID#",c.id);a=a.replace("#TEASER#",t.teaser_text);a=a.replace("#DATA-CARD-DEFAULT-ID#",t.key);break}case"tip":{a=l;a=a.replace("#VIDEOID#",c.id);a=a.replace("#DATA-CARD-DEFAULT-ID#",t.key);break}case"collaborator":{a=d;a=a.replace("#TITLE#",t.title);a=a.replace("#CHANNELURL#",t.channel_url);a=a.replace("#CALL#",t.custom_message);a=a.replace("#TEASER#",t.teaser_text);a=a.replace("#VIDEOID#",c.id);a=a.replace("#DATA-CARD-DEFAULT-ID#",t.key);break}case"poll":{var p="";jQuery.each(t.choices,function(e,t){p+=' <input class="tb-cards-link-edit tb-cards-poll-choice tb-material-input tb-card-item-input" maxlength="30" type="text" value="'+t+'" /><br/>'});a=u;a=a.replace("#TITLE#",t.title);a=a.replace("#TEASER#",t.teaser_text);a=a.replace("#DATA-CARD-DEFAULT-ID#",t.key);a=a.replace("#VIDEOID#",c.id);a=a.replace("#CHOICES#",p);break}}h+=a});b=b.replace("#OPTIONS#",h);jQuery("#tb-cards-destination-list").append(b);jQuery("#tb-cards-destination-total-count").text(a.videos.length)}});if(a.method==0||a.method==1)jQuery("#tb-cards-select-all-checkboxes").trigger("click");jQuery("#tb-cards-destination").show();jQuery("#tb-cards-method").hide();jQuery("#tb-cards-destination-list").show();jQuery("#tb-cards-loading-videos").hide()}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyCards] [gotVideoList]"})}};var k=function(){TubeBuddyYouTubeActions.GetCardsList(a.selectedVideo.id,TubeBuddyCards.GetCardsListCallback)};var L=function(){jQuery(document.body).on("CRTBGetImageBytes",function(e,t){try{if(t.success){var i=JSON.parse(t.response);a.imageConversionDic[t.data.Url]=i}else{a.imageConversionDic[t.data.Url]=""}var o=0;for(var n in a.imageConversionDic){var r=a.imageConversionDic[n];if(r!=null){o++}}if(Object.keys(a.imageConversionDic).length==o){j();v()}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyCards] CRTBGetImageBytes"})}});jQuery(document.body).on("CRTBLoadCardsTemplate",function(e,t){try{if(t.success){t.response=TBUtilities.FixLocalHtml(DOMPurify.sanitize(t.response,DOMPurifyConfig));jQuery("body").append(t.response);if(a.isDeleteOnly){A()}else{S()}}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyCards] CRTBLoadCardsTemplate"})}})};var U=function(){try{jQuery("#tb-cards-back-bulk").hide();jQuery("#tb-cards-fetching").show();if(a.fromBulkSelectMenu==true){jQuery("#tb-cards-back-bulk").show()}jQuery("#tb-cards-error-copy-container").hide();jQuery("#tb-cards-error-copy-container").attr("data-clipboard-text","");var e=new ClipboardJS("#tb-cards-error-copy-container");jQuery("#tb-cards-error-list2-count").text("0");jQuery("#tb-cards-selected-count").text("0");jQuery("#tb-cards-total-count").text("0");jQuery("#tb-cards-destination-selected-count").text("0");jQuery("#tb-cards-header-image").attr("src",a.selectedVideo.thumbnail);jQuery("#tb-cards-featured-thumbnail").attr("src",a.selectedVideo.thumbnail);jQuery("#tb-cards-method").hide();jQuery(".tb-cards-filter").val("all");jQuery("#tb-cards-completed-list2-count").text("0");if(a.isDeleteOnly){jQuery("#tb-cards-thumbnail").hide();jQuery("#tb-cards-title").hide();jQuery("#tb-cards-help-link").attr("href",TBGlobal.host+"/tools?tool=bulkdeletecards");jQuery("#tb-cards-title-block").text("Bulk Delete Cards - Step 1");jQuery("#tb-cards-back-bulk").hide();jQuery("#tb-cards-stop").text("Stop Deleting");jQuery(".tb-module-embed-video").hide()}else{jQuery(".tb-module-embed-video").show();jQuery("#tb-cards-thumbnail").attr("src",a.selectedVideo.thumbnail);jQuery("#tb-cards-title").text(a.selectedVideo.title);jQuery("#tb-cards-title").attr("href","https://www.youtube.com/watch?v="+a.selectedVideo.id);jQuery("#tb-cards-thumbnail").show();jQuery("#tb-cards-title").show();jQuery("#tb-cards-help-link").attr("href",TBGlobal.host+"/tools?tool=bulkcopycards");if(a.fromBulkSelectMenu==true){jQuery("#tb-cards-title-block").text("Bulk Copy Cards - Step 2")}else{jQuery("#tb-cards-title-block").text("Bulk Copy Cards - Step 1")}jQuery("#tb-cards-stop").text("Stop Copying")}jQuery("#tb-cards-status").hide();jQuery("#tb-cards-confirm").hide();jQuery("#tb-cards-bulk-description-updates-container").hide();jQuery("#tb-cards-featured-content-container").hide();jQuery("#tb-cards-kickoff").hide();jQuery("#tb-cards-summary-container").hide();jQuery("#tb-cards-featured-video-status-complete").hide();jQuery("#tb-cards-featured-video-status-processing").hide();jQuery("#tb-cards-bulk-descriptions-status-complete").hide();jQuery("#tb-cards-bulk-descriptions-status-processing").hide();jQuery("#tb-cards-success").hide();jQuery("#tb-cards-back").hide();jQuery("#tb-cards-container").fadeIn();jQuery("#tb-cards-methods-container").fadeIn();jQuery("#tb-cards-none").hide();jQuery("#tb-cards-has").hide();jQuery("#tb-cards-stop").hide();jQuery("#tb-cards-done-close").hide();jQuery("#tb-cards-destination").hide();jQuery("#tb-cards-source").show();jQuery("#tb-cards-input-ids").val("");jQuery("#tb-cards-input-ids-status").text("");jQuery("#tb-cards-method-full").prop("checked","checked");jQuery("#tb-cards-onlyLoadFirstPage-number").prop("disabled",true);jQuery("#tb-cards-onlyLoadFirstPage").prop("checked",false);var t=jQuery("#tb-cards-input-playlist").playlistSelect({tbMaterial:true,singleSelectMode:true,onSelect:function(e){a.playlistId=e}}).data("plugin_playlistSelect");jQuery(".tb-playlist-select-manual-id-invalid").hide();jQuery("#tb-cards-input-playlist").find(".tb-material-input").addClass("tb-bulk-input");jQuery("#tb-cards-input-playlist").find(".tb-material-radio-label").addClass("tb-bulk-radio-label");t.disable();if(!a.isDeleteOnly){jQuery("#tb-cards-continue").attr("disabled","disabled");jQuery("#tb-cards-step-2-title").text("Which videos do you want to copy the selected Card(s) to?");jQuery("#tb-cards-what-videos2").text("Which videos do you want to copy the selected Card(s) to?");jQuery("#tb-cards-additional-options-containers").show();jQuery("#tb-cards-delete-existing").prop("checked",false);jQuery("#tb-cards-header-image").hide();jQuery("#tb-cards-confirm-statement").show();jQuery("#tb-cards-confirm-text").text("copying");jQuery("#tb-cards-kickoff").text("Start Copying!");jQuery("#tb-cards-delete-existing-warning").html("<b>WARNING:</b> You have chosen to automatically delete all existing cards from the destination videos before copying new cards to them.");jQuery("#tb-delete-options").hide();jQuery("#tb-cards-source").show();jQuery(".tb-bulk-expand").show()}else{jQuery("#tb-cards-step-2-title").text("Which videos do you want to delete Cards from?");jQuery("#tb-cards-what-videos2").text("Which videos do you want to delete Cards from?");jQuery("#tb-cards-additional-options-containers").hide();jQuery("#tb-cards-delete-existing").prop("checked",true);jQuery("#tb-cards-header-image").hide();jQuery("#tb-cards-confirm-statement").hide();jQuery("#tb-cards-confirm-text").text("delete");jQuery("#tb-cards-kickoff").text("Start Deleting!");jQuery("#tb-cards-continue").show();jQuery("#tb-cards-continue").removeAttr("disabled");jQuery("#tb-delete-options").show();jQuery("#tb-cards-source").hide();jQuery(".tb-bulk-expand").hide()}}catch(e){TBUtilities.LogError({Exception:e,Location:"[CardsPrompt] prepareDialog"})}};var C=function(e){try{a.allData=e;if(e.feature_templates.length==0){a.cards=[];jQuery("#tb-cards-none").show();jQuery("#tb-cards-continue").hide();jQuery("#tb-cards-done-close").show()}else{a.cards=e.feature_templates;jQuery("#tb-cards-total-count").text(a.cards.length);jQuery("#tb-cards-has").show();jQuery("#tb-cards-continue").show();jQuery("#tb-cards-done-close").hide()}jQuery("#tb-cards-list").empty();TBGlobal.AddUserDebugInfo("TubeBuddyCards - Cards Returned");TBGlobal.AddUserDebugInfo(JSON.stringify(e));var t=a.cards.length;for(var i=0;i<t;i++){var o=a.cards[i];switch(o.type){case"collaborator":{var n=o.teaser_text;if(n==null||n.length===0){n=o.custom_message}jQuery("#tb-cards-list").append('<div class="tb-cards-cards-item tb-card-item" data-card-default-id="'+o.key+'" ><div class="tb-card-item-inner"> <div class="tb-card-item-type">Channel</div><div class="tb-card-item-input-label">Title</div><input class="tb-cards-default-setting tb-cards-collaborator-title tb-material-input tb-card-item-input" type="text" maxlength="50" data-card-default-id="'+o.key+'" value="'+o.title+'" /><div class="tb-card-item-input-label">Channel Url</div><input class="tb-cards-default-setting tb-cards-collaborator-channelurl tb-material-input tb-card-item-input" type="text" maxlength="60" data-card-default-id="'+o.key+'" value="'+o.channel_url+'" /><div class="tb-card-item-input-label">Custom Message</div><input class="tb-cards-default-setting  tb-cards-collaborator-custom-message tb-material-input tb-card-item-input" type="text" maxlength="30" data-card-default-id="'+o.key+'" value="'+o.custom_message+'" /><div class="tb-card-item-input-label">Teaser Text</div><input class="tb-cards-default-setting tb-cards-collaborator-teaser tb-material-input tb-card-item-input" type="text" maxlength="30" data-card-default-id="'+o.key+'" value="'+n+'" /><div><div class="tb-card-item-input-label">Start Time</div><div class="tb-margin-left10 tb-margin-top5">'+TBUtilities.ReplaceAll(TBUtilities.MilliSecondsToTime(o.start_ms),":"," ")+"</div></div></div></div>");break}case"product":case"associated":{var n=o.teaser_text;if(n==null||n.length===0){n=o.custom_message}jQuery("#tb-cards-list").append('<div class="tb-cards-cards-item tb-card-item" data-card-default-id="'+o.key+'"><div class="tb-card-item-inner"><div class="tb-card-item-type"><img style="height:20px; float:right;" src="'+o.image_url+'"/>Associated website</div><div></div><div class="tb-card-item-input-label">Title</div> <input class="tb-cards-default-setting tb-cards-associated-title tb-material-input tb-card-item-input" type="text" maxlength="50" data-card-default-id="'+o.key+'" value="'+o.title+'" /><div class="tb-card-item-input-label">Call to Action</div> <input class="tb-cards-default-setting tb-cards-associated-custom-message tb-material-input tb-card-item-input" type="text" maxlength="30" data-card-default-id="'+o.key+'" value="'+o.custom_message+'" /><div class="tb-card-item-input-label">URL</div> <input class="tb-cards-default-setting tb-cards-associated-target-url tb-material-input tb-card-item-input" type="text" data-card-default-id="'+o.key+'" value="'+o.target_url+'" /><div class="tb-card-item-input-label">Teaser Text</div> <input class="tb-cards-default-setting tb-cards-associated-teaser tb-material-input tb-card-item-input" type="text" maxlength="30" data-card-default-id="'+o.key+'" value="'+n+'" /><div><div class="tb-card-item-input-label">Start Time</div><div class="tb-margin-left10 tb-margin-top5">'+TBUtilities.ReplaceAll(TBUtilities.MilliSecondsToTime(o.start_ms),":"," ")+"</div></div></div></div>");break}case"fundraising":{var r=o.teaser_text;if(r==null||r.length===0){r=o.custom_message}jQuery("#tb-cards-list").append('<div class="tb-cards-cards-item tb-card-item" data-card-default-id="'+o.key+'"><div class="tb-card-item-inner"><div class="tb-card-item-type"><img style="height:20px; float:right;" src="'+o.image_url+'"/>Fundraising</div><div></div><div class="tb-card-item-input-label">Title</div><input class="tb-cards-default-setting tb-cards-fundraising-title tb-material-input tb-card-item-input" type="text" maxlength="50" data-card-default-id="'+o.key+'" value="'+o.title+'" /><div class="tb-card-item-input-label">Call to Action</div><input class="tb-cards-default-setting tb-cards-fundraising-custom-message tb-material-input tb-card-item-input" type="text" maxlength="30" data-card-default-id="'+o.key+'" value="'+o.custom_message+'" /><div class="tb-card-item-input-label">URL</div><input class="tb-cards-default-setting tb-cards-fundraising-target-url tb-material-input tb-card-item-input" type="text" data-card-default-id="'+o.key+'" value="'+o.target_url+'" /><div class="tb-card-item-input-label">Teaser Text</div><input class="tb-cards-default-setting tb-cards-fundraising-teaser tb-material-input tb-card-item-input" type="text" maxlength="30" data-card-default-id="'+o.key+'" value="'+r+'" /><div><div class="tb-card-item-input-label">Start Time</div><div class="tb-margin-left10 tb-margin-top5">'+TBUtilities.ReplaceAll(TBUtilities.MilliSecondsToTime(o.start_ms),":"," ")+"</div></div></div></div>");break}case"merch":{var s=o.teaser_text;if(s==null||s.length===0){s=o.custom_message}jQuery("#tb-cards-list").append('<div class="tb-cards-cards-item tb-card-item" data-card-default-id="'+o.key+'"  ><div class="tb-card-item-item-inner"><div class="tb-card-item-type"><img style="height:20px; float:right;" src="'+o.image_url+'"/>Merchandise</div><div></div><div class="tb-card-item-input-label">Title</div><input class="tb-cards-default-setting tb-cards-merch-title tb-material-input tb-card-item-input" type="text"  maxlength="50" data-card-default-id="'+o.key+'" value="'+o.title+'" /><div class="tb-card-item-input-label">Call to Action</div><input class="tb-cards-default-setting tb-cards-merch-custom-message tb-material-input tb-card-item-input" type="text" maxlength="30" data-card-default-id="'+o.key+'" value="'+o.custom_message+'" /><div class="tb-card-item-input-label">URL</div><input class="tb-cards-default-setting tb-cards-merch-target-url tb-material-input tb-card-item-input" type="text" data-card-default-id="'+o.key+'" value="'+o.target_url+'" /><div class="tb-card-item-input-label">Teaser Text</div><input class="tb-cards-default-setting tb-cards-merch-teaser tb-material-input tb-card-item-input" type="text" maxlength="30" data-card-default-id="'+o.key+'" value="'+s+'" /><div><div class="tb-card-item-input-label">Start Time</div><div class="tb-margin-left10 tb-margin-top5">'+TBUtilities.ReplaceAll(TBUtilities.MilliSecondsToTime(o.start_ms),":"," ")+"</div></div></div></div>");break}case"video":{jQuery("#tb-cards-list").append('<div class="tb-cards-cards-item tb-card-item" data-card-default-id="'+o.key+'"><div class="tb-card-item-inner"><div class="tb-card-item-type">Video</div><div class="tb-card-item-input-label">URL</div><input class="tb-cards-default-setting tb-cards-video-url tb-material-input tb-card-item-input" type="text" data-card-default-id="'+o.key+'" value="'+o.target_url+'" /><div class="tb-card-item-input-label">Custom Message</div><input class="tb-cards-default-setting tb-cards-video-custom-message tb-material-input tb-card-item-input" type="text" maxlength="30" data-card-default-id="'+o.key+'" value="'+o.custom_message+'" /><div class="tb-card-item-input-label">Teaser Text</div><input class="tb-cards-default-setting tb-cards-video-teaser tb-material-input tb-card-item-input" type="text" maxlength="30" data-card-default-id="'+o.key+'" value="'+o.teaser_text+'" /><div><div class="tb-card-item-input-label">Start Time</div><div class="tb-margin-left5 tb-margin-top5">'+TBUtilities.ReplaceAll(TBUtilities.MilliSecondsToTime(o.start_ms),":"," ")+"</div></div></div></div>");break}case"playlist":{jQuery("#tb-cards-list").append('<div class="tb-cards-cards-item tb-card-item" data-card-default-id="'+o.key+'"  ><div class="tb-card-item-inner"><div class="tb-card-item-type">Playlist</div><div class="tb-card-item-input-label">URL</div><input class="tb-cards-default-setting tb-cards-playlist-url tb-material-input tb-card-item-input" type="text" data-card-default-id="'+o.key+'" value="'+o.target_url+'" /><div class="tb-card-item-input-label">Custom Message</div><input class="tb-cards-default-setting tb-cards-playlist-custom-message tb-material-input tb-card-item-input" type="text" maxlength="30" data-card-default-id="'+o.key+'" value="'+o.custom_message+'" /><div class="tb-card-item-input-label">Teaser Text</div><input class="tb-cards-default-setting tb-cards-playlist-teaser tb-material-input tb-card-item-input" type="text" maxlength="30" data-card-default-id="'+o.key+'" value="'+o.teaser_text+'" /><div><div class="tb-card-item-input-label">Start Time</div><div class="tb-margin-left5 tb-margin-top5">'+TBUtilities.ReplaceAll(TBUtilities.MilliSecondsToTime(o.start_ms),":"," ")+"</div></div></div></div>");break}case"tip":{jQuery("#tb-cards-list").append('<div class="tb-cards-cards-item tb-card-item" data-card-default-id="'+o.key+'"><div class="tb-card-item-inner"><div class="tb-card-item-type">Fan Funding</div><div><div class="tb-card-item-input-label">Start Time</div><div class="tb-margin-top5 tb-margin-left5">'+TBUtilities.ReplaceAll(TBUtilities.MilliSecondsToTime(o.start_ms),":"," ")+"</div></div></div></div>");break}case"poll":{var l="";jQuery.each(o.choices,function(e,t){l+='<input class="tb-cards-default-setting tb-cards-poll-choice tb-material-input tb-card-item-input" type="text" maxlength="30" value="'+t+'" />'});jQuery("#tb-cards-list").append('<div class="tb-cards-cards-item tb-card-item" data-card-default-id="'+o.key+'"><div class="tb-card-item-inner"><div class="tb-card-item-type">Poll</div><div class="tb-card-item-input-label">Title</div><input class="tb-cards-default-setting tb-cards-poll-title tb-material-input tb-card-item-input" type="text" maxlength="50" data-card-default-id="'+o.key+'" value="'+o.title+'" /><div class="tb-card-item-input-label">Teaser Text</div><input class="tb-cards-default-setting tb-cards-poll-teaser tb-material-input tb-card-item-input" type="text" maxlength="30" data-card-default-id="'+o.key+'" value="'+o.teaser_text+'" /><div class="tb-card-item-input-label">Poll Choices</div><div style="margin-left:5px;max-height: 50px; overflow: auto;">'+l+'</div><div><div class="tb-card-item-input-label">Start Time</div><div class="tb-margin-left5 tb-margin-top5">'+TBUtilities.ReplaceAll(TBUtilities.MilliSecondsToTime(o.start_ms),":"," ")+"</div></div></div></div>");break}}}jQuery("#tb-cards-select-all-cards").click();jQuery("#tb-cards-fetching").hide()}catch(t){t.resultData=e;TBUtilities.LogError({Exception:t,Location:"[TubeBuddyCards] CRTBLoadCardsForVideo"})}};var A=function(){try{a.cards=[];a.selectedCards=[];a.videos=[];a.destinationVideos=[];a.currentVideo=null;a.duration=null;a.totalVideoMiliseconds=null;a.isStopped=false;a.videosWithDeletedCards=[];a.specificVideoIds.length=0;a.specificVideos.length=0;a.method=3;a.imageConversionDic={};TBGlobal.AddUserDebugInfo(JSON.stringify(TBGlobal.Profile()));r();U()}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyCards] show"})}};var S=function(){try{a.cards=[];a.selectedCards=[];a.videos=[];a.destinationVideos=[];a.currentVideo=null;a.duration=null;a.totalVideoMiliseconds=null;a.isStopped=false;a.videosWithDeletedCards=[];a.specificVideoIds.length=0;a.specificVideos.length=0;a.method=3;r();U();jQuery("#tb-cards-back").hide()}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyCards] showDelete"})}};return{CardDeleteDelay:function(){return o},CardCopyDelay:function(){return i},GetCardsListCallback:function(e){C(e)},ProcessNextVideo:function(e,t,i,o){if(o)a.currentVideo.error=o;j()},CheckForErrors:function(e,t,i,o){if(o)a.currentVideo.error=o},DeleteAllCardsCallBack:function(e,t,i){y(e,t,i)},Show:function(t,i,o,n){TBGlobal.ClearUserDebugInfo();TBGlobal.AddUserDebugInfo("TubeBuddyCards - Opening Cards");if(TBGlobal.IsAuthenticated()){a.isDeleteOnly=false;a.selectedVideo.id=t;a.selectedVideo.title=i;a.selectedVideo.thumbnail=o;a.step=1;a.fromBulkSelectMenu=n;if(!e){L();s();h();e=true}else{A()}}},ShowDelete:function(){TBGlobal.ClearUserDebugInfo();TBGlobal.AddUserDebugInfo("TubeBuddyCards - Opening Cards - Delete Mode");if(TBGlobal.IsAuthenticated()){a.selectedVideo.id="";a.selectedVideo.title="";a.selectedVideo.thumbnail="";a.step=1;a.isDeleteOnly=true;if(!e){L();s();h();e=true}else{S()}}},CheckCardStartMs:function(e,t,i){p(e,t,i)}}}();var TubeBuddyFindAndReplace=function(){var e=false;var t={ids:0,playlist:1,search:2,all:3,recent:4};var i={replace:1,appendAfter:2,appendBefore:3,remove:4,find:5,appendDescription:6,prependDescription:7,replaceDescription:8,trimDescription:9};var o={findText:"",replaceWith:"",replaceTitles:true,replaceDescriptions:true,findCount:0,channelVideoCount:0,actionType:i.replace,removeLineBreaks:false,removeBlankLines:false,method:t.all,specificVideoIds:[],specificVideos:[],playlistId:"",validPlaylistIds:[],search:"",videoEntity:null,videos:[],destinationVideos:[],currentVideo:null,isStopped:false,failedVideos:[],caseSensitive:false,matchWholeWord:true,affectsAllVideos:false};var a=function(){try{}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyFindAndReplace] [loadData]"})}};var n=function(e){if(e.totalCount-e.loaded>50){jQuery("#tb-findandreplace-loading-count").attr("data-auto-count",e.loaded);var t=e.totalCount;if(jQuery("#tb-findandreplace-onlyLoadFirstPage").is(":checked")){t=parseInt(jQuery("#tb-findandreplace-onlyLoadFirstPage-number").val())}jQuery("#tb-findandreplace-loading-count-total").text(t);TBUtilities.AutoIncrementCount(jQuery("#tb-findandreplace-loading-count"))}else{jQuery("#tb-findandreplace-rendering").show();jQuery("#tb-findandreplace-loading-count-container").hide()}};var r=function(){var e=TBGlobal.host+"/ModuleManager/findandreplace/findandreplace?v="+TBGlobal.versionNumber;if(loadLocalHTML&&(TBExtension.GetType()=="chrome"||TBExtension.GetType()=="firefox")){e=chrome.extension.getURL("modules/findandreplace.html")}else if(loadLocalHTML&&TBExtension.GetType()=="safari"){e="modules/findandreplace.html"}TBExtension.Get(e,"CRTBLoadFindAndReplaceTemplate")};var s=function(e){o.videoEntity=e;o.duration=new timelord(e.contentDetails.duration);o.totalVideoMiliseconds=o.duration.ticks()};var l=function(){jQuery(document).on("click","#tb-findandreplace-error-copy-container",function(){jQuery(this).attr("src","https://www.tubebuddy.com/images/icons/check.png");window.setTimeout(function(){jQuery("#tb-findandreplace-error-copy").attr("src","https://www.tubebuddy.com/images/icons/copy.png")},1500)});jQuery(document).on("click","#tb-findandreplace-onlyLoadFirstPage",function(e){if(jQuery(this).is(":checked")){jQuery("#tb-findandreplace-onlyLoadFirstPage-number").prop("disabled",false)}else{jQuery("#tb-findandreplace-onlyLoadFirstPage-number").prop("disabled",true)}});jQuery(document).on("click",".tb-findandreplace-default-setting",function(e){e.stopPropagation()});jQuery(document).on("click","#tb-findandreplace-done-close, #tb-findandreplace-cancel, .tb-findandreplace-closex",function(){try{TubeBuddyMenu.HideBackground();jQuery("#tb-findandreplace-container").hide();o.step=1}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyFindAndReplace] [click] tb-findandreplace-close"})}});jQuery(document).on("click","#tb-findandreplace-method-ids, #tb-findandreplace-method-playlist, #tb-findandreplace-method-search, #tb-findandreplace-method-full",function(e){o.method=parseInt(jQuery(this).attr("data-method"));var t=jQuery("#tb-findandreplace-input-playlist").playlistSelect({tbMaterial:true,singleSelectMode:true,onSelect:function(e){o.playlistId=e}}).data("plugin_playlistSelect");switch(o.method){case 0:jQuery("#tb-findandreplace-input-ids").removeAttr("disabled","disabled");jQuery("#tb-findandreplace-input-playlist").attr("disabled","disabled");jQuery("#tb-findandreplace-input-search").attr("disabled","disabled");t.disable();break;case 1:jQuery("#tb-findandreplace-input-ids").attr("disabled","disabled");jQuery("#tb-findandreplace-input-playlist").removeAttr("disabled","disabled");jQuery("#tb-findandreplace-input-search").attr("disabled","disabled");t.enable();t.showDropDown();break;case 2:jQuery("#tb-findandreplace-input-ids").attr("disabled","disabled");jQuery("#tb-findandreplace-input-playlist").attr("disabled","disabled");jQuery("#tb-findandreplace-input-search").removeAttr("disabled","disabled");t.disable();break;case 3:jQuery("#tb-findandreplace-input-ids").attr("disabled","disabled");jQuery("#tb-findandreplace-input-playlist").attr("disabled","disabled");jQuery("#tb-findandreplace-input-search").attr("disabled","disabled");t.disable();break}});jQuery(document).on("change keypress keyup paste keydown blur","#tb-findandreplace-input-playlist",function(e){o.playlistId="";var t=jQuery(this).val().trim();t=TBUtilities.ReplaceAll(t,'"',"");if(t.length==0){jQuery("#tb-findandreplace-input-playlist-status").hide();return}if(t.indexOf("list=")>0){t=t.substring(t.indexOf("list=")+5)}if(t.length!=18&&t.length!=34||t.substring(0,2)!="PL"){jQuery("#tb-findandreplace-input-playlist-status").text("Invalid Playlist Id");jQuery("#tb-findandreplace-input-playlist-status").css("color","red")}else{jQuery("#tb-findandreplace-input-playlist-status").text("Valid Playlist Id");jQuery("#tb-findandreplace-input-playlist-status").css("color","green");o.playlistId=t}jQuery("#tb-findandreplace-input-playlist-status").show()});jQuery(document).on("change keypress keyup paste keydown blur","#tb-findandreplace-input-search",function(e){o.search=jQuery(this).val().trim()});jQuery(document).on("change keypress keyup paste keydown blur","#tb-findandreplace-input-ids",function(e){var t=jQuery(this).val().trim();t=TBUtilities.ReplaceAll(t,'"',"");if(t.length==0){jQuery("#tb-findandreplace-input-ids-status").hide();return}jQuery("#tb-findandreplace-input-ids-status").show();o.specificVideoIds=[];if(t.indexOf(",")>-1){o.specificVideoIds=t.split(",")}else{o.specificVideoIds=t.split(" ")}for(var i=0;i<o.specificVideoIds.length;i++){o.specificVideoIds[i]=o.specificVideoIds[i].trim();o.specificVideoIds[i]=o.specificVideoIds[i].replace("https://www.youtube.com/watch?v=","");o.specificVideoIds[i]=o.specificVideoIds[i].replace("https://youtu.be/","");if(o.specificVideoIds[i].length!=11){o.specificVideoIds.splice(i,1);i--}}if(o.specificVideoIds.length==0){jQuery("#tb-findandreplace-input-ids-status").text("No videos detected");jQuery("#tb-findandreplace-input-ids-status").css("color","red")}else if(o.specificVideoIds.length==1){jQuery("#tb-findandreplace-input-ids-status").text("1 video detected");jQuery("#tb-findandreplace-input-ids-status").css("color","green");jQuery("#tb-findandreplace-method-ids").prop("checked",true);jQuery("#tb-findandreplace-method-ids").trigger("click")}else{jQuery("#tb-findandreplace-input-ids-status").text(o.specificVideoIds.length+" videos detected");jQuery("#tb-findandreplace-input-ids-status").css("color","green");jQuery("#tb-findandreplace-method-ids").prop("checked",true);jQuery("#tb-findandreplace-method-ids").trigger("click")}});jQuery(document).on("click",".tb-findandreplace-checkbox-include",function(){try{if(jQuery(this).is(":checked")){if(!TBGlobal.CanAccessLevel2Tools()&&jQuery("#tb-findandreplace-destination-list").find(".tb-findandreplace-checkbox-include:checked").length>1){jQuery(this).prop("checked",false);TBGlobal.ShowUpgradePage("find/replace/append/delete in bulk (more than 1 video at a time)","bulkfindreplaceappend");return}jQuery(this).closest(".tb-findandreplace-destination-row").addClass("tb-findandreplace-destination-row-selected")}else{jQuery(this).closest(".tb-findandreplace-destination-row").removeClass("tb-findandreplace-destination-row-selected")}jQuery("#tb-findandreplace-destination-selected-count").text(jQuery("#tb-findandreplace-destination-list").find(".tb-findandreplace-checkbox-include").filter(":visible").filter(":checked").length)}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyFindAndReplace] [click] tb-findandreplace-checkbox-include"})}});jQuery(document).on("click","#tb-findandreplace-select-all-checkboxes",function(){if(!TBGlobal.CanAccessLevel2Tools()&&o.findCount>1){TBGlobal.ShowUpgradePage("find/replace/append/delete in bulk (more than 1 video at a time)","bulkfindreplaceappend");return}jQuery(".tb-findandreplace-checkbox-include:visible").prop("checked",false);jQuery(".tb-findandreplace-checkbox-include:visible").trigger("click")});jQuery(document).on("click",".tb-findandreplace-more-info",function(){TBGlobal.ShowUpgradePage("find/replace/append/delete in bulk (more than 1 video at a time)","bulkfindreplaceappend")});jQuery(document).on("click","#tb-findandreplace-select-no-checkboxes",function(){jQuery(".tb-findandreplace-checkbox-include:visible").prop("checked",true);jQuery(".tb-findandreplace-checkbox-include:visible").trigger("click")});jQuery(document).on("click",".tb-findandreplace-search",function(){var e=jQuery(this).attr("data-video-id");var t=TBUtilities.GetInArray(o.videos,"id",e);var a=t.snippet.description;a=TBUtilities.ReplaceAll(a,"\n","<br />");if(o.actionType!=i.trimDescription)a=TBUtilities.ReplaceAll(a,o.findText,'<span style="background-color:#ffff66;">'+o.findText+"</span>",!o.caseSensitive,o.matchWholeWord);var n=jQuery(this).closest(".tb-findandreplace-destination-row").find(".tb-findandreplace-preview-description:first");var r=jQuery(this).closest(".tb-findandreplace-destination-row").find(".tb-findandreplace-preview-title:first");var s=jQuery(this).closest(".tb-findandreplace-destination-row").find(".tb-findandreplace-preview-tags:first");var l=jQuery(this).closest(".tb-findandreplace-destination-row").find(".tb-findandreplace-preview-options:first");if(n.is(":visible")||r.is(":visible")){n.slideUp();r.slideUp();s.slideUp();l.slideUp();return}if(o.actionType!=i.find)l.slideDown();if(o.replaceDescriptions)n.slideDown();n.find(".tb-findandreplace-preview-description-text").html(a);var d=t.snippet.title;d=TBUtilities.ReplaceAll(d,"\n","<br />");d=TBUtilities.ReplaceAll(d,o.findText,'<span style="background-color:#ffff66;">'+o.findText+"</span>",!o.caseSensitive,o.matchWholeWord);if(o.replaceTitles)r.slideDown();r.find(".tb-findandreplace-preview-title-text").html(d);var u=t.snippet.tags;u=TBUtilities.ReplaceAll(u,"\n","<br />");u=TBUtilities.ReplaceAll(u,o.findText,'<span style="background-color:#ffff66;">'+o.findText+"</span>",!o.caseSensitive,o.matchWholeWord);s.slideDown();s.find(".tb-findandreplace-preview-tags-text").html(u)});jQuery(document).on("click","#tb-findandreplace-stop",function(){o.isStopped=true;jQuery("#tb-findandreplace-stop").hide();jQuery("#tb-findandreplace-close").show();jQuery("#tb-findandreplace-working").hide();jQuery("#tb-findandreplace-stopped").show()});jQuery(document).on("click",".tb-findandreplace-preview-before",function(){var e=jQuery(this).attr("data-video-id");var t=TBUtilities.GetInArray(o.videos,"id",e);var a=t.snippet.description;a=TBUtilities.ReplaceAll(a,"\n","<br />");if(o.actionType!=i.trimDescription)a=TBUtilities.ReplaceAll(a,o.findText,'<span style="background-color:#ffff66;">'+o.findText+"</span>",!o.caseSensitive,o.matchWholeWord);var n=jQuery(this).closest(".tb-findandreplace-destination-row").find(".tb-findandreplace-preview-description:first");var r=jQuery(this).closest(".tb-findandreplace-destination-row").find(".tb-findandreplace-preview-title:first");n.find(".tb-findandreplace-preview-description-text").html(a);n.find(".tb-findandreplace-preview-box-header").removeClass("tb-findandreplace-preview-box-header--after");n.find(".tb-findandreplace-preview-box-header").addClass("tb-findandreplace-preview-box-header--before");var s=t.snippet.title;s=TBUtilities.ReplaceAll(s,"\n","<br />");s=TBUtilities.ReplaceAll(s,o.findText,'<span style="background-color:#ffff66;">'+o.findText+"</span>",!o.caseSensitive,o.matchWholeWord);r.find(".tb-findandreplace-preview-title-text").html(s);r.find(".tb-findandreplace-preview-box-header").removeClass("tb-findandreplace-preview-box-header--after");r.find(".tb-findandreplace-preview-box-header").addClass("tb-findandreplace-preview-box-header--before")});jQuery(document).on("click",".tb-findandreplace-preview-after",function(){var e=jQuery(this).attr("data-video-id");var t=TBUtilities.GetInArray(o.videos,"id",e);var a=t.snippet.description;if(o.actionType==i.trimDescription)a=jQuery.trim(a);a=TBUtilities.ReplaceAll(a,"\n","<br />");switch(o.actionType){case i.replace:a=TBUtilities.ReplaceAll(a,o.findText,'<span style="background-color:#ffff66;">'+o.findText+"</span>",!o.caseSensitive,o.matchWholeWord);a=TBUtilities.ReplaceAll(a,o.findText,TBUtilities.ReplaceAll(o.replaceWith,"\n","<br />"),!o.caseSensitive,o.matchWholeWord);break;case i.appendAfter:a=TBUtilities.ReplaceAll(a,o.findText,o.findText+'<br /><span style="background-color:#ffff66;">'+TBUtilities.ReplaceAll(o.replaceWith,"\n","<br />")+"</span>",!o.caseSensitive,o.matchWholeWord);break;case i.appendBefore:a=TBUtilities.ReplaceAll(a,o.findText,'<span style="background-color:#ffff66;">'+TBUtilities.ReplaceAll(o.replaceWith,"\n","<br />")+"</span><br />"+o.findText,!o.caseSensitive,o.matchWholeWord);break;case i.trimDescription:break;case i.remove:if(!o.removeLineBreaks&&!o.removeBlankLines){a=TBUtilities.ReplaceAll(a,o.findText,"",!o.caseSensitive,o.matchWholeWord)}if(o.removeBlankLines){while(a.indexOf(o.findText+" ")>-1)a=TBUtilities.ReplaceAll(a,o.findText+" ",o.findText,!o.caseSensitive);a=TBUtilities.ReplaceAll(a,o.findText+"<br /><br />","",!o.caseSensitive,o.matchWholeWord);a=TBUtilities.ReplaceAll(a,o.findText+" <br /><br />","",!o.caseSensitive,o.matchWholeWord);a=TBUtilities.ReplaceAll(a,o.findText+"<br><br>","",!o.caseSensitive,o.matchWholeWord);a=TBUtilities.ReplaceAll(a,o.findText+" <br><br>","",!o.caseSensitive,o.matchWholeWord);a=TBUtilities.ReplaceAll(a,o.findText,"",!o.caseSensitive,o.matchWholeWord)}if(o.removeLineBreaks){while(a.indexOf(o.findText+" ")>-1)a=TBUtilities.ReplaceAll(a,o.findText+" ",o.findText,!o.caseSensitive);a=TBUtilities.ReplaceAll(a,o.findText+"<br />","",!o.caseSensitive,o.matchWholeWord);a=TBUtilities.ReplaceAll(a,o.findText+"<br>","",!o.caseSensitive,o.matchWholeWord);a=TBUtilities.ReplaceAll(a,o.findText,"",!o.caseSensitive,o.matchWholeWord)}break;case i.appendDescription:a=a+'<br/><span style="background-color:#ffff66;">'+TBUtilities.ReplaceAll(o.findText,"\n","<br />")+"</span>";break;case i.prependDescription:var n="";if(jQuery("#tb-findandreplace-linebreak-prepend").is(":checked"))n="<br>";a='<span style="background-color:#ffff66;">'+TBUtilities.ReplaceAll(o.findText,"\n","<br />")+"</span>"+n+a;break;case i.replaceDescription:a='<span style="background-color:#ffff66;">'+TBUtilities.ReplaceAll(o.findText,"\n","<br />")+"</span>";break}var r=jQuery(this).closest(".tb-findandreplace-destination-row").find(".tb-findandreplace-preview-description:first");var s=jQuery(this).closest(".tb-findandreplace-destination-row").find(".tb-findandreplace-preview-title:first");r.find(".tb-findandreplace-preview-description-text").html(a);r.find(".tb-findandreplace-preview-box-header").removeClass("tb-findandreplace-preview-box-header--before");r.find(".tb-findandreplace-preview-box-header").addClass("tb-findandreplace-preview-box-header--after");var l=t.snippet.title;l=TBUtilities.ReplaceAll(l,"\n","<br />");switch(o.actionType){case i.replace:l=TBUtilities.ReplaceAll(l,o.findText,'<span style="background-color:#ffff66;">'+o.findText+"</span>",!o.caseSensitive,o.matchWholeWord);l=TBUtilities.ReplaceAll(l,o.findText,o.replaceWith,!o.caseSensitive,o.matchWholeWord);break;case i.remove:l=TBUtilities.ReplaceAll(l,o.findText,"",!o.caseSensitive,o.matchWholeWord);break}s.find(".tb-findandreplace-preview-title-text").html(l);s.find(".tb-findandreplace-preview-box-header").removeClass("tb-findandreplace-preview-box-header--before");s.find(".tb-findandreplace-preview-box-header").addClass("tb-findandreplace-preview-box-header--after")});jQuery(document).on("click","#tb-findandreplace-kickoff",function(){if(!jQuery("#tb-findandreplace-confirm-checkbox").is(":checked")){TBUtilities.Alert("Please check the box confirming that you want to run these bulk actions.");return}o.step=4;jQuery("#tb-findandreplace-status").show();jQuery("#tb-findandreplace-confirm").hide();jQuery("#tb-findandreplace-stop").show();jQuery("#tb-findandreplace-cancel").hide();jQuery("#tb-findandreplace-back").hide();jQuery("#tb-findandreplace-kickoff").hide();jQuery("#tb-findandreplace-continue").hide();try{switch(o.actionType){case i.find:TBUtilities.AddAction({VideoCount:o.destinationVideos.length,FindDescriptionSelected:o.replaceDescriptions,FindTitleSelected:o.replaceTitles},TBUtilities.ActionTypes.BulkFindReplaceAppent_Find,"bulkfindreplaceappend");break;case i.replace:TBUtilities.AddAction({VideoCount:o.destinationVideos.length,FindDescriptionSelected:o.replaceDescriptions,FindTitleSelected:o.replaceTitles},TBUtilities.ActionTypes.BulkFindReplaceAppend_FindAndUpdate,"bulkfindreplaceappend");break;case i.appendAfter:TBUtilities.AddAction({VideoCount:o.destinationVideos.length,FindDescriptionSelected:o.replaceDescriptions,FindTitleSelected:o.replaceTitles},TBUtilities.ActionTypes.BulkFindReplaceAppend_FindAndUpdate,"bulkfindreplaceappend");break;case i.appendBefore:TBUtilities.AddAction({VideoCount:o.destinationVideos.length,FindDescriptionSelected:o.replaceDescriptions,FindTitleSelected:o.replaceTitles},TBUtilities.ActionTypes.BulkFindReplaceAppend_FindAndUpdate,"bulkfindreplaceappend");break;case i.remove:TBUtilities.AddAction({VideoCount:o.destinationVideos.length,FindDescriptionSelected:o.replaceDescriptions,FindTitleSelected:o.replaceTitles},TBUtilities.ActionTypes.BulkFindReplaceAppend_FindAndUpdate,"bulkfindreplaceappend");break;case i.appendDescription:TBUtilities.AddAction({VideoCount:o.destinationVideos.length,FindDescriptionSelected:o.replaceDescriptions,FindTitleSelected:o.replaceTitles},TBUtilities.ActionTypes.BulkFindReplaceAppend_FindAndUpdate,"bulkfindreplaceappend");break;case i.prependDescription:TBUtilities.AddAction({VideoCount:o.destinationVideos.length,FindDescriptionSelected:o.replaceDescriptions,FindTitleSelected:o.replaceTitles},TBUtilities.ActionTypes.BulkFindReplaceAppend_FindAndUpdate,"bulkfindreplaceappend");break;case i.replaceDescription:TBUtilities.AddAction({VideoCount:o.destinationVideos.length,FindDescriptionSelected:o.replaceDescriptions,FindTitleSelected:o.replaceTitles},TBUtilities.ActionTypes.BulkFindReplaceAppend_FindAndUpdate,"bulkfindreplaceappend");break;case i.trimDescription:TBUtilities.AddAction({VideoCount:o.destinationVideos.length,FindDescriptionSelected:o.replaceDescriptions,FindTitleSelected:o.replaceTitles},TBUtilities.ActionTypes.BulkFindReplaceAppend_FindAndUpdate,"bulkfindreplaceappend");break}}catch(e){TBUtilities.LogError({Exception:e,Location:"[FindReplace] [addAction]"})}p()});jQuery(document).on("change",".tb-findandreplace-filter",function(){jQuery(".tb-findandreplace-destination-row").show();switch(jQuery(this).val()){case"all":break;case"public":jQuery('.tb-findandreplace-destination-row[data-privacy="private"]').hide();jQuery('.tb-findandreplace-destination-row[data-privacy="unlisted"]').hide();break;case"unlisted":jQuery('.tb-findandreplace-destination-row[data-privacy="public"]').hide();jQuery('.tb-findandreplace-destination-row[data-privacy="private"]').hide();break;case"private":jQuery('.tb-findandreplace-destination-row[data-privacy="public"]').hide();jQuery('.tb-findandreplace-destination-row[data-privacy="unlisted"]').hide();break;case"publicunlisted":jQuery('.tb-findandreplace-destination-row[data-privacy="private"]').hide();break;case"privateunlisted":jQuery('.tb-findandreplace-destination-row[data-privacy="public"]').hide();break}jQuery("#tb-findandreplace-destination-selected-count").text(jQuery("#tb-findandreplace-destination-list").find(".tb-findandreplace-checkbox-include").filter(":visible").filter(":checked").length)});jQuery(document).on("change","#tb-findandreplace-action-type",function(){var e=jQuery(this).val();jQuery(".tb-findandreplace-example").hide();jQuery(".tb-findandreplace-find-text").text("Find Text:");jQuery("#tb-findandreplace-options-container").css("display","flex");jQuery("#tb-findandreplace-example-container").css("display","inline");jQuery(".tb-findandreplace-find-text").css("top","-22px");jQuery("#tb-findandreplace-linebreak-prepend-box").hide();o.affectsAllVideos=false;switch(e){case"1":jQuery("#tb-findandreplace-find-container").show();jQuery("#tb-findandreplace-search-in-descriptions").show();jQuery("#tb-findandreplace-search-in-titles").show();jQuery("#tb-findandreplace-descriptions").removeAttr("disabled");jQuery("#tb-findandreplace-replace").show();jQuery("#tb-findandreplace-linebreak-box").hide();jQuery(".tb-findandreplace-action-type-text").text("Replace Text:");jQuery("#tb-findandreplace-example-input-container-replace").show();jQuery("#tb-findandreplace-example-input-container-find").show();jQuery(".tb-findandreplace-example-container").show();jQuery("#tb-findandreplace-action-type-text-container").show();jQuery("#tb-findandreplace-example-replace-before").show();jQuery("#tb-findandreplace-example-replace-after").show();jQuery("#tb-findandreplace-sample-replace-text").val("iTunes: http://smarturl.it/mjiT");jQuery("#tb-findandreplace-find").attr("rows","2");o.actionType=i.replace;break;case"2":jQuery("#tb-findandreplace-find-container").show();jQuery("#tb-findandreplace-search-in-descriptions").show();jQuery("#tb-findandreplace-descriptions").prop("checked",true);jQuery("#tb-findandreplace-descriptions").attr("disabled","disabled");jQuery("#tb-findandreplace-search-in-titles").hide();jQuery("#tb-findandreplace-replace").show();jQuery("#tb-findandreplace-linebreak-box").hide();jQuery(".tb-findandreplace-action-type-text").text("Append Text:");jQuery("#tb-findandreplace-example-input-container-replace").show();jQuery("#tb-findandreplace-example-input-container-find").show();jQuery(".tb-findandreplace-example-container").show();jQuery("#tb-findandreplace-action-type-text-container").show();jQuery("#tb-findandreplace-example-append-before").show();jQuery("#tb-findandreplace-example-append-after").show();jQuery("#tb-findandreplace-sample-replace-text").val("iTunes: http://smarturl.it/mjiT");jQuery("#tb-findandreplace-find").attr("rows","2");o.actionType=i.appendAfter;break;case"3":jQuery("#tb-findandreplace-find-container").show();jQuery("#tb-findandreplace-search-in-descriptions").show();jQuery("#tb-findandreplace-descriptions").prop("checked",true);jQuery("#tb-findandreplace-descriptions").attr("disabled","disabled");jQuery("#tb-findandreplace-search-in-titles").hide();jQuery("#tb-findandreplace-replace").show();jQuery("#tb-findandreplace-linebreak-box").hide();jQuery(".tb-findandreplace-action-type-text").text("Prepend Text:");jQuery("#tb-findandreplace-example-input-container-replace").show();jQuery("#tb-findandreplace-example-input-container-find").show();jQuery(".tb-findandreplace-example-container").show();jQuery("#tb-findandreplace-action-type-text-container").show();jQuery("#tb-findandreplace-example-prepend-before").show();jQuery("#tb-findandreplace-example-prepend-after").show();jQuery("#tb-findandreplace-sample-replace-text").val("iTunes: http://smarturl.it/mjiT");jQuery("#tb-findandreplace-find").attr("rows","2");o.actionType=i.appendBefore;break;case"4":jQuery("#tb-findandreplace-find-container").show();jQuery("#tb-findandreplace-search-in-descriptions").show();jQuery("#tb-findandreplace-search-in-titles").show();jQuery("#tb-findandreplace-descriptions").removeAttr("disabled");jQuery("#tb-findandreplace-replace").hide();jQuery("#tb-findandreplace-linebreak-box").show();jQuery(".tb-findandreplace-find-text").text("Remove Text:");jQuery(".tb-findandreplace-action-type-text").text("");jQuery("#tb-findandreplace-example-input-container-replace").hide();jQuery("#tb-findandreplace-example-input-container-find").show();jQuery(".tb-findandreplace-example-container").show();jQuery("#tb-findandreplace-action-type-text-container").hide();if(jQuery("#tb-findandreplace-linebreak").is(":checked")){jQuery("#tb-findandreplace-example-removeline-before").show();jQuery("#tb-findandreplace-example-removeline-after").show();jQuery("#tb-findandreplace-example-remove-before").hide();jQuery("#tb-findandreplace-example-remove-after").hide()}else{jQuery("#tb-findandreplace-example-remove-before").show();jQuery("#tb-findandreplace-example-remove-after").show();jQuery("#tb-findandreplace-example-removeline-before").hide();jQuery("#tb-findandreplace-example-removeline-after").hide()}jQuery("#tb-findandreplace-sample-replace-text").val("");jQuery("#tb-findandreplace-find").attr("rows","2");o.actionType=i.remove;break;case"5":jQuery("#tb-findandreplace-find-container").show();jQuery("#tb-findandreplace-search-in-descriptions").show();jQuery("#tb-findandreplace-search-in-titles").show();jQuery("#tb-findandreplace-descriptions").removeAttr("disabled");jQuery("#tb-findandreplace-replace").hide();jQuery("#tb-findandreplace-linebreak-box").hide();jQuery(".tb-findandreplace-action-type-text").text("");jQuery("#tb-findandreplace-example-input-container-replace").hide();jQuery("#tb-findandreplace-example-input-container-find").show();jQuery(".tb-findandreplace-example-container").show();jQuery("#tb-findandreplace-action-type-text-container").hide();jQuery("#tb-findandreplace-example-find-before").show();jQuery("#tb-findandreplace-sample-replace-text").val("");jQuery("#tb-findandreplace-find").attr("rows","5");jQuery(".tb-findandreplace-find-text").css("top","-62px");o.actionType=i.find;break;case"6":jQuery("#tb-findandreplace-find-container").show();jQuery("#tb-findandreplace-descriptions").prop("checked",true);jQuery("#tb-findandreplace-descriptions").attr("disabled","disabled");jQuery("#tb-findandreplace-search-in-titles").hide();jQuery("#tb-findandreplace-replace").hide();jQuery("#tb-findandreplace-linebreak-box").hide();jQuery(".tb-findandreplace-find-text").text("Append Text:");jQuery(".tb-findandreplace-action-type-text").text("");jQuery("#tb-findandreplace-example-input-container-replace").hide();jQuery("#tb-findandreplace-example-input-container-find").hide();jQuery(".tb-findandreplace-example-container").hide();jQuery("#tb-findandreplace-action-type-text-container").hide();jQuery("#tb-findandreplace-options-container").css("display","none");jQuery("#tb-findandreplace-example-container").css("display","none");jQuery("#tb-findandreplace-find").attr("rows","5");jQuery(".tb-findandreplace-find-text").css("top","-62px");o.affectsAllVideos=true;o.actionType=i.appendDescription;break;case"7":jQuery("#tb-findandreplace-linebreak-prepend-box").show();jQuery("#tb-findandreplace-find-container").show();jQuery("#tb-findandreplace-descriptions").prop("checked",true);jQuery("#tb-findandreplace-descriptions").attr("disabled","disabled");jQuery("#tb-findandreplace-search-in-titles").hide();jQuery("#tb-findandreplace-replace").hide();jQuery("#tb-findandreplace-linebreak-box").hide();jQuery(".tb-findandreplace-find-text").text("Prepend Text:");jQuery(".tb-findandreplace-action-type-text").text("");jQuery("#tb-findandreplace-example-input-container-replace").hide();jQuery("#tb-findandreplace-example-input-container-find").hide();jQuery(".tb-findandreplace-example-container").hide();jQuery("#tb-findandreplace-action-type-text-container").hide();jQuery("#tb-findandreplace-options-container").css("display","none");jQuery("#tb-findandreplace-example-container").css("display","none");jQuery("#tb-findandreplace-find").attr("rows","5");jQuery(".tb-findandreplace-find-text").css("top","-62px");o.affectsAllVideos=true;o.actionType=i.prependDescription;break;case"8":jQuery("#tb-findandreplace-find-container").show();jQuery("#tb-findandreplace-descriptions").prop("checked",true);jQuery("#tb-findandreplace-descriptions").attr("disabled","disabled");jQuery("#tb-findandreplace-search-in-titles").hide();jQuery("#tb-findandreplace-replace").hide();jQuery("#tb-findandreplace-linebreak-box").hide();jQuery(".tb-findandreplace-find-text").text("New Text:");jQuery(".tb-findandreplace-action-type-text").text("");jQuery("#tb-findandreplace-example-input-container-replace").hide();jQuery("#tb-findandreplace-example-input-container-find").hide();jQuery(".tb-findandreplace-example-container").hide();jQuery("#tb-findandreplace-action-type-text-container").hide();jQuery("#tb-findandreplace-options-container").css("display","none");jQuery("#tb-findandreplace-example-container").css("display","none");jQuery("#tb-findandreplace-find").attr("rows","5");jQuery(".tb-findandreplace-find-text").css("top","-62px");o.affectsAllVideos=true;o.actionType=i.replaceDescription;break;case"9":jQuery("#tb-findandreplace-find-container").hide();jQuery("#tb-findandreplace-descriptions").prop("checked",true);jQuery("#tb-findandreplace-descriptions").attr("disabled","disabled");jQuery("#tb-findandreplace-search-in-titles").hide();jQuery("#tb-findandreplace-replace").hide();jQuery("#tb-findandreplace-linebreak-box").hide();jQuery(".tb-findandreplace-find-text").text("New Text:");jQuery(".tb-findandreplace-action-type-text").text("");jQuery("#tb-findandreplace-example-input-container-replace").hide();jQuery("#tb-findandreplace-example-input-container-find").hide();jQuery(".tb-findandreplace-example-container").hide();jQuery("#tb-findandreplace-action-type-text-container").hide();jQuery("#tb-findandreplace-options-container").css("display","none");jQuery("#tb-findandreplace-example-container").css("display","none");jQuery("#tb-findandreplace-find").attr("rows","5");jQuery(".tb-findandreplace-find-text").css("top","-62px");o.affectsAllVideos=false;o.actionType=i.trimDescription;break}c()});jQuery(document).on("change click","#tb-findandreplace-linebreak",function(){if(jQuery("#tb-findandreplace-linebreak").is(":checked")){jQuery("#tb-findandreplace-example-removeline-before").show();jQuery("#tb-findandreplace-example-removeline-after").show();jQuery("#tb-findandreplace-example-remove-before").hide();jQuery("#tb-findandreplace-example-remove-after").hide()}else{jQuery("#tb-findandreplace-example-remove-before").show();jQuery("#tb-findandreplace-example-remove-after").show();jQuery("#tb-findandreplace-example-removeline-before").hide();jQuery("#tb-findandreplace-example-removeline-after").hide()}});jQuery(document).on("change keypress keyup keydown paste","#tb-findandreplace-find, #tb-findandreplace-replace",function(){o.findText=jQuery("#tb-findandreplace-find").val();o.replaceWith=jQuery("#tb-findandreplace-replace").val();if(TBUtilities.IsAlphaNumeric(o.findText.replace(/\s+/g,""))||!jQuery("#tb-findandreplace-options-container").is(":visible")){jQuery("#tb-findandreplace-specialcharacters").hide();jQuery("#tb-findandreplace-partialword").prop("disabled",false)}else{jQuery("#tb-findandreplace-specialcharacters").show();jQuery("#tb-findandreplace-partialword").prop("checked",true);jQuery("#tb-findandreplace-partialword").prop("disabled",true)}if(o.replaceWith.length>0)jQuery("#tb-findandreplace-replace").css("border","");c()});jQuery(document).on("click","#tb-findandreplace-continue, #tb-findandreplace-kickoff",function(){try{if(o.step==1){o.findText=jQuery("#tb-findandreplace-find").val();o.replaceWith=jQuery("#tb-findandreplace-replace").val();o.replaceTitles=jQuery("#tb-findandreplace-titles:first").is(":checked")&&jQuery("#tb-findandreplace-titles:first").is(":visible");o.replaceDescriptions=jQuery("#tb-findandreplace-descriptions:first").is(":checked")&&jQuery("#tb-findandreplace-descriptions:first").is(":visible");o.removeLineBreaks=jQuery("#tb-findandreplace-linebreak").is(":checked");o.removeBlankLines=jQuery("#tb-findandreplace-blanklines").is(":checked");if(o.findText.length==0&&o.actionType!=i.trimDescription){TBUtilities.Alert("You must enter some Text");return}if(!o.replaceTitles&&!o.replaceDescriptions){TBUtilities.Alert("You must select to search Titles and/or Descriptions");return}if(o.replaceWith==""&&(o.actionType==i.replace||o.actionType==i.appendAfter||o.actionType==i.appendBefore)){jQuery("#tb-findandreplace-replace").css("border","solid 1px red");switch(o.actionType){case i.replace:TBUtilities.Alert('Please enter replacement text.\n\n(If you are simply trying to delete the "Find Text", select "Remove" from the actions drop down.');break;case i.appendAfter:TBUtilities.Alert('Please enter text to append after "Find Text"');break;case i.appendBefore:TBUtilities.Alert('Please enter text to append before "Find Text"');break}return}if((o.replaceWith.indexOf(">")>-1||o.replaceWith.indexOf("<")>-1)&&jQuery("#tb-findandreplace-replace").is(":visible")){jQuery("#tb-findandreplace-replace").css("border","solid 1px red");TBUtilities.Alert('YouTube does not allow angle brackets in Titles or Descriptions (">" or "<")\n\nPlease remove them before continuing.');return}if((o.findText.indexOf(">")>-1||o.findText.indexOf("<")>-1)&&jQuery("#tb-findandreplace-find").is(":visible")){jQuery("#tb-findandreplace-replace").css("border","solid 1px red");TBUtilities.Alert('YouTube does not allow angle brackets in Titles or Descriptions (">" or "<")\n\nPlease remove them before continuing.');return}jQuery("#tb-findandreplace-replace").css("border","");o.caseSensitive=jQuery("#tb-findandreplace-casesensitive").is(":checked");o.matchWholeWord=!jQuery("#tb-findandreplace-partialword").is(":checked");jQuery("#tb-findandreplace-loading-videos").show();jQuery("#tb-findandreplace-destination-list").hide();jQuery("#tb-findandreplace-source").hide();jQuery("#tb-findandreplace-method").show();jQuery("#tb-findandreplace-back").show();var e=jQuery("#tb-findandreplace-input-playlist").playlistSelect({tbMaterial:true,singleSelectMode:true,onSelect:function(e){o.playlistId=e}}).data("plugin_playlistSelect");jQuery(".tb-playlist-select-manual-id-invalid").hide();jQuery("#tb-findandreplace-input-playlist").find(".tb-material-input").addClass("tb-bulk-input");jQuery("#tb-findandreplace-input-playlist").find(".tb-material-radio-label").addClass("tb-bulk-radio-label");o.method&&o.method==1?e.enable():e.disable();o.step=2}else if(o.step==2){switch(o.actionType){case i.find:jQuery("#tb-findandreplace-whatvideos-text").hide();jQuery("#tb-findandreplace-whatvideos-text2").show();jQuery("#tb-findandreplace-selected-text").hide();jQuery("#tb-findandreplace-selected-text2").hide();break;default:jQuery("#tb-findandreplace-whatvideos-text").show();jQuery("#tb-findandreplace-whatvideos-text2").hide();jQuery("#tb-findandreplace-selected-text").show();jQuery("#tb-findandreplace-selected-text2").show();break}switch(parseInt(o.method)){case 0:if(o.specificVideoIds.length==0){jQuery("#tb-findandreplace-input-ids-status").css("color","red");jQuery("#tb-findandreplace-input-ids-status").text("No videos detected");jQuery("#tb-findandreplace-input-ids-status").show();TBUtilities.Alert("You must enter a list of 1 or more valid Video IDs (or change you selection method above)");return}TBGlobal.AddUserDebugInfo("Video Selection Method: Video IDs "+JSON.stringify(o.specificVideoIds));d();break;case 1:var e=jQuery("#tb-findandreplace-input-playlist").playlistSelect({tbMaterial:true,singleSelectMode:true,onSelect:function(e){o.playlistId=e}}).data("plugin_playlistSelect");jQuery(".tb-playlist-select-manual-id-invalid").hide();var t=e.getSelectedPlaylistIds();if(!t||t.length==0){TBUtilities.Alert("You must enter a valid Playlist ID (or change you selection method above)",function(){return});return}else if(t.length>=2){TBUtilities.Alert("Please select only one playlist",function(){return});return}if(t.length==1){var a=jQuery("#tb-findandreplace-input-playlist").find(".playlistSelectTypeList").is(":checked");if(o.validPlaylistIds.indexOf(t[0])>-1||a&&t.length>0){o.playlistId=t.join(",")}else{e.showValidationWarning();TBUtilities.Alert("You must enter a valid Playlist ID (or change you selection method above)",function(){return});return}}TBGlobal.AddUserDebugInfo("Video Selection Method: Playlist ["+o.playlistId+"]");TBYouTubeApi.GetPlaylistVideos(o.playlistId,null,g,n);break;case 2:if(o.search==""){TBUtilities.Alert("You must enter a Search Term (or change you selection method above)");return}TBGlobal.AddUserDebugInfo("Video Selection Method: Search ["+o.search+"]");jQuery("#tb-findandreplace-destination").show();TBYouTubeApi.GetChannelVideosSearch(o.search,null,g,n);break;case 3:TBGlobal.AddUserDebugInfo("Video Selection Method: All");var r=null;if(jQuery("#tb-findandreplace-onlyLoadFirstPage").is(":checked")){var s=/^\+?\d+$/.test(jQuery("#tb-findandreplace-onlyLoadFirstPage-number").val());if(s==false){TBUtilities.Alert("Please enter a valid number for the number of videos to load");return}r=parseInt(jQuery("#tb-findandreplace-onlyLoadFirstPage-number").val());if(r<=0){TBUtilities.Alert("Please enter a valid number for the number of videos to load");return}}TBYouTubeApi.GetChannelVideos(TBGlobal.CurrentChannelId(),null,g,n,r,null,null);break}jQuery("#tb-findandreplace-method").hide();jQuery("#tb-findandreplace-destination").show();jQuery("#tb-findandreplace-destination-list").hide();jQuery("#tb-findandreplace-loading-videos").show();o.step=3;if(o.actionType==i.find){jQuery("#tb-findandreplace-continue").hide();jQuery("#tb-findandreplace-cancel").text("Close")}else{jQuery("#tb-findandreplace-continue").show();jQuery("#tb-findandreplace-cancel").text("Cancel")}}else if(o.step==3){if(jQuery(".tb-findandreplace-checkbox-include").filter(":visible").filter(":checked").length==0&&o.destinationVideos.length==0){TBUtilities.Alert("Please select at least 1 video to run Find and Replace on.");return}o.destinationVideos=[];jQuery(".tb-findandreplace-checkbox-include").filter(":visible").filter(":checked").each(function(){if(jQuery(this).is(":checked")){var e=jQuery(this).attr("data-video-id");jQuery.each(o.videos,function(t,i){if(i.id==e){o.destinationVideos.push(i);TBGlobal.AddUserDebugInfo("Selected Destination Video: https://www.youtube.com/watch?v="+e)}})}});var l="Please confirm that you want to";switch(o.actionType){case i.replace:l+=' find the text "<b>'+o.findText+'</b>" ';if(o.replaceTitles&&o.replaceDescriptions)l+=" in both Video Titles and Descriptions ";else if(o.replaceTitles)l+=" in Video Titles ";else l+=" in Video Descriptions ";l+=' and replace it with the text "<b>'+o.replaceWith+'</b>"';l+=" in the <b>"+o.destinationVideos.length+"</b> Video";if(o.destinationVideos.length>1)l+="s";l+=" that you selected.";break;case i.appendAfter:l+=' <br>find the text <br>"<b>'+o.findText+'</b>" ';if(o.replaceTitles&&o.replaceDescriptions)l+=" in both Video Titles and Descriptions ";else if(o.replaceTitles)l+=" in Video Titles ";else l+=" in Video Descriptions ";l+=' and add a new line after it with the text "<b>'+o.replaceWith+'"</b>"';l+=" in the <b>"+o.destinationVideos.length+"</b> Video";if(o.destinationVideos.length>1)l+="s";l+=" that you selected.";break;case i.appendBefore:l+=' find the text "<b>'+o.findText+'</b>" ';if(o.replaceTitles&&o.replaceDescriptions)l+=" in both Video Titles and Descriptions ";else if(o.replaceTitles)l+=" in Video Titles ";else l+=" in Video Descriptions ";l+=' and add a new line before it with the text "<b>'+o.replaceWith+'"</b>"';l+=" in the <b>"+o.destinationVideos.length+"</b> Video";if(o.destinationVideos.length>1)l+="s";l+=" that you selected.";break;case i.remove:l+=' find the text "<b>'+o.findText+'</b>" ';if(o.replaceTitles&&o.replaceDescriptions)l+=" in both Video Titles and Descriptions ";else if(o.replaceTitles)l+=" in Video Titles ";else l+=" in Video Descriptions ";l+=" and remove it ";if(o.removeLineBreaks)l+=" (and a line break if found immediately after)";if(o.removeBlankLines)l+=" (and a blank line if found immediately after)";l+=" in the <b>"+o.destinationVideos.length+"</b> Video";if(o.destinationVideos.length>1)l+="s";l+=" that you selected.";break;case i.appendDescription:l+=' append the text "<b>'+o.findText+'</b>" ';l+=" to the end of the Descriptions of the <b>"+o.destinationVideos.length+"</b> Video";if(o.destinationVideos.length>1)l+="s";l+=" that you selected.";break;case i.prependDescription:l+=' prepend the text "<b>'+o.findText+'</b>" ';l+=" to the beginning of the Descriptions of the <b>"+o.destinationVideos.length+"</b> Video";if(o.destinationVideos.length>1)l+="s";l+=" that you selected.";break;case i.replaceDescription:l+=' set to description to "<b>'+o.findText+'</b>" ';l+=" on the <b>"+o.destinationVideos.length+"</b> Video";if(o.destinationVideos.length>1)l+="s";l+=" that you selected.";break;case i.trimDescription:l+=" trim the descriptions (remove line breaks and spaces from beginning and end) ";l+=" on the <b>"+o.destinationVideos.length+"</b> Video";if(o.destinationVideos.length>1)l+="s";l+=" that you selected.";break}l=TBUtilities.ReplaceAll(l,"\n","<br/>");jQuery("#tb-findandreplace-confirmation-text").html(l);jQuery("#tb-findandreplace-queue-list").empty();jQuery("#tb-findandreplace-completed-list").empty();jQuery("#tb-findandreplace-destination-selected-count").text(o.destinationVideos.length);jQuery("#tb-findandreplace-method").hide();jQuery("#tb-findandreplace-confirm-checkbox").prop("checked",false);o.step=4;jQuery("#tb-findandreplace-destination").hide();jQuery("#tb-findandreplace-confirm").show();jQuery("#tb-findandreplace-kickoff").show();jQuery("#tb-findandreplace-continue").hide()}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyFindAndReplace] [click] #tb-findandreplace-continue, #tb-findandreplace-kickoff"})}});jQuery(document).on("click","#tb-findandreplace-back",function(){jQuery("#tb-findandreplace-continue").show();jQuery("#tb-findandreplace-cancel").text("Cancel");if(o.step==2){jQuery("#tb-findandreplace-source").show();jQuery("#tb-findandreplace-method").hide();jQuery("#tb-findandreplace-back").hide();o.step=1}else if(o.step==3){o.step=2;jQuery("#tb-findandreplace-destination").hide();jQuery("#tb-findandreplace-method").show();o.specificVideoIds.length=0;o.specificVideos.length=0;jQuery("#tb-findandreplace-input-ids").val("");jQuery("#tb-findandreplace-input-ids-status").hide();jQuery("#tb-findandreplace-destination-selected-count").text("0")}else if(o.step==4){o.step=3;jQuery("#tb-findandreplace-destination").show();jQuery("#tb-findandreplace-confirm").hide();jQuery("#tb-findandreplace-kickoff").hide();jQuery("#tb-findandreplace-continue").show()}});jQuery(document).on("click",".playlistSelectTypeManual",function(){var e=jQuery(this).parents(".playlistSelect").find(".playlistSelectMutliSelectListItem").find("input");e.each(function(e,t){o.validPlaylistIds.push(jQuery(t).val())})});jQuery(document).on("change keypress keyup paste keydown blur",".playlistSelectManualIds",function(){var e=jQuery(this).val();if(o.validPlaylistIds.indexOf(e)==-1){jQuery("#tb-playlist-select-manual-id-invalid").show()}else{jQuery("#tb-playlist-select-manual-id-invalid").hide()}});jQuery(document).on("click",".playlistSelectTypeList",function(){jQuery("#tb-playlist-select-manual-id-invalid").hide()})};var d=function(){var e=o.specificVideoIds[0];o.specificVideoIds.splice(0,1);TBYouTubeApi.GetVideoDetails(e,"contentDetails, snippet, id",u)};var u=function(e){if(e!=null)o.specificVideos.push(e);jQuery("#tb-findandreplace-progress-container").html(jQuery("#tb-findandreplace-progress-container").html()+" Got Details &rarr;");if(o.specificVideoIds.length>0){d()}else{g(o.specificVideos)}};var c=function(){var e="<b>Action:</b> ";switch(o.actionType){case i.find:if(o.findText.length>0)e+='Find the text "'+o.findText+'"';break;case i.replace:if(o.findText.length>0)e+='Find the text "'+o.findText+'" and replace it with "'+o.replaceWith+'"';break;case i.appendAfter:if(o.findText.length>0)e+='Find the text "'+o.findText+'" and append after it "'+o.replaceWith+'"';break;case i.appendBefore:if(o.findText.length>0)e+='Find the text "'+o.findText+'" and prepend before it "'+o.replaceWith+'"';break;case i.remove:if(o.findText.length>0)e+='Find the text "'+o.findText+'" and remove it';break;case i.appendDescription:if(o.findText.length>0)e+='Append to video descriptions: "'+o.findText+'"';break;case i.prependDescription:if(o.findText.length>0)e+='Prepend video descriptions with "'+o.findText+'"';break;case i.replaceDescription:if(o.findText.length>0)e+='Set video descriptions to "'+o.findText+'"';break;case i.trimDescription:e+="Trim video descriptions";break}jQuery("#tb-findandreplace-action-text").html(e);if(o.findText=="")jQuery("#tb-findandreplace-action-text").hide();else jQuery("#tb-findandreplace-action-text").show()};var p=function(){try{o.failedVideos=[];o.totalDestinationVideos=o.destinationVideos.length;o.hasFinished=false;o.errorCount=0;o.successCount=0;jQuery("#tb-findandreplace-queue-list").empty();jQuery("#tb-findandreplace-completed-list").empty();jQuery("#tb-findandreplace-queue-list2").empty();jQuery("#tb-findandreplace-completed-list2").empty();jQuery("#tb-findandreplace-error-list2").empty();jQuery("#tb-findandreplace-error-list2").hide();jQuery("#tb-findandreplace-error-none-list2").show();jQuery("#tb-findandreplace-working").show();jQuery("#tb-findandreplace-done").hide();jQuery("#tb-findandreplace-stopped").hide();TBUtilities.Log(o);b();y()}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyFindAndReplace] [startProcessing]"})}};var b=function(){try{if(o.isStopped)return;jQuery("#tb-findandreplace-progress-container").html("Start &rarr;");if(o.destinationVideos.length==0){jQuery("#tb-findandreplace-status-count").html("<b>"+o.totalDestinationVideos+"</b> of <b>"+o.totalDestinationVideos+"</b> videos complete");jQuery("#tb-findandreplace-progress-container").hide();if(o.currentVideo){if(!o.currentVideo.error)h(o.currentVideo);else f(o.currentVideo)}y();jQuery("#tb-findandreplace-working").hide();jQuery("#tb-findandreplace-done").show();jQuery("#tb-findandreplace-done-close").show();jQuery("#tb-findandreplace-stop").hide();jQuery("#tb-findandreplace-close").show();return}if(o.currentVideo){if(!o.currentVideo.error)h(o.currentVideo);else f(o.currentVideo)}var e=o.destinationVideos[0].id;var t=TBUtilities.RemoveFromArray(o.destinationVideos,"id",e)[0];o.currentVideo=t;jQuery("#tb-findandreplace-status-count").html("<b>"+parseInt(o.totalDestinationVideos-o.destinationVideos.length)+"</b> of <b>"+o.totalDestinationVideos+"</b> videos complete");jQuery("#tb-findandreplace-progress-container").html(jQuery("#tb-findandreplace-progress-container").html()+' Id: <a style="font-weight:normal" target="_blank" href="https://www.youtube.com/watch?v='+e+'">'+e+"</a> &rarr;");y();var a=o.currentVideo.snippet.title;var n=o.currentVideo.snippet.description;switch(o.actionType){case i.replace:n=TBUtilities.ReplaceAll(n,o.findText,o.replaceWith,!o.caseSensitive,o.matchWholeWord);a=TBUtilities.ReplaceAll(a,o.findText,o.replaceWith,!o.caseSensitive,o.matchWholeWord);break;case i.appendAfter:n=TBUtilities.ReplaceAll(n,o.findText,o.findText+"\n"+o.replaceWith,!o.caseSensitive,o.matchWholeWord);break;case i.appendBefore:n=TBUtilities.ReplaceAll(n,o.findText,o.replaceWith+"\n"+o.findText,!o.caseSensitive,o.matchWholeWord);break;case i.trimDescription:n=jQuery.trim(n);break;case i.remove:a=TBUtilities.ReplaceAll(a,o.findText,"",!o.caseSensitive,o.matchWholeWord);if(!o.removeLineBreaks&&!o.removeBlankLines)n=TBUtilities.ReplaceAll(n,o.findText,"",!o.caseSensitive,o.matchWholeWord);if(o.removeBlankLines){while(n.indexOf(o.findText+"  ")>-1)n=TBUtilities.ReplaceAll(n,o.findText+"  ",o.findText+" ",!o.caseSensitive);n=TBUtilities.ReplaceAll(n,o.findText+"\n\n","",!o.caseSensitive,o.matchWholeWord);n=TBUtilities.ReplaceAll(n,o.findText+" \n\n","",!o.caseSensitive,o.matchWholeWord);n=TBUtilities.ReplaceAll(n,o.findText+" ","",!o.caseSensitive,o.matchWholeWord);n=TBUtilities.ReplaceAll(n,o.findText,"",!o.caseSensitive,o.matchWholeWord)}if(o.removeLineBreaks){while(n.indexOf(o.findText+" ")>-1)n=TBUtilities.ReplaceAll(n,o.findText+" ",o.findText,!o.caseSensitive);n=TBUtilities.ReplaceAll(n,o.findText+"\n","",!o.caseSensitive,o.matchWholeWord);n=TBUtilities.ReplaceAll(n,o.findText,"",!o.caseSensitive,o.matchWholeWord)}break;case i.appendDescription:n=n+"\n"+o.findText;break;case i.prependDescription:var r="";if(jQuery("#tb-findandreplace-linebreak-prepend").is(":checked"))r="\n";n=o.findText+r+n;break;case i.replaceDescription:n=o.findText;break}var s="";var l={VideoId:o.currentVideo.id,Description:o.replaceDescriptions?n:null,Title:o.replaceTitles?a:null};s=jQuery.param(l);var d=TBGlobal.host+"/api/youtubevideos/UpdateVideoMetadata";TBExtension.Post(d,s,"CTTBFAREditVideo",null,{contentType:"application/x-www-form-urlencoded"})}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyFindAndReplace] [processNextVideo]"});jQuery("#tb-findandreplace-progress-container").html(jQuery("#tb-findandreplace-progress-container").html()+"Error: "+e.message);TBUtilities.Alert('Sorry, there was an error: "'+e.message+'"');jQuery("#tb-findandreplace-stop").trigger("click")}};var y=function(){jQuery("#tb-findandreplace-queue-list2").empty();jQuery("#tb-findandreplace-queue-complete-list2").hide();var e=0;jQuery.each(o.destinationVideos,function(t,i){var o=jQuery(".tb-findandreplace-processing-template2:last")[0].outerHTML;o=o.replace("#THUMBNAILURL#",i.snippet.thumbnails.thumbnailMedium?i.snippet.thumbnails.thumbnailMedium:i.snippet.thumbnails.default.url);o=TBUtilities.ReplaceAll(o,"#VIDEOID#",i.id);o=o.replace("#VIDEOTITLE#",i.snippet.title);o=o.replace("#HREF#","https://www.youtube.com/watch?v="+i.id);o=o.replace("display: none","display:flex");jQuery("#tb-findandreplace-queue-list2").prepend(o);e++;if(e==3)return false});if(e==0){jQuery("#tb-findandreplace-queue-complete-list2").show();jQuery("#tb-findandreplace-queue-list2").hide()}else{jQuery("#tb-findandreplace-queue-list2").show()}};var h=function(e){var t=jQuery(".tb-findandreplace-processed-success:last")[0].outerHTML;t=t.replace("#THUMBNAILURL#",e.snippet.thumbnails.thumbnailMedium?e.snippet.thumbnails.thumbnailMedium:e.snippet.thumbnails.default.url);t=TBUtilities.ReplaceAll(t,"#VIDEOID#",e.id);t=t.replace("#VIDEOTITLE#",e.snippet.title);t=t.replace("#HREF#","https://www.youtube.com/edit?o=U&feature=vm&video_id="+e.id);t=t.replace("display:none","display:flex");jQuery("#tb-findandreplace-completed-list2").prepend(t);jQuery("#tb-findandreplace-completed-none-list2").hide();jQuery("#tb-findandreplace-completed-list2").show();o.successCount++;jQuery("#tb-findandreplace-completed-list2-count").text(TBUtilities.FormatNumberWithCommas(o.successCount))};var f=function(e){try{jQuery("#tb-findandreplace-error-copy-container").show();var t=jQuery("#tb-findandreplace-error-copy").attr("data-clipboard-text");var i=[];if(t!=""){i=t.split(",");if(i.indexOf(e.id)==-1){i.push(e.id)}}else{i.push(e.id)}jQuery("#tb-findandreplace-error-copy").attr("data-clipboard-text",i.join(","))}catch(e){}var a=jQuery(".tb-findandreplace-processed-error:last")[0].outerHTML;a=a.replace("#THUMBNAILURL#",e.snippet.thumbnails.thumbnailMedium?e.snippet.thumbnails.thumbnailMedium:e.snippet.thumbnails.default.url);a=TBUtilities.ReplaceAll(a,"#VIDEOID#",e.id);a=a.replace("#VIDEOTITLE#",e.snippet.title);a=a.replace("#ERROR#",e.error);a=a.replace("#HREF#","https://www.youtube.com/edit?o=U&feature=vm&video_id="+e.id);a=a.replace("display:none","display:flex");jQuery("#tb-findandreplace-error-list2").prepend(a);jQuery("#tb-findandreplace-error-list2").show();jQuery("#tb-findandreplace-error-none-list2").hide();o.errorCount++;jQuery("#tb-findandreplace-error-list2-count").text(TBUtilities.FormatNumberWithCommas(o.errorCount))};var m=function(e,t){o.currentVideo.error=t;b()};var g=function(e){try{if(e==null){if(o.method==0)TBUtilities.Alert("No valid Video IDs found");else if(o.method==1)TBUtilities.Alert("Invalid Playlist Id or no videos found in playlist");else if(o.method==2)TBUtilities.Alert("No videos matching your search");else if(o.method==3)TBUtilities.Alert("No videos found or failed to load. Please try again.");jQuery("#tb-findandreplace-back").trigger("click");return}else if(e.length==0){if(o.method==0)TBUtilities.Alert("No valid Video IDs found");else if(o.method==1)TBUtilities.Alert("Invalid Playlist Id or no videos found in playlist");else if(o.method==2)TBUtilities.Alert("No videos matching your search");else if(o.method==3)TBUtilities.Alert("No videos found or failed to load. Please try again.");jQuery("#tb-findandreplace-back").trigger("click");return}jQuery("#tb-findandreplace-loading-videos").hide();o.videos=[];jQuery("#tb-findandreplace-destination-list").empty();var t=[];TBUtilities.Log("status.affectsAllVideos: "+o.affectsAllVideos);TBUtilities.Log("status.actionType: "+o.actionType);jQuery.each(e,function(e,a){if(a.id.videoId!=null){a.id=a.id.videoId}if(a.snippet.resourceId!=null)a.id=a.snippet.resourceId.videoId;if(a.snippet.tags==null)a.snippet.tags="";o.videos.push(a);var n=false;var r=a.snippet.thumbnails.thumbnailMedium?a.snippet.thumbnails.thumbnailMedium:a.snippet.thumbnails.default.url;var s=jQuery(".tb-findandreplace-destination-row:last")[0].outerHTML;s=s.replace("#VIDEOTITLE#",a.snippet.title);s=TBUtilities.ReplaceAll(s,"#VIDEOID#",a.id);s=s.replace("#VIDEOTHUMBNAIL#",r);if(a.status)s=s.replace("#PRIVACY#",a.status.privacy);if(o.replaceTitles){s=s.replace("#TITLEDISPLAY#","display:inline-block;");if(TBUtilities.CountMatches(a.snippet.title,o.findText,!o.caseSensitive,o.matchWholeWord)>0){s=s.replace("#TITLEFOUNDSTATUS#","tb-findandreplace-found-status--found");TBUtilities.Log("Title Match "+a.id);n=true}else{s=s.replace("#TITLEFOUNDSTATUS#","tb-findandreplace-found-status--notfound")}}else{s=s.replace("#TITLEDISPLAY#","display:none;")}if(o.replaceDescriptions){s=s.replace("#DESCRIPTIONDISPLAY#","display:inline-block;");var l=false;if(o.actionType==i.trimDescription){var d="abcd\ufeffe";a.snippet.description=a.snippet.description.replace(/[\u200B-\u200D\uFEFF]/g,"");l=a.snippet.description!=jQuery.trim(a.snippet.description)}if(o.affectsAllVideos||o.actionType==i.trimDescription&&l||o.actionType!=i.trimDescription&&TBUtilities.CountMatches(a.snippet.description,o.findText,!o.caseSensitive,o.matchWholeWord)>0){s=s.replace("#DESCRIPTIONFOUNDSTATUS#","tb-findandreplace-found-status--found");TBUtilities.Log("Description  Match: "+a.id);n=true}else{s=s.replace("#DESCRIPTIONFOUNDSTATUS#","tb-findandreplace-found-status--notfound")}}else{s=s.replace("#DESCRIPTIONDISPLAY#","display:none;")}if(o.actionType==i.find){s=TBUtilities.ReplaceAll(s,"#DISPLAYCHECKBOX#","display:none;");s=s.replace("#DISPLAYX#","display:none")}if(n){s=s.replace("#ENABLED#","");s=s.replace("#enabled#","");s=TBUtilities.ReplaceAll(s,"#DISPLAYCHECKBOX#","");s=s.replace("#DISPLAYX#","display:none");jQuery("#tb-findandreplace-destination-list").append(s)}else{s=s.replace("#ENABLED#",' disabled="disabled" ');s=s.replace("#enabled#",' disabled="disabled" ');s=TBUtilities.ReplaceAll(s,"#DISPLAYCHECKBOX#","display:none;");s=s.replace("#DISPLAYX#","");t.push(s)}});if(t.length>0){if(o.replaceDescriptions&&o.replaceTitles)jQuery("#tb-findandreplace-destination-list").append('<div style="border-bottom: solid 1px red; color:Red; padding-bottom:2px; font-size:11px; margin-bottom:10px; font-weight:bold;">Your search text was not found in the Title or Description of the following videos...</div>');else if(o.replaceDescriptions)jQuery("#tb-findandreplace-destination-list").append('<div style="border-bottom: solid 1px red; color:Red; padding-bottom:2px; font-size:11px; margin-bottom:10px; font-weight:bold;">Your search text was not found in the Description of the following videos...</div>');else jQuery("#tb-findandreplace-destination-list").append('<div style="border-bottom: solid 1px red; color:Red; padding-bottom:2px; font-size:11px; margin-bottom:10px; font-weight:bold;">Your search text was not found in the Title of the following videos...</div>');jQuery.each(t,function(e,t){jQuery("#tb-findandreplace-destination-list").append(t)})}o.channelVideoCount=e.length;o.findCount=e.length-t.length;try{if(o.actionType==5)TBUtilities.AddAction({VideoCount:o.findCount,FindDescriptionSelected:o.replaceDescriptions,FindTitleSelected:o.replaceTitles},TBUtilities.ActionTypes.BulkFindReplaceAppent_Find,"bulkfindreplaceappend")}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyFind] [addAction]"})}jQuery("#tb-findandreplace-destination").show();jQuery("#tb-findandreplace-method").hide();jQuery("#tb-findandreplace-destination-list").show();if((TBGlobal.CanAccessLevel2Tools()||o.findCount<2)&&(o.method==0||o.method==1))jQuery("#tb-findandreplace-select-all-checkboxes").trigger("click")}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyFindAndReplace] [gotVideoList]"})}};var v=function(){jQuery(document.body).on("CTTBFAREditVideo",function(e,t){try{if(t.success&&(t.response=="null"||t.response==null)){b()}else{t.location="CTTBFAREditVideo";TBUtilities.LogError("Error in find and replace. Details: "+JSON.stringify(t));m(o.currentVideo.id,"Failed to update video ("+t.response+")")}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyFindAndReplace] CTTBFAREditVideo"});m(o.currentVideo.id,t.response)}});jQuery(document.body).on("CRTBLoadFindAndReplaceTemplate",function(e,t){try{if(t.success){t.response=TBUtilities.FixLocalHtml(DOMPurify.sanitize(t.response,DOMPurifyConfig));jQuery("body").append(t.response);w()}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyFindAndReplace] CRTBLoadFindAndReplaceTemplate"})}})};var T=function(){try{jQuery("#tb-findandreplace-error-copy-container").hide();jQuery("#tb-findandreplace-error-copy").prop("data-clipboard-text","");var e=new ClipboardJS("#tb-findandreplace-error-copy");jQuery("#tb-findandreplace-selected-count").text("0");jQuery("#tb-findandreplace-destination-selected-count").text("0");jQuery("#tb-findandreplace-method").hide();jQuery("#tb-findandreplace-status").hide();jQuery("#tb-findandreplace-confirm").hide();jQuery("#tb-findandreplace-onlyLoadFirstPage-number").prop("disabled",true);jQuery("#tb-findandreplace-onlyLoadFirstPage").prop("checked",false);jQuery("#tb-findandreplace-bulk-description-updates-container").hide();jQuery("#tb-findandreplace-featured-content-container").hide();jQuery("#tb-findandreplace-cancel").text("Cancel");jQuery("#tb-findandreplace-kickoff").hide();jQuery("#tb-findandreplace-summary-container").hide();jQuery(".tb-findandreplace-filter").val("all");jQuery("#tb-findandreplace-featured-video-status-complete").hide();jQuery("#tb-findandreplace-featured-video-status-processing").hide();jQuery("#tb-findandreplace-bulk-descriptions-status-complete").hide();jQuery("#tb-findandreplace-bulk-descriptions-status-processing").hide();jQuery("#tb-findandreplace-success").hide();jQuery("#tb-findandreplace-back").hide();jQuery("#tb-findandreplace-container").fadeIn();jQuery("#tb-findandreplace-methods-container").fadeIn();jQuery("#tb-findandreplace-find").val("");jQuery("#tb-findandreplace-replace").val("");jQuery("#tb-findandreplace-action-text").text("");jQuery("#tb-findandreplace-cancel").show();jQuery("#tb-findandreplace-continue").show();jQuery("#tb-findandreplace-close").hide();jQuery("#tb-findandreplace-done-close").hide();jQuery("#tb-findandreplace-none").hide();jQuery("#tb-findandreplace-has").hide();jQuery("#tb-findandreplace-destination").hide();jQuery("#tb-findandreplace-source").show();jQuery("#tb-findandreplace-input-ids").val("");jQuery("#tb-findandreplace-input-ids-status").text("");jQuery("#tb-findandreplace-method-full").prop("checked","checked")}catch(e){TBUtilities.LogError({Exception:e,Location:"[V2VPromote] prepareDialog"})}};var w=function(){TBGlobal.ClearUserDebugInfo();TBGlobal.AddUserDebugInfo("Opening FindAndReplace");o.videoEntity=null;o.videos=[];o.destinationVideos=[];o.currentVideo=null;o.step=1;o.specificVideoIds.length=0;o.specificVideos.length=0;o.method=3;a();T()};return{Show:function(){if(TBGlobal.IsAuthenticated()){if(!e){v();r();l();e=true}else{w()}}}}}();var TubeBuddyEditVideo=function(){var e=false;var t=[];var i=[];var o=[];var a=0;var n=null;var r=false;var s;var l=false;var d=null;var u;var c=null;var p=true;var b=function(){jQuery(".video-settings-tag-chips-container").after(jQuery(".tb-edit-video-copy-tags-container:last")[0].outerHTML);jQuery(".tb-edit-video-copy-tags-container:first").after(TBUtilities.ReplaceAll(jQuery(".tb-notes-container:last")[0].outerHTML,"tb-edit-video-notesx","tb-edit-video-notes"));if(TBGlobal.Profile().SettingsShowInstaSuggest==true){jQuery(".video-settings-tag-chips-container").tagautocomplete({onTagsAdd:function(e){TubeBuddyEditVideo.AddTags(e)},openSuggestedTags:function(){var t=jQuery("#creator-editor-title-link").text();TubeBuddyMenu.ShowBackgroundSticky();TubeBuddySuggestedTags.Show(e,t,jQuery(".tb-edit-video-tag-suggestions-button"))},openTagExplorer:function(e){TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyTagExplorer.ShowTagExplorer(e,jQuery(".tb-edit-video-tag-explorer-button"),t)}}).data("plugin_tagautocomplete")}if(TBGlobal.Profile().SettingsShowSuggestedTags==true){jQuery(".tb-edit-video-suggested-tags-plugin").suggestedtags({onTagsAdd:function(e){TubeBuddyEditVideo.AddTags(e)}}).data("plugin_suggestedtags")}jQuery(".metadata-add-to-clickcard").after('<div class="tb-best-practices-plugin-container"><div>');jQuery(".tb-best-practices-plugin-container").bestpractices({videoId:s,videoTitle:jQuery(".video-settings-title").val(),videoThumbnail:"https://i.ytimg.com/vi/"+s+"/mqdefault.jpg",tagsContainer:jQuery(".video-settings-tag-chips-container"),titleElement:jQuery(".video-settings-title"),descriptionElement:jQuery(".video-settings-description"),suggestedTagsButton:jQuery(".tb-edit-video-tag-suggestions-button:first"),onMonitizationClick:function(){if(jQuery("[data-tab-id=monetization]").length>0){jQuery("[data-tab-id=monetization]")[0].click()}},onPlaylistClick:function(){},onTagsClick:function(){}}).data("plugin_bestpractices");if(TBGlobal.Profile().SettingsShowDemonetizationAudit==true){jQuery(".tb-best-practices-plugin-container").after('<div class="tb-demonetization-audit-container"><div>');jQuery(".tb-demonetization-audit-container").demonetizationaudit({}).data("plugin_demonetizationAudit")}if(TBExtension.GetType()!="firefox"){jQuery("#tb-edit-video-notes").wysiwyg({controls:{subscript:{visible:false},superscript:{visible:false},undo:{visible:false},redo:{visible:false},insertHorizontalRule:{visible:false},createLink:{visible:false},unLink:{visible:false},insertImage:{visible:false},h1:{visible:false},h2:{visible:false},h3:{visible:false},html:{visible:false},removeFormat:{visible:false},insertTable:{visible:false},code:{visible:false}},iFrameClass:"tb-topic-generator-editor",css:"https://www.tubebuddy.com/assets/js/jquery-emoji-picker/tb.css"});jQuery("#tb-edit-video-notes").wysiwyg("clear")}else{jQuery("#tb-edit-video-notes").val("")}var e=TBUtilities.GetUrlParameter("video_id");var i=TBGlobal.host+TBGlobal.apiUrls.youTubeVideosGetUserNotes+"/?videoId="+e;TBExtension.Get(i,"CREditVideoGetUserNotes");jQuery(".yt-chip").prepend(jQuery(".tb-edit-video-search-icon:last")[0].outerHTML);jQuery("#copy-tags-element").remove();jQuery(".video-settings-title").closest("label").append(jQuery(".tb-edit-video-title-length-container:first")[0].outerHTML);jQuery(".video-settings-description").closest("label").append(jQuery(".tb-edit-video-description-length-container:first")[0].outerHTML);jQuery(".video-settings-tag-chips-container").after(jQuery(".tb-edit-video-tags-length-container:first")[0].outerHTML);h();f();jQuery(".translation-editor-container").after(jQuery(".tb-edit-video-languageContainer:last")[0].outerHTML);jQuery(".translation-editor-container").after(jQuery(".tb-edit-video-languageGraphLoading:last")[0].outerHTML);u=setInterval(y,1500);setTimeout(L,5e3);T();w()};var y=function(){if(jQuery(".yt-chip").length>0){clearInterval(u);v(false);T(true);w();var e=TBUtilities.GetUrlParameter("tbaction");if(e==="tagtranslator"){setTimeout(function(){jQuery(".tb-edit-video-tag-translator-button:first").trigger("click")},100)}}};var h=function(){var e=jQuery(".video-settings-title").val().length;jQuery(".tb-edit-video-title-length").text(e);if(e>100){jQuery(".tb-edit-video-title-length").css("color","red");jQuery(".tb-edit-video-title-length").css("font-weight","bold")}else{jQuery(".tb-edit-video-title-length").css("color","#666");jQuery(".tb-edit-video-title-length").css("font-weight","normal")}};var f=function(){var e=jQuery(".video-settings-description").val();var t=g(e);jQuery(".tb-edit-video-description-length").text(t);if(t>5e3){jQuery(".tb-edit-video-description-length").css("color","red");jQuery(".tb-edit-video-description-length").css("font-weight","bold")}else{jQuery(".tb-edit-video-description-length").css("color","#666");jQuery(".tb-edit-video-description-length").css("font-weight","normal")}};var m=function(){var e=0;jQuery.each(t,function(t,i){var o=i.trim();o=o.replace(/\s/,"---");e+=o.length;e+=1});if(e>0)e--;var i=jQuery(".video-settings-add-tag").val();i=i.replace(/\s+/g,"---");e+=i.length;jQuery(".tb-edit-video-tags-length").text(e);if(e>500){jQuery(".tb-edit-video-tags-length").css("color","red");jQuery(".tb-edit-video-tags-length").css("font-weight","bold")}else{jQuery(".tb-edit-video-tags-length").css("color","#666");jQuery(".tb-edit-video-tags-length").css("font-weight","normal")}};var g=function(e){var t=e.length;for(var i=e.length-1;i>=0;i--){var o=e.charCodeAt(i);if(o>127&&o<=2047)t++;else if(o>2047&&o<=65535)t+=2;if(o>=56320&&o<=57343)i--}return t};var v=function(e){if(r)return;jQuery("#copy-tags-element").remove();jQuery("#tb-edit-video-clear").remove();var i="";t=[];jQuery(".video-settings-tag-chips-container").find(".yt-chip").each(function(e){i+=jQuery(this).find("span:first").text()+", ";t.push(jQuery(this).find("span:first").text())});if(t.length===0)return;if(TBGlobal.Profile().SettingsTagSearchRanking===true){if(e||!l){Q()}}else{jQuery(".tb-edit-video-tag-ranking").show()}var o='<button type="button" class="tb-button tb-button-default" id="tb-edit-video-clear" style="display:inline;  margin-right:3px;"> Clear</button>';jQuery(".tb-edit-video-tag-sorter-button").before(o);m()};var T=function(e){if(TBGlobal.Profile().SettingsShowSuggestedTags==true){var i=jQuery(".video-settings-title").val();var o=jQuery(".tb-edit-video-suggested-tags-plugin").suggestedtags().data("plugin_suggestedtags");o.getSuggestions(s,t,i,e)}};var w=function(){if(TBGlobal.Profile().SettingsShowDemonetizationAudit==true){clearTimeout(d);d=setTimeout(function(){var e=jQuery(".video-settings-title").val();var t=jQuery(".video-settings-description").val();var i=[];jQuery(".video-settings-tag-chips-container").find(".yt-chip").each(function(e){i.push(jQuery(this).find("span:first").text())});if(p){var o=jQuery(".tb-demonetization-audit-container").demonetizationaudit().data("plugin_demonetizationaudit");o.auditMetaData(e,t,i)}},1e3)}};var j=function(){if(jQuery(".tb-edit-video-suggested-tags-results").find(".tb-edit-video-suggested-tag").length==0){jQuery(".tb-edit-video-suggested-tags-results-container").hide();jQuery(".tb-edit-video-suggested-tags-results-empty").show()}else{jQuery(".tb-edit-video-suggested-tags-results-container").show();jQuery(".tb-edit-video-suggested-tags-results-empty").hide()}};var Q=function(){if(!jQuery(".tb-edit-video-loading-tag-rankings-legend").is(":visible")){jQuery(".tb-edit-video-loading-tag-rankings").show();jQuery(".tb-edit-video-loading-tag-rankings-done").hide()}jQuery(".tb-edit-video-tag-ranking").hide();l=true;try{var e=false;try{var i=jQuery(".video-info-text.localized-date");if(i&&i.attr("data-timestamp")){var o=i.attr("data-timestamp");var a=moment.unix(o);var n=moment.utc().diff(a,"hours");if(n<=72){e=true}}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyEditVideo] CREditVideoGetTagRankingsForToday"})}var r=0;jQuery.each(t,function(t,i){setTimeout(function(){TubeBuddyYouTubeActions.GetVideoSearchRank(s,i,U,1,null,e)},r);r+=10;haveAll=false})}catch(e){TBUtilities.LogError({Exception:e,Location:"[EditVideo] loadTagSearchRankings"})}};var x=function(){$(".tb-edit-video-languageGraph").highcharts({chart:{type:"column",style:{fontFamily:"CircularStd-Medium",color:"#666",fontWeight:"normal"}},title:{text:null},colors:["rgba(74, 144, 226, 0.8)","rgba(108, 200, 97, 0.8)","rgba(255, 170, 54, 0.8)","rgba(250, 53, 53, 0.8)","rgba(128, 133, 233, 0.8)","rgba(228, 211, 84, 0.8)","rgba(241, 92, 128, 0.8)","rgba(43, 144, 143, 0.8)"],subtitle:{text:null},xAxis:{type:"category"},yAxis:{title:{text:null}},legend:{enabled:false},credits:{enabled:false},plotOptions:{series:{borderWidth:0,dataLabels:{formatter:function(){return this.x+"   "+this.y},enabled:true,format:"{point.y:.1f}%",color:"#424242",style:{fontSize:"13px",fontFamily:"CircularStd-Bold"}}}},tooltip:{headerFormat:'<span style="font-size:11px">{series.name}</span><br>',pointFormat:'<span style="color:{point.color}">{point.name}</span>: <b>{point.y:.2f}%</b> of total<br/>'},series:[{name:"Language",colorByPoint:true,data:o}]});jQuery(".tb-edit-video-languageGraphLoading").hide();jQuery(".tb-edit-video-languageContainer").slideDown()};var B=function(){var e=TBGlobal.host+"/ModuleManager/editvideo/editvideo?v="+TBGlobal.versionNumber;if(loadLocalHTML&&(TBExtension.GetType()=="chrome"||TBExtension.GetType()=="firefox")){e=chrome.extension.getURL("modules/editvideo.html")}else if(loadLocalHTML&&TBExtension.GetType()==="safari"){e="modules/editvideo.html"}TBExtension.Get(e,"CRTBLoadEditVideoTemplate")};var k=function(){try{if(a>=i.length){clearTimeout(n);n=null;r=false;v(true);T();w();return}jQuery(".video-settings-add-tag").val(i[a++]);var e=jQuery(".video-settings-add-tag");e.trigger("focus");e.trigger("blur");n=setTimeout(k,100)}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyEditVideo] addTagsOneAtATime"})}};var L=function(){if(jQuery("body").html().indexOf('<button class="open-kwins">Keyword Inspector</button>')>0){jQuery(".tb-edit-video-drats").slideDown()}};var U=function(e,t,i){if(i>0){A(t,i)}if(i==-1){jQuery(".tb-edit-video-loading-tag-rankings-error").show()}C(t);if(i!=-1){var o=TBGlobal.host+TBGlobal.apiUrls.searchRankAddRankings;var a={VideoId:s,SearchTerm:t,Rank:i};var n=jQuery.param({Rankings:[a]});TBExtension.Post(o,n,"CREditVideoAddRank_NOTUSED",null,{contentType:"application/x-www-form-urlencoded; charset=UTF-8"})}setTimeout(function(){jQuery(".tb-edit-video-loading-tag-rankings").hide();jQuery(".tb-edit-video-loading-tag-rankings-done").show()},1e3)};var C=function(e,t){jQuery('.yt-chip[title="'+e+'" i]').css("border-color","#aaa")};var A=function(e,t){if(jQuery('.yt-chip[title="'+e+'" i]').find(".tb-tag-rank-value").length===0){jQuery('.yt-chip[title="'+e+'" i]').find("span:first").after('&nbsp;&nbsp;<span class="tb-tag-rank-value" style="opacity: .75;background-color:green; color:white;line-height: 14px;font-size: 10px;padding: 1px 5px 0px 4px;border-radius: 3px;position: relative;top: 4px;font-weight: 500;">'+t+"</span>&nbsp;");jQuery(".tb-edit-video-loading-tag-rankings-legend").show();if(TBGlobal.Profile().IncognitoSearch==true)jQuery(".tb-edit-video-loading-tag-rankings-legend").html('<span style="opacity: .95;background-color:green; color:white;line-height: 14px;font-size: 10px;padding: 1px 5px 0px 4px;border-radius: 3px;position: relative;font-weight: 500;">X</span> = Where this video ranks in YouTube Search Results (<a style="text-decoration:underline;font-weight:500" href="https://www.tubebuddy.com/channel/preferences/'+TBGlobal.CurrentChannelId()+'?change=rank" target="_blank">* Incognito Mode</a>)');else jQuery(".tb-edit-video-loading-tag-rankings-legend").html('<span style="opacity: .95;background-color:green; color:white;line-height: 14px;font-size: 10px;padding: 1px 5px 0px 4px;border-radius: 3px;position: relative;font-weight: 500;">X</span> = Where this video ranks in YouTube Search Results (<a style="text-decoration:underline;font-weight:500" href="https://www.tubebuddy.com/channel/preferences/'+TBGlobal.CurrentChannelId()+'?change=rank" target="_blank">* For You</a>)')}};var S=function(){var e=TBGlobal.host+TBGlobal.apiUrls.dataGetChannelLanguageStatistics;TBExtension.Get(e,"CREditVideoGetLanguageData")};var E=function(){jQuery(document).on("click",".tb-best-practices-playlist",function(e){if(jQuery(".metadata-add-to-playlist-button").length>0){jQuery(".metadata-add-to-playlist-button")[0].click()}});jQuery(document).on("blur",".video-settings-title",function(e){T()});jQuery(document).on("click",".tb-edit-video-save-notes",function(e){var t=TBUtilities.GetUrlParameter("video_id");var i=TBExtension.GetType()=="firefox"?jQuery("#tb-edit-video-notes").val():jQuery("#tb-edit-video-notes").wysiwyg("getContent");var o=jQuery.param({Id:t,UserNotes:i});var a=TBGlobal.host+TBGlobal.apiUrls.youTubeVideosSaveUserNotes;TBExtension.Post(a,o,"CREditVideoSaveUserNotes",null,{contentType:"application/x-www-form-urlencoded; charset=UTF-8"})});jQuery(document).on("click",".tb-edit-video-save-notes",function(e){var t=TBUtilities.GetUrlParameter("video_id");var i=TBExtension.GetType()=="firefox"?jQuery("#tb-edit-video-notes").val():jQuery("#tb-edit-video-notes").wysiwyg("getContent");var o=jQuery.param({Id:t,UserNotes:i});var a=TBGlobal.host+TBGlobal.apiUrls.youTubeVideosSaveUserNotes;TBExtension.Post(a,o,"CREditVideoSaveUserNotes",null,{contentType:"application/x-www-form-urlencoded; charset=UTF-8"})});jQuery(document).on("click",".tb-edit-video-translate",function(e){if(!TBGlobal.CanAccessLevel3Tools()){TBGlobal.ShowUpgradePage("translate your title and description","metaautotranslator");return false}var t=jQuery(".translation-editor-translation-menu-button").find(".yt-uix-button-content").text().trim();var i=TBUtilities.GetUrlParameter("video_id");var o=jQuery(".translation-editor-original-title").val();var a=jQuery(".translation-editor-original-description").val();var n=jQuery.param({VideoId:i,Title:o,Description:a,TargetLanguage:t});jQuery(".tb-edit-video-translate-loading").show();jQuery(".tb-edit-video-translate").prop("disabled",true);var r=TBGlobal.host+TBGlobal.apiUrls.translateVideoMetadata;TBExtension.Post(r,n,"CREditVideoTranslateVideoMeta",null,{contentType:"application/x-www-form-urlencoded; charset=UTF-8"});try{TBUtilities.AddAction(null,TBUtilities.ActionTypes.AutoTranslator_Use,"autotranslator")}catch(e){TBUtilities.LogError({Exception:e,Location:"[EditVideo] [addAction]"})}});jQuery(document).on("focus",".video-settings-title, .video-settings-description, .video-settings-add-tag",function(){jQuery(".tb-emoji-toggle").hide();jQuery(this).before('<span style="position:absolute; left:430px; opacity:.7" class="tb-emoji-toggle"><img src="'+TBGlobal.host+'/images/modules/emoji/face.png" style=" cursor:pointer; position:relative; top:5px;" /></span>')});jQuery(document).on("click",".tb-edit-video-tag-ranking",function(){jQuery(this).hide();Q()});jQuery(document).on("click",".tb-edit-video-copy-tags",function(e){e.stopPropagation();var t=[];jQuery(".video-settings-tag-chips-container").find(".yt-chip").each(function(e){t.push(jQuery(this).find("span:first").text())});TubeBuddyCopyTo.ShowMenu(jQuery(this),t)});jQuery(document).on("click",".yt-chip",function(){var e=jQuery(this).find("span:first").text();if(!r){TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyTagExplorer.ShowTagExplorer(e,jQuery(this),t)}});jQuery(document).on("click",'[data-tab-id="translations"]',function(){TBUtilities.AddAction(null,TBUtilities.ActionTypes.LanguageAnalysis_Use,"languageanalysis");if(!jQuery(".tb-edit-video-languageContainer:first").is(":visible"))S();if(jQuery(".translation-editor-delete-button").siblings(".tb-edit-video-translate-container").length==0){jQuery(".translation-editor-delete-button").after(jQuery(".tb-edit-video-translate-container:last")[0].outerHTML);var e=document.querySelector(".translation-editor-action-button");var t=new MutationObserver(function(e){var t=jQuery(".translation-editor-action-button").prop("disabled");jQuery(".tb-edit-video-translate").prop("disabled",t)});var i={attributes:true,childList:true,subtree:true,characterData:true};t.observe(e,i)}});jQuery(document).on("click",".yt-delete-chip",function(e){e.stopPropagation();if(!r){v(false);T();w()}});jQuery(document).on("change keyup keypress paste",".video-settings-description",function(e){f();w()});jQuery(document).on("change keyup keypress paste",".video-settings-title",function(e){h();w()});jQuery(document).on("change keyup keypress paste",".video-settings-add-tag",function(e){m();w()});jQuery(document).on("click","#tb-edit-video-clear",function(e){TBUtilities.Confirm("Are you sure you want to CLEAR all tags that you have entered?",function(){jQuery(".video-settings-tag-chips-container").find(".yt-delete-chip").each(function(){jQuery(this)[0].click()})},function(){})});jQuery(document).on("click",".tb-edit-video-tag-explorer-button",function(e){TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyTagExplorer.ShowTagExplorer(null,jQuery(this),t)});jQuery(document).on("click",".tb-edit-video-tag-translator-button",function(e){var t=[];jQuery(".video-settings-tag-chips-container").find(".yt-chip").each(function(e){t.push(jQuery(this).find("span:first").text())});TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyTagTranslator.Show(t)});jQuery(document).on("click",".tb-edit-video-tag-sorter-button",function(e){var t=[];var i=[];jQuery(".video-settings-tag-chips-container").find(".yt-chip").each(function(e){t.push(jQuery(this).find("span:first").text());i.push({tag:jQuery(this).find("span:first").text(),rank:jQuery(this).find(".tb-tag-rank-value").text()})});TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyTagSorter.Show(t,i)});jQuery(document).on("blur",".video-settings-add-tag, .video-settings-tag-chips-container",function(){jQuery(".yt-chip").each(function(){if(jQuery(this).find(".tb-edit-video-search-icon").length===0){jQuery(this).prepend(jQuery(".tb-edit-video-search-icon:last")[0].outerHTML)}});v(false);T()});jQuery(document).on("blur",".video-settings-tag-chips-container",function(){v(false);T()});jQuery(document).on("click",".tb-edit-video-add-notes",function(){jQuery(".tb-edit-video-notes-none").hide();jQuery(".tb-edit-video-notes-loaded").show();jQuery(".tb-notes-container").css("background-color","#f3f3f3")});jQuery(document).on("click",".tb-edit-video-tag-suggestions-button",function(e){var t=TBUtilities.GetUrlParameter("video_id");var i=jQuery("#creator-editor-title-link").text();TubeBuddyMenu.ShowBackgroundSticky();TubeBuddySuggestedTags.Show(t,i,jQuery(this))});jQuery(document).on("click",".tb-edit-video-tag-list-button",function(e){TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyTagLists.Show(true)});jQuery(document).on("mousedown",".save-changes-button",function(e){if(c){var t={ThumbnailId:c,VideoId:s};var i=TBGlobal.host+TBGlobal.apiUrls.seoScorePublishSavedThumbnailData;TBExtension.Post(i,JSON.stringify(t),function(e,t,i){try{if(e){c=null;var o=jQuery(".custom-thumb-selectable").find("img:first");if(o){jQuery(o).attr("src","https://i.ytimg.com/vi/"+s+"/0.jpg?time="+Math.random())}}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyEditVideo] publishOptimizationThumbnail"})}},null,{contentType:"application/json"})}})};var I=function(){jQuery(document.body).on("CREditVideoTranslateVideoMeta",function(e,t){try{if(t.success){jQuery(".tb-edit-video-translate-loading").hide();jQuery(".tb-edit-video-translate").prop("disabled",false);var i=JSON.parse(t.response);var o=jQuery(".translation-editor-translated-title");o.val(i.Title);o.trigger("keyup");var a=document.createEvent("HTMLEvents");a.initEvent("input",true,true);var n=o[0];n.dispatchEvent(a);var r=jQuery(".translation-editor-translated-description");r.val(i.Description);r.trigger("keyup");var a=document.createEvent("HTMLEvents");a.initEvent("input",true,true);var n=r[0];n.dispatchEvent(a)}else{jQuery(".tb-edit-video-translate-loading").hide();jQuery(".tb-edit-video-translate").prop("disabled",false);if(t.response==501){TBUtilities.Alert("There was an error translating your title and descrption. We were unable to find translations for your selected language.")}else if(t.response==426){TBUtilities.Alert("You've reached the limit for translations within 24 hours.  Please wait 24 hours and try again.")}else{TBUtilities.Alert("There was an error translating your title and descrption.  Please try again and contact support@tubebuddy.com if this problem continues.")}}}catch(e){jQuery(".tb-edit-video-translate-loading").hide();jQuery(".tb-edit-video-translate").prop("disabled",false);TBUtilities.Alert("There was an error translating your title and descrption.  Please try again and contact support@tubebuddy.com if this problem continues.");TBUtilities.LogError({Exception:e,Location:"[TubeBuddySearchRanking] CRSearchRankingAddTerm"})}});jQuery(document.body).on("CRTBLoadEditVideoTemplate",function(e,t){try{if(t.success){t.response=TBUtilities.FixLocalHtml(DOMPurify.sanitize(t.response,DOMPurifyConfig));jQuery("body").append(t.response);b();jQuery(".tb-edit-video-tag-translator-button").show();v(false);var i=TBUtilities.GetUrlParameter("tbaction");if(i==="suggestedtags"){setTimeout(function(){var e=TBUtilities.GetUrlParameter("video_id");TBYouTubeApi.GetVideoDetails(e,"id, snippet",function(t){TubeBuddyMenu.ShowBackgroundSticky();TubeBuddySuggestedTags.Show(e,t.snippet.title,jQuery(".tb-edit-video-tag-suggestions-button:first"),t.snippet.tags)})},500)}else if(i==="thumbnailgenerator"){setTimeout(function(){var e=TBUtilities.GetUrlParameter("video_id");var t=jQuery("#creator-editor-title-link").attr("title");var i="https://img.youtube.com/vi/"+e+"/mqdefault.jpg";TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyThumbnailCreator.Show(e,t,i)},1e3)}else if(i==="seostudio"){setTimeout(function(){var e=TBUtilities.GetUrlParameter("video_id");var t=jQuery("#creator-editor-title-link").attr("title");TubeBuddyMenu.ShowBackgroundSticky();TubeBuddySeoStudio.ShowSeoStudio(null,e,t)},1e3)}}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyEditVideo] CRTBLoadEditVideoTemplate"})}});jQuery(document.body).on("CREditVideoGetUserNotes",function(e,t){try{if(t.success){var i=null;if(t.response){i=TBUtilities.ReplaceAll(t.response,'"',"");if(i=="null")i=""}else{i=""}jQuery(".tb-edit-video-notes-loading").hide();if(i&&i!=""){if(TBExtension.GetType()=="firefox"){jQuery(".tb-edit-video-notes-loaded").show()}else{jQuery("#tb-edit-video-notes").wysiwyg("setContent",i)}jQuery("#tb-edit-video-notes").val(i);jQuery(".tb-edit-video-notes-loaded").show();jQuery(".tb-notes-container").css("background-color","#f3f3f3")}else{jQuery(".tb-edit-video-notes-none").show()}}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyEditVideos] CREditVideoGetUserNotes"})}});jQuery(document.body).on("CREditVideoSaveUserNotes",function(e,t){jQuery(".tb-edit-notes-saved").show().delay(2e3).fadeOut()});jQuery(document.body).on("CREditVideoGetLanguageData",function(e,t){try{if(t.success){o=[];var i=JSON.parse(t.response);jQuery.each(i,function(e,t){if(e>9)return;o.push({y:t.Percent*100,name:t.Language})});x()}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddySearchRanking] CRSearchRankingAddTerm"})}})};return{Initialize:function(){if(TBGlobal.IsAuthenticated()){if(!e){s=TBUtilities.GetUrlParameter("video_id");c=null;I();B();E();e=true}else{b()}}},SetTags:function(e){i=e;r=true;jQuery(".video-settings-tag-chips-container").find(".yt-delete-chip").each(function(){jQuery(this)[0].click()});a=0;n=setTimeout(k,10)},AddTags:function(e){i=e;r=true;a=0;n=setTimeout(k,10)},ApplyOptimizedThumbnail:function(e){c=e}}}();var TubeBuddyQuickEditToolbar=function(){var e=false;var t="";var i=false;var o={startingIndex:0,totalItems:0,showInList:7,currentPage:1,max:9999,cookie:null,isFetching:false,startPage:1,currentlUrl:"",onPage:1,startingUrl:"",isLoadingPlaylists:false};var a=function(){TBUtilities.Log("Quick-Edit Toolbar Referrer: "+document.referrer);var e=TBUtilities.GetCookie("tb_pl_edit");TBUtilities.RemoveCookie("tb_pl_edit");if(document.location.href.indexOf("/my_videos?")>-1){var t=TBUtilities.GetUrlParameter("pi");if(!t)t=1;TBUtilities.Log("Is My Videos Page");r(document.location.href,t,'This list currently shows videos that were last displayed on your <a href="'+document.location.href+'">My Videos</a> page.')}else if(document.location.href.indexOf("/playlist")>-1){TBUtilities.Log("Is Playlist Page");r(document.location.href,1,'This list currently shows videos in the <a href="'+document.location.href+'">'+TBUtilities.GetHtmlEncoded(jQuery(".pl-header-title").text())+"</a> Playlist.")}else{if(e=="1"||document.referrer.indexOf("playlist")>-1||document.referrer.indexOf("/edit")>-1||document.referrer.indexOf("/my_videos")>-1||document.referrer.indexOf("/enhance")>-1||document.referrer.indexOf("/audio")>-1||document.referrer.indexOf("/my_videos_annotate")>-1||document.referrer.indexOf("/cards")>-1||document.referrer.indexOf("/timedtext_video")>-1||document.referrer.indexOf("/endscreen")>-1){var i=TBUtilities.GetCookie("tb-quick-edit-toolbar-data"+TBGlobal.CurrentChannelId());if(i){TBUtilities.Log("Fetching initial Quick-Edit Toolbar page");o.cookie=JSON.parse(TBUtilities.GetCookie("tb-quick-edit-toolbar-data"+TBGlobal.CurrentChannelId()));jQuery("#creator-page").before(jQuery("#tb-editvideo-nav-video")[0].outerHTML);jQuery("#content").before(jQuery("#tb-editvideo-nav-list-menu")[0].outerHTML);if(TBUtilities.GetCookie("tb-edit-video-hide-menu")!=true&&TBUtilities.GetCookie("tb-edit-video-hide-menu")!="true"){TBUtilities.Log("Not hiding, go fetch results.");n()}else{TBUtilities.Log("Hiding, do not fetch results.");jQuery(".tb-editvideos-hide-editor").hide();jQuery(".tb-editvideos-show-editor").show();jQuery("#tb-editvideo-nav-video").css("height","24px");jQuery("#tb-editvideo-nav-video").css("width","50px");jQuery("#tb-editvideo-nav-video").css("opacity",".6")}}else{TBUtilities.Log("Not a Quick-Edit Toolbar page url")}}else{TBUtilities.Log("Not coming from Playlist or My Videos page")}}};var n=function(){i=true;TBUtilities.Log("Fetching first page: "+o.cookie.url);jQuery("#tb-editvideo-nav-list-loading-more").show();o.currentlUrl=o.cookie.url;o.onPage=o.cookie.page;o.startingUrl=o.cookie.url;TBExtension.Get(o.cookie.url,"CRTBLoadQuickEditToolbarFirstPage")};var r=function(e,t,i){var o={url:e,page:t,videos:[],description:i};TBUtilities.Log("cookie");TBUtilities.Log(o);TBUtilities.RemoveCookie("tb-quick-edit-toolbar-data"+TBGlobal.CurrentChannelId());TBUtilities.CreateCookie("tb-quick-edit-toolbar-data"+TBGlobal.CurrentChannelId(),JSON.stringify(o),7)};var s=function(){if(o.isLoadingPlaylists==true){jQuery("#tb-editvideo-nav-list-loading-more").show();return}o.totalItems=o.cookie.videos.length;var e="";var i=0;if(o.startingIndex<0)o.startingIndex=0;jQuery.each(o.cookie.videos,function(a,n){if(a>=o.startingIndex&&a<o.startingIndex+o.showInList){var r=document.location.href;r=TBUtilities.ReplaceAll(r,t,n.v);if(n.v==t){e+='<div style=""><span style="position:fixed; top:'+(115+i*47)+'px;display:none" class="tb-editvideo-nav-title tb-editvideo-nav-title'+n.v+'">'+TBUtilities.GetHtmlEncoded(n.t)+'</span>                         <img style="border:solid 3px red !important;"             class="tb-editvideo-nav-image" data-videoid="'+n.v+'" src="'+(n.i?n.i:"https://i.ytimg.com/vi/"+n.v+"/default.jpg")+'" title="'+TBUtilities.GetHtmlEncoded(n.t)+'" /></div>'}else{e+='<div style=""><span style="position:fixed; top:'+(115+i*47)+'px;display:none" class="tb-editvideo-nav-title tb-editvideo-nav-title'+n.v+'">'+TBUtilities.GetHtmlEncoded(n.t)+'</span><a data-page-url="'+n.u+'" data-page="'+n.p+'" class="tb-quickedit-toolbar-link" href="'+r+'"><img style="opacity:.45;" class="tb-editvideo-nav-image" data-videoid="'+n.v+'" src="'+(n.i?n.i:"https://i.ytimg.com/vi/"+n.v+"/default.jpg")+'" title="'+TBUtilities.GetHtmlEncoded(n.t)+'" /></a></div>'}i++}});if(o.startingIndex>0||o.cookie.page>1){jQuery("#tb-editvideo-nav-list-prev").css("cursor","pointer");jQuery("#tb-editvideo-nav-list-prev").css("opacity","1")}else{jQuery("#tb-editvideo-nav-list-prev").css("opacity",".2");jQuery("#tb-editvideo-nav-list-prev").css("cursor","default")}if(o.startingIndex==0&&(o.cookie.page==1||o.startPage==1)){jQuery("#tb-editvideo-nav-list-prev").css("opacity",".2");jQuery("#tb-editvideo-nav-list-prev").css("cursor","default")}else{jQuery("#tb-editvideo-nav-list-prev").css("opacity","1");jQuery("#tb-editvideo-nav-list-prev").css("cursor","pointer")}if(o.totalItems<o.max){jQuery("#tb-editvideo-nav-list-next").show()}else{jQuery("#tb-editvideo-nav-list-next").hide()}if(o.cookie.url.indexOf("playlist")>-1&&o.cookie.videos.length<=o.showInList+o.startingIndex){jQuery("#tb-editvideo-nav-list-next").hide()}jQuery("#tb-editvideo-nav-list").html(DOMPurify.sanitize(e,DOMPurifyConfig));TBUtilities.Log(o)};var l=function(e){var t=e.indexOf('window["ytInitialData"] = ');t=t+26;var i=e.substring(t,e.length);var o=i.indexOf("};")+1;var i=i.substring(0,o);var a=jQuery.parseJSON(i);return a};var d=function(e,t){var i=0;var a=TBGlobal.GetYouTubeUI();if(t===true){a="default"}else{if(e.indexOf('window["ytInitialData"] = {"responseContext"')>-1){a="material"}}switch(a){case"default":{jQuery(".pl-video",e).each(function(e,t){var a=jQuery(this).attr("data-video-id");var n=jQuery(this).find(".pl-video-title-link").text().trim();var r=jQuery(this).find(".yt-thumb-clip:first").find("img:first").attr("data-thumb");var s=jQuery(this).find(".pl-video-owner").find("a").attr("data-ytid");if(r.indexOf("i.ytimg")>-1){r=""}n=TBUtilities.ReplaceAll(n,"\r","");n=TBUtilities.ReplaceAll(n,"\n","");n=n.trim();if(a&&s==TBGlobal.CurrentChannelId()){var l=TBUtilities.GetInArray(o.cookie.videos,"v",a);TBUtilities.Log(l);if(!l&&n&&n!="\\n\\n"){o.cookie.videos.push({v:a,t:n,i:r,u:o.currentlUrl,p:o.onPage});o.totalItems++;i++}}});break}case"studio":case"material":{o.isLoadingPlaylists=true;var n=l(e);if(n.contents.twoColumnBrowseResultsRenderer.tabs["0"]){try{var r=0;jQuery.each(n.contents.twoColumnBrowseResultsRenderer.tabs["0"].tabRenderer.content.sectionListRenderer.contents["0"].itemSectionRenderer.contents["0"].playlistVideoListRenderer.contents,function(e,t){if(t.playlistVideoRenderer){var a=t.playlistVideoRenderer.videoId;var l=t.playlistVideoRenderer.title.simpleText;var d=t.playlistVideoRenderer.thumbnail.thumbnails["0"].url;TubeBuddyYouTubeActions.GetVideoInfo(a,function(t){r++;if(a&&t!=null&&t.channelid!=null&&t.channelid==TBGlobal.CurrentChannelId()){var u=TBUtilities.GetInArray(o.cookie.videos,"v",a);TBUtilities.Log(u);if(!u&&l&&l!="\\n\\n"){o.cookie.videos.push({v:a,t:l,i:d,u:o.currentlUrl,p:o.onPage,d:t.publishDate,o:e});o.totalItems++;i++}}if(r>=n.contents.twoColumnBrowseResultsRenderer.tabs["0"].tabRenderer.content.sectionListRenderer.contents["0"].itemSectionRenderer.contents["0"].playlistVideoListRenderer.contents.length){o.cookie.videos.sort(function(e,t){return e.o-t.o});o.isLoadingPlaylists=false;jQuery("#tb-editvideo-nav-list-loading-more").hide();s();if(i==0){o.max=o.totalItems}else{o.max=o.totalItems+1;jQuery("#tb-editvideo-nav-list-next").show()}}})}})}catch(e){}}break}}if(i==0){o.max=o.totalItems}else{jQuery("#tb-editvideo-nav-list-next").show()}};var u=function(e){var t=e.indexOf("VIDEO_LIST_DISPLAY_OBJECT");TBUtilities.Log("currentIndex: "+t);var i=0;var a=0;while(e.indexOf("data-video-id",t)>-1&&t>i){if(t>i)i=t;var n=e.indexOf("data-video-id",t)+"data-video-id".length+3;var r=e.substring(n,n+11);if(r=="__VIDEO_ID"){}else{TBUtilities.Log("videoId: "+r);var s=e.indexOf("vm-video-title-content",n);s=e.indexOf("data-sessionlink=",s);s=e.indexOf("u003e",s)+"u003e".length;var l=e.indexOf("u003c",s)-1;var d=e.substring(s,l);if(!d)d="";d=d.trim();TBUtilities.Log(r+" - "+d);var u="";var c=e.indexOf("vm-private",t);var p=e.substring(c,c+25).indexOf("hid")==-1;var b=e.indexOf("vm-video-privacy-draft-badge",t)>-1;if(p||b){var y=e.indexOf("yt-thumb-clip",t);y=e.indexOf("https",y);var h=e.indexOf('"',y)-1;var f=e.substring(y,h);f=TBUtilities.ReplaceAll(f,"\\/","\\");f=TBUtilities.ReplaceAll(f,"\\u0026amp;","&");u=f}t=e.indexOf("vm-video-item-content-horizontal-divider",t+5);var m=TBUtilities.GetInArray(o.cookie.videos,"v",r);if(!m&&d&&d!="\\n\\n"){o.cookie.videos.push({v:r,t:d,i:u,u:o.currentlUrl,p:o.onPage});o.totalItems++;a++}}}if(a==0){o.max=o.totalItems}else{jQuery("#tb-editvideo-nav-list-next").show()}};var c=function(){var e=TBGlobal.host+"/ModuleManager/quickEditToolbar/quickEditToolbar?v="+TBGlobal.versionNumber;if(loadLocalHTML&&(TBExtension.GetType()=="chrome"||TBExtension.GetType()=="firefox")){e=chrome.extension.getURL("modules/quickedittoolbar.html")}else if(loadLocalHTML&&TBExtension.GetType()=="safari"){e="modules/quickedittoolbar.html"}TBExtension.Get(e,"CRTBLoadQuickEditToolbarTemplate")};var p=function(){if(!o.isFetching){o.isFetching=true;if(o.cookie.url.indexOf("pi=")==-1){o.cookie.url+="&pi=1"}o.cookie.url=TBUtilities.ReplaceAll(o.cookie.url,"pi="+o.cookie.page,"pi="+(parseInt(o.cookie.page)+1));o.cookie.page=parseInt(o.cookie.page)+1;TBUtilities.Log("Next: "+o.cookie.url);o.currentlUrl=o.cookie.url;o.onPage=o.cookie.page;TBExtension.Get(o.cookie.url,"CRTBLoadQuickEditToolbarNextPage")}};var b=function(){if(!o.isFetching){o.isFetching=true;if(o.cookie.url.indexOf("pi=")==-1){o.cookie.url+="&pi=1"}o.cookie.url=TBUtilities.ReplaceAll(o.cookie.url,"pi="+o.cookie.page,"pi="+(parseInt(o.cookie.page)-1));o.cookie.page=parseInt(o.cookie.page)-1;TBUtilities.Log("Prev: "+o.cookie.url);o.currentlUrl=o.cookie.url;o.onPage=o.cookie.page;TBExtension.Get(o.cookie.url,"CRTBLoadQuickEditToolbarPrevPage")}};var y=function(){jQuery(document).on("mouseover",".tb-editvideo-nav-image",function(e){var t=jQuery(this).attr("data-videoid");jQuery(this).parent().parent().find(".tb-editvideo-nav-title"+t).fadeIn("fast")});jQuery(document).on("click",".tb-quickedit-toolbar-link",function(e){if(document.referrer.indexOf("playlist")>-1){TBUtilities.AddAction(null,TBUtilities.ActionTypes.QuickEditToolbar_PlaylistEdit,"quickedittoolbar")}else if(document.referrer.indexOf("my_videos")>-1){TBUtilities.AddAction(null,TBUtilities.ActionTypes.QuickEditToolbar_MyVideosEdit,"quickedittoolbar")}var t=jQuery(this).attr("data-page-url");var i=jQuery(this).attr("data-page");if(t!=o.startingUrl){r(t,i,o.cookie.description)}});jQuery(document).on("mouseleave",".tb-editvideo-nav-image",function(e){var t=jQuery(this).attr("data-videoid");jQuery(this).parent().parent().find(".tb-editvideo-nav-title"+t).hide()});jQuery(document).on("click","#tb-editvideo-nav-list-header-menu, .tb-editvideo-settings-closex",function(){jQuery("#tb-editvideo-nav-list-menu").toggle()});jQuery(document).on("click",".tb-editvideos-hide-editor",function(){jQuery(this).hide();jQuery(".tb-editvideos-show-editor").show();jQuery("#tb-editvideo-nav-video").css("height","24px");jQuery("#tb-editvideo-nav-video").css("width","50px");jQuery("#tb-editvideo-nav-video").css("opacity",".6");TBUtilities.CreateCookie("tb-edit-video-hide-menu",true);jQuery("#tb-editvideo-nav-list-menu").toggle()});jQuery(document).on("click",".tb-editvideos-show-editor",function(){jQuery(this).hide();jQuery(".tb-editvideos-hide-editor").show();jQuery("#tb-editvideo-nav-list-wrapper").slideDown();jQuery("#tb-editvideo-nav-video").css("height","");jQuery("#tb-editvideo-nav-video").css("width","70px");jQuery("#tb-editvideo-nav-video").css("opacity","1");TBUtilities.CreateCookie("tb-edit-video-hide-menu",false);if(!i)n();jQuery("#tb-editvideo-nav-list-menu").toggle()});jQuery(document).on("click","#tb-editvideo-nav-list-prev",function(){if(jQuery("#tb-editvideo-nav-list-prev").css("cursor")=="pointer"){if(o.startingIndex<o.showInList&&o.cookie.page>1&&o.startPage>1){jQuery(this).hide();jQuery("#tb-editvideo-nav-list-loading-prev").show();b()}else{o.startingIndex-=o.showInList;if(o.startingIndex<0)o.startingIndex=0;s()}jQuery("#tb-editvideo-nav-list-loading-more").hide();jQuery("#tb-editvideo-nav-list-next").show()}});jQuery(document).on("click","#tb-editvideo-nav-list-next",function(){if(o.startingIndex+o.showInList>=o.totalItems){jQuery(this).hide();jQuery("#tb-editvideo-nav-list-loading-more").show();p()}else{o.startingIndex+=o.showInList;s()}})};var h=function(){jQuery(document.body).on("CRTBLoadQuickEditToolbarFirstPage",function(e,i){o.isFetching=false;jQuery("#tb-editvideo-nav-list-loading-more").hide();try{if(i.success){var a=i.response;if(o.cookie.url.indexOf("/playlist")>0||o.cookie.url.indexOf("view_all_playlists")>-1){var n=false;if(o.cookie.url.indexOf("/playlist")>-1&&o.cookie.url.indexOf("disable_polymer=true")>-1){n=true}d(a,n)}else{u(a)}if(TBUtilities.GetCookie("tb-edit-video-hide-menu")=="true"){jQuery(".tb-editvideos-hide-editor").hide();jQuery(".tb-editvideos-show-editor").show();jQuery("#tb-editvideo-nav-video").css("height","24px");jQuery("#tb-editvideo-nav-video").css("width","50px");jQuery("#tb-editvideo-nav-video").css("opacity",".6")}jQuery.each(o.cookie.videos,function(e,i){if(i!=null){if(i.v==t){o.startingIndex=e-3;if(o.startingIndex<0)o.startingIndex=0}}});o.startPage=o.cookie.page;if(o.startPage==1){jQuery("#tb-editvideo-nav-list-prev").css("opacity",".2");jQuery("#tb-editvideo-nav-list-prev").css("cursor","default")}jQuery(".tb-quickedittoolbar-description").html(DOMPurify.sanitize(o.cookie.description,DOMPurifyConfig));s()}else{}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyQuickEditToolbar] CRTBLoadQuickEditToolbarFirstPage"})}});jQuery(document.body).on("CRTBLoadQuickEditToolbarNextPage",function(e,t){o.isFetching=false;try{if(t.success){var i=t.response;var a=i.indexOf("VIDEO_LIST_DISPLAY_OBJECT");TBUtilities.Log("currentIndex: "+a);var n=0;var r=0;while(i.indexOf("data-video-id",a)>-1&&a>n){if(a>n)n=a;var l=i.indexOf("data-video-id",a)+"data-video-id".length+3;var d=i.substring(l,l+11);if(d=="__VIDEO_ID"){}else{TBUtilities.Log("videoId: "+d);var u=i.indexOf("vm-video-title-content",l);u=i.indexOf("data-sessionlink=",u);u=i.indexOf("u003e",u)+"u003e".length;var c=i.indexOf("u003c",u)-1;var p=i.substring(u,c);if(!p)p="";p=p.trim();TBUtilities.Log(d+" - "+p);var b="";var y=i.indexOf("vm-private",a);var h=i.substring(y,y+25).indexOf("hid")==-1;if(h){var f=i.indexOf("yt-thumb-clip",a);f=i.indexOf("https",f);var m=i.indexOf('"',f)-1;var g=i.substring(f,m);g=TBUtilities.ReplaceAll(g,"\\/","\\");g=TBUtilities.ReplaceAll(g,"\\u0026amp;","&");b=g}a=i.indexOf("vm-video-item-content-horizontal-divider",a+5);var v=TBUtilities.GetInArray(o.cookie.videos,"v",d);TBUtilities.Log(v);if(!v&&p&&p!="\\n\\n"){o.cookie.videos.push({v:d,t:p,i:b,u:o.currentlUrl,p:o.onPage});o.totalItems++;r++}}}jQuery("#tb-editvideo-nav-list-loading-more").hide();if(r==0){o.max=o.totalItems}else{jQuery("#tb-editvideo-nav-list-next").show()}s()}else{}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyQuickEditToolbar] CRTBLoadQuickEditToolbarNextPage"})}});jQuery(document.body).on("CRTBLoadQuickEditToolbarPrevPage",function(e,t){o.isFetching=false;try{if(t.success){var i=t.response;var a=i.indexOf("VIDEO_LIST_DISPLAY_OBJECT");TBUtilities.Log("currentIndex: "+a);var n=0;var r=false;var l=o.cookie.videos.length;while(i.indexOf("data-video-id",a)>-1&&a>n){if(a>n)n=a;var d=i.indexOf("data-video-id",a)+"data-video-id".length+3;var u=i.substring(d,d+11);if(u=="__VIDEO_ID"){a=a+9999999999}else{TBUtilities.Log("videoId: "+u);var c=i.indexOf("vm-video-title-content",d);c=i.indexOf("data-sessionlink=",c);c=i.indexOf("u003e",c)+"u003e".length;var p=i.indexOf("u003c",c)-1;var b=i.substring(c,p);if(!b)b="";b=b.trim();TBUtilities.Log(u+" - "+b);var y="";var h=i.indexOf("vm-private",a);var f=i.substring(h,h+25).indexOf("hid")==-1;if(f){var m=i.indexOf("yt-thumb-clip",a);m=i.indexOf("https",m);var g=i.indexOf('"',m)-1;var v=i.substring(m,g);v=TBUtilities.ReplaceAll(v,"\\/","\\");v=TBUtilities.ReplaceAll(v,"\\u0026amp;","&");y=v}a=i.indexOf("vm-video-item-content-horizontal-divider",a+5);var T=TBUtilities.GetInArray(o.cookie.videos,"v",u);TBUtilities.Log(T);if(!T&&b){o.cookie.videos.splice(r,0,{v:u,t:b,i:y,u:o.currentlUrl,p:o.onPage});o.totalItems++;r++}}}jQuery("#tb-editvideo-nav-list-loading-prev").hide();if(r>0){jQuery("#tb-editvideo-nav-list-prev").show();o.startingIndex+=r-o.showInList}s()}else{}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyQuickEditToolbar] CRTBLoadQuickEditToolbarPrevPage"})}});jQuery(document.body).on("CRTBLoadQuickEditToolbarTemplate",function(e,t){try{if(t.success){t.response=TBUtilities.FixLocalHtml(DOMPurify.sanitize(t.response,DOMPurifyConfig));jQuery("body").append(t.response);a()}else{}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyQuickEditToolbar] CRTBLoadQuickEditToolbarTemplate"})}})};return{Initialize:function(){if(TBGlobal.IsAuthenticated()){if(!e){t=TBUtilities.GetUrlParameter("video_id");if(!t)t=TBUtilities.GetUrlParameter("v");h();c();y();e=true}else{a()}}},CreateQuickEditToolbarCookie:function(e,t,i){r(e,t,i)}}}();var TubeBuddyQuickEditToolbarStudio=function(){var e=false;var t="";var i=false;var o={startingIndex:0,totalItems:0,showInList:7,currentPage:1,max:9999,cookie:null,isFetching:false,startPage:1,currentlUrl:"",onPage:1,startingUrl:"",isLoadingPlaylists:false};var a=function(){return document.location.href.indexOf("/channel/")>-1&&document.location.href.indexOf("/videos?")>-1};var n=function(){TBUtilities.Log("Quick-Edit Toolbar Referrer: "+document.referrer);var e=TBUtilities.GetCookie("tb_pl_edit");TBUtilities.RemoveCookie("tb_pl_edit");if(document.location.href.indexOf("/videos/upload")>-1||a()){o.totalItems=0;var t=TBUtilities.GetUrlParameter("pi");if(!t)t=1;TBUtilities.Log("Is My Videos Page");s(document.location.href,t,'This list currently shows videos that were last displayed on your <a href="'+document.location.href+'">My Videos</a> page.')}else if(document.location.href.indexOf("/playlist")>-1){TBUtilities.Log("Is Playlist Page");s(document.location.href,1,'This list currently shows videos in the <a href="'+document.location.href+'">'+TBUtilities.GetHtmlEncoded(jQuery(".pl-header-title").text())+"</a> Playlist.")}else{if(e=="1"||document.referrer.indexOf("playlist")>-1||document.location.href.indexOf("/edit")>-1){var i=TBUtilities.GetCookie("tb-quick-edit-toolbar-data"+TBGlobal.CurrentChannelId());if(i){TBUtilities.Log("Fetching initial Quick-Edit Toolbar page");o.cookie=JSON.parse(TBUtilities.GetCookie("tb-quick-edit-toolbar-data"+TBGlobal.CurrentChannelId()));var n=setInterval(function(){var e=jQuery("ytcp-video-metadata-basics #left").is(":visible");if(e===true){clearInterval(n);jQuery("ytcp-video-metadata-basics #left").before(jQuery("#tb-editvideo-nav-video")[0].outerHTML);jQuery("#tb-editvideo-nav-video").before(jQuery("#tb-editvideo-nav-list-menu")[0].outerHTML)}},100);if(TBUtilities.GetCookie("tb-edit-video-hide-menu")!=true&&TBUtilities.GetCookie("tb-edit-video-hide-menu")!="true"){TBUtilities.Log("Not hiding, go fetch results.");r()}else{TBUtilities.Log("Hiding, do not fetch results.");jQuery(".tb-editvideos-hide-editor").hide();jQuery(".tb-editvideos-show-editor").show();jQuery("#tb-editvideo-nav-video").css("height","24px");jQuery("#tb-editvideo-nav-video").css("width","50px");jQuery("#tb-editvideo-nav-video").css("opacity",".6")}}else{TBUtilities.Log("Not a Quick-Edit Toolbar Studio page url")}}else{TBUtilities.Log("Not coming from Playlist or My Videos page")}}};var r=function(){i=true;TBUtilities.Log("Fetching first page: "+o.cookie.url);jQuery("#tb-editvideo-nav-list-loading-more").show();o.currentlUrl=o.cookie.url;o.onPage=o.cookie.page;o.startingUrl=o.cookie.url;TBExtension.Get(o.cookie.url,"CRTBLoadQuickEditToolbarFirstPage")};var s=function(e,t,i){var o={url:e,page:t,videos:[],description:i};TBUtilities.Log("cookie");TBUtilities.Log(o);TBUtilities.RemoveCookie("tb-quick-edit-toolbar-data"+TBGlobal.CurrentChannelId());TBUtilities.CreateCookie("tb-quick-edit-toolbar-data"+TBGlobal.CurrentChannelId(),JSON.stringify(o),7)};var l=function(){if(o.isLoadingPlaylists==true){jQuery("#tb-editvideo-nav-list-loading-more").show();return}var e=window.localStorage.getItem("tb-videos-list-studio-current-url"+TBGlobal.CurrentChannelId());jQuery(".tb-quickedittoolbar-description a").attr("href",e);o.totalItems=o.cookie.videos.length;var i="";var a=0;if(o.startingIndex<0)o.startingIndex=0;jQuery.each(o.cookie.videos,function(e,n){n.editLink="https://studio.youtube.com/video/"+n.v+"/edit";if(e>=o.startingIndex&&e<o.startingIndex+o.showInList){if(n.v==t){i+='<div style="">                       <img style="border:solid 3px red !important;"             class="tb-editvideo-nav-image" data-videoid="'+n.v+'" src="'+(n.i?n.i:"https://i.ytimg.com/vi/"+n.v+"/default.jpg")+'" title="'+TBUtilities.GetHtmlEncoded(n.t)+'" /></div>'}else{i+='<div style=""><a data-page-url="'+n.editLink+'" data-page="'+n.p+'" class="tb-quickedit-toolbar-link" href="'+n.editLink+'"><img style="opacity:.45;" class="tb-editvideo-nav-image" data-videoid="'+n.v+'" src="'+(n.i?n.i:"https://i.ytimg.com/vi/"+n.v+"/default.jpg")+'" title="'+TBUtilities.GetHtmlEncoded(n.t)+'" /></a></div>'}a++}});if(o.startingIndex>0||o.cookie.page>1){jQuery("#tb-editvideo-nav-list-prev").css("cursor","pointer");jQuery("#tb-editvideo-nav-list-prev").css("opacity","1")}else{jQuery("#tb-editvideo-nav-list-prev").css("opacity",".2");jQuery("#tb-editvideo-nav-list-prev").css("cursor","default")}if(o.startingIndex==0&&(o.cookie.page==1||o.startPage==1)){jQuery("#tb-editvideo-nav-list-prev").css("opacity",".2");jQuery("#tb-editvideo-nav-list-prev").css("cursor","default")}else{jQuery("#tb-editvideo-nav-list-prev").css("opacity","1");jQuery("#tb-editvideo-nav-list-prev").css("cursor","pointer")}if(o.totalItems<o.max){jQuery("#tb-editvideo-nav-list-next").show()}else{jQuery("#tb-editvideo-nav-list-next").hide()}if(o.cookie.url.indexOf("playlist")>-1&&o.cookie.videos.length<=o.showInList+o.startingIndex){jQuery("#tb-editvideo-nav-list-next").hide()}jQuery("#tb-editvideo-nav-list").html(i);TBUtilities.Log(o)};var d=function(e){var t=e.indexOf('window["ytInitialData"] = ');t=t+26;var i=e.substring(t,e.length);var o=i.indexOf("};")+1;var i=i.substring(0,o);var a=jQuery.parseJSON(i);return a};var u=function(e,t){var i=0;var a=TBGlobal.GetYouTubeUI();if(t===true){a="default"}else{if(e.indexOf('window["ytInitialData"] = {"responseContext"')>-1){a="material"}}switch(a){case"default":{jQuery(".pl-video",e).each(function(e,t){var a=jQuery(this).attr("data-video-id");var n=jQuery(this).find(".pl-video-title-link").text().trim();var r=jQuery(this).find(".yt-thumb-clip:first").find("img:first").attr("data-thumb");var s=jQuery(this).find(".pl-video-owner").find("a").attr("data-ytid");if(r.indexOf("i.ytimg")>-1){r=""}n=TBUtilities.ReplaceAll(n,"\r","");n=TBUtilities.ReplaceAll(n,"\n","");n=n.trim();if(a&&s==TBGlobal.CurrentChannelId()){var l=TBUtilities.GetInArray(o.cookie.videos,"v",a);TBUtilities.Log(l);if(!l&&n&&n!="\\n\\n"){o.cookie.videos.push({v:a,t:n,i:r,u:o.currentlUrl,p:o.onPage});o.totalItems++;i++}}});break}case"studio":case"material":{o.isLoadingPlaylists=true;var n=d(e);if(n.contents.twoColumnBrowseResultsRenderer.tabs["0"]){try{var r=0;jQuery.each(n.contents.twoColumnBrowseResultsRenderer.tabs["0"].tabRenderer.content.sectionListRenderer.contents["0"].itemSectionRenderer.contents["0"].playlistVideoListRenderer.contents,function(e,t){if(t.playlistVideoRenderer){var a=t.playlistVideoRenderer.videoId;var s=t.playlistVideoRenderer.title.simpleText;var d=t.playlistVideoRenderer.thumbnail.thumbnails["0"].url;TubeBuddyYouTubeActions.GetVideoInfo(a,function(t){r++;if(a&&t!=null&&t.channelid!=null&&t.channelid==TBGlobal.CurrentChannelId()){var u=TBUtilities.GetInArray(o.cookie.videos,"v",a);TBUtilities.Log(u);if(!u&&s&&s!="\\n\\n"){o.cookie.videos.push({v:a,t:s,i:d,u:o.currentlUrl,p:o.onPage,d:t.publishDate,o:e});o.totalItems++;i++}}if(r>=n.contents.twoColumnBrowseResultsRenderer.tabs["0"].tabRenderer.content.sectionListRenderer.contents["0"].itemSectionRenderer.contents["0"].playlistVideoListRenderer.contents.length){o.cookie.videos.sort(function(e,t){return e.o-t.o});o.isLoadingPlaylists=false;jQuery("#tb-editvideo-nav-list-loading-more").hide();l();if(i==0){o.max=o.totalItems}else{o.max=o.totalItems+1;jQuery("#tb-editvideo-nav-list-next").show()}}})}})}catch(e){}}break}}if(i==0){o.max=o.totalItems}else{jQuery("#tb-editvideo-nav-list-next").show()}};var c=function(){var e=0;var t=JSON.parse(window.localStorage.getItem("tb-videos-list-studio-video-info"+TBGlobal.CurrentChannelId()));if(t){t.forEach(function(t){o.cookie.videos.push({v:t.videoId,t:t.title,i:t.thumbnail,u:o.currentlUrl,p:o.onPage});o.totalItems++;e++})}if(e==0){o.max=o.totalItems}else{jQuery("#tb-editvideo-nav-list-next").show()}l()};var p=function(){var e=TBGlobal.host+"/ModuleManager/quickEditToolbarStudio/quickEditToolbarStudio?v="+TBGlobal.versionNumber;if(loadLocalHTML&&(TBExtension.GetType()=="chrome"||TBExtension.GetType()=="firefox")){e=chrome.extension.getURL("modules/quickedittoolbarstudio.html")}else if(loadLocalHTML&&TBExtension.GetType()=="safari"){e="modules/quickedittoolbarstudio.html"}TBExtension.Get(e,"CRTBLoadQuickEditToolbarTemplate")};var b=function(){if(!o.isFetching){o.isFetching=true;if(o.cookie.url.indexOf("pi=")==-1){o.cookie.url+="&pi=1"}o.cookie.url=TBUtilities.ReplaceAll(o.cookie.url,"pi="+o.cookie.page,"pi="+(parseInt(o.cookie.page)+1));o.cookie.page=parseInt(o.cookie.page)+1;TBUtilities.Log("Next: "+o.cookie.url);o.currentlUrl=o.cookie.url;o.onPage=o.cookie.page;TBExtension.Get(o.cookie.url,"CRTBLoadQuickEditToolbarNextPage")}};var y=function(){if(!o.isFetching){o.isFetching=true;if(o.cookie.url.indexOf("pi=")==-1){o.cookie.url+="&pi=1"}o.cookie.url=TBUtilities.ReplaceAll(o.cookie.url,"pi="+o.cookie.page,"pi="+(parseInt(o.cookie.page)-1));o.cookie.page=parseInt(o.cookie.page)-1;TBUtilities.Log("Prev: "+o.cookie.url);o.currentlUrl=o.cookie.url;o.onPage=o.cookie.page;TBExtension.Get(o.cookie.url,"CRTBLoadQuickEditToolbarPrevPage")}};var h=function(){jQuery(document).on("mouseover",".tb-editvideo-nav-image",function(e){var t=jQuery(this).attr("data-videoid");jQuery(this).parent().parent().find(".tb-editvideo-nav-title"+t).fadeIn("fast")});jQuery(document).on("click",".tb-quickedit-toolbar-link",function(e){if(document.referrer.indexOf("playlist")>-1){TBUtilities.AddAction(null,TBUtilities.ActionTypes.QuickEditToolbar_PlaylistEdit,"quickedittoolbar")}else if(document.referrer.indexOf("my_videos")>-1||document.location.href.indexOf("/edit")>-1){TBUtilities.AddAction(null,TBUtilities.ActionTypes.QuickEditToolbar_MyVideosEdit,"quickedittoolbar")}var t=jQuery(this).attr("data-page-url");e.preventDefault();document.location.href=t;var i=jQuery(this).attr("data-page");if(t!=o.startingUrl){s(t,i,o.cookie.description)}});jQuery(document).on("mouseleave",".tb-editvideo-nav-image",function(e){var t=jQuery(this).attr("data-videoid");jQuery(this).parent().parent().find(".tb-editvideo-nav-title"+t).hide()});jQuery(document).on("click","#tb-editvideo-nav-list-header-menu, .tb-editvideo-settings-closex",function(){jQuery("#tb-editvideo-nav-list-menu").toggle()});jQuery(document).on("click",".tb-editvideos-hide-editor",function(){jQuery(this).hide();jQuery(".tb-editvideos-show-editor").show();jQuery("#tb-editvideo-nav-video").css("height","24px");jQuery("#tb-editvideo-nav-video").css("width","50px");jQuery("#tb-editvideo-nav-video").css("opacity",".6");TBUtilities.CreateCookie("tb-edit-video-hide-menu",true);jQuery("#tb-editvideo-nav-list-menu").toggle()});jQuery(document).on("click",".tb-editvideos-show-editor",function(){jQuery(this).hide();jQuery(".tb-editvideos-hide-editor").show();jQuery("#tb-editvideo-nav-list-wrapper").slideDown();jQuery("#tb-editvideo-nav-video").css("height","");jQuery("#tb-editvideo-nav-video").css("width","80px");jQuery("#tb-editvideo-nav-video").css("opacity","1");TBUtilities.CreateCookie("tb-edit-video-hide-menu",false);if(!i||!o.cookie.videos.length)r();jQuery("#tb-editvideo-nav-list-menu").toggle()});jQuery(document).on("click","#tb-editvideo-nav-list-prev",function(){if(jQuery("#tb-editvideo-nav-list-prev").css("cursor")=="pointer"){if(o.startingIndex<o.showInList&&o.cookie.page>1&&o.startPage>1){jQuery(this).hide();jQuery("#tb-editvideo-nav-list-loading-prev").show();y()}else{o.startingIndex-=o.showInList;if(o.startingIndex<0)o.startingIndex=0;l()}jQuery("#tb-editvideo-nav-list-loading-more").hide();jQuery("#tb-editvideo-nav-list-next").show()}});jQuery(document).on("click","#tb-editvideo-nav-list-next",function(){if(o.startingIndex+o.showInList>=o.totalItems){jQuery(this).hide();jQuery("#tb-editvideo-nav-list-loading-more").show();b()}else{o.startingIndex+=o.showInList;l()}})};var f=function(){jQuery(document.body).on("CRTBLoadQuickEditToolbarFirstPage",function(e,i){o.isFetching=false;jQuery("#tb-editvideo-nav-list-loading-more").hide();jQuery("#tb-editvideo-container").show();try{if(i.success){var a=i.response;if(o.cookie.url.indexOf("/playlist")>0||o.cookie.url.indexOf("view_all_playlists")>-1){var n=false;if(o.cookie.url.indexOf("/playlist")>-1&&o.cookie.url.indexOf("disable_polymer=true")>-1){n=true}u(a,n)}else{c()}if(TBUtilities.GetCookie("tb-edit-video-hide-menu")=="true"){jQuery(".tb-editvideos-hide-editor").hide();jQuery(".tb-editvideos-show-editor").show();jQuery("#tb-editvideo-nav-video").css("height","24px");jQuery("#tb-editvideo-nav-video").css("width","50px");jQuery("#tb-editvideo-nav-video").css("opacity",".6")}else{jQuery(".tb-editvideos-show-editor").hide();jQuery(".tb-editvideos-hide-editor").show();jQuery("#tb-editvideo-nav-video").css("height","");jQuery("#tb-editvideo-nav-video").css("width","80px");jQuery("#tb-editvideo-nav-video").css("opacity","1")}jQuery.each(o.cookie.videos,function(e,i){if(i!=null){if(i.v==t){o.startingIndex=e-3;if(o.startingIndex<0)o.startingIndex=0}}});o.startPage=o.cookie.page;if(o.startPage==1){jQuery("#tb-editvideo-nav-list-prev").css("opacity",".2");jQuery("#tb-editvideo-nav-list-prev").css("cursor","default")}jQuery(".tb-quickedittoolbar-description").html(o.cookie.description);l()}else{}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyQuickEditToolbar] CRTBLoadQuickEditToolbarFirstPage"})}});jQuery(document.body).on("CRTBLoadQuickEditToolbarNextPage",function(e,t){o.isFetching=false;try{if(t.success){var i=t.response;var a=i.indexOf("VIDEO_LIST_DISPLAY_OBJECT");TBUtilities.Log("currentIndex: "+a);var n=0;var r=0;while(i.indexOf("data-video-id",a)>-1&&a>n){if(a>n)n=a;var s=i.indexOf("data-video-id",a)+"data-video-id".length+3;var d=i.substring(s,s+11);if(d=="__VIDEO_ID"){}else{TBUtilities.Log("videoId: "+d);var u=i.indexOf("vm-video-title-content",s);u=i.indexOf("data-sessionlink=",u);u=i.indexOf("u003e",u)+"u003e".length;var c=i.indexOf("u003c",u)-1;var p=i.substring(u,c);if(!p)p="";p=p.trim();TBUtilities.Log(d+" - "+p);var b="";var y=i.indexOf("vm-private",a);var h=i.substring(y,y+25).indexOf("hid")==-1;if(h){var f=i.indexOf("yt-thumb-clip",a);f=i.indexOf("https",f);var m=i.indexOf('"',f)-1;var g=i.substring(f,m);g=TBUtilities.ReplaceAll(g,"\\/","\\");g=TBUtilities.ReplaceAll(g,"\\u0026amp;","&");b=g}a=i.indexOf("vm-video-item-content-horizontal-divider",a+5);var v=TBUtilities.GetInArray(o.cookie.videos,"v",d);TBUtilities.Log(v);if(!v&&p&&p!="\\n\\n"){o.cookie.videos.push({v:d,t:p,i:b,u:o.currentlUrl,p:o.onPage});o.totalItems++;r++}}}jQuery("#tb-editvideo-nav-list-loading-more").hide();if(r==0){o.max=o.totalItems}else{jQuery("#tb-editvideo-nav-list-next").show()}l()}else{}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyQuickEditToolbar] CRTBLoadQuickEditToolbarNextPage"})}});jQuery(document.body).on("CRTBLoadQuickEditToolbarPrevPage",function(e,t){o.isFetching=false;try{if(t.success){var i=t.response;var a=i.indexOf("VIDEO_LIST_DISPLAY_OBJECT");TBUtilities.Log("currentIndex: "+a);var n=0;var r=false;var s=o.cookie.videos.length;while(i.indexOf("data-video-id",a)>-1&&a>n){if(a>n)n=a;var d=i.indexOf("data-video-id",a)+"data-video-id".length+3;var u=i.substring(d,d+11);if(u=="__VIDEO_ID"){a=a+9999999999}else{TBUtilities.Log("videoId: "+u);var c=i.indexOf("vm-video-title-content",d);c=i.indexOf("data-sessionlink=",c);c=i.indexOf("u003e",c)+"u003e".length;var p=i.indexOf("u003c",c)-1;var b=i.substring(c,p);if(!b)b="";b=b.trim();TBUtilities.Log(u+" - "+b);var y="";var h=i.indexOf("vm-private",a);var f=i.substring(h,h+25).indexOf("hid")==-1;if(f){var m=i.indexOf("yt-thumb-clip",a);m=i.indexOf("https",m);var g=i.indexOf('"',m)-1;var v=i.substring(m,g);v=TBUtilities.ReplaceAll(v,"\\/","\\");v=TBUtilities.ReplaceAll(v,"\\u0026amp;","&");y=v}a=i.indexOf("vm-video-item-content-horizontal-divider",a+5);var T=TBUtilities.GetInArray(o.cookie.videos,"v",u);TBUtilities.Log(T);if(!T&&b){o.cookie.videos.splice(r,0,{v:u,t:b,i:y,u:o.currentlUrl,p:o.onPage});o.totalItems++;r++}}}jQuery("#tb-editvideo-nav-list-loading-prev").hide();if(r>0){jQuery("#tb-editvideo-nav-list-prev").show();o.startingIndex+=r-o.showInList}l()}else{}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyQuickEditToolbar] CRTBLoadQuickEditToolbarPrevPage"})}});jQuery(document.body).on("CRTBLoadQuickEditToolbarTemplate",function(e,t){try{if(t.success){t.response=TBUtilities.FixLocalHtml(DOMPurify.sanitize(t.response,DOMPurifyConfig));jQuery("body").append(t.response);n()}else{}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyQuickEditToolbar] CRTBLoadQuickEditToolbarTemplate"})}})};return{Initialize:function(){if(TBGlobal.IsAuthenticated()){if(!e){t=document.location.href.indexOf("/video/")>-1?document.location.href.split("/video/")[1].substr(0,11):"";if(!t)t=TBUtilities.GetUrlParameter("v");f();p();h();e=true}else{t=document.location.href.indexOf("/video/")>-1?document.location.href.split("/video/")[1].substr(0,11):"";n()}}},CreateQuickEditToolbarCookie:function(e,t,i){s(e,t,i)}}}();var TubeBuddyPlaylist=function(){var e=false;var t="";var i=function(){jQuery(".playlist-add-video-button").before(jQuery(".tb-playlist-embed-playlist:last")[0].outerHTML);jQuery(".playlist-add-video-button").before(jQuery(".tb-playlist-edit-video:last")[0].outerHTML)};var o=function(){var e=TBGlobal.host+"/ModuleManager/playlist/playlist?v="+TBGlobal.versionNumber;if(loadLocalHTML&&(TBExtension.GetType()=="chrome"||TBExtension.GetType()=="firefox")){e=chrome.extension.getURL("modules/playlist.html")}else if(loadLocalHTML&&TBExtension.GetType()=="safari"){e="modules/playlist.html"}TBExtension.Get(e,"CRTBLoadPlaylistTemplate")};var a=function(){jQuery(document).on("click",".tb-playlist-embed-playlist",function(e){e.stopPropagation();e.preventDefault();var t=jQuery(".pl-header-title").text();var i=TBUtilities.GetUrlParameter("list");var o=jQuery(".pl-header-thumb").find("img").attr("src");TubeBuddyEmbed.ShowForPlaylist(i,t,o)});jQuery(document).on("click",".tb-playlist-edit-video",function(e){e.stopPropagation();e.preventDefault();jQuery(".tb-playlist-edit-video-loading").show();var t=TBUtilities.GetUrlParameter("list");TBExtension.Get("https://www.youtube.com/playlist?list="+t+"&disable_polymer=true","CRTBLoadPlaylistGetPlaylist")})};var n=function(e){var t=e.indexOf('window["ytInitialData"] = ');t=t+26;var i=e.substring(t,e.length);var o=i.indexOf("};")+1;var i=i.substring(0,o);var a=jQuery.parseJSON(i);return a};var r=function(e,t,i){var o=TBUtilities.GetUrlParameter("list");if(t){if(TBExtension.GetType()=="firefox")TBUtilities.CreateCookie("tb_pl_edit","1");TubeBuddyQuickEditToolbar.CreateQuickEditToolbarCookie("https://www.youtube.com/playlist?list="+o,1,'This list currently shows videos in the <a target="_blank" href="https://www.youtube.com/playlist?list='+o+'">'+TBUtilities.GetHtmlEncoded(e)+"</a> Playlist.");document.location.href="https://www.youtube.com/edit?video_id="+t}else if(i){jQuery(".tb-playlist-edit-video-loading").hide();TBUtilities.Alert("This playlist does not contain any videos that you own.")}else{jQuery(".tb-playlist-edit-video-loading").hide();TBUtilities.Alert("This playlist does not contain any videos.")}};var s=function(){jQuery(document.body).on("CRTBLoadPlaylistGetPlaylist",function(e,t){try{if(t.success){var i="";var o=false;var a="default";if(t.response.indexOf('window["ytInitialData"] = {"responseContext"')>-1){a="material"}switch(a){case"default":{var s=DOMPurify.sanitize(t.response,DOMPurifyConfig);var l=jQuery(".pl-header-title",s).text().trim();jQuery(".pl-video",s).each(function(e,t){var a=jQuery(this).attr("data-video-id");o=true;if(a&&!i){i=a;return false}});r(l,i,o);break}case"studio":case"material":{var s=DOMPurify.sanitize(t.response,DOMPurifyConfig);var l=jQuery("title",s).text().replace(" - YouTube","").trim();var d=n(t.response);if(d.contents.twoColumnBrowseResultsRenderer.tabs["0"]){try{jQuery.each(d.contents.twoColumnBrowseResultsRenderer.tabs["0"].tabRenderer.content.sectionListRenderer.contents["0"].itemSectionRenderer.contents["0"].playlistVideoListRenderer.contents,function(e,t){if(t.playlistVideoRenderer){var a=t.playlistVideoRenderer.videoId;i=a;o=true;return false}})}catch(e){o=false}}r(l,i,o);break}}}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyPlaylist] CRTBLoadAllPlaylistTemplate"})}});jQuery(document.body).on("CRTBLoadPlaylistTemplate",function(e,t){try{if(t.success){t.response=TBUtilities.FixLocalHtml(DOMPurify.sanitize(t.response,DOMPurifyConfig));jQuery("body").append(t.response);i()}else{}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyPlaylist] CRTBLoadPlaylistTemplate"})}})};return{Initialize:function(){if(TBGlobal.IsAuthenticated()){if(!e){t=TBUtilities.GetUrlParameter("list");s();o();a();e=true}else{i()}}}}}();var TubeBuddyAllPlaylists=function(){var e=false;var t="";var i=[];var o=0;var a="";var n="";var r="";var s=false;var l=function(){jQuery(".vm-pl-edit").each(function(){var e=jQuery(this).find(".vm-playlist-edit-button").attr("href");e=e.substring(e.indexOf("=")+1,e.length);jQuery(this).find(".yt-uix-button-content").text("Edit Playlist");jQuery(this).find(".vm-playlist-edit-button").before(jQuery(".tb-playlists-edit-videos:last")[0].outerHTML.replace("#PLAYLISTID#",e));jQuery(this).parent().find(".vm-pl-thumbs").before(jQuery(".tb-playlist-checkbox:last")[0].outerHTML.replace("#PLAYLISTID#",e))});if(jQuery(".vm-video-actions-inner").length==1){jQuery("#creator-subheader").after(jQuery(".tb-all-playlists-bar")[0].innerHTML)}jQuery(".vm-video-actions-inner:first").prepend(jQuery(".tb-playlists-bulk-dropdown-template:last")[0].outerHTML);jQuery(".vm-video-actions-inner:first").prepend(jQuery(".tb-playlist-bulk-list-dropdown:last")[0].outerHTML);jQuery(".vm-video-actions-inner:first").prepend(jQuery(".tb-playlist-checkbox-select-all:last")[0].outerHTML)};var d=function(){var e=TBGlobal.host+"/ModuleManager/allPlaylists?v="+TBGlobal.versionNumber;if(loadLocalHTML&&(TBExtension.GetType()=="chrome"||TBExtension.GetType()=="firefox")){e=chrome.extension.getURL("modules/allplaylists.html")}else if(loadLocalHTML&&TBExtension.GetType()=="safari"){e="modules/allplaylists.html"}TBExtension.Get(e,"CRTBLoadAllPlaylistTemplate")};var u=function(e){jQuery(".tb-playlists-bulk-dropdown-template").addClass("tb-hid")};var c=function(){jQuery(document).on("click","#page",function(){if(!s)u();jQuery(".tb-all-playlists-processing-container").hide()});jQuery(document).on("click",".tb-playlists-edit-videos",function(){jQuery(this).find(".tb-playlist-edit-video-loading").show();t=jQuery(this).attr("data-playlist-id");TBExtension.Get("https://www.youtube.com/playlist?list="+t,"CRTBLoadAllPlaylistGetPlaylist")});jQuery(document).on("click",".tb-playlistactions-templates-closex",function(e){u();jQuery(".tb-all-playlists-processing-container").hide()});jQuery(document).on("click",".tb-playlist-bulk-list-dropdown",function(e){jQuery(".tb-playlists-bulk-dropdown-template:first").removeClass("tb-hid");e.stopPropagation()});jQuery(document).on("click",".tb-all-playlists-apply",function(e){if(s)return;var t=jQuery("#vm-playlist-video-list-ol .playlist-checkbox:checked").length;if(t==0){TBUtilities.Alert("You haven't selected any Playlists to modify.");return}var o=jQuery(".tb-playlist-bulk-privacy:first").val();var a=jQuery(".tb-playlist-bulk-ordering:first").val();var n=jQuery(".tb-playlist-bulk-filtering:first").val();if(o=="NONE"&&a=="NONE"&&n=="NONE"){TBUtilities.Alert("You have to choose a Privacy, Ordering or Filter update before you can apply changes.");return}var r="";if(o!="NONE")r+="<br>&nbsp;&nbsp;&gt; Privacy: "+jQuery(".tb-playlist-bulk-privacy:first option:selected").text();if(a!="NONE")r+="<br>&nbsp;&nbsp;&gt; Ordering: "+jQuery(".tb-playlist-bulk-ordering:first option:selected").text();if(n!="NONE")r+="<br>&nbsp;&nbsp;&gt; Clean Up: "+jQuery(".tb-playlist-bulk-filtering:first option:selected").text();if(!TBGlobal.CanAccessLevel2Tools()&&i.length>1){TBGlobal.ShowUpgradePage("update multiple Playlists at a time",TBGlobal.limitation.bulkupdateplaylists);return}if(!TBGlobal.CanAccessLevel1Tools()&&(a=="MostLiked"||a=="MostCommented"||a=="MostSubscribersGenerated"||a=="MostShared"||a=="HighestAvgViewDuration"||a=="HighestAvgViewPercentage")){TBGlobal.ShowUpgradePage("use any Analytics Ordering options",TBGlobal.limitation.playlistactions);return}var l="s";if(i.length==1){l=""}else{TBUtilities.AddAction({VideoCount:i.length},TBUtilities.ActionTypes.Playlists_BulkUpdate,"bulkupdateplaylists")}if(TBUtilities.Confirm("You have chosen to update "+i.length+" Playlist"+l+" <Br> "+r+"<br><Br>Contiue with the update?",function(){p()}));});jQuery(document).on("click",".tb-playlists-bulk-dropdown-template",function(e){e.stopPropagation()});jQuery(document).on("click","#vm-playlist-video-list-ol .playlist-checkbox",function(){if(jQuery(this).is(":checked")){jQuery(this).closest(".playlist-item").css("background-color","#ecf4fb")}else{jQuery(this).closest(".playlist-item").css("background-color","transparent")}y()});jQuery(document).on("click change",".tb-playlist-bulk-privacy:first",function(){y()});jQuery(document).on("click change",".tb-playlist-bulk-ordering:first",function(){y()});jQuery(document).on("click change",".tb-playlist-bulk-filtering:first",function(){y()});jQuery(document).on("click",".vm-playlist-select-all",function(){if(jQuery(this).is(":checked")){jQuery("#vm-playlist-video-list-ol .playlist-checkbox").prop("checked",false);jQuery("#vm-playlist-video-list-ol .playlist-checkbox").trigger("click")}else{jQuery("#vm-playlist-video-list-ol .playlist-checkbox").prop("checked",true);jQuery("#vm-playlist-video-list-ol .playlist-checkbox").trigger("click")}})};var p=function(){s=true;a=jQuery(".tb-playlist-bulk-privacy:first").val();n=jQuery(".tb-playlist-bulk-ordering:first").val();r=jQuery(".tb-playlist-bulk-filtering:first").val();o=1;TBUtilities.Log(i);TBUtilities.Log(a);TBUtilities.Log(n);TBUtilities.Log(r);jQuery(".tb-all-playlists-videoofx").text(i.length);b();jQuery(".tb-all-playlists-processing-container").show();jQuery(".tb-all-playlists-processing").show();jQuery(".tb-all-playlists-processing-complete").hide();jQuery(".tb-all-playlists-apply").prop("disabled",true);jQuery(".tb-all-playlists-apply").attr("disabled","disabled");jQuery(".tb-all-playlists-processing-results").show();jQuery(".tb-all-playlists-processing-results").html("")};var b=function(){jQuery(".tb-all-playlists-videox").text(o);TBUtilities.Log("Processing: "+o+" of "+i.length+" ("+i[o-1]+")");if(n&&n!="NONE")TBUtilities.AddAction({Data:i[o-1]},TBUtilities.ActionTypes.Playlist_UpdateOrdering,"playlistactions");var e=TBGlobal.host+TBGlobal.apiUrls.playlistsUpdatePlaylist;var t={Privacy:a,Ordering:n,Filtering:r,PlaylistId:i[o-1],FixedAtStart:0,FixedAtEnd:0};TBExtension.Post(e,JSON.stringify(t),"CRTBAllPlaylistApplyChanges",null,{contentType:"application/json"})};var y=function(){jQuery(".tb-all-playlists-apply").prop("disabled",false);jQuery(".tb-all-playlists-apply").removeAttr("disabled");var e=jQuery("#vm-playlist-video-list-ol .playlist-checkbox:checked").length;if(e==0){jQuery(".tb-all-playlists-selected-count").html('<span class="tb-font-medium" style="color:#FA3535"><img src="'+TBGlobal.host+'/images/icons/error.png" style="position:relative; top:2px;" /> You haven\'t selected any Playlists</span>');jQuery(".tb-all-playlists-apply").prop("disabled",true);jQuery(".tb-all-playlists-apply").attr("disabled","disabled")}else if(e==1){jQuery(".tb-all-playlists-selected-count").html('<span class="tb-font-medium"><img src="'+TBGlobal.host+'/images/icons/playlists.png" style="position:relative; top:2px; height:14px;" /> You have <span class="tb-font-cbold">1</span> Playlist selected</span>')}else{jQuery(".tb-all-playlists-selected-count").html('<span class="tb-font-medium"><img src="'+TBGlobal.host+'/images/icons/playlists.png" style="position:relative; top:2px; height:14px;" /> You have <span class="tb-font-cbold">'+e+"</span> Playlists selected</span>")}i=[];jQuery("#vm-playlist-video-list-ol .playlist-checkbox:checked").each(function(){var e=jQuery(this).attr("value");i.push(e)});a=jQuery(".tb-playlist-bulk-privacy:first").val();n=jQuery(".tb-playlist-bulk-ordering:first").val();r=jQuery(".tb-playlist-bulk-filtering:first").val();if(a=="NONE"&&n=="NONE"&&r=="NONE"){jQuery(".tb-all-playlists-apply").prop("disabled",true);jQuery(".tb-all-playlists-apply").attr("disabled","disabled")}};var h=function(e,i,o){if(i){if(TBExtension.GetType()=="firefox")TBUtilities.CreateCookie("tb_pl_edit","1");TubeBuddyQuickEditToolbar.CreateQuickEditToolbarCookie("https://www.youtube.com/playlist?list="+t,1,'This list currently shows videos in the <a target="_blank" href="https://www.youtube.com/playlist?list='+t+'">'+TBUtilities.GetHtmlEncoded(e)+"</a> Playlist.");document.location.href="https://www.youtube.com/edit?video_id="+i}else if(o){jQuery(".tb-playlist-edit-video-loading").hide();TBUtilities.Alert("This playlist does not contain any videos that you own.")}else{jQuery(".tb-playlist-edit-video-loading").hide();TBUtilities.Alert("This playlist does not contain any videos.")}};var f=function(e){var t=e.indexOf('window["ytInitialData"] = ');t=t+26;var i=e.substring(t,e.length);var o=i.indexOf("};")+1;var i=i.substring(0,o);var a=jQuery.parseJSON(i);return a};var m=function(){jQuery(document.body).on("CRTBLoadAllPlaylistTemplate",function(e,t){try{if(t.success){t.response=TBUtilities.FixLocalHtml(DOMPurify.sanitize(t.response,DOMPurifyConfig));jQuery("body").append(t.response);l()}else{}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyPlaylist] CRTBLoadAllPlaylistTemplate"})}});jQuery(document.body).on("CRTBLoadAllPlaylistGetPlaylist",function(e,t){try{if(t.success){var i="";var o=false;var a=TBGlobal.GetYouTubeUI();if(t.response.indexOf('window["ytInitialData"] = {"responseContext"')>-1){a="material"}switch(a){case"default":{var n=DOMPurify.sanitize(t.response,DOMPurifyConfig);var r=jQuery(".pl-header-title",n).text().trim();jQuery(".pl-video",n).each(function(e,t){var a=jQuery(this).attr("data-video-id");var n=jQuery(this).find(".pl-video-owner").find("a").attr("data-ytid");o=true;if(a&&!i&&n==TBGlobal.CurrentChannelId()){i=a;return false}});h(r,i,o);break}case"studio":case"material":{var n=DOMPurify.sanitize(t.response,DOMPurifyConfig);var r=jQuery("title",n).text().replace(" - YouTube","").trim();var s=f(t.response);if(s.contents.twoColumnBrowseResultsRenderer.tabs["0"]){try{jQuery.each(s.contents.twoColumnBrowseResultsRenderer.tabs["0"].tabRenderer.content.sectionListRenderer.contents["0"].itemSectionRenderer.contents["0"].playlistVideoListRenderer.contents,function(e,t){if(t.playlistVideoRenderer){var a=t.playlistVideoRenderer.videoId;i=a;o=true;return false}})}catch(e){o=false}}h(r,i,o);break}}}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyPlaylist] CRTBLoadAllPlaylistTemplate"})}});jQuery(document.body).on("CRTBAllPlaylistApplyChanges",function(e,t){try{jQuery(".tb-all-playlists-processing-results").append(TBUtilities.ReplaceAll(t.response,'"',""));if(o<i.length){o++;jQuery(".tb-all-playlists-videox").text(o);b()}else{jQuery(".tb-all-playlists-processing-complete").show();jQuery(".tb-all-playlists-apply").show();jQuery(".tb-all-playlists-processing").hide();jQuery(".tb-all-playlists-apply").prop("disabled",false);jQuery(".tb-all-playlists-apply").removeAttr("disabled");s=false}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyPlaylist] CRTBAllPlaylistApplyChanges"});jQuery(".tb-all-playlists-processing-complete").show();jQuery(".tb-all-playlists-apply").show();jQuery(".tb-all-playlists-processing").hide();jQuery(".tb-all-playlists-apply").prop("disabled",false);jQuery(".tb-all-playlists-apply").removeAttr("disabled");s=false}})};return{Initialize:function(){if(TBGlobal.IsAuthenticated()){if(!e){m();d();c();jQuery("div#vm-create-playlist-dialog").removeClass("hid");e=true}else{l()}}}}}();var TubeBuddyUploadDefaults=function(){var e=false;var t="default";var i="[YouTube]";var o=[];var a=null;var n=function(){TBUtilities.Log("TubeBuddyUploadDefaults - populateUploadDefaults");try{var e=TBUtilities.GetInArray(o,"Id",t);jQuery(".privacy-input").val(e.Privacy);jQuery(".category-input").val(e.Category=="0"?"":e.Category);jQuery("#license-select").val(e.License);jQuery("#title").val(e.Title);jQuery("#description").val(e.Description);jQuery("#tags").val(e.Tags);jQuery("[name=allow_comments]").prop("checked",e.AllowComments);jQuery("[name=allow_comments_type]").val(e.AllowCommentsDetail);jQuery("[name=allow_ratings]").prop("checked",e.UsersCanViewRatingsForThisVideo);jQuery("#default-monetize").prop("checked",e.MonetizeWithAds);jQuery("[name=overlay_ads]").prop("checked",e.OverlayInVideoAds);jQuery("#trueview-instream-ads-checkbox").prop("checked",e.SkippableVideoAds);jQuery(".yt-languagepicker-button").find("span.yt-uix-button-content").text(e.VideoLanguage);jQuery("[name=audio_language]").val(e.VideoLanguageAbbreviation);jQuery("[name=captions_certificate]").val(e.CaptionCertification=="0"?"":e.CaptionCertification);jQuery("[name=suggested_edits]").val(e.SuggestVideoImprovements);jQuery("[name=location_longitude]").val(e.LocationLongitude);jQuery("[name=location_latitude]").val(e.LocationLatitude);jQuery("[name=allow_public_stats]").prop("checked",e.VideoStatisticsPublic);jQuery("[name=allow_comment_ratings]").prop("checked",e.UsersCanVoteOnComments);jQuery("[name=instream_ads]").prop("checked",e.NonSkipableVideoAds);jQuery("[name=long_instream_ads]").prop("checked",e.LongNonSkipableVideoAds);if(e.LocationLongitude!=""&&e.LocationLongitude!=0){jQuery(".location-input").val(e.LocationLongitude+", "+e.LocationLatitude)}else{jQuery(".location-input").val("")}jQuery(".yt-uix-form-input-select").each(function(){jQuery(this).find(".yt-uix-form-input-select-value").text(jQuery(this).find(".yt-uix-form-input-select-element option:selected").text())});if(i=="[YouTube]")jQuery("[value=scheduled]").css("display","none");else jQuery("[value=scheduled]").css("display","")}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyUploadDefaults] populateUploadDefaults"})}};var r=function(){try{if(jQuery(".tb-upload-defaults-container").length==1)jQuery(".creator-subheader-controls:first").prepend(jQuery(".tb-upload-defaults-container:last")[0].outerHTML);jQuery(".creator-subheader-controls:first").css("text-align","right");jQuery(".account-save-button:first").css("margin-top","7px");jQuery(".account-content").append(jQuery(".tb-upload-defaults-debug-code")[0].outerHTML);if(a==null){a={Id:"default",YouTubeChannelId:TBGlobal.CurrentChannelId(),Privacy:jQuery(".privacy-input:first").val(),Category:jQuery(".category-input:first").val(),License:jQuery("#license-select").val(),Title:jQuery("#title").val(),Description:jQuery("#description").val(),Tags:jQuery("#tags").val(),AllowComments:jQuery("[name=allow_comments]").is(":checked"),AllowCommentsDetail:jQuery("[name=allow_comments_type]").val(),UsersCanViewRatingsForThisVideo:jQuery("[name=allow_ratings]").is(":checked"),MonetizeWithAds:jQuery("#default-monetize").is(":checked"),OverlayInVideoAds:jQuery("[name=overlay_ads]").is(":checked"),SkippableVideoAds:jQuery("#trueview-instream-ads-checkbox").is(":checked"),VideoLanguage:jQuery(".yt-languagepicker-button").find("span.yt-uix-button-content").text(),CaptionCertification:jQuery("[name=captions_certificate]").val(),SuggestVideoImprovements:jQuery("[name=suggested_edits]").val(),LocationLongitude:jQuery("[name=location_longitude]").val(),LocationLatitude:jQuery("[name=location_latitude]").val(),VideoStatisticsPublic:jQuery("[name=allow_public_stats]").is(":checked"),UsersCanVoteOnComments:jQuery("[name=allow_comment_ratings]").is(":checked"),NonSkipableVideoAds:jQuery("[name=instream_ads]").is(":checked"),LongNonSkipableVideoAds:jQuery("[name=long_instream_ads]").is(":checked"),VideoLanguageAbbreviation:jQuery("#yt-languagepicker-input-audio_language").val(),Name:"[YouTube]"}}if(jQuery(".privacy-input:first")[0].outerHTML.indexOf("scheduled")==-1)jQuery(".privacy-input:first").append('<option value="scheduled">Scheduled</option>');o=[];o.push(a);TBUtilities.Log(Object.values(a)+" Profile ");TBUtilities.Log("TubeBuddyUploadDefaults - calling upload defaults get list");var e=TBGlobal.host+TBGlobal.apiUrls.uploadDefaultsList;TBExtension.Get(e,"CRUploadDefaultsGetList")}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyUploadDefaults] populateContent"})}};var s=function(){var e=TBGlobal.host+"/ModuleManager/UploadDefaults/UploadDefaults?v="+TBGlobal.versionNumber;if(loadLocalHTML&&(TBExtension.GetType()=="chrome"||TBExtension.GetType()=="firefox")){e=chrome.extension.getURL("modules/uploaddefaults.html")}else if(loadLocalHTML&&TBExtension.GetType()=="safari"){e="modules/uploaddefaults.html"}TBExtension.Get(e,"CRTBLoadUploadDefaultsTemplate")};var l=function(){jQuery(document).on("change",".tb-upload-defaults-select",function(){try{TBUtilities.Log("TubeBuddyUploadDefaults - tb-upload-defaults-select change ");if(jQuery(this).val()!=="default"){jQuery(".tb-upload-default-delete-button").removeAttr("disabled");jQuery(".tb-upload-default-delete-button").attr("data-tooltip-text","Delete this Profile");jQuery(".tb-upload-default-save-button").show();jQuery(".account-save-button").hide()}else{jQuery(".tb-upload-default-delete-button").attr("disabled","disabled");jQuery(".tb-upload-default-delete-button").attr("data-tooltip-text","You can't delete the [YouTube] Profile");jQuery(".tb-upload-default-save-button").hide();jQuery(".account-save-button").show()}t=jQuery(this).val();i=jQuery(this).find("option:selected").text();TBUtilities.Log(t);TBUtilities.Log(i);jQuery(this).attr("title",i);n()}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyUploadDefaults] .tb-upload-defaults-select [change]"})}});jQuery(document).on("click",".tb-upload-defaults-debug-code",function(){TBUtilities.Confirm("Are you sure you want to send your Debug Code to the developers at TubeBuddy?\n\nOnly do this if they have asked you to. Thanks!",function(){TBGlobal.AddUserDebugInfo("UPLOAD DEFAULTS<Br>"+jQuery("body").html());TBUtilities.AddActivityLog({Data:TBGlobal.UserDebugCode()},TBUtilities.ActivityLogTypes.Layout_SubmitDebugCode);TBUtilities.Alert("Thanks! We will review the info and get back to you.")},function(){})});jQuery(document).on("click",".tb-upload-default-delete-button",function(){try{TBUtilities.Log("TubeBuddyUploadDefaults -  tb-upload-default-delete-button click");if(jQuery(this).attr("disabled")==="disabled")return;TBUtilities.Confirm('Are you sure you want to delete the profile?\n\n"'+jQuery(".tb-upload-defaults-select:first option:selected").text()+'"',function(){var e=TBGlobal.host+TBGlobal.apiUrls.uploadDefaultsDelete;var i=jQuery.param({Id:t});TBExtension.Post(e,i,"CRUploadDefaultsDelete",null,{contentType:"application/x-www-form-urlencoded; charset=UTF-8"})},function(){})}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyUploadDefaults] .tb-upload-default-delete-button [change]"})}});jQuery(document).on("click",".tb-upload-default-save-button",function(){try{TBUtilities.Log("TubeBuddyUploadDefaults -  tb-upload-default-save-button click");if(jQuery("#description").val().length>5e3){TBUtilities.Alert("Sorry, your Description is too long (YouTube only allows up to 5,000 characters).<Br><br>You have "+TBUtilities.FormatNumberWithCommas(jQuery("#description").val().length)+" characters. Please reduce it to 5,000 or fewer.");return}var e=TBGlobal.host+TBGlobal.apiUrls.uploadDefaultsUpdate;var o=jQuery.param({Id:t,YouTubeChannelId:TBGlobal.CurrentChannelId(),Privacy:jQuery(".privacy-input:first").val(),Category:jQuery(".category-input:first").val(),License:jQuery("#license-select").val(),Title:jQuery("#title").val(),Description:jQuery("#description").val(),Tags:jQuery("#tags").val(),AllowComments:jQuery("[name=allow_comments]").is(":checked"),AllowCommentsDetail:jQuery("[name=allow_comments_type]").val(),UsersCanViewRatingsForThisVideo:jQuery("[name=allow_ratings]").is(":checked"),MonetizeWithAds:jQuery("#default-monetize").is(":checked"),OverlayInVideoAds:jQuery("[name=overlay_ads]").is(":checked"),SkippableVideoAds:jQuery("#trueview-instream-ads-checkbox").is(":checked"),VideoLanguage:jQuery(".yt-languagepicker-button").find("span.yt-uix-button-content").text(),CaptionCertification:jQuery("[name=captions_certificate]").val(),SuggestVideoImprovements:jQuery("[name=suggested_edits]").val(),LocationLongitude:jQuery("[name=location_longitude]").val(),LocationLatitude:jQuery("[name=location_latitude]").val(),VideoStatisticsPublic:jQuery("[name=allow_public_stats]").is(":checked"),UsersCanVoteOnComments:jQuery("[name=allow_comment_ratings]").is(":checked"),NonSkipableVideoAds:jQuery("[name=instream_ads]").is(":checked"),LongNonSkipableVideoAds:jQuery("[name=long_instream_ads]").is(":checked"),VideoLanguageAbbreviation:jQuery("#yt-languagepicker-input-audio_language").val(),Name:i});TBExtension.Post(e,o,"CRUploadDefaultsUpdate",null,{contentType:"application/x-www-form-urlencoded; charset=UTF-8"})}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyUploadDefaults] .tb-upload-default-save-button [click]"})}});jQuery(document).on("click",".tb-upload-default-new-button",function(){try{TBUtilities.Log("TubeBuddyUploadDefaults -  tb-upload-default-new-button click");if(o.length>=2&&!TBGlobal.CanAccessLevel1Tools()){TBGlobal.ShowUpgradePage("create more than one custom Default Upload Profile",TBGlobal.limitation.defaultuploadprofiles);return}TBUtilities.Prompt("Please enter a name for the new Profile",i+" - Copy",function(e,t){if(t!=null){if(t.length>74)t=t.substring(0,74);var i=TBGlobal.host+TBGlobal.apiUrls.uploadDefaultsAdd;var o=jQuery.param({YouTubeChannelId:TBGlobal.CurrentChannelId(),Privacy:jQuery(".privacy-input:first").val(),Category:jQuery(".category-input:first").val(),License:jQuery("#license-select").val(),Title:jQuery("#title").val(),Description:jQuery("#description").val(),Tags:jQuery("#tags").val(),AllowComments:jQuery("[name=allow_comments]").is(":checked"),AllowCommentsDetail:jQuery("[name=allow_comments_type]").val(),UsersCanViewRatingsForThisVideo:jQuery("[name=allow_ratings]").is(":checked"),MonetizeWithAds:jQuery("#default-monetize").is(":checked"),OverlayInVideoAds:jQuery("[name=overlay_ads]").is(":checked"),SkippableVideoAds:jQuery("#trueview-instream-ads-checkbox").is(":checked"),VideoLanguage:jQuery(".yt-languagepicker-button").find("span.yt-uix-button-content").text(),CaptionCertification:jQuery("[name=captions_certificate]").val(),SuggestVideoImprovements:jQuery("[name=suggested_edits]").val(),LocationLongitude:jQuery("[name=location_longitude]").val(),LocationLatitude:jQuery("[name=location_latitude]").val(),VideoStatisticsPublic:jQuery("[name=allow_public_stats]").is(":checked"),UsersCanVoteOnComments:jQuery("[name=allow_comment_ratings]").is(":checked"),NonSkipableVideoAds:jQuery("[name=instream_ads]").is(":checked"),LongNonSkipableVideoAds:jQuery("[name=long_instream_ads]").is(":checked"),VideoLanguageAbbreviation:jQuery("#yt-languagepicker-input-audio_language").val(),Name:t});TBUtilities.Log("TubeBuddyUploadDefaults - calling CRUploadDefaultsAdd");TBUtilities.Log(o);TBExtension.Post(i,o,"CRUploadDefaultsAdd",null,{contentType:"application/x-www-form-urlencoded; charset=UTF-8"})}},function(){})}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyUploadDefaults] tb-upload-default-new-button [click]"})}})};var d=function(){try{jQuery(".tb-upload-defaults-select").empty();jQuery.each(o,function(e,t){jQuery(".tb-upload-defaults-select:first").append(jQuery("<option></option>").attr("value",t.Id).text(t.Name))});jQuery(".tb-upload-defaults-select:first").val(t);jQuery(".tb-upload-defaults-select:first").trigger("change")}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyUploadDefaults] populateUploadDefaultSelect"})}};var u=function(){jQuery(document.body).on("CRTBLoadUploadDefaultsTemplate",function(e,t){try{TBUtilities.Log("TubeBuddyUploadDefaults - CRTBLoadUploadDefaultsTemplate");if(t.success){t.response=TBUtilities.FixLocalHtml(DOMPurify.sanitize(t.response,DOMPurifyConfig));jQuery("body").append(t.response);r()}else{}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyUploadDefaults] CRTBLoadUploadDefaultsTemplate"})}});jQuery(document.body).on("CRUploadDefaultsUpdate",function(e,t){try{TBUtilities.Log("TubeBuddyUploadDefaults - CRUploadDefaultsUpdate");if(t.success){r();TBUtilities.Alert("Your changes were successfully saved!")}else{}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyUploadDefaults] CRUploadDefaultsUpdate"})}});jQuery(document.body).on("CRUploadDefaultsDelete",function(e,o){try{TBUtilities.Log("TubeBuddyUploadDefaults - CRUploadDefaultsDelete");if(o.success){t="default";i="[YouTube]";r();TBUtilities.Alert("Profile successfully deleted!")}else{}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyUploadDefaults] CRUploadDefaultsUpdate"})}});jQuery(document.body).on("CRUploadDefaultsAdd",function(e,a){try{TBUtilities.Log("TubeBuddyUploadDefaults - CRUploadDefaultsAdd");TBUtilities.Log(a);if(a.success){var n=JSON.parse(a.response);TBUtilities.Log(n);o.push(n);t=n.Id;i=n.Name;d();TBUtilities.Alert("Your new Profile was successfully created!")}else{}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyUploadDefaults] CRUploadDefaultsAdd"})}});jQuery(document.body).on("CRUploadDefaultsGetList",function(e,t){try{TBUtilities.Log("TubeBuddyUploadDefaults - CRUploadDefaultsGetList");if(t.success){if(t.response!=null&&t.response.length>0){var i=JSON.parse(t.response);TBUtilities.Log(i);jQuery.each(i,function(e,t){o.push(t)})}d()}else{}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyUploadDefaults] CRUploadDefaultsGetList"})}})};return{Initialize:function(){if(TBGlobal.IsAuthenticated()){if(!e){u();s();l();e=true}else{r()}}}}}();var TubeBuddyUpload=function(){var t=false;var i=[];var o=[];var a=0;var n=null;var r=null;var s=[];var l=null;var d=null;var u=null;var c=null;var p=null;var b=null;var y=null;var h=null;var f=false;var m=null;var g=null;var v=0;var T=false;var w=false;var j=null;var Q=[];var x=null;var B=function(){TBExtension.GetDbValue("tb-upload-hide-tools","TBUploadGetToolsWindowSetting");setInterval(G,1e3);setInterval(E,1e3);var e=TBGlobal.host+TBGlobal.apiUrls.uploadDefaultsList;TBExtension.Get(e,"CRUploadDefaultsGetList")};var k=function(){var e=TBGlobal.host+"/ModuleManager/upload/upload?v="+TBGlobal.versionNumber;if(loadLocalHTML&&(TBExtension.GetType()=="chrome"||TBExtension.GetType()=="firefox")){e=chrome.extension.getURL("modules/upload.html")}else if(loadLocalHTML&&TBExtension.GetType()=="safari"){e="modules/upload.html"}TBExtension.Get(e,"CRTBLoadUploadTemplate")};var L=function(e){var t=e.closest(".upload-item").find(".video-settings-title").val().length;e.closest(".upload-item").find(".tb-upload-title-length").text(t);if(t>100){e.closest(".upload-item").find(".tb-upload-title-length").css("color","red");e.closest(".upload-item").find(".tb-upload-title-length").css("font-weight","bold")}else{e.closest(".upload-item").find(".tb-upload-title-length").css("color","#666");e.closest(".upload-item").find(".tb-upload-title-length").css("font-weight","normal")}};var U=function(e){var t=e.closest(".upload-item").find(".video-settings-description").val();var i=S(t);e.closest(".upload-item").find(".tb-upload-description-length").text(i);if(i>5e3){e.closest(".upload-item").find(".tb-upload-description-length").css("color","red");e.closest(".upload-item").find(".tb-upload-description-length").css("font-weight","bold")}else{e.closest(".upload-item").find(".tb-upload-description-length").css("color","#666");e.closest(".upload-item").find(".tb-upload-description-length").css("font-weight","normal")}};var C=function(t){var i=[];TBUtilities.Log("getTagsForUploadArea ");try{t.closest(".upload-item").find(".video-settings-tag-chips-container").find(".yt-chip").each(function(e){i.push(jQuery(this).find("span:first").text())})}catch(t){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyUploads] getTagsForUploadArea"})}TBUtilities.Log("Len:  "+i.length);return i};var A=function(e){var t=[];TBUtilities.Log("setTagsLengths ");e.closest(".upload-item").find(".video-settings-tag-chips-container").find(".yt-chip").each(function(e){t.push(jQuery(this).find("span:first").text())});TBUtilities.Log("Len:  "+t.length);var i=0;jQuery.each(t,function(e,t){TBUtilities.Log("Tag: "+t);var o=t.trim();o=o.replace(/\s/,"---");i+=o.length;i+=1});if(i>0)i--;var o=e.closest(".upload-item").find(".video-settings-add-tag").val();if(!o)o="";o=o.replace(/\s+/g,"---");i+=o.length;e.closest(".upload-item").find(".tb-upload-tags-length").text(i);if(i>500){e.closest(".upload-item").find(".tb-upload-tags-length").css("color","red");e.closest(".upload-item").find(".tb-upload-tags-length").css("font-weight","bold")}else{e.closest(".upload-item").find(".tb-upload-tags-length").css("color","#666");e.closest(".upload-item").find(".tb-upload-tags-length").css("font-weight","normal")}};var S=function(e){var t=e.length;for(var i=e.length-1;i>=0;i--){var o=e.charCodeAt(i);if(o>127&&o<=2047)t++;else if(o>2047&&o<=65535)t+=2;if(o>=56320&&o<=57343)i--}return t};var E=function(){jQuery(".upload-item").each(function(){var e=jQuery(this).find(".progress-bar-processing:first");if(e!=null){var t=e.attr("aria-valuenow");if(t=="100"){var i=jQuery(this);jQuery(this).find(".tb-post-process-actions-processing").hide();jQuery(this).find(".tb-post-process-actions").show();var o=jQuery(this).find(".share-panel-url").attr("data-video-id");if(!o){var a=jQuery(this).find("a").attr("href");o=a.substr(a.lastIndexOf("/")+1)}var n=i.find(".tb-upload-suggested-tags-plugin").suggestedtags().data("plugin_suggestedtags");if(n){n.saveKeyword(o)}jQuery(this).closest(".upload-item").find(".tb-upload-pre-publish-link-enhancements").attr("href","https://www.youtube.com/enhance?v="+o);jQuery(this).closest(".upload-item").find(".tb-upload-pre-publish-link-audio").attr("href","https://www.youtube.com/audio?v="+o);jQuery(this).closest(".upload-item").find(".tb-upload-pre-publish-link-annotations").attr("href","https://www.youtube.com/my_videos_annotate?v="+o);jQuery(this).closest(".upload-item").find(".tb-upload-pre-publish-link-cards").attr("href","https://www.youtube.com/cards?v="+o);jQuery(this).closest(".upload-item").find(".tb-upload-pre-publish-link-endscreens").attr("href","https://www.youtube.com/endscreen?v="+o);jQuery(this).closest(".upload-item").find(".tb-upload-pre-publish-link-subtitles").attr("href","https://www.youtube.com/timedtext_video?v="+o);if(jQuery(this).find(".tb-best-practices-plugin-container").length==0&&jQuery(this).find(".share-panel-url-input-container").length>0){jQuery(this).find(".tb-upload-tab-post-processing-container").before('<div class="tb-best-practices-plugin-container"><div>');jQuery(".tb-best-practices-plugin-container").bestpractices({videoId:o,videoTitle:jQuery(this).find(".video-settings-title").val(),videoThumbnail:"https://i.ytimg.com/vi/"+o+"/mqdefault.jpg",tagsContainer:jQuery(this).find(".video-settings-tag-chips-container"),titleElement:jQuery(this).find(".video-settings-title"),descriptionElement:jQuery(this).find(".video-settings-description"),suggestedTagsButton:jQuery(this).find(".tb-upload-tag-suggestions-button:first"),onMonitizationClick:function(){if(i.find(".return-to-editing-button").length>0&&jQuery("[data-tab-id=monetization]").length>0){i.find(".return-to-editing-button")[0].click();setTimeout(function(){jQuery("[data-tab-id=monetization]")[0].click();jQuery("html, body").animate({scrollTop:jQuery("[data-tab-id=monetization]").offset().top},500)},1e3)}},onPlaylistClick:function(){if(i.find(".return-to-editing-button").length>0){i.find(".return-to-editing-button")[0].click();setTimeout(function(){i.find(".metadata-add-to-playlist-button")[0].click()},1e3)}},onTagsClick:function(){if(i.find(".return-to-editing-button").length>0){i.find(".return-to-editing-button")[0].click()}}}).data("plugin_bestpractices")}}}})};var I=function(){if(Q.length==0){clearInterval(g);g=null;return}jQuery.each(Q,function(e,t){TBUtilities.Log("In Loop");TBUtilities.Log(t.id);TBUtilities.Log(".share-panel-url: "+t.container.find(".share-panel-url").length);TBUtilities.Log(".watch-page-link: "+t.container.find(".watch-page-link").length);try{TBUtilities.Log(".container: "+t.container[0].outerHTML.split(t.container.html())[0])}catch(e){}if(t.container.find(".watch-page-link").length>0){var i="";var o=t.container.find("a").attr("href");if(o!=null)i=o.substr(o.lastIndexOf("/")+1);TBUtilities.Log("waitForVideoId Found: "+i);if(i&&i.length==11){TBUtilities.Log("Length _wfv: "+Q.length);TBUtilities.RemoveFromArray(Q,"id",t.id);TBUtilities.Log("Length AFTER _wfv: "+Q.length);M()}}})};var G=function(){try{jQuery(".upload-item").each(function(){var e=jQuery(this).find(".tb-upload-container").length>0;if(!e){if(jQuery(".tb-upload-container:last").length>0){if(jQuery(".tb-upload-container:last").length>0){jQuery(this).find(".upload-item-sidebar-text:first").after(jQuery(".tb-upload-container:last")[0].outerHTML);if(TBGlobal.Profile().HideChecklistOnUploadScreen==false){jQuery(this).find(".metadata-add-to-clickcard").after(jQuery(".tb-launchpad-container:last")[0].outerHTML);jQuery(this).find(".tb-launchpad-container:first").show();jQuery(".tb-upload-setup-uploadchecklist").attr("href",TBGlobal.host+"/launchpad/checklist/"+TBGlobal.CurrentChannelId()+"?firstTime=1");if(f==true){TBUtilities.Log("Has Checklist");Q.push({id:(new Date).getTime(),container:jQuery(this)});clearInterval(g);g=null;g=setInterval(I,500)}else{TBUtilities.Log("No Checklist");R();jQuery(".tb-upload-has-upload-checklist").hide();jQuery(".tb-upload-no-upload-checklist").hide();jQuery(".tb-upload-checklist-loading").show()}}}var t=jQuery(this).find(".tb-upload-default-select:first");jQuery.each(i,function(e,i){t.append(jQuery("<option></option>").attr("value",i.Id).text(i.Name))});if(i.length>0){jQuery(".tb-uploads-no-upload-default-profiles").hide();jQuery(".tb-uploads-has-upload-default-profiles").show()}else{jQuery(".tb-uploads-no-upload-default-profiles").show();jQuery(".tb-uploads-has-upload-default-profiles").hide()}if(jQuery(".tb-upload-copy-tags-container:last").length>0)jQuery(this).find(".video-settings-tag-chips-container").after(jQuery(".tb-upload-copy-tags-container:last")[0].outerHTML);if(jQuery(".tb-upload-search-icon:last").length>0)jQuery(this).find(".yt-chip").prepend(jQuery(".tb-upload-search-icon:last")[0].outerHTML);jQuery(this).find(".video-settings-title").closest("label").append(jQuery(".tb-upload-title-length-container:first")[0].outerHTML);jQuery(this).find(".video-settings-description").closest("label").append(jQuery(".tb-upload-description-length-container:first")[0].outerHTML);jQuery(this).find(".video-settings-tag-chips-container").after(jQuery(".tb-upload-tags-length-container:first")[0].outerHTML);jQuery(this).find(".tb-upload-container").after(jQuery("#tb-seo-studio-apply-optimization-template").html());if(jQuery(".tb-trigger-magic-links")!=null){if(jQuery(".tb-trigger-magic-links").length>0&&jQuery(this).find(".tb-trigger-magic-links").length==0){jQuery(this).find(".video-settings-description").after(jQuery(".tb-trigger-magic-links")[0].outerHTML)}}if(jQuery(".tb-upload-tab-post-processing-container:last").length>0)jQuery(this).find(".upload-item-main").append(jQuery(".tb-upload-tab-post-processing-container:last")[0].outerHTML);jQuery(this).find(".tb-upload-tab-post-processing-container").show();TBUtilities.Log("_hideToolsWindow: "+w);if(w){var o=jQuery(this).find(".tb-upload-tab-post-processing-container");o.find(".tb-upload-show-tools").show();o.find(".tb-upload-hide-tools").hide();o.find(".tb-post-process-actions-wrapper").slideUp()}U(jQuery(this).find(".video-settings-title"));L(jQuery(this).find(".video-settings-title"));A(jQuery(this).find(".video-settings-title"));var a=TBGlobal.host+"/launchpad/checklist/"+TBGlobal.CurrentChannelId();jQuery(".tb-upload-upload-checklist-settings").prop("href",a);if(TBGlobal.Profile().SettingsShowInstaSuggest==true){jQuery(this).find(".video-settings-tag-chips-container").tagautocomplete({tagAddSender:jQuery(this),onTagsAdd:function(e,t){TubeBuddyUpload.AddTags(e,t)},openSuggestedTags:function(e){var t=e.closest(".upload-item").find(".share-panel-url").attr("data-video-id");if(!t){var i=e.closest(".upload-item").find("a").attr("href");if(i!=null)t=i.substr(i.lastIndexOf("/")+1)}TubeBuddyMenu.ShowBackgroundSticky();TubeBuddySuggestedTags.Show(t,jQuery(e).closest(".upload-item").find(".video-settings-title").val(),jQuery(e).find(".tb-upload-tag-suggestions-button"))},openTagExplorer:function(e,t){TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyTagExplorer.ShowTagExplorer(e,jQuery(t).find(".tb-upload-tag-explorer-button"),C(jQuery(t)))}}).data("plugin_tagautocomplete")}if(TBGlobal.Profile().SettingsShowSuggestedTags==true){jQuery(this).find(".tb-upload-suggested-tags-plugin").suggestedtags({onTagsAdd:function(e,t){TubeBuddyUpload.AddTags(e,t)},tagAddSender:jQuery(this)}).data("plugin_tagautocomplete")}H(jQuery(this),true);if(TBGlobal.Profile().SettingsShowDemonetizationAudit==true){if(jQuery(this).find(".tb-demonetization-audit-container").length==0){if(jQuery(this).find(".tb-launchpad-container").length>0){jQuery(this).find(".tb-launchpad-container").after('<div class="tb-demonetization-audit-container"><div>')}else{jQuery(this).find(".metadata-add-to-clickcard").after('<div class="tb-demonetization-audit-container"><div>')}jQuery(this).find(".tb-demonetization-audit-container").demonetizationaudit({}).data("plugin_demonetizationAudit")}}z(jQuery(this))}}})}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyUploads] addUploadDefaults"})}};var R=function(){TBUtilities.Log("Interval: checkForUploadChecklist");if(f==false){var e=TBGlobal.host+TBGlobal.apiUrls.launchPadChecklistTemplateItemsExist;TBUtilities.Log(e);TBExtension.Get(e,"CRTBUploadChecklistTemplateItemsExist")}};var P=function(e){try{TBUtilities.Log("addTagsOneAtATime Element: "+e);TBUtilities.Log("Index:"+a+", Length: "+o.length);if(a>=o.length){clearTimeout(n);n=null;A(jQuery("#"+e).find(".video-settings-add-tag"));return}TBUtilities.Log("LENGTH - ADD TAG: "+jQuery("#"+e).find(".video-settings-add-tag").length);TBUtilities.Log("LENGTH - CONTAINER: "+jQuery("#"+e).length);var t=jQuery("#"+e).find(".video-settings-add-tag");t.val(o[a++]);t.trigger("focus");t.trigger("blur");n=setTimeout(P,10,e)}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyUploads] addTagsOneAtATime"})}};var D=function(){var e=jQuery('.upload-item[data-video-id="'+l+'"]');jQuery(e).find(".tb-uploads-cards-complete").show().delay(4e3).fadeOut();y=null;_()};var V=function(){var e=TBGlobal.host+TBGlobal.apiUrls.youTubeVideosGetVideoCardTemplates;TBExtension.Get(e,"CRUploadGetVideoCardTemplates",null)};var _=function(){jQuery(".tb-upload-copy-cards-button").prop("disabled",false);jQuery(".tb-upload-copying").each(function(e){if(jQuery(this).hasClass("tb-hid")==false){jQuery(this).addClass("tb-hid")}});jQuery(".tb-upload-copy-cards-select").show();jQuery(".tb-upload-copy-cards-button").show()};var M=function(){jQuery(".upload-item").each(function(){TBUtilities.Log("looping");if(jQuery(this).find(".tb-upload-has-upload-checklist:visible").length>0){TBUtilities.Log("has upload checklist is visible");return}var e=jQuery(this).find(".share-panel-url").attr("data-video-id");if(!e){var t=jQuery(this).find("a").attr("href");if(t!=null)e=t.substr(t.lastIndexOf("/")+1)}if(e!=null){if(e.length==11){jQuery(this).find(".tb-generating-checklist").html("Generating checklist...");var i=TBGlobal.host+TBGlobal.apiUrls.launchPadCreateChecklist+"/"+e;TBUtilities.Log(i);TBExtension.Get(i,"CRTBUploadCreateChecklist",{videoId:e})}}TBUtilities.Log("VideoId e: "+e)})};var O=function(e){switch(y){case"card":{TBUtilities.Alert("There was an error copying cards.  Please try again.\n\n"+e);break}}_()};var F=function(e){var t=jQuery(e.target).closest(".upload-item").find(".share-panel-url").attr("data-video-id");if(!t){var i=jQuery(e.target).closest(".upload-item").find("a").attr("href");if(i!=null)t=i.substr(i.lastIndexOf("/")+1)}return t};var N=function(){jQuery(document).on("click",'[data-tab-id="translations"]',function(e){var t=jQuery(e.currentTarget).parent().closest(".upload-item");var i=t.find(".translation-editor-delete-button");if(t&&i&&i.siblings(".tb-upload-video-translate-container").length==0){var o=jQuery("#tb-upload-translate-template").html();i.after(o);var a=i[0];var n=new MutationObserver(function(e){var t=jQuery(e[0].target);var i=t.prop("disabled");t.siblings(".tb-upload-video-translate-container").find("button").prop("disabled",i)});var r={attributes:true,childList:true,subtree:true,characterData:true};n.observe(a,r)}});jQuery(document).on("click",".tb-upload-video-translate",function(e){if(!TBGlobal.CanAccessLevel3Tools()){TBGlobal.ShowUpgradePage("translate your title and description","metaautotranslator");return false}var t=jQuery(this).closest(".upload-item");var i=t.find(".translation-editor-translation-menu-button").find(".yt-uix-button-content").text().trim();var o=F(e);var a=t.find(".translation-editor-original-title").val();var n=t.find(".translation-editor-original-description").val();var r=jQuery.param({VideoId:o,Title:a,Description:n,TargetLanguage:i});t.find(".tb-upload-video-translate-loading").show();t.find(".tb-upload-video-translate").prop("disabled",true);var s=TBGlobal.host+TBGlobal.apiUrls.translateVideoMetadata;TBExtension.Post(s,r,"CRUploadVideoTranslateVideoMeta",null,{contentType:"application/x-www-form-urlencoded; charset=UTF-8"});j=t;try{TBUtilities.AddAction(null,TBUtilities.ActionTypes.AutoTranslator_Use,"autotranslator")}catch(e){TBUtilities.LogError({Exception:e,Location:"[UploadVideo] [addAction]"})}});jQuery(document).on("focus",".video-settings-title, .video-settings-description, .video-settings-add-tag",function(){jQuery(".tb-emoji-toggle").hide();jQuery(this).before('<span style="position:absolute; left:430px; opacity:.7" class="tb-emoji-toggle"><img src="'+TBGlobal.host+'/images/modules/emoji/face.png" style=" cursor:pointer; position:relative; top:5px;" /></span>')});jQuery(document).on("click",".tb-upload-launch-pad-best-practices",function(e){if(TBGlobal.CanAccessLevel1Tools()==false){TBGlobal.ShowUpgradePage("run Best Practice Audit",TBGlobal.limitation.bestpractice);return}var t=F(e);TBUtilities.Log(".tb-upload-launch-pad-best-practices - "+t);var i=TBGlobal.host+"/launchpad/processvideo?channelid="+TBGlobal.CurrentChannelId()+"&videoid="+t+"&c=false&b=true&o=false&type=1";var o=window.open(i,"_blank");o.focus()});jQuery(document).on("click",".tb-upload-setup-uploadchecklist",function(e){var t=F(e);TBUtilities.Log(".tb-upload-setup-uploadchecklist - "+t);jQuery(this).closest(".tb-upload-no-upload-checklist").hide();jQuery(this).closest(".tb-upload-no-upload-checklist").parent().find(".tb-upload-generate-upload-checklist").show()});jQuery(document).on("click",".tb-upload-setup-generate-uploadchecklist",function(e){TBUtilities.Log("Click - tb-upload-setup-generate-uploadchecklist");M()});jQuery(document).on("click",".tb-checklist-item-arrow",function(e){TBUtilities.Log("tb-checklist-item-arrow");var t=jQuery(this).attr("data-checklist-item-id");TBUtilities.Log(t);if(jQuery('[data-checklist-item-description-id="'+t+'"]').is(":visible")){jQuery('[data-checklist-item-description-id="'+t+'"]').slideUp();jQuery(this).find("img").attr("src",TBGlobal.host+"/images/icons/caret-up.png")}else{jQuery('[data-checklist-item-description-id="'+t+'"]').slideDown();jQuery(this).find("img").attr("src",TBGlobal.host+"/images/icons/caret-down.png")}});jQuery(document).on("click",".tb-checklist-item-check-all",function(e){jQuery(this).closest(".tb-upload-checklist-todo-list").find(".tb-checklist-item-check:not(:checked)").trigger("click")});jQuery(document).on("click",".tb-checklist-item-check",function(e){TBUtilities.Log("tb-checklist-item-check");var t=jQuery(this).attr("data-item-id");TBUtilities.Log(t);var i;var o=jQuery(this).closest(".tb-upload-checklist-todo-list");var a=o.find(".tb-checklist-item-check").not(":checked").length;TBUtilities.Log(a);if(a==0){jQuery(".tb-upload-remaining-none").show();jQuery(".tb-upload-remaining").hide();o.find(".tb-checklist-item-check-all").hide()}else{o.find(".tb-checklist-item-check-all").show();jQuery(".tb-upload-remaining-none").hide();jQuery(".tb-upload-remaining").show();jQuery(this).closest(".tb-launchpad-container").find(".tb-upload-remaining-count").text(a)}if(jQuery(this).is(":checked")){i=jQuery.param({id:t,Status:3});jQuery(this).parent().find(".tb-upload-checklistitem-name").css("color","#aaa")}else{i=jQuery.param({Id:t,Status:1});jQuery(this).parent().find(".tb-upload-checklistitem-name").css("color","#333")}TBExtension.Post(TBGlobal.host+TBGlobal.apiUrls.launchPadUpdateItemStatus,i,null,null,{contentType:"application/x-www-form-urlencoded; charset=UTF-8"});e.stopPropagation()});jQuery(document).on("click",".tb-upload-checklist-set-default",function(e){jQuery(".tb-upload-generating-chcecklist").show();jQuery(this).hide();var t=jQuery('input[name="tb-checklist-template-option"]:checked').attr("data-checklist");var i=1;switch(t){case"derral":i=2;break;case"roberto":i=3;break;case"owen":i=4;break;case"brian":i=5;break;case"amy":i=6;break}var o=jQuery.param({Type:i});TBExtension.Post(TBGlobal.host+TBGlobal.apiUrls.launchPadImportChecklistTemplateItemDefaults,o,"CRTBUploadChecklistTemplateSelected",null,{contentType:"application/x-www-form-urlencoded; charset=UTF-8"})});jQuery(document).on("click",".tb-upload-copy-cards-button",function(e){var t=F(e);TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyCardTemplates.Show(t,jQuery(e.target).closest(".upload-item").find(".video-settings-title").val(),"https://i.ytimg.com/vi/"+t+"/0.jpg?time="+Math.random())});jQuery(document).on("click",".tb-upload-checklist-template-option",function(e){jQuery(this).parent().find("input").attr("checked","checked");jQuery(this).parent().find("input").prop("checked",true)});jQuery(document).on("click",".tb-upload-copy-endscreen-button",function(e){var t=F(e);TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyEndScreenTemplates.Show(t,jQuery(e.target).closest(".upload-item").find(".video-settings-title").val(),"https://i.ytimg.com/vi/"+t+"/0.jpg?time="+Math.random())});jQuery(document).on("click",".yt-delete-chip",function(e){var t=jQuery(e.originalEvent.path[4]);tbdelay(function(){z(t);H(t)},1500)});jQuery(document).on("change keyup keypress paste",".video-settings-description",function(e){U(jQuery(this));var t=jQuery(this);tbdelay(function(){z(t)},1500)});jQuery(document).on("change keyup keypress paste",".video-settings-title",function(e){var t=jQuery(this);L(t);tbdelay(function(){H(t);z(t)},1500)});jQuery(document).on("change keyup keypress paste",".video-settings-add-tag",function(e){var t=jQuery(this);A(t);tbdelay(function(){H(t);z(t)},1500)});jQuery(document).on("click",".tb-upload-scheduledvideoaction",function(e){TBUtilities.AddAction(null,TBUtilities.ActionTypes.SunsetVideos_Schedule,"sunsetvideos");var t=F(e);TubeBuddyMenu.ShowBackgroundSticky();TubeBuddySunsetVideo.Show(t,jQuery(e.target).closest(".upload-item").find(".video-settings-title").val())});jQuery(document).on("click",".tb-upload-schedulegolive",function(e){TBUtilities.AddAction(null,TBUtilities.ActionTypes.ScheduleGoLive_Schedule,"schedulegolive");var t=F(e);TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyGoLiveVideo.Show(t,jQuery(e.target).closest(".upload-item").find(".video-settings-title").val())});jQuery(document).on("click",".tb-upload-scheduledvideoupdate",function(e){var t=F(e);TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyScheduledMetaUpdates.Show(t,jQuery(e.target).closest(".upload-item").find(".video-settings-title").val(),"https://i.ytimg.com/vi/"+t+"/0.jpg?time="+Math.random())});jQuery(document).on("click",".tb-upload-thumbnailCreator",function(e){TBUtilities.AddAction(null,TBUtilities.ActionTypes.ThumbnailGenerator_Use,"thumbnailgenerator");var t=F(e);TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyThumbnailCreator.Show(t,jQuery(e.target).closest(".upload-item").find(".video-settings-title").val(),"https://i.ytimg.com/vi/"+t+"/0.jpg?time="+Math.random())});jQuery(document).on("click",".tb-upload-captions",function(e){TBUtilities.AddAction(null,TBUtilities.ActionTypes.ThumbnailGenerator_Use,"thumbnailgenerator");var t=F(e);TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyTranscriptions.Show(t,jQuery(e.target).closest(".upload-item").find(".video-settings-title").val(),"https://i.ytimg.com/vi/"+t+"/0.jpg?time="+Math.random())});jQuery(document).on("click",".tb-upload-publishToFacebook",function(e){var t=F(e);TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyCopyToFacebook.Show(t,"https://i.ytimg.com/vi/"+t+"/0.jpg?time="+Math.random(),jQuery(e.target).closest(".upload-item").find(".video-settings-title").val())});jQuery(document).on("click",".tb-upload-shareOnTwitter",function(e){var t=F(e);TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyTwitterPost.Show(t,jQuery(e.target).closest(".upload-item").find(".video-settings-title").val(),"https://img.youtube.com/vi/"+t+"/mqdefault.jpg")});jQuery(document).on("click",".tb-upload-publishToFacebook",function(e){var t=F(e);TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyCopyToFacebook.Show(t,"https://i.ytimg.com/vi/"+t+"/0.jpg?time="+Math.random(),jQuery(e.target).closest(".upload-item").find(".video-settings-title").val())});jQuery(document).on("click",".tb-upload-hide-tools",function(){var e=jQuery(this).closest(".tb-upload-tab-post-processing-container");e.find(".tb-upload-show-tools").show();e.find(".tb-upload-hide-tools").hide();e.find(".tb-post-process-actions-wrapper").slideUp();TBExtension.SetDbValue("tb-upload-hide-tools",true);w=true});jQuery(document).on("click",".tb-upload-show-tools",function(){var e=jQuery(this).closest(".tb-upload-tab-post-processing-container");e.find(".tb-upload-show-tools").hide();e.find(".tb-upload-hide-tools").show();e.find(".tb-post-process-actions-wrapper").slideDown();TBExtension.SetDbValue("tb-upload-hide-tools",false);w=false});jQuery(document).on("click",".tb-upload-share-tracker",function(e){TBUtilities.AddAction(null,TBUtilities.ActionTypes.ShareTracker_Track,"sharetracker");var t=F(e);TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyShareTracker.ShowForVideo(t,jQuery(e.target).closest(".upload-item").find(".video-settings-title").val(),"https://i.ytimg.com/vi/"+t+"/0.jpg?time="+Math.random())});jQuery(document).on("click",".tb-upload-vid2vid",function(e){var t=F(e);TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyV2VPromote.Show(t,jQuery(e.target).closest(".upload-item").find(".video-settings-title").val(),"https://i.ytimg.com/vi/"+t+"/0.jpg?time="+Math.random(),false)});jQuery(document).on("change",".tb-upload-default-select",function(){jQuery(this).attr("data-tooltip-text",jQuery(this).find("option:selected").text())});jQuery(document).on("click",".yt-chip",function(){var e=jQuery(this).text();TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyTagExplorer.ShowTagExplorer(e,jQuery(this),C(jQuery(this)))});jQuery(document).on("click",".yt-delete-chip",function(e){e.stopPropagation()});jQuery(document).on("click",".tb-upload-debug-code",function(){TBUtilities.Confirm("Are you sure you want to send your Debug Code to the developers at TubeBuddy?\n\nOnly do this if they have asked you to. Thanks!",function(){TBGlobal.AddUserDebugInfo("UPLOAD<Br>"+jQuery("body").html());TBUtilities.AddActivityLog({Data:TBGlobal.UserDebugCode()},TBUtilities.ActivityLogTypes.Layout_SubmitDebugCode);TBUtilities.Alert("Thanks! We will review the info and get back to you.")},function(){})});jQuery(document).on("click",".tb-upload-tag-explorer-button",function(e){TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyTagExplorer.ShowTagExplorer(null,jQuery(this),C(jQuery(this)))});jQuery(document).on("click",".tb-upload-tag-suggestions-button",function(e){var t=F(e);TubeBuddyMenu.ShowBackgroundSticky();TubeBuddySuggestedTags.Show(t,jQuery(e.target).closest(".upload-item").find(".video-settings-title").val(),jQuery(this))});jQuery(document).on("click",".tb-upload-tag-clear-all-button",function(e){var t=jQuery(this);TBUtilities.Confirm("Are you sure you want to remove all Tags?",function(){t.closest(".upload-item").find(".yt-delete-chip").each(function(){TBUtilities.Log("del");jQuery(this)[0].click()});A(t)})});jQuery(document).on("click",".tb-upload-tag-translator-button",function(e){var t=F(e);var i=[];jQuery(this).closest(".upload-item").find(".yt-chip").each(function(){i.push(jQuery(this).text())});TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyTagTranslator.Show(i,jQuery(this))});jQuery(document).on("click",".tb-upload-tag-sorter-button",function(e){var t=F(e);var i=[];jQuery(this).closest(".upload-item").find(".yt-chip").each(function(){i.push(jQuery(this).text())});TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyTagSorter.Show(i,[],jQuery(this))});jQuery(document).on("click",".tb-upload-tag-import-button",function(e){TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyTagLists.Show(true)});jQuery(document).on("blur",".video-settings-add-tag",function(){jQuery(".yt-chip").each(function(){if(jQuery(this).find(".tb-upload-search-icon").length==0){jQuery(this).prepend(jQuery(".tb-upload-search-icon:last")[0].outerHTML)}})});jQuery(document).on("click",".tb-upload-default-apply-button",function(){var e="0";try{TBUtilities.AddAction(null,TBUtilities.ActionTypes.DefaultUploadProfiles_Apply,"defaultuploadprofiles");var t=jQuery(this).closest(".tb-upload-container").find(".tb-upload-default-select").val();e+="["+t+"]";e+="["+i.length+"]";var r=TBUtilities.GetInArray(i,"Id",t);e+="["+r+"]";jQuery(this).closest(".upload-item").find("[data-tab-id=basic-info]")[0].click();jQuery(this).closest(".upload-item").find(".video-settings-title").val(r.Title);jQuery(this).closest(".upload-item").find(".video-settings-description").val(r.Description);jQuery(this).closest(".upload-item").find(".metadata-privacy-input").val(r.Privacy);jQuery(this).closest(".upload-item").find('select[data-ng-model="category"]').val("string:"+r.Category);jQuery(this).closest(".upload-item").find(".license-input").val(r.License);jQuery(this).closest(".upload-item").find(".video-settings-allow-comments").prop("checked",r.AllowComments);jQuery(this).closest(".upload-item").find("[name=allow_comments_detail]").val(r.AllowCommentsDetail);jQuery(this).closest(".upload-item").find("[name=allow_ratings]").prop("checked",r.UsersCanViewRatingsForThisVideo);if(jQuery(this).closest(".upload-item").find('[data-ng-model="formats.has_overlay_ads"]').is(":visible"))jQuery(this).closest(".upload-item").find('[data-ng-model="formats.has_overlay_ads"]').prop("checked",r.OverlayInVideoAds);if(jQuery(this).closest(".upload-item").find('[data-ng-model="formats.has_skippable_video_ads"]').is(":visible"))jQuery(this).closest(".upload-item").find('[data-ng-model="formats.has_skippable_video_ads"]').prop("checked",r.SkippableVideoAds);e+="[A]";if(jQuery(this).closest(".upload-item").find('[data-ng-model="isMonetizing"]').is(":visible")){jQuery(this).closest(".upload-item").find('[data-ng-model="isMonetizing"]').prop("checked",r.MonetizeWithAds);if(r.MonetizeWithAds){jQuery(this).closest(".upload-item").find('[data-ng-model="isMonetizing"]')[0].click()}}jQuery(this).closest(".upload-item").find("#yt-languagepicker-input-audio_language").attr("value",r.VideoLanguageAbbreviation);jQuery(this).closest(".upload-item").find(".yt-languagepicker").find(".yt-uix-button-content").text(r.VideoLanguage);jQuery(this).closest(".upload-item").find(".yt-languagepicker").find("[name=audio_language]").attr("value",r.VideoLanguageAbbreviation);jQuery(this).closest(".upload-item").find("ul.yt-uix-languagepicker-language-list:first").find("li").removeClass("yt-uix-button-menu-item-selected");jQuery(this).closest(".upload-item").find("ul.yt-uix-languagepicker-language-list:first").append('<li role="menuitem" data-value="'+r.VideoLanguageAbbreviation+'" class="yt-uix-languagepicker-menu-item yt-uix-button-menu-item-selected"><span class="yt-uix-button-menu-item">'+r.VideoLanguage+"</span></li>");e+="[B]";jQuery(this).closest(".upload-item").find("[name=captions_certificate_reason]").val(r.CaptionCertification);jQuery(this).closest(".upload-item").find(".location-longitude").val(r.LocationLongitude);jQuery(this).closest(".upload-item").find(".location-latitude").val(r.LocationLatitude);jQuery(this).closest(".upload-item").find("[name=allow_public_stats]").prop("checked",r.VideoStatisticsPublic);jQuery(this).closest(".upload-item").find(".video-settings-tag-chips-container").find(".yt-delete-chip").each(function(){jQuery(this)[0].click()});jQuery(this).closest(".upload-item").find(".video-settings-tags").val(r.Tags);e+="[C]";o=[];if(r.Tags!=null&&r.Tags.length>0){if(r.Tags.indexOf(",")>-1){o=r.Tags.split(",")}else{o=r.Tags.match(/(".*?"|[^"\s]+)+(?=\s*|\s*$)/g)}}a=0;var s=jQuery(this).closest(".upload-item").attr("id");TBUtilities.Log("uploadContainerId: "+s);if(s.indexOf(".")>0)s=TBUtilities.ReplaceAll(s,".","\\.");TBUtilities.Log("new uploadContainerId: "+s);if(s)if(o.length>0){n=setTimeout(P,10,s)}e+="[D]";jQuery(this).closest(".upload-item").find(".yt-uix-form-input-select").each(function(){jQuery(this).find(".yt-uix-form-input-select-value:first").text(jQuery(this).find(".yt-uix-form-input-select-element option:selected").text());jQuery(this).find(".yt-uix-form-input-select-element:first")[0].click()});U(jQuery(this).closest(".upload-item").find(".video-settings-title"));A(jQuery(this).closest(".upload-item").find(".video-settings-title"));L(jQuery(this).closest(".upload-item").find(".video-settings-title"))}catch(t){TBUtilities.LogError({Exception:t,Location:"[TubeBuddyUploads] tb-upload-default-apply-button [click] "+e})}});jQuery(document).on("click",".tb-seo-studio-apply-optimization",function(e){var t=setInterval(function(){var i=F(e);if(i.length===11){clearInterval(t);TubeBuddySeoStudio.ShowSeoStudio(null,i,null,null,null,Y)}},500)});jQuery(document).on("mousedown",".save-changes-button",function(e){if(x){var t=F(e);var i={ThumbnailId:x,VideoId:t};var o=TBGlobal.host+TBGlobal.apiUrls.seoScorePublishSavedThumbnailData;TBExtension.Post(o,JSON.stringify(i),function(e,i,o){try{if(e){x=null;jQuery(".upload-thumb-img").each(function(){if(jQuery(this).attr("src").indexOf(t)>0)jQuery(this).attr("src","https://i.ytimg.com/vi/"+t+"/0.jpg?time="+Math.random())})}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyUpload] publishOptimizationThumbnail"})}},null,{contentType:"application/json"})}})};var Y=function(e,t,i,o,a){var n=jQuery('.watch-page-link a[href="https://youtu.be/'+o+'"]');var r=n.closest(".upload-item");var s=r.find(".expand-button-text");s[0].click();var l=r.find(".video-settings-title");l.val(e);l.trigger("keyup");var d=document.createEvent("HTMLEvents");d.initEvent("input",true,true);var u=l[0];u.dispatchEvent(d);var c=r.find(".video-settings-description");c.val(t);c.trigger("keyup");var d=document.createEvent("HTMLEvents");d.initEvent("input",true,true);var u=c[0];u.dispatchEvent(d);r.find(".video-settings-tag-chips-container").find(".yt-delete-chip").each(function(){jQuery(this)[0].click()});TubeBuddyUpload.AddTags(n,i);x=a;if(a){jQuery(".upload-thumb-img").each(function(){if(jQuery(this).attr("src").indexOf(o)>0)jQuery(this).attr("src","https://tubebuddy.s3-us-west-1.amazonaws.com/seostudio/"+a+".jpg")})}};var H=function(e,t){try{if(TBGlobal.Profile().SettingsShowSuggestedTags==true){var i=e.closest(".upload-item");var o=i.find(".video-settings-title").val();var a=[];i.find(".video-settings-tag-chips-container").find(".yt-chip").each(function(e){a.push(jQuery(this).find("span:first").text())});var n=i.find(".tb-upload-suggested-tags-plugin").suggestedtags().data("plugin_suggestedtags");n.getSuggestions(l,a,o,t)}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyUploads] getSuggestedTags "})}};var z=function(e){try{if(TBGlobal.Profile().SettingsShowDemonetizationAudit==true){var t=e.closest(".upload-item");var i=t.find(".video-settings-title").val();var o=t.find(".video-settings-description").val();var a=[];t.find(".video-settings-tag-chips-container").find(".yt-chip").each(function(e){a.push(jQuery(this).find("span:first").text())});var n=t.find(".tb-demonetization-audit-container").demonetizationaudit().data("plugin_demonetizationaudit");if(n){n.auditMetaData(i,o,a)}}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyUploads] auditInputs "})}};var W=function(){jQuery(document.body).on("CRUploadVideoTranslateVideoMeta",function(e,t){try{if(t.success){j.find(".tb-upload-video-translate-loading").hide();j.find(".tb-upload-video-translate").prop("disabled",false);var i=JSON.parse(t.response);var o=j.find(".translation-editor-translated-title");o.val(i.Title);o.trigger("keyup");var a=document.createEvent("HTMLEvents");a.initEvent("input",true,true);var n=o[0];n.dispatchEvent(a);var r=j.find(".translation-editor-translated-description");r.val(i.Description);r.trigger("keyup");var a=document.createEvent("HTMLEvents");a.initEvent("input",true,true);var n=r[0];n.dispatchEvent(a)}else{j.find(".tb-edit-video-translate-loading").hide();j.find(".tb-edit-video-translate").prop("disabled",false);if(t.response==501){TBUtilities.Alert("There was an error translating your title and descrption. We were unable to find translations for your selected language.")}else if(t.response==426){TBUtilities.Alert("You've reached the limit for translations within 24 hours.  Please wait 24 hours and try again.")}else{TBUtilities.Alert("There was an error translating your title and descrption.  Please try again and contact support@tubebuddy.com if this problem continues.")}}}catch(e){j.find(".tb-edit-video-translate-loading").hide();j.find(".tb-edit-video-translate").prop("disabled",false);TBUtilities.Alert("There was an error translating your title and descrption.  Please try again and contact support@tubebuddy.com if this problem continues.");TBUtilities.LogError({Exception:e,Location:"[TubeBuddyUpload] CRUploadVideoTranslateVideoMeta"})}finally{j=null}});jQuery(document.body).on("CRUploadGetVideoCardTemplates",function(e,t){try{if(t.success){d=jQuery.parseJSON(t.response);if(d.length>0){jQuery(".tb-uploads-no-card-templates").addClass("tb-hid");jQuery(".tb-upload-copy-cards-select").empty();jQuery.each(d,function(){jQuery(".tb-upload-copy-cards-select").append(jQuery("<option></option>").text(this.Title).val(this.Id))})}else{}jQuery(".tb-upload-copy-cards-button").show();jQuery(".tb-upload-copy-cards-select").show()}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyUploads] CRUploadGetVideoCardTemplates"})}});jQuery(document.body).on("TBUploadGetToolsWindowSetting",function(e,t){TBUtilities.Log("Got TBUploadGetToolsWindowSetting");TBUtilities.Log(t);TBUtilities.Log(t.value);TBUtilities.Log(t.value==true);TBUtilities.Log(t.value=="true");TBUtilities.Log(t.value==false);TBUtilities.Log(t.value=="false");if(t){w=t.value==true;TBUtilities.Log("_hideToolsWindow: "+w)}});jQuery(document.body).on("CRTBUploadCreateChecklist",function(e,t){TBUtilities.Log("CRTBUploadCreateChecklist - VIDEOID: "+t.data.videoId);try{var i=JSON.parse(t.response);var o=jQuery('.share-panel-url[data-video-id="'+t.data.videoId+'"]:first').closest(".upload-item");if(o.length==0){TBUtilities.Log("No Share Panel");o=jQuery('a[href="https://youtu.be/'+t.data.videoId+'"]:first').closest(".upload-item")}TBUtilities.Log("Upload Item Length: "+o.length);o.find(".tb-upload-checklist-loading").hide();TBUtilities.Log("Checklist Length - "+i.ChecklistItems.length);if(i.ChecklistItems.length==0){}else{o.find(".tb-upload-no-upload-checklist").hide();o.find(".tb-upload-has-upload-checklist").show();o.find(".tb-upload-checklist-todo-list").html("");o.find(".tb-upload-remaining").show();o.find(".tb-upload-remaining-count").html(i.ChecklistItems.length);o.find(".tb-upload-generate-upload-checklist").hide();jQuery(".tb-upload-upload-checklist-print").show();jQuery(".tb-upload-upload-checklist-print").attr("href",TBGlobal.host+"/launchpad/printchecklist/"+TBGlobal.CurrentChannelId());var a=false;jQuery.each(i.ChecklistItems,function(e,t){a=e==i.ChecklistItems.length-1;var n="margin:0px -5px 0px -5px; padding-bottom:0px; border-bottom:dashed 1px #ddd;";if(a)n="margin:0px -5px 0px -5px; margin-bottom:-8px;";var r=o.find(".tb-upload-checklist-todo-list").html();o.find(".tb-upload-checklist-todo-list").html(r+'<div style="'+n+'"><div data-checklist-item-id="'+t.Id+'" class="tb-checklist-item-arrow" style="cursor:pointer; padding:5px 0 1px;"><input class="tb-checklist-item-check" type="checkbox" data-item-id="'+t.Id+'" style="position:relative; top:3px; vertical-align:top;" /> <span class="tb-upload-checklistitem-name" style="display:inline-block; overflow:hidden; font-weight:500; text-overflow: ellipsis;width: 230px;">'+t.Name+'</span><img style="height:10px; position:relative; opacity:.6; top:4px; float:right; margin-right:4px;" src="'+TBGlobal.host+'/images/icons/caret-up.png" /></div><div data-checklist-item-description-id="'+t.Id+'" style="display:none; padding: 5px 10px 5px 5px;font-size:12px;color: #666;border-left:dotted 0px #666;margin-left: 10px; margin-bottom:15px; max-height:150px; overflow:auto;">'+t.Description+'<div style="text-align:right; display:none; font-size11px; padding-top:1px; margin-top:5px; margin-bottom:-2px; border-top:dashed 1px #ccc;"><a target="new" href="'+TBGlobal.host+"/launchpad/checklist/"+t.Id+'">View In Launch Pad...</a></div></div></div>')});o.find(".tb-upload-checklist-todo-list").html(o.find(".tb-upload-checklist-todo-list").html()+'<div style="margin: 7px -10px -8px -10px;background-color: #f0f0f0;color: green;padding-left: 5px;padding: 3px 10px;border-top: solid 1px #ccc; text-align:right;"><a class="tb-checklist-item-check-all" style="cursor:pointer">&#x2713; Mark all items as Complete</a></div>');if(T){jQuery(".tb-uploade-checklist-created").show().delay(5e3).fadeOut();T=false}}}catch(e){}});jQuery(document.body).on("CRTBUploadChecklistTemplateSelected",function(e,t){try{if(t.success){jQuery(".tb-launchpad-container").after('<div class="tb-uploade-checklist-created" style="display:none; font-weight:500; color:green; font-size:15px; padding:10px; text-align:center;"><img src="'+TBGlobal.host+'/images/icons/check.png" style="position:relative; top:2px;" />Checklist Successfully Created!</div>');T=true;M()}else{TBUtilities.Alert('Sorry, there was an error. You can set up your checklist by logging in at TubeBuddy.com and clicking "Launch Pad".')}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyUploads] CRUploadDefaultsGetList"})}});jQuery(document.body).on("CRTBUploadChecklistTemplateItemsExist",function(e,t){try{TBUtilities.Log("CRTBUploadChecklistTemplateItemsExist Result: "+t);TBUtilities.Log(t);if(t.response=="true"){f=true;M()}else{jQuery(".tb-upload-no-upload-checklist").show();jQuery(".tb-upload-has-upload-checklist").hide();jQuery(".tb-upload-checklist-loading").hide()}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyUploads] CRTBUploadChecklistTemplateItemsExist"})}});jQuery(document.body).on("CRUploadSession",function(e,t){try{var i=DOMPurify.sanitize(t.response,DOMPurifyConfig);var o=jQuery.parseHTML(i);r=TBUtilities.GetSessionToken(i);var a=0;jQuery.each(s,function(e,t){a++;var i=jQuery.extend({},t);TubeBuddyCards.CheckCardStartMs(i,c,b);var o=TubeBuddyCards.CardCopyDelay()*a;setTimeout(function(){if(a==s.length)TubeBuddyYouTubeActions.CopyCard(l,i,r,TubeBuddyUpload.CardsCopyDone);else TubeBuddyYouTubeActions.CopyCard(l,i,r,null)},o)})}catch(e){_();O();y=null;TBUtilities.LogError({Exception:e,Location:"[TubeBuddyUploads] CRUploadSession"})}});jQuery(document.body).on("CRUploadDefaultsGetList",function(e,t){try{if(t.success){jQuery.each(JSON.parse(t.response),function(e,t){i.push(t)})}else{}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyUploads] CRUploadDefaultsGetList"})}});jQuery(document.body).on("CRTBLoadUploadTemplate",function(e,t){try{if(t.success){t.response=TBUtilities.FixLocalHtml(t.response);jQuery("body").append(t.response);jQuery("#page").after(jQuery(".tb-upload-debug-code")[0].outerHTML);V()}else{}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyUploads] CRTBLoadUploadTemplate"})}})};return{Initialize:function(){if(TBGlobal.IsAuthenticated()){if(!t){x=null;W();B();k();N();t=true}}},GetCardsListCallback:function(e){getCardsListCallback(e)},CardsCopyDone:function(e){D(e)},SetTags:function(e,t){a=0;o=t;e.closest(".upload-item").find(".video-settings-tag-chips-container").find(".yt-delete-chip").each(function(){jQuery(this)[0].click()});var i=e.closest(".upload-item").attr("id");if(o.length>0){n=setTimeout(P,10,i)}},AddTags:function(e,t){a=0;o=t;var i=e.closest(".upload-item").attr("id");if(o.length>0){n=setTimeout(P,10,i)}}}}();var TubeBuddySearchResults=function(){var e=false;var t="";var i=function(){var e=TBUtilities.GetUrlParameter("search_query");if(e==null||e=="")e=TBUtilities.GetUrlParameter("q");t=TBUtilities.ReplaceAll(TBUtilities.GetUrlDecoded(e),"+"," ");t=jQuery("<div/>").html(t).text();jQuery(".filter-button-container:first").after(jQuery(".tb-search-results-tag-explorer:last")[0].outerHTML.replace("#TAG#",t))};var o=function(){var e=TBGlobal.host+"/ModuleManager/searchresults/searchresults?v="+TBGlobal.versionNumber;if(loadLocalHTML&&(TBExtension.GetType()=="chrome"||TBExtension.GetType()=="firefox")){e=chrome.extension.getURL("modules/searchresults.html")}else if(loadLocalHTML&&TBExtension.GetType()=="safari"){e="modules/searchresults.html"}TBExtension.Get(e,"CRTBLoadSearchResultsTemplate")};var a=function(){jQuery(document).on("click",".tb-search-results-tag-explorer",function(){TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyTagExplorer.ShowTagExplorer(t,jQuery(this))})};var n=function(){jQuery(document.body).on("CRTBLoadSearchResultsTemplate",function(e,t){try{if(t.success){t.response=TBUtilities.FixLocalHtml(DOMPurify.sanitize(t.response,DOMPurifyConfig));jQuery("body").append(t.response);i()}else{}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddySearchResults] CRTBLoadSearchResultsTemplate"})}})};return{Initialize:function(){if(TBGlobal.IsAuthenticated()){if(!e){n();o();a();e=true}else{i()}}}}}();var TubeBuddyVideoInfo=function(){var e=false;var t=false;var i=[];var o="";var a=false;var n=[];var r;var s;var l;var d;var u=0;var c=0;var p=0;var b=0;var y;var h=false;var f=false;var m=false;var g={share_count:0,like_count:0,comment_count:0};var v={tweets:0};var T={posts:0};var w="";var j;var Q=function(){TBUtilities.Log("TubeBuddyVideoInfo.loadHtml");var e=TBGlobal.host+"/ModuleManager/videoinfo/videoinfo?v="+TBGlobal.versionNumber;if(loadLocalHTML&&(TBExtension.GetType()=="chrome"||TBExtension.GetType()=="firefox")){e=chrome.extension.getURL("modules/videoinfo.html")}else if(loadLocalHTML&&TBExtension.GetType()=="safari"){e="modules/videoinfo.html"}TBExtension.Get(e,"CRTBLoadVideoInfoTemplate")};var x=function(){TBUtilities.Log("TubeBuddyVideoInfo.populateNewContent");if(jQuery("#watch-description").length>0){TBUtilities.Log("TubeBuddyVideoInfo.populateNewContent watch-description found");if(j){clearTimeout(j)}a=false;f=false;m=false;i=[];jQuery("#tb-video-info-loading-tag-rankings").hide();jQuery("#tb-video-info-loading-tag-rankings-legend").hide();if(jQuery(".tb-layout-video-info-details").length<2){jQuery("#watch-header").after('<div class="tb-layout-video-info-details-container"></div>');jQuery(".tb-layout-video-info-details-container").append(jQuery(".tb-layout-video-info-details:last")[0].outerHTML);jQuery(".tb-layout-video-info-details-container").append(jQuery(".tb-layout-video-info-details-tabs:last")[0].outerHTML)}U()}};var B=function(){if(jQuery("#watch-description").length>0){TBUtilities.Log("CRTBLoadVideoInfoTemplate.watch-description > 0");if(j){clearTimeout(j)}if(jQuery(".tb-layout-video-info-details").length<2){jQuery("#watch-header").after('<div class="tb-layout-video-info-details-container"></div>');jQuery(".tb-layout-video-info-details-container").append(jQuery(".tb-layout-video-info-details:last")[0].outerHTML);jQuery(".tb-layout-video-info-details-container").append(jQuery(".tb-layout-video-info-details-tabs:last")[0].outerHTML)}}else{TBUtilities.Log("CRTBLoadVideoInfoTemplate.watch-description == 0")}};var k=function(e){i=[];jQuery.each(e,function(e,t){i.push(t)});L();if(TBGlobal.Profile().SettingsTagSearchRanking==true){if(!a&&i.length>0){R()}}};var L=function(){jQuery(".tb-video-info-tag-list").empty();o="";var e=i.length;if(i.length>0){jQuery.each(i,function(t,i){if(t==e-1){o+=i}else{o+=i+", "}var a=i;if(i.indexOf("(")>0)a=i.substring(0,i.indexOf("("));jQuery(".tb-video-info-tag-list").append('<span title="'+escape(a.toLowerCase().trim())+'" class="tb-video-info-tag-item"><img src="'+TBGlobal.host+'/images/icons/search.png" style="opacity:.5; height:11px;" /> '+TBUtilities.GetHtmlEncoded(i.trim())+"</span>")})}else{jQuery(".tb-video-info-tag-list").append('<span "style=font-size:12px; color:#999">(This video has no tags)</span>')}};var U=function(){var e=jQuery("html").html();if(e.indexOf('"keywords":"')>0){var t=e.indexOf('"keywords":"')+'"keywords":"'.length;i=[];var a=e.indexOf('"',t);o=e.substring(t,a);jQuery.each(o.split(","),function(e,t){i.push(t)});L()}};var C=function(){};var A=function(){var e="https://www.reddit.com/search?q=url:"+l+"&sort=new&t=all";TBExtension.Get(e,"CRTBLoadVideoInfoRedditData")};var S=function(e,t,i){try{TBUtilities.Log("gotSearchRank searchTerm = "+t+" rank= "+i);if(i>0){E(t,i)}if(n[n.length-1]==t){jQuery("#tb-video-info-loading-tag-rankings-legend").show();if(TBGlobal.Profile().IncognitoSearch==true)jQuery("#tb-video-info-loading-tag-rankings-legend").html('<span style="opacity: .95;background-color:green; color:white;line-height: 14px;font-size: 10px;padding: 1px 5px 0px 4px;border-radius: 3px;position: relative;font-weight: 500;">X</span> = Where this video ranks in YouTube Search Results <span style="font-weight:500">(Incognito)</span></a> <a style="text-decoration:underline" href="https://www.tubebuddy.com/channel/preferences/'+TBGlobal.CurrentChannelId()+'?change=rank" target="_blank">change setting</a>');else jQuery("#tb-video-info-loading-tag-rankings-legend").html('<span style="opacity: .95;background-color:green; color:white;line-height: 14px;font-size: 10px;padding: 1px 5px 0px 4px;border-radius: 3px;position: relative;font-weight: 500;">X</span> = Where this video ranks in YouTube Search Results  <span style="font-weight:500">(For You)</span> <a style="text-decoration:underline" href="https://www.tubebuddy.com/channel/preferences/'+TBGlobal.CurrentChannelId()+'?change=rank" target="_blank">change setting</a>');jQuery("#tb-video-info-loading-tag-rankings").hide()}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyVideoInfo] gotSearchRank"})}};var E=function(e,t){var i=e.toLowerCase().trim();if(e.indexOf("(")>0){i=e.substring(0,e.indexOf("("))}var o=jQuery(".tb-video-info-tag-item[title='"+escape(i)+"']");if(o){o.append('&nbsp;&nbsp;<span style="opacity: .75;background-color:green; color:white;line-height: 14px;font-size: 10px;padding: 1px 5px 0px 4px;border-radius: 3px;position: relative;font-weight: 500;">'+t+"</span>&nbsp;")}else{TBUtilities.Log("addSearchRankToTag tag not found found")}};var I=function(){var e=jQuery('[title="Apply Magic Transform"]').length>0;var t=jQuery(".ytp-cued-thumbnail-overlay").is(":visible");TBUtilities.Log("hasMagicActionsInstalled: "+e);TBUtilities.Log("hasStopAutoPlayEnabled: "+t);return e&&t};var G=function(){TBUtilities.Log("videoInfo.js|populateContent");if(j){clearTimeout(j);j=null}jQuery(".tb-video-info-estimated-earnings").html("");jQuery(".tb-video-info-content-owner").html("");jQuery(".tb-video-info-content-owner").show();jQuery(".tb-video-info-content-owner-link").hide();l=TBUtilities.GetUrlParameter("v");var e="/watch?v="+l;TBExtension.Get(e,function(e,t,i){try{if(e){var o=jQuery.parseHTML(DOMPurify.sanitize(i,DOMPurifyConfig));o=jQuery(o);var a=o.find("#watch-header");r=a.find(".watch-title").text().trim();l=a.find(".yt-uix-videoactionmenu:first").attr("data-video-id");s="https://img.youtube.com/vi/"+l+"/0.jpg";d=o.find('[itemprop="channelId"]').attr("content");u=parseInt(o.find("[itemprop=interactionCount]").attr("content")*1);p=parseInt(TBUtilities.ReplaceAll(TBUtilities.ReplaceAll(o.find(".like-button-renderer-like-button:first").text(),",",""),".",""));b=parseInt(TBUtilities.ReplaceAll(TBUtilities.ReplaceAll(o.find(".like-button-renderer-dislike-button:first").text(),",",""),".",""));jQuery(".tb-video-info-estimated-earnings").html(u);jQuery(".tb-video-info-estimated-earnings").html(TBUtilities.ToCurrency(u*.0015));var n=new Date(o.find('[itemprop="datePublished"]').attr("content"));var c=new Date;var y=1e3*60*60*24;var h=Date.UTC(n.getFullYear(),n.getMonth(),n.getDate());var f=Date.UTC(c.getFullYear(),c.getMonth(),c.getDate());var m=Math.floor((f-h)/y)-1;if(jQuery(".tb-video-info-quick-when").length>=2){TBUtilities.Log("tb-video-info-quick-when");return}if(m<=0)jQuery(".watch-time-text").after('<span class="tb-video-info-quick-when" style="padding-left:5px; font-size:11px; color:#666;">(Today)</span>');else if(m==1)jQuery(".watch-time-text").after('<span class="tb-video-info-quick-when" style="padding-left:5px; font-size:11px; color:#666;">(Yesterday)</span>');else jQuery(".watch-time-text").after('<span class="tb-video-info-quick-when" style="padding-left:5px; font-size:11px; color:#666;">('+m+" days ago)</span>");var g=null;try{var v=i;var T=v.indexOf('"ptk":"');if(T!=-1){T+=7;var w=v.indexOf('"',T);g=v.substring(T,w)}if(g!=null){if(g.indexOf("user")!=-1){g="(this channel)"}else{g=TBUtilities.ReplaceAll(g,"/","");g=TBUtilities.GetUrlDecoded(g);g=TBUtilities.ReplaceAll(g,"_"," ");g=TBUtilities.ReplaceAll(g,"+"," ");g=checkNetwork(g)}}else{g="(this channel)"}}catch(e){}if(g!=null){g=TBUtilities.ReplaceAll(g,"/","");g=TBUtilities.GetUrlDecoded(g);g=TBUtilities.ReplaceAll(g,"_"," ");g=TBUtilities.ReplaceAll(g,"+"," ");if(g.length!="SZKpdPOGeYzRBYotYf9dMA".length&&g.length>2&&g.length<200){var j=true;var Q="";var x="";var B=TBGlobal.GetNetwork(g.toLowerCase());if(B!=null){jQuery(".tb-video-info-content-owner-link").html(B.name);jQuery(".tb-video-info-content-owner-link").attr("href",B.url);jQuery(".tb-video-info-content-owner").hide();jQuery(".tb-video-info-content-owner-link").show()}else{jQuery(".tb-video-info-content-owner").html(g);jQuery(".tb-video-info-content-owner").show();jQuery(".tb-video-info-content-owner-link").hide()}}else{jQuery(".tb-video-info-content-owner").html("(this channel)");jQuery(".tb-video-info-content-owner").show();jQuery(".tb-video-info-content-owner-link").hide()}}else{jQuery(".tb-video-info-content-owner").html("(this channel)");jQuery(".tb-video-info-content-owner").show();jQuery(".tb-video-info-content-owner-link").hide()}TBUtilities.Log("tb-layout-video-info-details = "+jQuery(".tb-layout-video-info-details").length)}else{TBUtilities.LogFailedWebRequest({Location:"videoInfo.js|populateContent",Data:t,Response:i})}}catch(e){TBUtilities.LogError({Exception:e,Location:"videoInfo.js|populateContent"})}},null,{dataType:null})};var R=function(){if(!a&&i.length>0){jQuery("#tb-video-info-loading-tag-rankings").show();jQuery("#tb-video-info-loading-tag-rankings-legend").hide();n=[];jQuery.each(i,function(e,t){var i=t;if(t.indexOf("(")>0){i=t.substring(0,t.indexOf("("))}n.push(i)});var e=0;jQuery.each(n,function(t,i){setTimeout(function(){TubeBuddyYouTubeActions.GetVideoSearchRank(TBUtilities.GetUrlParameter("v"),i,S,1)},e);e+=50});a=true}};var P=function(){jQuery(document).on("click",".tb-video-info-search-ranking",function(){jQuery(this).hide();a=false;R()});jQuery(document).on("click","#tb-video-info-copy-tags",function(e){e.stopPropagation();var t=o.split(",");TubeBuddyCopyTo.ShowMenu(jQuery(this),t)});jQuery(document).on("click",".tb-video-info-tab-header",function(){if(jQuery(".tb-videolytics-container-disabled").is(":visible")){jQuery(".tb-videolytics-enabled-img:first").trigger("click");jQuery("html, body").animate({scrollTop:0},"fast")}return;try{jQuery(".tb-video-info-tab").hide();jQuery("#"+jQuery(this).attr("data-tab-id")).show();jQuery(".tb-video-info-tab-header").removeClass("selected");jQuery(this).addClass("selected");if(jQuery(this).attr("data-tab-id")=="tb-video-info-description-tab"){jQuery(".tb-popout-tabs-container:first").hide();jQuery("#action-panel-details").show()}else{jQuery(".tb-popout-tabs-container:first").show();jQuery("#action-panel-details").hide()}var e=jQuery(this).attr("data-tab-id");jQuery(".tb-video-info-search-ranking").hide();if(e=="tb-video-info-tags-tab"){t=false;if(TBGlobal.Profile().SettingsTagSearchRanking==true){jQuery(".tb-video-info-tag-list").html('<div style="padding:10px 15px"><img src="'+TBGlobal.host+'/images/general/loading1.gif" /> Loading...</div>');jQuery("#tb-video-info-loading-tag-rankings").hide();jQuery("#tb-video-info-loading-tag-rankings-legend").hide();jQuery(".tb-video-info-search-ranking").hide()}else{jQuery(".tb-video-info-search-ranking").show()}a=false;TubeBuddyYouTubeActions.GetVideoTags(TBUtilities.GetUrlParameter("v"),k)}if(!f){TBUtilities.AddAction(null,TBUtilities.ActionTypes.ViewAndCopyVideoTags_Copy,"watchpagestats")}f=true;if(e=="tb-video-info-info-tab"&&!h){G();C();A();h=true;if(!m){TBUtilities.AddAction(null,TBUtilities.ActionTypes.WatchPageStats_Stats,"watchpagestats")}m=true}else if(e=="tb-video-info-actions-tab"){G()}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyembedExplorer] .tb-video-info-tab-header [click]"})}});jQuery(document).on("click","#tb-video-info-tags-tab-header",function(){if(jQuery("#tb-video-info-loading-tag-rankings-legend").is(":visible"))return;if(i==null)return;if(i.length==0)return;if(TBGlobal.Profile().SettingsTagSearchRanking==true){jQuery(".tb-video-info-search-ranking").hide();R()}else{jQuery(".tb-video-info-search-ranking").show()}});jQuery(document).on("click",".tb-video-info-tag-item",function(){var e=unescape(jQuery(this).attr("title"));TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyTagExplorer.ShowTagExplorer(e,jQuery(this))});jQuery(document).on("click",".tb-video-info-tool-button",function(){var e=jQuery(this).attr("data-tool");var t=d!=TBGlobal.CurrentChannelId();if(typeof l=="undefined"){l=TBUtilities.GetUrlParameter("v")}TubeBuddyMenu.ShowBackgroundSticky();switch(e){case"social-monitor":TubeBuddySocialMonitor.Show(l,r,s,t);break;case"advanced-embed":TubeBuddyEmbed.ShowForVideo(l,r,s);break;case"search-rank":TubeBuddySearchRanking.Show(l,s,r);break;case"share-tracker":TubeBuddyShareTracker.ShowForVideo(l,r,s);break;case"copy-annotations":TBUtilities.Alert("Sorry but YouTube has removed the ability to add or update Annotations. They are requesting that you use Cards or End Screens instead.");return;TubeBuddyAnnotations.Show(l,r,s);break;case"vid2vid-promotion":TubeBuddyV2VPromote.Show(l,r,s,t);break;case"twitter-post":TubeBuddyTwitterPost.Show(l,r,s,_link);break;case"gif-generator":TubeBuddyGifGenerator.Show(l,r,s,t);break}})};var D=function(){jQuery(document.body).on("CRTBLoadVideoInfoStats",function(e,t){try{if(t.success){var i=JSON.parse(t.response);g.share_count=i.FacebookShareCount;g.comment_count=i.FacebookCommentCount;if(!g.share_count)g.share_count=0;if(!g.comment_count)g.comment_count=0;jQuery("#tb-video-info-fb-shares").text(TBUtilities.FormatNumberWithCommas(g.share_count));jQuery("#tb-video-info-fb-comments").text(TBUtilities.FormatNumberWithCommas(g.comment_count));jQuery("#tb-video-info-like-ratio").text(i.LikeRatio);jQuery(".tb-video-info-engagement-ratio").text(i.EngagementRatio);jQuery("#tb-video-info-fb-shares-link").attr("href","https://www.facebook.com/search/str/"+l+"/keywords_top");jQuery("#tb-video-info-fb-likes-link").attr("href","https://www.facebook.com/search/str/"+l+"/keywords_top");jQuery("#tb-video-info-fb-comments-link").attr("href","https://www.facebook.com/search/str/"+l+"/keywords_top")}else{}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyVideoInfo] CRTBLoadVideoInfoStats"})}});jQuery(document.body).on("CRTBLoadVideoInfoRedditData",function(e,t){try{if(t.success){T.posts=TBUtilities.CountMatches(t.response,"search-result search-result-link",false,false);jQuery("#tb-video-info-rd-posts").text(T.posts);jQuery("#tb-video-info-rd-posts-link").attr("href","https://www.reddit.com/search?q=url:"+l)}else{}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyVideoInfo] CRTBLoadVideoInfoRedditData"})}});jQuery(document.body).on("CRTBLoadVideoInfoTemplate",function(e,t){try{if(t.success){t.response=TBUtilities.FixLocalHtml(DOMPurify.sanitize(t.response,DOMPurifyConfig));jQuery("body").append(t.response);w=t.response;if(!I()){TBUtilities.Log("CRTBLoadVideoInfoTemplate.NoConflict");j=setInterval(B,10)}else{TBUtilities.Log("CRTBLoadVideoInfoTemplate.Conflict")}}else{}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyVideoInfo] CRTBLoadVideoInfoTemplate"})}})};return{Initialize:function(){var i=TBGlobal.GetYouTubeUI();if(i=="material"){return}if(TBGlobal.IsAuthenticated()){h=false;if(!e){TBUtilities.Log("TubeBuddyVideoInfo.Initialize1");D();Q();P();e=true}else{t=true;TBUtilities.Log("TubeBuddyVideoInfo.Initialize2");if(!I())j=setInterval(x,10)}}}}}();var TubeBuddyVideoMenuStudio=function(){var e=false;var t=function(){if(document.location.href.indexOf("studio.youtube.com/video/")){var e=setInterval(function(){var t=jQuery('ytcp-navigation-drawer[layout="video"] div#entity-label-container').filter(":visible");var i=jQuery(".title.input-container #textbox:visible");if(t.length>0&&i.length>0){clearInterval(e);if(t.find(".tb-video-tools-menu-dropdown").length==0){var o=jQuery("#tb-studio-video-edit-dropdown-template").html();jQuery(o).attr("id","tb-video-edit-studio-tools-menu-dropdown");t.append(o)}else if(t.find(".tb-video-tools-menu-dropdown:hidden").length==1){t.find(".tb-video-tools-menu-dropdown").show()}}},1e3)}};var i=function(){jQuery(".tb-video-menu-overview").hide();jQuery(".tb-studio-video-edit-dropdown").removeAttr("menu-open")};var o=function(){var e=TBGlobal.host+"/ModuleManager/videomenustudio/videomenustudio?v="+TBGlobal.versionNumber;if(loadLocalHTML&&(TBExtension.GetType()=="chrome"||TBExtension.GetType()=="firefox")){e=chrome.extension.getURL("modules/videomenustudio.html")}else if(loadLocalHTML&&TBExtension.GetType()=="safari"){e="modules/videomenustudio.html"}TBExtension.Get(e,"CRTBLoadVideoMenuStudio")};var a=function(){return document.location.href.slice(document.location.href.search("/video/")+7,document.location.href.search("/video/")+18)};var n=function(){if(jQuery("#entity-name").length>0)return jQuery("#entity-name").text().trim();return""};var r=function(){if(jQuery(".description").find("textarea").length>0)return jQuery(".description").find("textarea").val().trim();return};var s=function(){if(jQuery("#img-with-fallback:first").length>0)return jQuery("#img-with-fallback:first").attr("src");else return"https://img.youtube.com/vi/"+a()+"/mqdefault.jpg"};var l=function(e){var t=JSON.parse(window.localStorage.getItem("tb-videos-list-studio-video-info"+TBGlobal.CurrentChannelId()));if(t&&t.length>0){var i=t.filter(function(t){return t.videoId==e});if(i.length>0){return i[0].views}else{return null}}else{return null}};var d=function(e){jQuery(".tb-video-edit-studio-playlist-container").html('<span class="tb-spinner tb-margin-right5"></span> Loading Playlists...');TBExtension.Get("https://www.youtube.com/edit?o=U&video_id="+e,"CRTBLoadVideoMenuStudioEditPage",{videoId:e})};var u=function(){jQuery(document).on("click",".tb-video-tools-menu-dropdown-ab-test",function(){var e=a();var t=n();var o=encodeURI("https://img.youtube.com/vi/"+e+"/mqdefault.jpg");i(true);window.open(TBGlobal.host+"/channel/abtestcreate/"+TBGlobal.CurrentChannelId()+"?videoid="+e+"&videotitle="+t+"&videothumbnail="+o,"_blank")});jQuery(document).on("click",".tb-video-tools-menu-dropdown-comments",function(){var e=jQuery(this).attr("data-id");TBUtilities.Confirm("Are you sure you want to export all comments (1,000 max) from this video to a CSV file?\n\nThis process can take up to 2 MINUTES to complete based on how many comments you have (so be patient).",function(){if(!TBGlobal.CanAccessLevel3Tools()){TBGlobal.ShowUpgradePage("export video comments",TBGlobal.limitation.exportComments);return false}var t=TBGlobal.host+"/youtubechannel/ExportVideoComments?channelId="+TBGlobal.CurrentChannelId()+"&videoId="+e;var i=window.open(t,"_blank");i.focus()},null)});jQuery(document).on("click",".tb-video-tools-menu-studio-seo-studio",function(){i();TubeBuddyMenu.ShowBackgroundSticky();TubeBuddySeoStudio.ShowSeoStudio(null,a(),n())});jQuery(document).on("click",".tb-video-id-copy",function(){jQuery(".tb-video-id-copy").text("Copied");window.setTimeout(function(){jQuery(".tb-video-id-copy").text("Copy")},1500)});jQuery(document).on("click",".tb-video-link-copy",function(){jQuery(".tb-video-link-copy").text("Copied");window.setTimeout(function(){jQuery(".tb-video-link-copy").text("Copy")},1500)});jQuery(document).on("click",".tb-video-studio-playlist-copy",function(){jQuery(this).text("Copied");window.setTimeout(function(){jQuery(".tb-video-studio-playlist-copy").text("Copy")},1500)});jQuery(document).on("click",".tb-video-tools-menu-dropdown-suggested-tags",function(e){e.preventDefault();if(window.location.href.indexOf("edit")>-1){var t=a();var o=n();TubeBuddyMenu.ShowBackgroundSticky();var r=TubeBuddyEditVideoStudio.GetTags();TubeBuddySuggestedTags.Show(t,o,jQuery(this),r,function(e){var t=[];t.push(e);TubeBuddyEditVideoStudio.AddTags(t)});i();e.stopPropagation()}else{var s=jQuery(this).find("a").attr("href");var l=window.open(s,"_blank")}});jQuery(document).on("click",".tb-video-tools-menu-dropdown-tag-translator",function(e){e.preventDefault();if(window.location.href.indexOf("edit")>-1){var t=[];jQuery("#outer").find("div.ytcp-chip").each(function(e){t.push(jQuery(this).text())});TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyTagTranslator.Show(t);i();e.stopPropagation()}else{var o=jQuery(this).find("a").attr("href");var a=window.open(o,"_blank")}});jQuery(document).on("click",".tb-studio-video-edit-dropdown",function(e){if(jQuery(this).attr("menu-open")){i()}else{var t=a();var o=n();var r=s();if(jQuery("div.nav-and-main-content").find("#tb-video-menu-studio-overview").length==0){var l=jQuery("#tb-video-tools-menu-studio-dropdown-template").html();var d=l.formatTemplate(t,o,r);jQuery("ytcp-navigation-drawer.ytcp-entity-page").prepend(DOMPurify.sanitize(d,DOMPurifyConfig));var u=TBGlobal.host+TBGlobal.apiUrls.youTubeVideosGetVideoStatus+"?videoId="+a();TBExtension.Get(u,"CRTBEditVideoAnnotationsLoadVideoStudioStatus")}jQuery("#tb-video-menu-studio-overview").css("left","200px");jQuery("#tb-video-menu-studio-overview").removeClass("tb-hid");jQuery("#tb-video-menu-studio-overview").show();e.stopPropagation();jQuery(this).attr("menu-open",true)}});jQuery(document).on("click",".tb-video-menu-studio-tab-header",function(){jQuery(this).parent().find(".tb-video-menu-studio-tab-header").removeClass("selected tb-selected");jQuery(this).addClass("selected tb-selected");jQuery(this).parent().parent().find(".tb-video-edit-studio-menu-tab-container").hide();jQuery(this).parent().parent().find("#"+jQuery(this).attr("data-tab-id")).show();var e=a();var t=n();var i=s();jQuery(this).closest("div").find(".tb-videos-list-info-video-id").val(e);jQuery(this).closest("div").find(".tb-videos-list-info-video-link").val("https://youtu.be/"+e);jQuery(".tb-video-id-copy").attr("data-clipboard-text",e);var o=new ClipboardJS(".tb-video-id-copy");jQuery(".tb-video-link-copy").attr("data-clipboard-text","https://youtu.be/"+e);var r=new ClipboardJS(".tb-video-link-copy");if(jQuery(this).parent().parent().find(".tb-video-edit-studio-playlist-container").html().trim().length==0)d(e)});jQuery(document).on("click",".tb-video-tools-menu-video-overview, .tb-video-menu-overview",function(e){e.stopPropagation()});jQuery(document).on("click","#entity-page",function(){i()});jQuery(document).on("change",".tb-video-tools-menu-comment-filters",function(e){if(jQuery(this).val()=="filter")return;var t=window.open("https://www.youtube.com/comments?filter="+a()+"&tbfilter="+jQuery(this).val(),"_blank");jQuery(this).val("filter");e.stopPropagation()});jQuery(document).on("click",".tb-video-tools-menu-dropdown-promote",function(e){var t=a();var o=n();var r=s();TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyV2VPromote.Show(t,o,r);i();e.stopPropagation()});jQuery(document).on("click",".tb-video-tools-menu-dropdown-twitter",function(e){var t=a();var o=n();var r=s();TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyTwitterPost.Show(t,o,r);i();e.stopPropagation()});jQuery(document).on("click",".tb-video-tools-menu-dropdown-captions",function(e){var t=a();var o=n();var r=s();TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyTranscriptions.Show(t,o,r);i();e.stopPropagation()});jQuery(document).on("click",".tb-video-tools-menu-dropdown-social-monitor",function(e){var t=a();var o=n();var r=s();TubeBuddyMenu.ShowBackgroundSticky();TubeBuddySocialMonitor.Show(t,o,r);i();e.stopPropagation()});jQuery(document).on("click",".tb-video-tools-menu-dropdown-copy-cards",function(e){var t=a();var o=n();var r=s();TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyCards.Show(t,o,r);i();e.stopPropagation()});jQuery(document).on("click",".tb-video-tools-menu-dropdown-embed",function(e){var t=a();var o=n();var r=s();TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyEmbed.ShowForVideo(t,o,r);i();e.stopPropagation()});jQuery(document).on("click",".tb-video-tools-menu-dropdown-share-tracker",function(e){var t=a();var o=n();var r=s();TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyShareTracker.ShowForVideo(t,o,r);i();e.stopPropagation()});jQuery(document).on("click",".tb-video-tools-menu-dropdown-search-ranking",function(e){var t=a();var o=n();var r=s();TubeBuddyMenu.ShowBackgroundSticky();TubeBuddySearchRanking.Show(t,r,o);i();e.stopPropagation()});jQuery(document).on("click",".tb-video-tools-menu-dropdown-thumbnail-creator",function(e){var t=a();var o=n();var d=s();var u=r();var c=l(t);TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyThumbnailCreator.Show(t,o,d,u,c);i();e.stopPropagation()});jQuery(document).on("click",".tb-video-tools-menu-dropdown-pick-a-winner",function(e){var t=a();var o=n();var r=s();TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyPickAWinner.Show(t,r,o);i();e.stopPropagation()});jQuery(document).on("click",".tb-video-tools-menu-dropdown-export-to-facebook",function(e){var t=a();var o=n();var r=s();TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyCopyToFacebook.Show(t,r,o);i();e.stopPropagation()});jQuery(document).on("click",".tb-video-tools-menu-dropdown-sunset-video",function(e){var t=a();var o=n();var r=s();TubeBuddyMenu.ShowBackgroundSticky();TubeBuddySunsetVideo.Show(t,o,r);i();e.stopPropagation()});jQuery(document).on("click",".tb-video-tools-menu-dropdown-golive-video",function(e){var t=a();var o=n();var r=s();TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyGoLiveVideo.Show(t,o,r);i();e.stopPropagation()});jQuery(document).on("click",".tb-video-tools-menu-dropdown-scheduled-video-update-video",function(e){var t=a();var o=n();var r=s();TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyScheduledMetaUpdates.Show(t,o,r);i();e.stopPropagation()});jQuery(document).on("click",".tb-video-tools-menu-dropdown-gif-generator",function(e){var t=a();var o=n();var r=s();TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyGifGenerator.Show(t,o,r);i();e.stopPropagation()});jQuery(document).on("click",".tb-video-tools-menu-dropdown-apply-card-template",function(e){var t=a();var o=n();var r=s();TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyCardTemplates.Show(t,o,r);i();e.stopPropagation()});jQuery(document).on("click",".tb-video-tools-menu-dropdown-copy-endscreen",function(e){var t=a();var o=n();var r=s();TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyEndScreens.Show(t,o,r);i();e.stopPropagation()});jQuery(document).on("click",".tb-video-tools-menu-dropdown-apply-endscreen-template",function(e){var t=a();var o=n();var r=s();TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyEndScreenTemplates.Show(t,o,r);i();e.stopPropagation()});jQuery(document).on("click","a",function(){var e=jQuery(this).attr("id");if(e=="back-button"||e=="home-button"||e=="Comments"||e=="AnalyticsRealtime")jQuery("#tb-video-edit-studio-tools-menu-dropdown").hide();if(e=="video-title")jQuery("#tb-video-edit-studio-tools-menu-dropdown").show()});jQuery(document).on("click","ul.tb-menu-quick-list li",function(){var e=jQuery(this).find("a.tb-menu-item").text();if(e=="Dashboard"||e=="My Videos"){jQuery("#tb-video-edit-studio-tools-menu-dropdown").hide()}})};var c=function(){jQuery(document.body).on("CRTBLoadVideoMenuStudioEditPage",function(e,t){if(t.success){var i=t.response.indexOf("{'X-YouTube-Identity-Token': \"")+"{'X-YouTube-Identity-Token': \"".length;var o=t.response.indexOf('"',i+2);var a=t.response.substring(i,o);var n={video_ids:t.data.videoId,session_token:a,src_playlist_id:""};TBExtension.Post("https://www.youtube.com/addto_ajax?action_get_dropdown=1&hide_watch_later=true&feature=edit",jQuery.param(n),"CRTBLoadVideoMenuStudioPlaylistData",{videoId:t.data.videoId},{contentType:"application/x-www-form-urlencoded; charset=UTF-8"})}else{}});jQuery(document.body).on("CRTBLoadVideoMenuStudioPlaylistData",function(e,t){var i=false;if(t.success){$(".tb-video-edit-studio-playlist-container").empty();var o=t.data.videoId;var a=DOMPurify.sanitize(t.response,DOMPurifyConfig);jQuery(a).find("li").each(function(){var e=jQuery(this).find(".playlist-name:first").html();var t=jQuery(this).find("button:first").attr("aria-checked");var a=jQuery(this).attr("data-full-list-id");if(t=="checked"){$(".tb-video-edit-studio-playlist-container").append('<div style="padding:0 0 10px"><b>Playlist Link - "'+e+'"</b><br /> <input class="tb-material-input tb-playlist-info-studio" style="width:50%;" type="text" value="https://www.youtube.com/watch?v='+o+"&list="+a+'" readonly /><button id="tb-video-studio-copy-playlist-'+a+'" class="tb-btn-blue tb-video-studio-playlist-copy" data-clipboard-action="copy" data-clipboard-text="https://www.youtube.com/watch?v='+o+"&list="+a+'" >Copy</button></div>');i=true;new ClipboardJS("#tb-video-studio-copy-playlist-"+a)}});if(!i)$(".tb-video-edit-studio-playlist-container").append('<div style="padding:15px 0 10px 5px; color:coral;">This video was not found in any of your Playlists.</div>')}else{}});jQuery(document.body).on("CRTBLoadVideoMenuStudio",function(e,i){try{if(i.success){i.response=TBUtilities.FixLocalHtml(DOMPurify.sanitize(i.response,DOMPurifyConfig));jQuery("body").append(i.response);t()}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyVideoMenuStudio] CRTBLoadVideoMenuStudio"})}});jQuery(document.body).on("CRTBEditVideoAnnotationsLoadVideoStudioStatus",function(e,t){if(t.success){var i=JSON.parse(t.response);if(i.DateThumbnailGeneratedLocal){jQuery(".tb-video-tools-menu-thumbnail-generated-date").text(i.DateThumbnailGeneratedLocal);jQuery(".tb-video-tools-menu-thumbnail-generated").show();jQuery(".tb-video-tools-menu-notes").show()}if(i.IsCardTemplate){jQuery(".tb-video-tools-menu-is-card-template").show();jQuery(".tb-video-tools-menu-notes").show()}if(i.DateFacebookPostedLocal){jQuery(".tb-video-tools-menu-facebook-date").text(i.DateFacebookPostedLocal);jQuery(".tb-video-tools-menu-view-facebook").attr("href","https://www.facebook.com/video/video.php?v="+i.FacebookVideoId);jQuery(".tb-video-tools-menu-facebook").show();jQuery(".tb-video-tools-menu-notes").show()}if(i.ScheduledGoLiveLocal){jQuery(".tb-video-tools-menu-golive-date").text(i.ScheduledGoLiveLocal);jQuery(".tb-video-tools-menu-golive").show();jQuery(".tb-video-tools-menu-notes").show()}if(i.DateWentLiveLocal){jQuery(".tb-video-tools-menu-wentlive-date").text(i.DateWentLiveLocal);jQuery(".tb-video-tools-menu-wentlive").show();jQuery(".tb-video-tools-menu-notes").show()}if(i.DateSunsetLocal){jQuery(".tb-video-tools-menu-sunset-date").text(i.DateSunsetLocal);jQuery(".tb-video-tools-menu-sunset").show();jQuery(".tb-video-tools-menu-notes").show()}if(i.DateSunsettedLocal){jQuery(".tb-video-tools-menu-sunsetted-date").text(i.DateSunsettedLocal);jQuery(".tb-video-tools-menu-sunsetted").show();jQuery(".tb-video-tools-menu-notes").show()}if(i.DateScheduledMetaUpdate){jQuery(menuContainer).find(".tb-video-tools-menu-scheduledmetaupdate-date").text(i.DateScheduledMetaUpdateLocal);jQuery(menuContainer).find(".tb-video-tools-menu-scheduledmetaupdate").show();jQuery(menuContainer).find(".tb-video-tools-menu-notes").show()}if(i.DateScheduledMetaUpdated){jQuery(menuContainer).find(".tb-video-tools-menu-scheduledmetaupdated-date").text(i.DateScheduledMetaUpdatedLocal);jQuery(menuContainer).find(".tb-video-tools-menu-scheduledmetaupdated").show();jQuery(menuContainer).find(".tb-video-tools-menu-notes").show()}if(i.SharedWithNetworks!=null){jQuery(".tb-video-tools-menu-share-tracker-items").show();jQuery.each(i.SharedWithNetworks,function(e,t){jQuery(".tb-video-tools-menu-share-tracker-items-list").append('<img src="'+TBGlobal.host+"/images/icons/social/"+t+'.png" style="height:12px;" /> ')});jQuery(".tb-video-tools-menu-notes").show()}}else{}})};return{Initialize:function(){if(TBGlobal.IsAuthenticated()){if(!e){c();o();u();e=true}else{o()}}}}}();