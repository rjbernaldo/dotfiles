var TubeBuddySearchTermAnalysis=function(){var e=false;var t=false;var i=false;var o=null;var a;var s=false;var n=false;var r=0;var l=4;var u=["#F40000","#F87E00","#FDED01","#7FD500","#00AE00"];var d=null;var c=null;var p=function(){if(c){clearInterval(c);c=null}c=setInterval(function(){var e=h();if(e.length>0){clearInterval(c);c=null;e.removeAttr("hidden");var i=e.find("#tb-search-term-analysis-container");if(i.length>0){i.remove()}t=true;e.append(jQuery("#tb-search-term-analysis-container")[0].outerHTML);jQuery("#tb-search-term-analysis-keyword-score-container-loading").show();jQuery("#tb-search-term-analysis-keyword-score-container").hide();d=e.find("#tb-search-term-analysis-container");if(n===true){s=true;jQuery("#tb-search-term-analysis-disabled").hide();if(TBGlobal.CanAccessLevel1Tools()==false){jQuery("#tb-search-term-analysis-keyword-score-container-loading").hide();jQuery("#tb-search-term-analysis-keyword-score-container").show();jQuery("#tb-search-term-analysis-keyword-score-container-paid").hide();jQuery("#tb-search-term-analysis-keyword-score-container-free").show()}else{jQuery("#tb-search-term-analysis-keyword-score-container-loading").show();jQuery("#tb-search-term-analysis-keyword-score-container").show();jQuery("#tb-search-term-analysis-keyword-score-container-paid").hide();jQuery("#tb-search-term-analysis-keyword-score-container-free").hide();b()}var a=jQuery("body")[0].outerHTML;var r=a.indexOf('PSUGGEST_TOKEN":"')+'PSUGGEST_TOKEN":"'.length;var l=a.indexOf('"',r);var u=a.substring(r,l);var p="https://clients1.google.com/complete/search?client=youtube&hl=en&gl=us&gs_rn=23&gs_ri=youtube&tok="+u+"&ds=yt&cp=15&gs_id=a&q="+encodeURIComponent(o)+"&callback=google.sbox.p50&gs_gbg=3no8d";TBExtension.Get(p,"CRTBSearchTermAnalysisGetYouTubeSuggest");var f=[];jQuery("a.ytd-thumbnail:visible").each(function(e){var t=jQuery(this).attr("href");var i=T("v",t);if(i&&f.indexOf(i)===-1){f.push(i)}});var y=[];var g=0;if(f.length>0){jQuery.each(f,function(e,t){TubeBuddyYouTubeActions.GetVideoInfo(t,function(e){g++;if(e!=null&&e.title!=null){y.push(e)}if(g>=f.length){v(y);var t=L(y);_(t,y)}})})}else{jQuery("#tb-search-term-analysis-most-used-tags-container-loading").hide();jQuery("#tb-search-term-analysis-most-used-tags-container").show();jQuery("#tb-search-term-analysis-most-used-tags-list").append('<span style="line-height:250%;color:#999; font-size:15px; position:relative;">(No Search Results)</span>');jQuery("#tb-search-term-analysis-keyword-stats-container-loading").hide();jQuery("#tb-search-term-analysis-keyword-stats-container").append('<span style="line-height:250%;color:#999; font-size:15px; position:relative;">(No Search Results)</span>')}j("clipboard");C();jQuery("#tb-search-term-analysis-keyword-score-tab").click();jQuery('[data-tbtooltip!=""]').qtip({content:{attr:"data-tbtooltip"},style:{classes:"qtip-youtube-tubebuddy"}})}else{s=false;jQuery("#tb-search-term-analysis-body").hide();jQuery("#tb-search-term-analysis-disabled").show();jQuery("#tb-search-term-analysis-disable").hide();jQuery("#tb-search-term-analysis-enable").show();jQuery(".tb-search-term-analysis-header-carret").attr("title","expand")}}setTimeout(function(){m()},500)},500)};var b=function(){var e='"'+o+'"';TubeBuddyYouTubeActions.GetSearchEstimatedResultCount(e).then(function(e){var t=new Object;t[o.toLowerCase()]=e;var i=TBGlobal.GetPrefCookieObject();var a={Region:"us",Tags:[],Language:"en",TagsWithExactCounts:t};if(i&&i.gl){a.Region=i.gl}if(i&&i.hl){a.Language=i.hl}var s=TBGlobal.host+TBGlobal.apiUrls.tagScoreGet;TBExtension.Post(s,JSON.stringify(a),"CRTSearchTermAnalysisGetTagScore",null,{contentType:"application/json"})}).catch(function(e){TBUtilities.LogError(e)})};var h=function(){var e=jQuery("ytd-secondary-search-container-renderer#secondary");return e};var m=function(){r++;if(r>=l){return}var e=jQuery("#secondary").find("#tb-search-term-analysis-container");if(e){var t=e.index();if(t!==-1&&t!==0){jQuery("#secondary").prepend(e)}}setTimeout(function(){m()},2e3)};var f=function(){var e=TBGlobal.host+"/ModuleManager/SearchTermAnalysis/SearchTermAnalysis?v="+TBGlobal.versionNumber;if(loadLocalHTML&&(TBExtension.GetType()=="chrome"||TBExtension.GetType()=="firefox")){e=chrome.extension.getURL("modules/searchtermanalysis.html")}else if(loadLocalHTML&&TBExtension.GetType()=="safari"){e="modules/searchtermanalysis.html"}TBExtension.Get(e,"CRTBLoadSearchTermAnalysisTemplate")};var y=function(){jQuery(document).on("click",".tb-search-term-analysis-keyword-score-label-tag-explorer",function(e){TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyTagExplorer.ShowTagExplorer(o)});jQuery(document).on("click",".tb-search-term-analysis-suggested-tag",function(e){var t=jQuery(this).text();window.location="/results?search_query="+encodeURI(t)});jQuery(document).on("click",".tb-search-term-analysis-keyword-score-container-free-button",function(e){jQuery("#tb-search-term-analysis-keyword-score-container-free").hide();jQuery("#tb-search-term-analysis-keyword-score-container-loading").show();jQuery("#tb-search-term-analysis-keyword-score-container").show();b()});jQuery(document).on("click",".tb-search-term-analysis-tab",function(e){var t=jQuery(this).attr("data-tab-container");jQuery(".tb-search-term-analysis-tab-active").removeClass("tb-search-term-analysis-tab-active").addClass("tb-search-term-analysis-tab-inactive");if(t){jQuery(this).removeClass("tb-search-term-analysis-tab-inactive");jQuery(this).addClass("tb-search-term-analysis-tab-active");jQuery(".tb-search-term-analysis-tab-content").hide();jQuery("#"+t).show();if(t=="tb-search-term-analysis-keyword-stats-container"){jQuery(this).parent().parent().children().filter(".tb-searchalytics-panel").addClass("tb-search-term-analysis--secondary-tab-active")}else{jQuery(this).parent().parent().children().filter(".tb-searchalytics-panel").removeClass("tb-search-term-analysis--secondary-tab-active")}}});jQuery(document).on("click",".tb-search-term-analysis-all-tags",function(e){jQuery(this).closest("#tb-search-term-analysis-most-used-tags-container").find(".tb-search-term-analysis-tag-checkbox").each(function(){jQuery(this).prop("checked",true)});C();k()});jQuery(document).on("click",".tb-search-term-analysis-none-tags",function(e){jQuery(this).closest("#tb-search-term-analysis-most-used-tags-container").find(".tb-search-term-analysis-tag-checkbox").each(function(){jQuery(this).prop("checked",false)});C();k()});jQuery(document).on("click",".tb-search-term-analysis-action-insert",function(e){if(jQuery(this).attr("disabled")=="disabled"){return true}jQuery(this).attr("disabled",true);var t=jQuery(this).attr("data-action");switch(t){case"list":{var i=jQuery(this).attr("data-list-id");if(i){var o=[];jQuery(".tb-search-term-analysis-tag-checkbox").each(function(){if(jQuery(this).is(":checked")&&jQuery(this).hasClass("tb-search-term-analysis-tag-checkbox-hidden")==false){var e=decodeURIComponent(jQuery(this).attr("data-tag-value"));if(e){o.push(e)}}});jQuery(".tb-search-term-analysis-action-insert").html('<div> <span class="tb-spinner"></span></div>');var a={Id:i,Tags:o};var s=TBGlobal.host+TBGlobal.apiUrls.taglistsAddTags;TBExtension.Post(s,JSON.stringify(a),"CRTBSearchTermAnalysisAddTags",null,{contentType:"application/json"})}break}case"clipboard":{jQuery(".tb-search-term-analysis-action-insert").html('<img class="" src="https://www.tubebuddy.com/images/icons/check.png"/>');window.setTimeout(function(){jQuery(".tb-search-term-analysis-action-insert").html("Copy")},1500);jQuery(this).attr("disabled",false);Q();C();break}}});jQuery(document).on("click",".tb-search-term-analysis-action-select .tb-search-term-analysis-action-dropdown-action-option-disabled",function(e){e.stopPropagation()});jQuery(document).on("click",".tb-search-term-analysis-action-select .tb-search-term-analysis-action-dropdown-action-option",function(e){var t=jQuery(this).attr("data-option");var i=jQuery(this).attr("data-list-id");var o=jQuery(this).attr("data-list-name");j(t,i,o);C();e.stopPropagation()});jQuery(document).on("click","#tb-modal-overlay, #tb-search-term-analysis-container",function(e){if(jQuery(".tb-search-term-analysis-action-select").find(".tb-search-term-analysis-action-dropdown").length>0){B()}});jQuery(document).on("click",".tb-search-term-analysis-action-select",function(e){e.stopPropagation();if(jQuery(this).hasClass("tb-search-term-analysis-action-dropdown-action-option")==false){jQuery(".tb-search-term-analysis-action-select").find(".tb-search-term-analysis-action-dropdown").remove();var t=jQuery("#tb-search-term-analysis-action-dropdown-template").html();var i=t.formatTemplate();jQuery(".tb-search-term-analysis-action-select").append(i);var o=TBGlobal.host+TBGlobal.apiUrls.taglistsGetLists;TBExtension.Get(o,"CRTBSearchTermAnalysisGetLists")}});jQuery(document).on("click",".tb-search-term-analysis-action-select .tb-search-term-analysis-action-dropdown-action-option-disabled",function(e){e.stopPropagation()});jQuery(document).on("change",".tb-search-term-analysis-tag-checkbox",function(e){C();k()});jQuery(document).bind("click",function(e){if(jQuery(".tb-search-term-analysis-action-select").find(".tb-search-term-analysis-action-dropdown").length>0){B()}});jQuery(document).on("click",".tb-search-term-analysis-disable-img",function(){if(jQuery("#tb-search-term-analysis-body").is(":visible")===true){jQuery("#tb-search-term-analysis-body").slideUp();jQuery("#tb-search-term-analysis-disabled").show();jQuery("#tb-search-term-analysis-disable").hide();jQuery("#tb-search-term-analysis-enable").show();jQuery(".tb-search-term-analysis-header-carret").attr("title","expand");n=false}else{n=true;jQuery("#tb-search-term-analysis-disabled").hide();jQuery("#tb-search-term-analysis-body").slideDown();jQuery("#tb-search-term-analysis-enable").hide();jQuery("#tb-search-term-analysis-disable").show();jQuery(".tb-search-term-analysis-header-carret").attr("title","minimize")}g(n);if(s===false&&n===true){p(true)}});jQuery(document).on("click",".tb-search-term-analysis-enabled-button",function(){jQuery("#tb-search-term-analysis-disabled").hide();n=true;jQuery("#tb-search-term-analysis-enable").hide();jQuery("#tb-search-term-analysis-disable").show();jQuery(".tb-search-term-analysis-header-carret").attr("title","minimize");g(n);p(true)})};var g=function(e){var t={Enabled:e};TBUtilities.Log(t);var i=TBGlobal.host+TBGlobal.apiUrls.searchTermAnalysisToggle;TBExtension.Post(i,JSON.stringify(t),"",null,{contentType:"application/json"})};var v=function(e){var t=new Object;for(var i=0;i<e.length;i++){jQuery.each(e[i].tags,function(e,i){if(i.trim()!=""){if(t[i]==null)t[i]=1;else t[i]++}})}var a=Object.keys(t).sort(function(e,i){return t[i]-t[e]});var s=0;if(a[0]!=null)jQuery.each(a,function(e,i){if(s===0)s=t[i]});var n=0;var r=0;jQuery("#tb-search-term-analysis-most-used-tags-list").empty();jQuery.each(a,function(i,a){if(a.toLowerCase()===o.toLowerCase()){return true}else if(n===3&&!TBGlobal.CanAccessLevel1Tools()){r++}else{var l=" "+a;var u=t[a];jQuery("#tb-search-term-analysis-most-used-tags-list").append('<div style="font-size:18px; display: flex; align-items:center; justify-content:space-between; max-height:22px; margin:2px 0;"><div style="display:flex; align-items:center;"><i class="tb-search-term-analysis-tag-checkbox-confirm tb-search-term-analysis-tag-checkbox-hidden material-icons tb-font-color-green tb-move-left4 tb-margin-top4 tb-margin-bottom4 tb-margin-right2">check_circle</i><div class="tb-material-checkbox-container tb-move-left5 tb-padding5" style=""><label class="tb-material-checkbox-label"><input data-tag-value='+encodeURIComponent(l.trim())+' class="tb-search-term-analysis-tag-checkbox tb-material-checkbox-input" type="checkbox" /><span class="tb-material-checkbox-box"><span class="tb-check tb-material-checkbox-check"></span></span></label></div><div style="max-width:200px; white-space:nowrap; text-overflow:ellipsis; overflow:hidden;"><a class="tb-search-term-analysis-suggested-tag tb-margin-right5" title="'+l+'">'+l+'</a></div><a target="_blank" href="https://www.youtube.com/results?search_query='+TBUtilities.GetUrlEncoded(l)+'"><i class="material-icons tb-font-size14 tb-move-down3 tb-mat-icon-gray">open_in_new</i></a></div><div style="background-color:#4A90E2; border-radius:2px; display:inline-block; color:white; font-size:12px; font-weight:bold; text-align:right; min-width:25px; height:16px; width:'+parseInt(u)/s*72+"px; opacity:"+parseInt(u)*1.3/s+';"><span style="position:relative; top:-2px; font-size:10px; left:-2px;">'+Math.floor(u/e.length*100).toFixed(0)+"%</span></div></div>");n++}});if(r>0){jQuery("#tb-search-term-analysis-most-used-tags-list").append('<div class="tb-search-term-analysis-upgrade-container"><b> <i class="material-icons tb-font-color-yellow tb-move-down5">lock</i> </b>Only 3 of '+(r+n)+' total results are shown. Upgrade your license to view all results. <div><a target="_blank" class="tb-search-term-analysis-upgrade tb-btn-blue tb-margin-bottom-10 tb-margin-top5">Upgrade Now</a></div></div>');jQuery(".tb-search-term-analysis-upgrade").attr("href",TBGlobal.host+"/account/upgrade?id="+TBGlobal.CurrentChannelId())}jQuery("#tb-search-term-analysis-most-used-tags-container-loading").hide();jQuery("#tb-search-term-analysis-most-used-tags-container").show()};var T=function(e,t){if(!t)t=window.location.href;e=e.replace(/[\[\]]/g,"\\$&");var i=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),o=i.exec(t);if(!o)return null;if(!o[2])return"";return decodeURIComponent(o[2].replace(/\+/g," "))};var j=function(e,t,i){jQuery(".tb-search-term-analysis-action-insert").attr("data-action",e);jQuery(".tb-search-term-analysis-action-insert").removeAttr("data-list-id");w();switch(e){case"clipboard":{jQuery(".tb-search-term-analysis-action-selected").html('<i class="material-icons tb-font-size14 tb-move-down2 tb-font-color-gray tb-mat-icon-gray tb-margin-right5">file_copy</i> Copy to Clipboard');jQuery(".tb-search-term-analysis-action-insert").text("Copy");k();break}case"newlist":{TBUtilities.Prompt("What would you like the list name to be?",null,function(e,t){if(t.length==0){TBUtilities.Alert("Please enter a list name.");return}var i={Name:t};var o=TBGlobal.host+TBGlobal.apiUrls.taglistsAddList;TBExtension.Post(o,JSON.stringify(i),"CRTBTagExplorerAddList",null,{contentType:"application/json"})},null);break}case"list":{jQuery(".tb-search-term-analysis-action-insert").text("Copy");jQuery(".tb-search-term-analysis-action-insert").attr("data-list-id",t);jQuery(".tb-search-term-analysis-action-selected").html('<i class="material-icons tb-font-size14 tb-move-down2 tb-font-color-gray tb-mat-icon-gray tb-margin-right5">view_list</i> Copy to Tag List<div style="font-weight:500; padding-left:19px;">'+TBUtilities.Truncate(i,25,false)+"</div>");break}}B();if(e!="newlist")TBUtilities.CreateCookie("tb-search-term-analysis-action",e+"|"+t+"|"+encodeURIComponent(i),365)};var Q=function(){jQuery(".tb-search-term-analysis-tag-checkbox").each(function(){if(jQuery(this).is(":checked")){jQuery(this).parent().parent().addClass("tb-search-term-analysis-tag-checkbox-hidden");jQuery(this).parent().parent().siblings(".tb-search-term-analysis-tag-checkbox-confirm").removeClass("tb-search-term-analysis-tag-checkbox-hidden")}})};var w=function(){jQuery(".tb-search-term-analysis-tag-checkbox").each(function(){jQuery(this).parent().parent().removeClass("tb-search-term-analysis-tag-checkbox-hidden");jQuery(this).parent().parent().siblings(".tb-search-term-analysis-tag-checkbox-confirm").addClass("tb-search-term-analysis-tag-checkbox-hidden")})};var k=function(){var e=jQuery(".tb-search-term-analysis-action-insert").attr("data-action");if(e=="clipboard"){var t=[];jQuery(".tb-search-term-analysis-tag-checkbox").each(function(e,i){if(jQuery(this).is(":checked")&&jQuery(this).hasClass("tb-search-term-analysis-tag-checkbox-hidden")==false){var o=decodeURIComponent(jQuery(this).attr("data-tag-value"));if(o){t.push(o)}}});var i="";var o=t.length;if(t.length>0){jQuery.each(t,function(e,t){if(e==o-1){i+=t}else{i+=t+", "}})}if(a){a.destroy()}jQuery(".tb-search-term-analysis-action-insert").attr("data-clipboard-text",i);a=new ClipboardJS(".tb-search-term-analysis-action-insert")}else{jQuery(".tb-search-term-analysis-action-insert").removeAttr("data-clipboard-text")}};var B=function(){jQuery(".tb-search-term-analysis-action-select").find(".tb-search-term-analysis-action-dropdown").remove()};var C=function(){var e=0;var t=[];jQuery(".tb-search-term-analysis-tag-checkbox").each(function(){if(jQuery(this).is(":checked")&&jQuery(this).parent().parent().hasClass("tb-search-term-analysis-tag-checkbox-hidden")==false){e++;var i=decodeURIComponent(jQuery(this).attr("data-tag-value"));if(i){t.push(i)}}});jQuery(".tb-search-term-analysis-selected-count").text(e);if(e>0){jQuery(".tb-search-term-analysis-action-insert").attr("disabled",false)}else{jQuery(".tb-search-term-analysis-action-insert").attr("disabled",true)}var i="";var o=t.length;if(t.length>0){jQuery.each(t,function(e,t){if(e==o-1){i+=t}else{i+=t+", "}})}jQuery(".tb-search-term-analysis-action-insert").attr("data-clipboard-text",i);return e};var x=function(){jQuery(document.body).on("CRTBSearchTermAnalysisGetHistorical",function(e,t){jQuery("#tb-search-term-analysis-historical-container-none").hide();jQuery("#tb-search-term-analysis-historical-container").show();jQuery("#tb-search-term-analysis-historical-container-apiquota").hide();try{if(t.success){if(t.response.toLowerCase().indexOf("enough search volume")>0){jQuery("#tb-search-term-analysis-historical-container-none").show();jQuery("#tb-search-term-analysis-historical-container").hide()}else if(t.response.toLowerCase().indexOf("error")>0){jQuery("#tb-search-term-analysis-historical-container-apiquota").show();jQuery("#tb-search-term-analysis-historical-container-none").hide();jQuery("#tb-search-term-analysis-historical-container").hide()}}else{jQuery("#tb-search-term-analysis-historical-container-none").show();jQuery("#tb-search-term-analysis-historical-container").hide()}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyTagExplorer] CRTBTagExplorerGetHistorical"})}});jQuery(document.body).on("CRTBLoadSearchTermAnalysisTemplate",function(e,t){try{if(t.success){t.response=TBUtilities.FixLocalHtml(DOMPurify.sanitize(t.response,DOMPurifyConfig));jQuery("body").append(t.response);var o=false;if(i&&i==true){o=true}p(o)}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddySearchTermAnalysis] CRTBLoadSearchTermAnalysisTemplate"})}});jQuery(document.body).on("CRTSearchTermAnalysisGetTagScore",function(e,t){try{jQuery("#tb-search-term-analysis-keyword-score-quota").hide();if(t.success){var i=jQuery.parseJSON(t.response);if(i.length>0&&i[0].Score!=null){_tagScore=i[0];S(_tagScore);jQuery(".tb-search-term-analysis-keyword-characters").hide();jQuery(".tb-search-term-analysis-keyword-characters-keyword").text("");if(_tagScore.Tag!==o.toLowerCase()){jQuery(".tb-search-term-analysis-keyword-characters").show();jQuery(".tb-search-term-analysis-keyword-characters-keyword").text(_tagScore.Tag)}}}else{_tagScore=null;if(t.response===430||t.response===429){jQuery("#tb-search-term-analysis-keyword-score-container-loading").hide();jQuery("#tb-search-term-analysis-keyword-score-container").hide();jQuery("#tb-search-term-analysis-keyword-score-container-paid").hide();jQuery("#tb-search-term-analysis-keyword-score-quota").show()}}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddySearchTermAnalysis] CRTSearchTermAnalysisGetTagScore"})}});jQuery(document.body).on("CRTBSearchTermAnalysisGetYouTubeSuggest",function(e,t){try{if(t.success){jQuery("#tb-search-term-analysis-autocomplete-container-loading").hide();var i=t.response.indexOf("[");var a=t.response.indexOf("{");var s=t.response.substring(i,a);s=TBUtilities.ReplaceAll(s,'"',"'");var n=s.match(/'[^']*'/g);var r=[];var l=0;var u=0;jQuery("#tb-search-term-analysis-autocomplete-container").empty();jQuery("#tb-search-term-analysis-autocomplete-container").show();jQuery.each(n,function(e,t){t=TBUtilities.ReplaceAll(t,"'","").trim();t=TBUtilities.ReplaceAll(t,"\\u0027","'").trim();t=TBUtilities.ReplaceAll(t,"'","'").trim();var i=TBUtilities.GetInArray(r,null,t);if(i==null){r.push(t);if(t.toLowerCase()==o.toLowerCase()){return true}if(l==3&&!TBGlobal.CanAccessLevel1Tools()){u++}else{jQuery("#tb-search-term-analysis-autocomplete-container").append('<div style="display:flex; align-items:center; max-height:24px"><i class="tb-search-term-analysis-tag-checkbox-confirm tb-search-term-analysis-tag-checkbox-hidden material-icons tb-font-color-green tb-move-left4 tb-margin-top4 tb-margin-bottom4 tb-margin-right2">check_circle</i><div class="tb-material-checkbox-container tb-move-left5 tb-padding5"><label class="tb-material-checkbox-label"><input data-tag-value='+encodeURIComponent(t.trim())+' class="tb-search-term-analysis-tag-checkbox tb-material-checkbox-input" type="checkbox" /><span class="tb-material-checkbox-box"><span class="tb-check tb-material-checkbox-check"></span></span></label></div><div style="max-width:300px; white-space:nowrap; text-overflow:ellipsis; overflow:hidden;"><a class="tb-search-term-analysis-suggested-tag tb-margin-right5" style="cursor:pointer" title="'+TBUtilities.GetHtmlEncoded(t)+'">'+TBUtilities.GetHtmlEncoded(t)+'</a></div><a target="_blank" href="https://www.youtube.com/results?search_query='+TBUtilities.GetUrlEncoded(t)+'"><i class="material-icons tb-font-size14 tb-move-down3 tb-mat-icon-gray">open_in_new</i></a></div>');l++}}});if(u>0){jQuery("#tb-search-term-analysis-autocomplete-container").append('<div class="tb-search-term-analysis-upgrade-container"><b> <i class="material-icons tb-font-color-yellow tb-move-down5">lock</i> </b>Only 3 of '+(u+l)+' total results are shown. Upgrade your license to view all results. <div><a target="_blank" class="tb-search-term-analysis-upgrade tb-btn-blue tb-margin-bottom-10 tb-margin-top5">Upgrade Now</a></div></div>');jQuery(".tb-search-term-analysis-upgrade").attr("href",TBGlobal.host+"/account/upgrade?id="+TBGlobal.CurrentChannelId())}if(r.length===1)jQuery("#tb-search-term-analysis-autocomplete-container").append('<span class="tb-margin-top5 tb-margin-bottom5" style="color:#999; font-size:15px; position:relative;">(YouTube has no suggestions)</span>')}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyTagExplorer] CRTBTagExplorerGetYouTubeSuggest"})}});jQuery(document.body).on("CRTBSearchTermAnalysisAddTags",function(e,t){try{if(t.success){jQuery(".tb-search-term-analysis-action-insert").html('<img class="" src="https://www.tubebuddy.com/images/icons/check.png"/>');window.setTimeout(function(){jQuery(".tb-search-term-analysis-action-insert").html("Copy")},2e3);Q();C()}else{TBUtilities.Alert("There was an error copying tag(s) to your list.  Please make sure the list is still active and try again.")}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyTagLists] CRTBTagListAdd"})}});jQuery(document.body).on("CRTBSearchTermAnalysisAddList",function(e,t){try{if(t.success){var i=jQuery.parseJSON(t.response);j("list",i.Id,i.Name)}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyTagLists] CRTBTagListAdd"})}});jQuery(document.body).on("CRTBSearchTermAnalysisGetLists",function(e,t){try{if(t.success){jQuery(".tb-search-term-analysis-lists-container").empty();var i=jQuery.parseJSON(t.response);if(i.length==0){jQuery(".tb-search-term-analysis-lists-container").append('<span class="tb-margin-left10">You don\'t have any tag lists</span>')}else{var o="";jQuery.each(i,function(e,t){o+='<div class="tb-search-term-analysis-action-dropdown-action-option" data-option="list" data-list-id="'+t.Id+'" data-list-name="'+t.Name+'" style="margin-left: 5px; margin-bottom:4px; margin-top:2px; padding:3px 4px 1px 14px; font-size: 13px;font-weight: normal;vertical-align: middle; line-height:18px;"><i class="material-icons tb-font-size14 tb-move-left5 tb-font-color-gray tb-mat-icon-gray">view_list</i><span title="'+t.Name+'" style="position:relative; top:-3px;">'+TBUtilities.Truncate(t.Name,25,true)+"</span></div>"});jQuery(".tb-search-term-analysis-lists-container").append(o)}}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyTagExplorer] CRTBTagExplorerGetLists"})}})};var S=function(e){Highcharts.SVGRenderer.prototype.symbols.leftarrow=function(e,t,i,o){return["M",19,t-4,"l",-8,8,8,8,"V",7,"z"]};if(Highcharts.VMLRenderer){Highcharts.VMLRenderer.prototype.symbols.leftarrow=Highcharts.SVGRenderer.prototype.symbols.leftarrow}var t;if(e.SearchVolume<=20){t="Poor"}else if(e.SearchVolume<=40){t="Fair"}else if(e.SearchVolume<=60){t="Good"}else if(e.SearchVolume<=80){t="Very Good"}else{t="Excellent"}jQuery("#tb-search-term-analysis-search-volume-chart-label").text(t);if(jQuery("#tb-search-term-analysis-search-volume-chart").highcharts()){jQuery("#tb-search-term-analysis-search-volume-chart").highcharts().destroy()}jQuery("#tb-search-term-analysis-search-volume-chart").highcharts({chart:{inverted:true,type:"scatter",margin:[4,4,4,4]},title:{text:null},tooltip:{enabled:false},credits:{enabled:false},yAxis:{gridLineColor:"transparent",min:0,max:100,opposite:true,labels:{enabled:false},title:{text:null},plotBands:[{from:0,to:20,color:u[0]},{from:20,to:40,color:u[1]},{from:40,to:60,color:u[2]},{from:60,to:80,color:u[3]},{from:80,to:100,color:u[4]}]},xAxis:{labels:{enabled:false},tickLength:0,min:0,max:1,lineWidth:0,minorGridLineWidth:0,lineColor:"transparent",minorTickLength:0,tickLength:0},series:[{data:[e.SearchVolume],animation:true,showInLegend:false,color:"#000000",dataLabels:{enabled:false,style:{color:"black"}},marker:{symbol:"leftarrow"},states:{hover:{enabled:false}}}]});var i;if(e.Competition<=20){i="Excellent"}else if(e.Competition<=40){i="Very Good"}else if(e.Competition<=60){i="Good"}else if(e.Competition<=80){i="Fair"}else{i="Poor"}jQuery("#tb-search-term-analysis-difficulty-chart-label").text(i);var o=100-e.Competition;if(jQuery("#tb-search-term-analysis-difficulty-chart").highcharts()){jQuery("#tb-search-term-analysis-difficulty-chart").highcharts().destroy()}jQuery("#tb-search-term-analysis-difficulty-chart").highcharts({chart:{inverted:true,type:"scatter",margin:[4,4,4,4]},title:{text:null},tooltip:{enabled:false},credits:{enabled:false},yAxis:{gridLineColor:"transparent",min:0,max:100,opposite:true,labels:{enabled:false},title:{text:null},plotBands:[{from:0,to:20,color:u[0]},{from:20,to:40,color:u[1]},{from:40,to:60,color:u[2]},{from:60,to:80,color:u[3]},{from:80,to:100,color:u[4]}]},xAxis:{labels:{enabled:false},tickLength:0,min:0,max:1,minorGridLineWidth:0,lineColor:"transparent",minorTickLength:0,tickLength:0,reversed:true},series:[{data:[o],animation:true,showInLegend:false,color:"#000000",dataLabels:{enabled:false,style:{color:"black"}},marker:{symbol:"leftarrow"},states:{hover:{enabled:false}}}]});jQuery("#tb-search-term-analysis-total-score-description").text(e.ScoreDescription);var a=Math.round(e.Score);jQuery("#tb-search-term-analysis-total-score").text(e.ScoreRating);jQuery("#tb-search-term-analysis-total-score-number").text(a+"/100");if(e.Score<=20){jQuery("#tb-search-term-analysis-total-score").css("color",u[0])}else if(e.Score<=40){jQuery("#tb-search-term-analysis-total-score").css("color",u[1])}else if(e.Score<=60){jQuery("#tb-search-term-analysis-total-score").css("color",u[2])}else if(e.Score<=80){jQuery("#tb-search-term-analysis-total-score").css("color",u[3])}else{jQuery("#tb-search-term-analysis-total-score").css("color",u[4])}var s=["#0D0D0D","#8e8e8e"];if(jQuery("#tb-search-term-analysis-overall-score-chart").highcharts()){var n=jQuery("#tb-search-term-analysis-overall-score-chart").highcharts();n.series[0].data[0].update(a)}else{jQuery("#tb-search-term-analysis-overall-score-chart").highcharts({chart:{renderTo:"tb-search-term-analysis-overall-score-chart",type:"gauge",backgroundColor:"none",margin:[0,0,0,0]},tooltip:{enabled:false},colors:[s[0],s[1]],credits:{enabled:false},title:{text:"",style:{fontFamily:"arial,helvetica,sans-serif",color:s[1],fontWeight:"bold",fontSize:"24px"}},legend:{enabled:false},pane:[{startAngle:-90,endAngle:90,background:null,size:"150%",center:["50%","90%"]}],yAxis:[{min:0,max:100,lineColor:"transparent",tickWidth:2,tickLength:12,tickColor:"transparent",minorTickColor:"transparent",labels:{enabled:false},plotBands:[{from:0,to:20,color:u[0],innerRadius:"50%",outerRadius:"100%"},{from:20,to:40,color:u[1],innerRadius:"50%",outerRadius:"100%"},{from:40,to:60,color:u[2],innerRadius:"50%",outerRadius:"100%"},{from:60,to:80,color:u[3],innerRadius:"50%",outerRadius:"100%"},{from:80,to:100,color:u[4],innerRadius:"50%",outerRadius:"100%"}],pane:0}],plotOptions:{gauge:{dial:{radius:"100%",baseWidth:8,baseLength:3,rearLength:0,labels:{enabled:false}},pivot:{radius:3,backgroundColor:s[1]},showInLegend:false}},series:[{name:"Rank",data:[a],dial:{backgroundColor:s[0]},yAxis:0,dataLabels:{enabled:false,x:0,y:0,color:s[0],borderWidth:0,borderRadius:7,backgroundColor:"#ffffff",padding:1,style:{fontSize:"20px",fontWeight:"bold",lineHeight:"40px"}},states:{hover:{enabled:false}}}]})}jQuery("#tb-search-term-analysis-keyword-score-container-loading").hide();jQuery("#tb-search-term-analysis-keyword-score-container").show();jQuery("#tb-search-term-analysis-keyword-score-container-paid").show();if(e.Volume&&e.Volume!=null){jQuery(".tb-search-term-analysis-search-amount-container").show();if(TBExtension.GetType()==="firefox")jQuery(".tb-search-term-analysis-tab-single").parent().css("top","-4px");jQuery(".tb-search-term-analysis-search-amount").html(TBUtilities.FormatNumberAbbreviated(e.Volume))}else{jQuery(".tb-search-term-analysis-search-amount-container").hide();jQuery(".tb-search-term-analysis-search-amount").html("");if(TBExtension.GetType()==="firefox")jQuery(".tb-search-term-analysis-tab-single").parent().css("top","-3px")}};var L=function(e){var t={lowestviews:0,highestviews:0,avgviews:0,topchannel:"na",ownedvideos:0,lowestsubs:0,highestsubs:0,avgsubs:0,newvideos:0,totalvideos:0,searchtermintitle:0,searchtermindesc:0,searchtermintags:0};try{if(e&&e.length>0){t.totalvideos=e.length;var i=e.sort(function(e,t){return parseFloat(e.views)-parseFloat(t.views)});for(a=0;a<i.length;a++){if(i[a].views){t.lowestviews=i[a].views;break}}for(var a=i.length;a--;){if(i[a].views){t.highestviews=i[a].views;break}}var s=0;var n=new Date;jQuery.each(e,function(){try{s+=this.views;if(TBGlobal.CurrentChannelId()==this.channelid){t.ownedvideos++}if(this.publishDate){var e=Math.floor((n-this.publishDate)/864e5);if(e<=7){t.newvideos++}}if(this.title&&this.title.toLowerCase().indexOf(o.toLowerCase())!=-1){t.searchtermintitle++}if(this.description&&this.description.toLowerCase().indexOf(o.toLowerCase())!=-1){t.searchtermindesc++}if(this.tags&&this.tags.length>0){var i=o.toLowerCase();for(a=0;a<this.tags.length;a++){if(this.tags[a].toLowerCase()==i){t.searchtermintags++;break}}}}catch(e){TBUtilities.LogError(e)}});t.avgviews=(s/e.length).toFixed(0);var r=new Object;for(a=0;a<e.length;a++){if(r[e[a].channelid]==null){r[e[a].channelid]=1}else{r[e[a].channelid]++}}var l=Object.keys(r).sort(function(e,t){return r[t]-r[e]});var u=0;jQuery.each(l,function(e,t){if(u==0)u=r[t]});if(l&&l.length>0&&u>1){var d=l[0];var c=e.filter(function(e){return e.channelid==d});t.topchannel=c[0].channelname}var p=e.sort(function(e,t){return parseFloat(e.channelsubscribers)-parseFloat(t.channelsubscribers)});for(a=0;a<p.length;a++){if(p[a].channelsubscribers&&p[a].channelsubscribers!=0){t.lowestsubs=p[a].channelsubscribers;break}}t.highestsubs=p[p.length-1].channelsubscribers}}catch(e){TBUtilities.LogError(e)}return t};var _=function(e,t){jQuery("#tb-search-term-analysis-highestviews").text(TBUtilities.FormatNumberWithCommas(e.highestviews));jQuery("#tb-search-term-analysis-lowestviews").text(TBUtilities.FormatNumberWithCommas(e.lowestviews));jQuery("#tb-search-term-analysis-avgviews").text(TBUtilities.FormatNumberWithCommas(e.avgviews));jQuery("#tb-search-term-analysis-topchannel").text(e.topchannel);jQuery("#tb-search-term-analysis-ownedvideos").text(e.ownedvideos);jQuery("#tb-search-term-analysis-lowestsubs").text(TBUtilities.FormatNumberWithCommas(e.lowestsubs));jQuery("#tb-search-term-analysis-highestsubs").text(TBUtilities.FormatNumberWithCommas(e.highestsubs));jQuery("#tb-search-term-analysis-avgsubs").text(TBUtilities.FormatNumberWithCommas(e.avgsubs));var i=t.find(function(e){return e.publishDate!==null});if(i){jQuery("#tb-search-term-analysis-newvideos").text(TBUtilities.FormatNumberWithCommas(e.newvideos));jQuery("#tb-search-term-analysis-newvideos-row").show()}else{jQuery("#tb-search-term-analysis-newvideos-row").hide()}jQuery("#tb-search-term-analysis-termintitle").text(TBUtilities.FormatNumberWithCommas(e.searchtermintitle));jQuery("#tb-search-term-analysis-termindesc").text(TBUtilities.FormatNumberWithCommas(e.searchtermindesc));jQuery("#tb-search-term-analysis-termintags").text(TBUtilities.FormatNumberWithCommas(e.searchtermintags));jQuery(".tb-search-term-analysis-totalvideos").text(TBUtilities.FormatNumberWithCommas(e.totalvideos));jQuery("#tb-search-term-analysis-keyword-stats-container-loading").hide();jQuery("#tb-search-term-analysis-keyword-stats-table").show()};var I=function(){var t=decodeURI(TBUtilities.GetUrlParameter("search_query"));o=t.replace(/\+/g," ").trim();B();if(!e){n=TBGlobal.Profile().SettingsShowSearchTermAnalysis;e=true;x();f();y()}else{p(true)}};var U=function(){var t=E();if(t===false){if(d){d.remove();d=null;e=false;jQuery("#tb-search-term-analysis-container").remove()}}};var E=function(){var e=false;var t=TBUtilities.GetUrlParameter("search_query");if(t){e=true}return e};return{Initialize:function(e){i=e;TBUtilities.Log("TubeBuddySearchTermAnalysis Initialize");var t=TBGlobal.GetYouTubeUI();if(TBGlobal.IsAuthenticated()&&t==="material"){if(TBExtension.GetType()==="firefox"){window.requestAnimationFrame=window.requestAnimationFrame.bind(window)}I()}else{TBUtilities.Log("TubeBuddySearchTermAnalysis disabled")}if(i===true){U()}},CleanPage:function(){U()}}}();var TubeBuddyFormula=function(){var e=false;var t=function(){};var i=function(){var e=TBGlobal.host+"/ModuleManager/formula/formula?v="+TBGlobal.versionNumber;if(loadLocalHTML&&(TBExtension.GetType()=="chrome"||TBExtension.GetType()=="firefox")){e=chrome.extension.getURL("modules/formula.html")}else if(loadLocalHTML&&TBExtension.GetType()=="safari"){e="modules/formula.html"}TBExtension.Get(e,"CRTBLoadFormulaTemplate")};var o=function(e){var t='<div class="tb-formula-item">'+e+"</div>";jQuery(".tb-formula").append(t);var i=jQuery(".tb-formula").first().text();TBUtilities.Log(i);i=TBUtilities.ReplaceAll(i,"Video Views","1123");i=TBUtilities.ReplaceAll(i,"Video Comments","55");i=TBUtilities.ReplaceAll(i,"Video Likes","122");i=TBUtilities.ReplaceAll(i,"Video Dislikes","10");i=TBUtilities.ReplaceAll(i,"Days Published","10");i=TBUtilities.ReplaceAll(i,"Hours Published","10");i=TBUtilities.ReplaceAll(i,"Channel Views","10");i=TBUtilities.ReplaceAll(i,"Channel Subscribers","10");i=TBUtilities.ReplaceAll(i,"Channel Uploads","10");i=TBUtilities.ReplaceAll(i,"Ã·","/");i=TBUtilities.ReplaceAll(i,"Ã—","*");TBUtilities.Log(i);try{var o=math.eval(i);if(jQuery('input[name="tb-number-type"]:checked').attr("number-type")=="percent"){var a=parseFloat(o*100).toFixed(2);jQuery("#tb-result").text(a+"%")}else{jQuery("#tb-result").text(o)}}catch(e){jQuery("#tb-result").text("Not a valid equation ("+e+")")}};var a=function(){jQuery(document).on("click",".tb-operator",function(){var e=jQuery(this).attr("data-operator-text");o(e)});jQuery(document).on("dblclick",".tb-formula-item",function(){jQuery(this).remove()})};var s=function(){jQuery(document.body).on("CRTBLoadFormulaTemplate",function(e,i){try{if(i.success){i.response=TBUtilities.FixLocalHtml(i.response);jQuery("body").append(i.response);t()}else{}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyFormula] CRTBLoadFormulaTemplate"})}})};return{Initialize:function(){if(TBGlobal.IsAuthenticated()){if(!e){s();i();a();e=true}else{t()}}}}}();var TubeBuddyMagicLinks=function(){var e=false;var t=false;var i=function(){jQuery(".video-settings-description").after(jQuery(".tb-trigger-magic-links")[0].outerHTML)};var o=function(){var e=TBGlobal.host+"/ModuleManager/magiclinks/magiclinks?v="+TBGlobal.versionNumber;if(loadLocalHTML&&(TBExtension.GetType()=="chrome"||TBExtension.GetType()=="firefox")){e=chrome.extension.getURL("modules/magiclinks.html")}else if(loadLocalHTML&&TBExtension.GetType()=="safari"){e="modules/magiclinks.html"}TBExtension.Get(e,"CRTBLoadTubeBuddyMagicLinksTemplate")};var a=function(){jQuery(document).on("click",".tb-magic-links-closex",function(){jQuery("#tb-magic-links-container").hide();TubeBuddyMenu.HideBackground()});jQuery(document).on("click",".tb-copy-magic-link",function(){var e=jQuery(this).attr("data-copy-text");var t=document.createElement("textarea");document.body.appendChild(t);t.value=e;t.focus();t.select();document.execCommand("Copy");t.remove();jQuery(this).find(".fa-check").show().fadeOut(1e3)});jQuery(document).on("click","#tb-magic-links-create",function(){var e=jQuery("#tb-magic-links-url").val();var t=TBGlobal.host+TBGlobal.apiUrls.magiclinksCreateLink+"?url="+e;TBExtension.Get(t,"CRTBMagicLinksCreateLink");jQuery("#tb-magic-links-creating").show();jQuery("#tb-magic-links-create").attr("disabled","disabled");jQuery("#tb-magic-link-product-name").text("")});jQuery(document).on("keypress","#tb-magic-links-url",function(e){TBUtilities.Log("clicked");var t=e.which;if(t==13){TBUtilities.Log("clicked 2");$("#tb-magic-links-create").trigger("click");return false}});jQuery(document).on("click",".tb-trigger-magic-links",function(){TubeBuddyMenu.ShowBackgroundSticky();if(TBGlobal.Profile().IsLoggedIn){s()}else{jQuery("#tb-site-login-dialog").show()}})};var s=function(){jQuery("#tb-magic-links-container").show();if(jQuery("#tb-magic-links-recent-loading").is(":visible")){var e=TBGlobal.host+TBGlobal.apiUrls.magiclinksGetRecent;TBExtension.Get(e,"CRTBMagicLinksGetRecent")}};var n=function(){jQuery(document.body).on("CRTBMagicLinksCreateLink",function(e,i){try{if(i.success){jQuery("#tb-magic-links-creating").hide();jQuery("#tb-magic-links-create").removeAttr("disabled");var o=JSON.parse(i.response);if(o.link==null){jQuery("#tb-magic-links-created").hide();jQuery("#tb-magic-links-failed").show();jQuery("#tb-magic-links-created-no-affiliate").hide()}else{jQuery("#tb-magic-links-failed").hide();if(!o.aff){jQuery("#tb-magic-links-created-no-affiliate").show()}else{jQuery("#tb-magic-links-created-no-affiliate").hide()}jQuery("#tb-magic-links-url").val("");jQuery("#tb-magic-links-created-copy").attr("data-copy-text",o.link);jQuery("#tb-magic-links-created-link").attr("href",o.link);jQuery("#tb-magic-links-created-link").text(o.link);jQuery("#tb-magic-links-created").show();t=true;var a=TBGlobal.host+TBGlobal.apiUrls.magiclinksGetRecent;TBExtension.Get(a,"CRTBMagicLinksGetRecent")}}}catch(e){}});jQuery(document.body).on("CRTBMagicLinksGetRecent",function(e,i){try{if(i.success){jQuery("#tb-magic-links-recent-loading").hide();var o=JSON.parse(i.response);jQuery("#tb-magic-links-recent-list").html("");if(o.links.length>0){jQuery("#tb-magic-link-product-name").text(o.links[0].productName);jQuery.each(o.links,function(e,t){var i='<div class="tb-copy-magic-link-outer"><a class="tb-copy-magic-link tb-btn-white" data-copy-text="'+t.link+'"><i class="small material-icons">copy</i> Copy<i class="small material-icons" style="color:green; display:none; position:absolute; top:0px; right:-1px">check</i></a><div class="tb-ml-list-result"> <a href="'+t.link+'" target="_blank">'+t.link+'</a>  <span class="tb-magic-links-copy-success" style="color:green; display:none">Copied!</span>';if(!t.productName)t.productName="<span style='font-size:.8em;'> </span>";i+='<div class="tb-ml-item-title">'+t.productName+"</div></div></div>";jQuery("#tb-magic-links-recent-list").append(i)})}else{jQuery("#tb-magic-links-recent-list").html("<div>No recent links found on your account.</div>")}if(t){TBUtilities.Log("FIRST TIME");t=false;setTimeout(function(){var e=TBGlobal.host+TBGlobal.apiUrls.magiclinksGetRecent;TBExtension.Get(e,"CRTBMagicLinksGetRecent")},1e3)}}else{jQuery("#tb-magic-links-recent-list").html("<div>There was an error loading your info.</div>");jQuery("#tb-magic-links-recent-loading").hide()}}catch(e){}});jQuery(document.body).on("CRTBLoadTubeBuddyMagicLinksTemplate",function(e,t){try{if(t.success){t.response=TBUtilities.FixLocalHtml(DOMPurify.sanitize(t.response,DOMPurifyConfig));jQuery("body").append(t.response);jQuery(".tb-trigger-magic-links:first").show();i()}else{}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyTubeBuddyMagicLinks] CRTBLoadTubeBuddyMagicLinksTemplate"})}})};return{Initialize:function(){if(!TBGlobal.Profile().IsLoggedIn||!TBGlobal.Profile().HasMagicLinksIntegration)return;if(TBGlobal.IsAuthenticated()){if(!e){n();o();a();e=true}else{i()}}},Show:function(){s()}}}();var TubeBuddyVideosStudioList=function(){var e=false;var t="";var i=false;var o="";var a="";var s=false;var n=false;var r=false;var l=null;var u=null;var d=null;var c=function(){var e=TBGlobal.host+"/ModuleManager/videosliststudio?v="+TBGlobal.versionNumber;if(loadLocalHTML&&(TBExtension.GetType()=="chrome"||TBExtension.GetType()=="firefox")){e=chrome.extension.getURL("modules/videosliststudio.html")}else if(loadLocalHTML&&TBExtension.GetType()=="safari"){e="modules/videosliststudio.html"}TBUtilities.Log("loadHtml");TBExtension.Get(e,"CRTBLoadVideosListStudioTemplate")};var p=function(){var e=jQuery("#tb-videos-new-tab-template").html();jQuery(".edit-expand-menu-button").find('li[role="menuitem"]').find("span").each(function(t){var i=jQuery(this).attr("href");if(i){jQuery(this).removeAttr("onclick");jQuery(this).removeAttr("href");jQuery(this).attr("data-href",i);jQuery(this).addClass("tb-edit-menu-button");var o=e.formatTemplate(i);jQuery(this).html(jQuery(this).html()+o)}})};var b=function(){TBUtilities.Log("checkForVideosLoaded");var e=jQuery("#table-header").length;if(jQuery("paper-dialog.ytcp-uploads-dialog").length>0)TubeBuddyUploadStudio.LoadTubeBuddyTools();if(e!=null&&e>0){clearInterval(l);c();return}};var h=function(e){t=e;var i=TBGlobal.host+TBGlobal.apiUrls.youTubeVideosGetVideoStatus+"?videoId="+e;TBExtension.Get(i,"CRTBVideoListLoadVideoStatus",{videoId:e})};var m=function(e){try{if(e){jQuery('[data-video-container-id="'+t+'"]').find(".tb-videos-list-card-count").text("("+e.feature_templates.length+")")}else{jQuery("[data-video-container-id="+t+"]").find(".tb-videos-list-card-count").text("(0)")}}catch(e){}};var f=function(e){if(e){jQuery(".tb-video-list-studio-video-overview:visible").remove()}else{jQuery(".tb-video-list-studio-video-overview").hide();jQuery(".tb-videos-bulk-dropdown-template").addClass("tb-hid")}};var y=function(e){jQuery(".tb-video-list-playlists-container").html('<span class="tb-spinner"></span> Loading Playlists...');TBExtension.Get("https://www.youtube.com/edit?o=U&video_id="+e,"CRTBLoadVideosListEditPage",{videoId:e})};var g=function(){var e=jQuery("#vm-myvideos-search-box").val().indexOf("video_id:")>-1;if(!e&&o){jQuery("#vm-myvideos-search-box").val((jQuery("#vm-myvideos-search-box").val()+" video_id:{"+o+"}").trim());var t=new Event("change");jQuery("#vm-myvideos-search-box")[0].dispatchEvent(t)}};var v=function(){jQuery(document).on("click",".tb-edit-menu-button",function(e){var t=jQuery(this).attr("data-href");if(t){window.location.href=t}});jQuery(document).on("click",".tb-videoslist-tab-notes-tab",function(e){var t=jQuery(this).attr("data-id");if(jQuery("[data-notes-loaded-id="+t+"]").length>0)return;jQuery(".tb-videoslist-notes-loaded").hide();jQuery(".tb-videoslist-notes-loading").show();if(TBExtension.GetType()!="firefox"){jQuery("[data-notes-id="+t+"]").wysiwyg({controls:{subscript:{visible:false},superscript:{visible:false},undo:{visible:false},redo:{visible:false},insertHorizontalRule:{visible:false},createLink:{visible:false},unLink:{visible:false},insertImage:{visible:false},h1:{visible:false},h2:{visible:false},h3:{visible:false},html:{visible:false},removeFormat:{visible:false},insertTable:{visible:false},code:{visible:false}},iFrameClass:"tb-videoslist-generator-editor",css:"https://www.tubebuddy.com/assets/js/jquery-emoji-picker/tb.css"});jQuery("[data-notes-id="+t+"]").wysiwyg("clear")}else{jQuery("[data-notes-id="+t+"]").val("")}var i=TBGlobal.host+TBGlobal.apiUrls.youTubeVideosGetUserNotes+"/?videoId="+t;TBExtension.Get(i,"CRVideosListGetUserNotes",{videoid:t})});jQuery(document).on("mouseenter",".tb-edit-menu-button",function(e){var t=jQuery(this).find(".tb-videos-new-tab-button img");if(t&&t.length>=1){var i=TBGlobal.host+"/images/icons/external-white-small.png";t.attr("src",i)}});jQuery(document).on("mouseleave",".tb-edit-menu-button",function(e){var t=this;var i=jQuery(t).find(".tb-videos-new-tab-button img");if(i&&i.length>=1){var o=TBGlobal.host+"/images/icons/external.png";i.attr("src",o)}});jQuery(document).on("click",".tb-videos-new-tab-button",function(e){e.stopPropagation();var t=jQuery(this).attr("href");if(t){if(TBExtension.GetType()=="firefox"){var i=window.open(t,"_blank")}else{var i=window.open("about:blank","_blank");i.location=t}}return false});jQuery(document).on("click",".tb-video-list-menu-item-url",function(e){e.preventDefault();e.stopPropagation();var t=jQuery(this).find(".tb-videos-list-tool").attr("data-url");if(t){if(TBExtension.GetType()=="firefox"){var i=window.open(t,"_blank")}else{var i=window.open("about:blank","_blank");i.location=t}}});jQuery(document).on("click","#main-container",function(){f()});jQuery(document).on("click","#entity-page",function(){f()});jQuery(document).on("click",".tb-videoslist-tab-header",function(){jQuery(this).parent().find(".tb-videoslist-tab-header, .tb-tab-icon-selected").removeClass("selected tb-selected tb-tab-icon-selected");jQuery(this).addClass("selected tb-selected");jQuery(this).find(".tb-tab-icon").addClass("tb-tab-icon-selected");jQuery(this).parent().parent().find(".tb-videoslist-tab-container").hide();jQuery(this).parent().parent().find("#"+jQuery(this).attr("data-tab-id")).show();var e=jQuery(this).attr("data-id");jQuery(this).closest("div").find(".tb-videos-list-info-video-id").val(e);jQuery(this).closest("div").find(".tb-videos-list-info-video-link").val("https://youtu.be/"+e);jQuery(".tb-video-id-copy").attr("data-clipboard-text",e);var t=new ClipboardJS(".tb-video-id-copy");jQuery(".tb-video-link-copy").attr("data-clipboard-text","https://youtu.be/"+e);var i=new ClipboardJS(".tb-video-link-copy");if(jQuery(this).parent().parent().find(".tb-video-list-playlists-container").html().trim().length==0)y(e)});jQuery(document).on("click",".tb-videos-bulk-list-dropdown",function(e){jQuery(".tb-videos-bulk-dropdown-template").removeClass("tb-hid");e.stopPropagation()});jQuery(document).on("click","#tb-videoslist-generate-uploadchecklist",function(e){var t=jQuery(this).attr("data-id");jQuery("#tb-videoslist-generate-uploadchecklist-loading").show();jQuery("#tb-videoslist-generate-uploadchecklist").prop("disabled",true);jQuery("#tb-videoslist-generate-uploadchecklist").attr("disabled","disabled")});jQuery(document).on("click","#tb-videoslist-run-launchpad-checkup",function(e){var t=jQuery(this).attr("data-id");jQuery("#tb-videoslist-run-launchpad-checkup-loading").show();jQuery("#tb-videoslist-run-launchpad-checkup").prop("disabled",true);jQuery("#tb-videoslist-run-launchpad-checkup").attr("disabled","disabled")});jQuery(document).on("click","#tb-videoslist-launchpad-tab-header",function(e){var i=jQuery("[data-video-container-id='"+t+"']");jQuery(i).find(".tb-videoslist-launchpad-loading").show();jQuery(i).find(".tb-videoslist-launchpad-loaded").hide();jQuery(i).find(".tb-videoslist-launchpad-opportunities-nodata").hide();jQuery(i).find(".tb-videoslist-launchpad-opportunities-hasdata").hide();jQuery(i).find(".tb-videoslist-launchpad-checklist-nodata").hide();jQuery(i).find(".tb-videoslist-launchpad-checklist-hasdata").hide();jQuery(i).find(".tb-videoslist-launchpad-bestpractices-nodata").hide();jQuery(i).find(".tb-videoslist-launchpad-bestpractices-hasdata").hide();var o=TBGlobal.host+TBGlobal.apiUrls.launchPadGetVideoSummary+"?videoid="+t;TBExtension.Get(o,"CRTBVideoListGetLaunchPadSummary")});jQuery(document).on("change",".tb-videolist-create-uploadchecklist",function(){jQuery("#tb-videolist-generating-checklist").show();jQuery(".tb-videolist-create-uploadchecklist").hide();var e=TBGlobal.host+TBGlobal.apiUrls.launchPadCreateChecklist+"/"+t;TBExtension.Get(e,"CRTBVideoListCreateChecklist",{videoId:videoId})});jQuery(document).on("change",".tb-videos-list-comment-filters",function(){var e=window.open("https://www.youtube.com/comments?filter="+t+"&tbfilter="+jQuery(this).val(),"_blank");jQuery(this).val("filter")});jQuery(document).on("click",".tb-studio-videos-list-dropdown",function(e){f();var t=jQuery(this).attr("data-id");var i=jQuery(this).attr("data-title");var o=jQuery(this).attr("data-thumbnail");var a=jQuery(this).attr("data-description");var s=jQuery(this).attr("data-views");var n=jQuery(this).attr("data-is-draft");var r=jQuery(this).closest(".tablecell-video").width();if(jQuery(this).find(".tb-video-list-studio-video-overview").length==0){var l=jQuery("#tb-videos-list-dropdown-template").html();var u=l.formatTemplate(t,i,o,a,s,n);jQuery(this).closest("#row-container").before(u);if(jQuery(this).hasClass("tb-studio-videos-list-dropdown--new-hover")){jQuery(".tb-video-list-studio-video-overview").css("margin-top","62px");jQuery(".tb-video-list-studio-video-overview").css("margin-left",jQuery(this).position().left+55+"px")}else{jQuery(".tb-video-list-studio-video-overview").css("margin-top","80px");jQuery(".tb-video-list-studio-video-overview").css("margin-left",r+20+"px")}h(t)}var d=jQuery("[data-video-container-id='"+t+"']");d.show();e.stopPropagation()});jQuery(document).on("click",".tb-video-list-studio-video-overview",function(e){e.stopPropagation()});jQuery(document).on("click",".tb-video-list-dropdown-promote",function(){var e=jQuery(this).attr("data-title");var t=jQuery(this).attr("data-thumbnail");var i=jQuery(this).attr("data-id");TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyV2VPromote.Show(i,e,t);f(true)});jQuery(document).on("click",".tb-video-list-dropdown-twitter",function(){var e=jQuery(this).attr("data-title");var t=jQuery(this).attr("data-thumbnail");var i=jQuery(this).attr("data-id");TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyTwitterPost.Show(i,e,t);f(true)});jQuery(document).on("click",".tb-video-list-dropdown-ab-test",function(){var e=jQuery(this).attr("data-id");var t=jQuery(this).attr("data-title");var i=jQuery(this).attr("data-thumbnail");var o=jQuery(this).attr("data-is-draft");var i=o!="true"?encodeURI("https://img.youtube.com/vi/"+e+"/mqdefault.jpg"):encodeURI(i);f(true);window.open(TBGlobal.host+"/channel/abtestcreate/"+TBGlobal.CurrentChannelId()+"?videoid="+e+"&videotitle="+t+"&videothumbnail="+i,"_blank")});jQuery(document).on("click",".tb-video-list-dropdown-twitter-post",function(e){var t=jQuery(this).attr("data-title");var i=jQuery(this).attr("data-thumbnail");var o=jQuery(this).attr("data-id");TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyTwitterPost.Show(o,t,i);f(true)});jQuery(document).on("click",".tb-video-list-dropdown-social-monitor",function(){var e=jQuery(this).attr("data-title");var t=jQuery(this).attr("data-thumbnail");var i=jQuery(this).attr("data-id");TubeBuddyMenu.ShowBackgroundSticky();TubeBuddySocialMonitor.Show(i,e,t);f(true)});jQuery(document).on("click",".tb-video-list-dropdown-transcriptions",function(){var e=jQuery(this).attr("data-title");var t=jQuery(this).attr("data-thumbnail");var i=jQuery(this).attr("data-id");TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyTranscriptions.Show(i,e,t);f(true)});jQuery(document).on("click",".tb-video-list-dropdown-copy-cards",function(){var e=jQuery(this).attr("data-title");var t=jQuery(this).attr("data-thumbnail");var i=jQuery(this).attr("data-id");TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyCards.Show(i,e,t);f(true)});jQuery(document).on("click",".tb-video-list-dropdown-copy-endscreens",function(){var e=jQuery(this).attr("data-title");var t=jQuery(this).attr("data-thumbnail");var i=jQuery(this).attr("data-id");TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyEndScreens.Show(i,e,t);f(true)});jQuery(document).on("click",".tb-video-list-dropdown-embed",function(){var e=jQuery(this).attr("data-title");var t=jQuery(this).attr("data-thumbnail");var i=jQuery(this).attr("data-id");TBUtilities.AddAction({VideoId:i},TBUtilities.ActionTypes.AdvancedVideoEmbedding_Use,"advancedvideoembedding");TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyEmbed.ShowForVideo(i,e,t);f(true)});jQuery(document).on("click",".tb-video-list-dropdown-share-tracker",function(){var e=jQuery(this).attr("data-title");var t=jQuery(this).attr("data-thumbnail");var i=jQuery(this).attr("data-id");TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyShareTracker.ShowForVideo(i,e,t);f(true)});jQuery(document).on("click",".tb-video-list-dropdown-search-ranking",function(){var e=jQuery(this).attr("data-title");var t=jQuery(this).attr("data-thumbnail");var i=jQuery(this).attr("data-id");TubeBuddyMenu.ShowBackgroundSticky();TubeBuddySearchRanking.Show(i,t,e);f(true)});jQuery(document).on("click",".tb-video-list-dropdown-find-and-replace",function(){TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyFindAndReplace.Show();f(true)});jQuery(document).on("click",".tb-video-list-dropdown-bulk-thumbnail",function(){TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyBulkThumbnail.Show();f(true)});jQuery(document).on("click",".tb-video-list-dropdown-delete-cards",function(){TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyCards.ShowDelete();f(true)});jQuery(document).on("click",".tb-video-list-dropdown-bulkcopy-cards",function(){TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyBulkCopySelect.Show("TubeBuddyCards");f(true)});jQuery(document).on("click",".tb-video-list-dropdown-bulkcopy-endscreens",function(){TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyBulkCopySelect.Show("tubebuddyendscreens");f(true)});jQuery(document).on("click",".tb-video-list-dropdown-bulkupdate-endscreens",function(){TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyEndScreenUpdate.Show();f(true)});jQuery(document).on("click",".tb-video-list-dropdown-bulkupdate-endscreens",function(){TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyEndScreenUpdate.Show();f(true)});jQuery(document).on("click",".tb-video-list-dropdown-bulkdelete-endscreens",function(){TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyEndScreens.ShowDelete();f(true)});jQuery(document).on("click",".tb-video-list-dropdown-thumbnail-creator",function(){var e=jQuery(this).attr("data-title");var t=jQuery(this).attr("data-thumbnail");var i=jQuery(this).attr("data-id");var o=jQuery(this).attr("data-description");var a=jQuery(this).attr("data-views");TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyThumbnailCreator.Show(i,e,t,o,a);f(true)});jQuery(document).on("click",".tb-video-list-dropdown-gif-generator",function(){var e=jQuery(this).attr("data-title");var t=jQuery(this).attr("data-thumbnail");var i=jQuery(this).attr("data-id");TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyGifGenerator.Show(i,e,t);f(true)});jQuery(document).on("click",".vm-search-container, #vm-search-container",function(e){if(!i&&s){i=true;TBExtension.Get("https://www.youtube.com/view_all_playlists?sf=name&vmo=title_asc&sa=0","CRTBVideosListGetPlaylists")}});jQuery(document).on("click",".tb-video-list-dropdown-pick-a-winner",function(){var e=jQuery(this).attr("data-title");var t=jQuery(this).attr("data-thumbnail");var i=jQuery(this).attr("data-id");TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyPickAWinner.Show(i,t,e);f(true)});jQuery(document).on("click",".tb-video-list-dropdown-export-comments",function(){var e=jQuery(this).attr("data-id");TBUtilities.Confirm("Are you sure you want to export all comments (1,000 max) from this video to a CSV file?\n\nThis process can take up to 2 MINUTES to complete based on how many comments you have (so be patient).",function(){if(!TBGlobal.CanAccessLevel3Tools()){TBGlobal.ShowUpgradePage("export video comments",TBGlobal.limitation.exportComments);return false}var t=TBGlobal.host+"/youtubechannel/ExportVideoComments?channelId="+TBGlobal.CurrentChannelId()+"&videoId="+e;var i=window.open(t,"_blank");i.focus()},null)});jQuery(document).on("click",".tb-video-list-dropdown-export-to-facebook",function(){var e=jQuery(this).attr("data-title");var t=jQuery(this).attr("data-thumbnail");var i=jQuery(this).attr("data-id");TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyCopyToFacebook.Show(i,t,e);f(true)});jQuery(document).on("click",".tb-video-list-dropdown-sunset-video",function(){var e=jQuery(this).attr("data-id");var t=jQuery(this).attr("data-thumbnail");var i=jQuery(this).attr("data-title");TubeBuddyMenu.ShowBackgroundSticky();TubeBuddySunsetVideo.Show(e,i,t);f(true)});jQuery(document).on("click",".tb-video-list-dropdown-golive-video",function(){var e=jQuery(this).attr("data-id");var t=jQuery(this).attr("data-thumbnail");var i=jQuery(this).attr("data-title");TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyGoLiveVideo.Show(e,i,t);f(true)});jQuery(document).on("click",".tb-video-list-dropdown-video-updated-video",function(){var e=jQuery(this).attr("data-id");var t=jQuery(this).attr("data-thumbnail");var i=jQuery(this).attr("data-title");TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyScheduledMetaUpdates.Show(e,i,t);f(true)});jQuery(document).on("change",".tb-videoslist-playlists-select",function(){var e=jQuery(this).val();if(e!="select"&&!jQuery(this).attr("data-video-id-list")){jQuery(".tb-videoslist-playlist-loading").show();a=e;TBExtension.Get("https://www.youtube.com/playlist?list="+e,"CRTBVideosListGetPlaylist")}else{a="";o=""}});jQuery(document).on("mouseenter","#row-container",function(){var e=this;jQuery(e).find(".view-on-youtube-link").css("visibility","visible");jQuery(e).find("ytcp-icon-button").css("visibility","visible");jQuery(e).find("paper-icon-button").css("visibility","visible");jQuery(e).addClass("row-highlighted")});jQuery(document).on("mouseleave","#row-container",function(){var e=this;jQuery(e).find(".view-on-youtube-link").css("visibility","hidden");jQuery(e).find("ytcp-icon-button").css("visibility","hidden");jQuery(e).find("paper-icon-button").css("visibility","hidden");jQuery(e).removeClass("row-highlighted")});jQuery(document).on("mouseleave",".tb-video-list-studio-video-overview",function(e){if(jQuery(".tb-video-list-studio-video-overview").has(e.target).length>0&&!e.relatedTarget){e.stopPropagation();return}f(true)});jQuery(document).on("click",".tb-video-list-cards-update",function(){TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyCardsUpdate.Show()});jQuery(document).on("click",".tb-backup-backup-button",function(){TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyBackup.Show()});jQuery(document).on("click",".tb-bulk-menu-item-ctr",function(){TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyCTRCenter.Show()});jQuery(document).on("click",".tb-bulk-menu-item-demonetization-double-check",function(){TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyDemonetizationChecker.Show()});jQuery(document).on("click",".tb-bulk-menu-item-kids-center",function(){TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyKidsCenter.Show()});jQuery(document).on("mousedown","#submit-search-button",function(e){g()});jQuery(document).on("keydown","#advanced-search-dropdown input",function(e){var t=e.charCode?e.charCode:e.keyCode?e.keyCode:0;if(t==13){g()}});jQuery(document).on("click",".tb-videoslist-save-notes",function(){var e=jQuery(this).attr("data-id");var t=TBExtension.GetType()=="firefox"?jQuery("[data-notes-id="+e+"]").val():jQuery("[data-notes-id="+e+"]").wysiwyg("getContent");var i=jQuery.param({Id:e,UserNotes:t});var o=TBGlobal.host+TBGlobal.apiUrls.youTubeVideosSaveUserNotes;TBExtension.Post(o,i,"CRVideosListSaveUserNotes",null,{contentType:"application/x-www-form-urlencoded; charset=UTF-8"})});jQuery(document).on("click",".tb-bulk-menu-item-annotation-audit",function(){TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyAnnotationAudit.Show()});jQuery(document).on("click",".tb-video-list-dropdown-apply-card-templates",function(){var e=jQuery(this).attr("data-id");var t=jQuery(this).attr("data-thumbnail");var i=jQuery(this).attr("data-title");TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyCardTemplates.Show(e,i,t);f(true)});jQuery(document).on("click",".tb-video-list-dropdown-apply-endscreen-templates",function(){var e=jQuery(this).attr("data-id");var t=jQuery(this).attr("data-thumbnail");var i=jQuery(this).attr("data-title");TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyEndScreenTemplates.Show(e,i,t);f(true)});jQuery(document).on("click",".tb-video-id-copy",function(){jQuery(".tb-video-id-copy").text("Copied");window.setTimeout(function(){jQuery(".tb-video-id-copy").text("Copy")},1500)});jQuery(document).on("click",".tb-video-link-copy",function(){jQuery(".tb-video-link-copy").text("Copied");window.setTimeout(function(){jQuery(".tb-video-link-copy").text("Copy")},1500)});jQuery(document).on("click",".tb-video-playlist-copy",function(){jQuery(this).text("Copied");window.setTimeout(function(){jQuery(".tb-video-playlist-copy").text("Copy")},1500)});jQuery(document).on("click",".tb-videoslist-tab-header",function(){var e=jQuery(this).attr("data-id");jQuery("#tb-videos-list-quick-link-realtime").attr("href","https://studio.youtube.com/video/"+e+"/analytics/tab-overview/period-since_publish?utm_campaign=upgrade&utm_medium=redirect&utm_source=%2Fanalytics");jQuery("#tb-videos-list-quick-link-watchtime").attr("href","https://studio.youtube.com/video/"+e+"/analytics/tab-interest_viewers/period-since_publish/explore?utm_campaign=upgrade&utm_medium=redirect&utm_source=%2Fanalytics&entity_type=VIDEO&entity_id="+e+"&time_period=since_publish&explore_type=TABLE_AND_CHART&chart_type=LINE_CHART&metric=WATCH_TIME&granularity=DAY&t_metrics[]=VIEWS&t_metrics[]=WATCH_TIME&t_metrics[]=AVERAGE_WATCH_TIME&t_metrics[]=LIKES_PER_LIKES_PLUS_DISLIKES_PERCENT&t_metrics[]=SHARINGS&v_metrics[]=VIEWS&v_metrics[]=WATCH_TIME&v_metrics[]=AVERAGE_WATCH_TIME&v_metrics[]=LIKES_PER_LIKES_PLUS_DISLIKES_PERCENT&v_metrics[]=SHARINGS&dimension=VIDEO&o_column=WATCH_TIME&o_direction=ANALYTICS_ORDER_DIRECTION_DESC&smooth_timelines=undefined");jQuery("#tb-videos-list-quick-link-earnings").attr("href","https://studio.youtube.com/video/"+e+"/analytics/tab-earn_revenue/period-since_publish?utm_campaign=upgrade&utm_medium=redirect&utm_source=%2Fanalytics");jQuery("#tb-videos-list-quick-link-audience-retention").attr("href","https://studio.youtube.com/video/"+e+"/analytics/tab-interest_viewers/period-since_publish/explore?utm_campaign=upgrade&utm_medium=redirect&utm_source=%2Fanalytics&entity_type=VIDEO&entity_id="+e+"&time_period=lifetime&explore_type=AUDIENCE_RETENTION");jQuery("#tb-videos-list-quick-link-demographics").attr("href","https://studio.youtube.com/video/"+e+"/analytics/tab-build_audience/period-since_publish?utm_campaign=upgrade&utm_medium=redirect&utm_source=%2Fanalytics");jQuery("#tb-videos-list-quick-link-playback-locations").attr("href","https://studio.youtube.com/video/"+e+"/analytics/tab-reach_viewers/period-since_publish/explore?utm_campaign=upgrade&utm_medium=redirect&utm_source=%2Fanalytics&entity_type=VIDEO&entity_id="+e+"&time_period=lifetime&explore_type=TABLE_AND_CHART&chart_type=LINE_CHART&metric=WATCH_TIME&granularity=DAY&t_metrics[]=WATCH_TIME&t_metrics[]=VIEWS&t_metrics[]=AVERAGE_WATCH_TIME&dimension=PLAYBACK_LOCATION_TYPE&o_column=WATCH_TIME&o_direction=ANALYTICS_ORDER_DIRECTION_DESC&smooth_timelines=false");jQuery("#tb-videos-list-quick-link-traffic-sources").attr("href","https://studio.youtube.com/video/"+e+"/analytics/tab-reach_viewers/period-since_publish?utm_campaign=upgrade&utm_medium=redirect&utm_source=%2Fanalytics");jQuery("#tb-videos-list-quick-link-devices").attr("href","https://studio.youtube.com/video/"+e+"/analytics/tab-reach_viewers/period-since_publish/explore?utm_campaign=upgrade&utm_medium=redirect&utm_source=%2Fanalytics&entity_type=VIDEO&entity_id="+e+"&time_period=lifetime&explore_type=TABLE_AND_CHART&chart_type=LINE_CHART&metric=VIEWS&granularity=DAY&t_metrics[]=WATCH_TIME&t_metrics[]=VIEWS&t_metrics[]=AVERAGE_WATCH_TIME&dimension=DEVICE_PLATFORM_TYPE&o_column=WATCH_TIME&o_direction=ANALYTICS_ORDER_DIRECTION_DESC&smooth_timelines=false");jQuery("#tb-videos-list-quick-link-subscribers").attr("href","https://studio.youtube.com/video/"+e+"/analytics/tab-overview/period-since_publish/explore?utm_campaign=upgrade&utm_medium=redirect&utm_source=%2Fanalytics&entity_type=VIDEO&entity_id="+e+"&time_period=since_publish&explore_type=TABLE_AND_CHART&chart_type=LINE_CHART&metric=SUBSCRIBERS_NET_CHANGE&granularity=DAY&t_metrics[]=VIEWS&t_metrics[]=WATCH_TIME&t_metrics[]=SUBSCRIBERS_NET_CHANGE&t_metrics[]=TOTAL_ESTIMATED_EARNINGS&t_metrics[]=VIDEO_THUMBNAIL_IMPRESSIONS&t_metrics[]=VIDEO_THUMBNAIL_IMPRESSIONS_VTR&v_metrics[]=VIEWS&v_metrics[]=WATCH_TIME&v_metrics[]=SUBSCRIBERS_NET_CHANGE&v_metrics[]=TOTAL_ESTIMATED_EARNINGS&v_metrics[]=VIDEO_THUMBNAIL_IMPRESSIONS&v_metrics[]=VIDEO_THUMBNAIL_IMPRESSIONS_VTR&dimension=VIDEO&o_column=SUBSCRIBERS_NET_CHANGE&o_direction=ANALYTICS_ORDER_DIRECTION_DESC&smooth_timelines=undefined");jQuery("#tb-videos-list-quick-link-likes").attr("href","https://studio.youtube.com/video/"+e+"/analytics/tab-overview/period-since_publish/explore?utm_campaign=upgrade&utm_medium=redirect&utm_source=%2Fanalytics&entity_type=VIDEO&entity_id="+e+"&time_period=lifetime&explore_type=TABLE_AND_CHART&chart_type=LINE_CHART&metric=RATINGS_LIKES&granularity=DAY&t_metrics[]=RATINGS_LIKES&t_metrics[]=RATINGS_DISLIKES&t_metrics[]=LIKES_PER_LIKES_PLUS_DISLIKES_PERCENT&dimension=VIDEO&o_column=RATINGS_LIKES&o_direction=ANALYTICS_ORDER_DIRECTION_DESC&smooth_timelines=undefined");jQuery("#tb-videos-list-quick-link-in-playlists").attr("href","https://studio.youtube.com/video/"+e+"/analytics/tab-reach_viewers/period-since_publish/explore?utm_campaign=upgrade&utm_medium=redirect&utm_source=%2Fanalytics&entity_type=VIDEO&entity_id="+e+"&ddr_dimension=TRAFFIC_SOURCE_TYPE&ddr_value=PLAYLIST&time_period=since_publish&explore_type=TABLE_AND_CHART&chart_type=LINE_CHART&metric=VIEWS&granularity=DAY&t_metrics[]=VIDEO_THUMBNAIL_IMPRESSIONS&t_metrics[]=VIDEO_THUMBNAIL_IMPRESSIONS_VTR&t_metrics[]=VIEWS&t_metrics[]=AVERAGE_WATCH_TIME&t_metrics[]=WATCH_TIME&dimension=TRAFFIC_SOURCE_DETAIL&o_column=VIEWS&o_direction=ANALYTICS_ORDER_DIRECTION_DESC&smooth_timelines=undefined");jQuery("#tb-videos-list-quick-link-sharing").attr("href","https://studio.youtube.com/video/"+e+"/analytics/tab-reach_viewers/period-since_publish/explore?utm_campaign=upgrade&utm_medium=redirect&utm_source=%2Fanalytics&entity_type=VIDEO&entity_id="+e+"&time_period=lifetime&explore_type=TABLE_AND_CHART&chart_type=LINE_CHART&metric=SHARINGS&granularity=DAY&t_metrics[]=SHARINGS&dimension=SHARING_SERVICE&o_column=SHARINGS&o_direction=ANALYTICS_ORDER_DIRECTION_DESC&smooth_timelines=false");jQuery("#tb-videos-list-quick-link-cards").attr("href","https://studio.youtube.com/video/"+e+"/analytics/tab-reach_viewers/period-since_publish/explore?utm_campaign=upgrade&utm_medium=redirect&utm_source=%2Fanalytics&entity_type=VIDEO&entity_id="+e+"&time_period=lifetime&explore_type=TABLE_AND_CHART&chart_type=LINE_CHART&metric=INFO_CARD_TEASER_CLICKS&granularity=DAY&t_metrics[]=INFO_CARD_TEASER_CLICKS&t_metrics[]=INFO_CARD_TEASER_CLICK_RATE&t_metrics[]=INFO_CARD_CLICKS&t_metrics[]=INFO_CARD_CLICK_RATE&dimension=INFO_CARD_ID&o_column=INFO_CARD_TEASER_CLICKS&o_direction=ANALYTICS_ORDER_DIRECTION_DESC&smooth_timelines=false")});jQuery(document).on("click",".edit-draft-button",function(){TubeBuddyUploadStudio.LoadTubeBuddyTools()});jQuery(document).on("click",".ytcp-video-row #hover-items ytcp-icon-button#video-details,.ytcp-video-row .video-title-wrapper",function(){if(jQuery(this).closest("#row-container").find(".edit-draft-button").length>0){TubeBuddyUploadStudio.LoadTubeBuddyTools()}});jQuery(document).on("click","#video-thumbnail",function(){if(jQuery(this).find("#video-thumbnail-container").hasClass("draft-thumbnail")){TubeBuddyUploadStudio.LoadTubeBuddyTools()}});jQuery(document).on("mouseenter","#video-list div#row-container",function(e){if(jQuery("#hover-items").length>0&&jQuery("#tb-studio-videos-list-dropdown-template").length>0){B(jQuery(this));return}var t=jQuery(this).find("span.tb-studio-videos-list-dropdown");jQuery(t).css("background-color","#f4f4f4")}).on("mouseleave","div#row-container",function(){var e=jQuery(this).find("span.tb-studio-videos-list-dropdown");if(jQuery(this).hasClass("row-selected"))return;else jQuery(e).css("background-color","white")})};var T=function(e){return e.find("#video-title").text().trim()};var j=function(e){return e.find(".description").text().trim()};var Q=function(e){return e.find("#img-with-fallback").attr("src")};var w=function(e){return e.find(".tablecell-views").text().trim()};var k=function(e){return e&&e.length>0?e.split("/")[e.split("/").indexOf("vi")+1]:null};var B=function(e){var t=T(e);var i=j(e);var o=Q(e);var a=k(o);var s=w(e);if(e.find(".tb-studio-videos-list-dropdown").length>0){e.find(".tb-studio-videos-list-dropdown").remove()}var n=jQuery("#tb-studio-videos-list-dropdown-template").html();var r=n.formatTemplate(a,t,i,o,s);e.find("#hover-items").append(r);e.find(".tb-studio-videos-list-dropdown").css("background-color","transparent");if(e.find("ytcp-video-list-cell-video[show-hover-items]").width()<378&&e.find(".edit-draft-button").length==0){e.find(".tb-studio-videos-list-dropdown").css("left","-44px").css("top","20px")}};var C=function(){if(d===null){d=setInterval(function(){var e=jQuery("#video-list").is(":visible");var t=jQuery("#video-list").find("ytcp-video-row").length;if(e===true&&t>0){clearInterval(d);d=null;jQuery("#video-info-edit.ytcp-video-list-cell-video").each(function(){if(jQuery(this).closest("li.ytcp-omnisearch").length>0){return}var e=jQuery(this).closest("#row-container");var t=jQuery(this).closest(".vm-video-item-content-primary");var i=t.find(".vm-video-title-content").text().trim();var o=t.find(".yt-thumb-clip img:first").attr("src");var a=t.find("input:first").attr("value");var s=jQuery(this).parent().find("#video-info").find(".description").hasClass("placeholder")?"":jQuery(this).parent().find("#video-info").find(".description").text().trim();var n=w(e);jQuery(".tb-studio-videos-list-dropdown:last").find("li").attr("data-title",i).attr("data-thumbnail",o).attr("data-id",a).attr("data-description",s).attr("data-views",n);if(jQuery(this).find(".tb-studio-videos-list-dropdown").length==0)jQuery(this).append(jQuery(".tb-studio-videos-list-dropdown:last")[0].outerHTML)});S();if(jQuery("#header").find(".tb-videos-bulk-list-section").length==0){jQuery("#stuck-to-left-header").before(jQuery(".tb-videos-bulk-list-section:last")[0].outerHTML)}jQuery("#advanced-search-dropdown").prepend(jQuery(".tb-advanced-text-input-playlist:first")[0].outerHTML);if(document.location.href.indexOf("tbplylst")>-1){jQuery(".advanced-search-id").val("");jQuery("#vm-myvideos-search-box").val("")}if(jQuery("#advanced-search-dropdown").is(":visible")){if(!i){i=true;TBExtension.Get("https://www.youtube.com/view_all_playlists?sf=name&vmo=title_asc&sa=0","CRTBVideosListGetPlaylists")}}if(TBGlobal.Profile().EnablePreview){jQuery("#tb-bulk-menu-item-ctr-container").show()}if(u){clearInterval(u)}u=setInterval(x,500)}},2e3)}};var x=function(){clearInterval(u);C()};var S=function(){var e=[];if(jQuery("#hover-items").length>0){jQuery('ytcp-video-row[role="row"] div#row-container').each(function(){var t=T(jQuery(this));var i=Q(jQuery(this));var o=k(i);var a=w(jQuery(this));e.push({videoId:o,title:t,thumbnail:i,views:a})})}else if(jQuery(".tb-studio-videos-list-dropdown").length>0){jQuery(".tb-studio-videos-list-dropdown").each(function(){var t=jQuery(this).closest("ytcp-video-row");if(t.length>0){var i=t.find(".ytcp-video-list-cell-video").find("a:first");var o=t.find(".ytcp-video-list-cell-visibility").filter(".privacy-label").text();var a=jQuery(this).closest("#row-container");if(i&&i.attr("href")){var s=i.attr("href").indexOf("/video/")+"/video/".length;var n=i.attr("href").substring(s,s+11);var r=t.find(".video-title-wrapper").text().trim();var l=t.find("img.ytcp-img-with-fallback").attr("src");var u=t.find(".description").hasClass("placeholder")?"":t.find(".description").text().trim();var d=w(a);jQuery(this).attr("data-id",n);jQuery(this).attr("data-title",r);jQuery(this).attr("data-thumbnail",l);jQuery(this).attr("data-description",u);jQuery(this).attr("data-views",d);jQuery(this).attr("data-is-draft",false);jQuery(this).css("display","block");e.push({videoId:n,title:r,thumbnail:l,views:d})}else if(i&&o=="Draft"){var c=i.filter(".view-on-youtube-link").attr("href");var p=c.split("watch?v=")[1];var r=t.find(".video-title-wrapper").text().trim();var l=t.find("img.ytcp-img-with-fallback").attr("src");var u=t.find(".description").hasClass("placeholder")?"":t.find(".description").text().trim();var d=jQuery(this).parent().parent().parent().parent().find(".tablecell-views").text().trim();jQuery(this).attr("data-id",p);jQuery(this).attr("data-title",r);jQuery(this).attr("data-thumbnail",l);jQuery(this).attr("data-description",u);jQuery(this).attr("data-views",d);jQuery(this).attr("data-is-draft",true);jQuery(this).css("display","block");e.push({videoId:n,title:r,thumbnail:l,views:d})}}})}if(e.length>0)L(e)};var L=function(e){window.localStorage.removeItem("tb-videos-list-studio-video-info"+TBGlobal.CurrentChannelId());window.localStorage.setItem("tb-videos-list-studio-video-info"+TBGlobal.CurrentChannelId(),JSON.stringify(e));window.localStorage.removeItem("tb-videos-list-studio-current-url"+TBGlobal.CurrentChannelId());window.localStorage.setItem("tb-videos-list-studio-current-url"+TBGlobal.CurrentChannelId(),document.location.href)};var _=function(){jQuery(document.body).on("CRTBVideoListGetLaunchPadSummary",function(e,i){try{var o=jQuery("[data-video-container-id='"+t+"']");TBUtilities.Log("CRTBVideoListGetLaunchPadSummary Result: "+i);jQuery(o).find(".tb-videoslist-launchpad-loading").hide();jQuery(o).find(".tb-videoslist-launchpad-loaded").show();var a=JSON.parse(i.response);var s;if(a.Processed==true){jQuery(o).find(".tb-videoslist-launchpad-videosummary").text("Manage this Video in Launch Pad");s=TBGlobal.host+"/launchpad/video/"+t}else{jQuery(o).find(".tb-videoslist-launchpad-videosummary").text("Add Video to Launch Pad");s=TBGlobal.host+"/launchpad/processvideo?videoid="+t+"&channelid="+TBGlobal.CurrentChannelId()+"&c=false&b=true&o=true&type=1"}jQuery(o).find(".tb-videoslist-launchpad-videosummary").prop("href",s);if(a.BestPracticPercentComplete!="NA"){jQuery(o).find(".tb-videoslist-launchpad-bestpractices-hasdata").show();jQuery(o).find(".tb-videoslist-launchpad-bestpractices-nodata").hide();jQuery(o).find(".tb-videoslist-launchpad-bestpractices-remaining").text(a.BestPracticRemaining);jQuery(o).find(".tb-videoslist-launchpad-bestpractices-remaining").attr("href",s+"?tab=bestpractices");jQuery(o).find(".tb-videoslist-launchpad-bestpractices-percentComplete").text(a.BestPracticPercentComplete)}else{jQuery(o).find(".tb-videoslist-launchpad-bestpractices-nodata").show();jQuery(o).find(".tb-videoslist-launchpad-bestpractices-hasdata").hide()}if(a.ChecklistPercentComplete!="NA"){jQuery(o).find(".tb-videoslist-launchpad-checklist-hasdata").show();jQuery(o).find(".tb-videoslist-launchpad-checklist-nodata").hide();jQuery(o).find(".tb-videoslist-launchpad-checklist-remaining").text(a.ChecklistRemaining);jQuery(o).find(".tb-videoslist-launchpad-checklist-remaining").attr("href",s+"?tab=checklist");jQuery(o).find(".tb-videoslist-launchpad-checklist-percentComplete").text(a.ChecklistPercentComplete)}else{jQuery(o).find(".tb-videoslist-launchpad-checklist-nodata").show();jQuery(o).find(".tb-videoslist-launchpad-checklist-hasdata").hide()}if(a.OpportunityPercentComplete!="NA"){jQuery(o).find(".tb-videoslist-launchpad-opportunities-hasdata").show();jQuery(o).find(".tb-videoslist-launchpad-opportunities-nodata").hide();jQuery(o).find(".tb-videoslist-launchpad-opportunities-remaining").text(a.OpportunityRemaining);jQuery(o).find(".tb-videoslist-launchpad-opportunities-remaining").attr("href",s+"?tab=opportunities");jQuery(o).find(".tb-videoslist-launchpad-opportunities-percentComplete").text(a.OpportunityPercentComplete)}else{jQuery(o).find(".tb-videoslist-launchpad-opportunities-nodata").show();jQuery(o).find(".tb-videoslist-launchpad-opportunities-hasdata").hide()}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyVideoList] CRTBVideoListGetLaunchPadSummary"})}});jQuery(document.body).on("CRVideosListGetUserNotes",function(e,t){try{if(t.success){var i=null;if(t.response){i=TBUtilities.ReplaceAll(t.response,'"',"");if(i=="null")i=""}else{i=""}jQuery(".tb-videoslist-notes-loading").hide();if(TBExtension.GetType()=="firefox"){jQuery("#tb-videoslist-video-notes").show()}else{jQuery("[data-notes-id="+t.data.videoid+"]").wysiwyg("setContent",i)}jQuery("[data-notes-id="+t.data.videoid+"]").val(i);jQuery(".tb-videoslist-notes-loaded").show();jQuery("[data-notes-id="+t.data.videoid+"]").attr("data-notes-loaded-id",t.data.videoid)}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyEditVideos] CREditVideoGetUserNotes"})}});jQuery(document.body).on("CRVideosListSaveUserNotes",function(e,t){jQuery(".tb-videoslist-notes-saved").show().delay(2e3).fadeOut()});jQuery(document.body).on("CRTBVideosListGetPlaylist",function(e,t){TBUtilities.Log("CRTBVideosListGetPlaylist");TBUtilities.Log(t);if(t.success){var i=TBGlobal.GetYouTubeUI();if(t.response.indexOf('window["ytInitialData"] = {"responseContext"')>-1){i="material"}var a="";switch(i){case"default":{var s=DOMPurify.sanitize(t.response,DOMPurifyConfig);jQuery(".pl-video",s).each(function(e){var t=jQuery(this).attr("data-video-id");if(a)a+=" ";if(t.indexOf("-")>0||t.indexOf("_")>0)a+='"'+t+'"';else a+=t;TBUtilities.Log(t)});break}case"studio":case"material":{var n=I(t.response);if(n.contents.twoColumnBrowseResultsRenderer.tabs["0"]){try{jQuery.each(n.contents.twoColumnBrowseResultsRenderer.tabs["0"].tabRenderer.content.sectionListRenderer.contents["0"].itemSectionRenderer.contents["0"].playlistVideoListRenderer.contents,function(e,t){if(t.playlistVideoRenderer){var i=t.playlistVideoRenderer.videoId;if(a)a+=" ";if(i.indexOf("-")>0||i.indexOf("_")>0)a+='"'+i+'"';else a+=i;TBUtilities.Log(i)}})}catch(e){TBUtilities.LogError(e)}}break}}TBUtilities.Log(a);jQuery(".tb-videoslist-playlist-loading").hide();o=a+" tbplylst"}});jQuery(document.body).on("CRTBVideosListGetPlaylists",function(e,t){if(t.success){var i=DOMPurify.sanitize(t.response,DOMPurifyConfig);jQuery(".vm-video-title-text",i).each(function(e){var t=jQuery(this).text();var i=jQuery(this).attr("href").toString().replace("/playlist?list=","");jQuery(".tb-videoslist-playlists-select").append('<option value="'+i+'">'+t+"</option>")});jQuery(".tb-videoslist-playlists-select-loading").hide();jQuery(".tb-videoslist-playlists-select").show()}});jQuery(document.body).on("CRTBLoadVideosListStudioTemplate",function(e,t){TBUtilities.Log("CRTBLoadVideosListStudioTemplate");if(t.success){t.response=TBUtilities.FixLocalHtml(DOMPurify.sanitize(t.response,DOMPurifyConfig));jQuery("body").append(t.response);C();p();s=true}});jQuery(document.body).on("CRTBLoadVideosListEditPage",function(e,t){if(t.success){var i=t.response.indexOf("{'X-YouTube-Identity-Token': \"")+"{'X-YouTube-Identity-Token': \"".length;var o=t.response.indexOf('"',i+2);var a=t.response.substring(i,o);var s={video_ids:t.data.videoId,session_token:a,src_playlist_id:""};TBExtension.Post("https://www.youtube.com/addto_ajax?action_get_dropdown=1&hide_watch_later=true&feature=edit",jQuery.param(s),"CRTBLoadVideosListPlaylistData",{videoId:t.data.videoId},{contentType:"application/x-www-form-urlencoded; charset=UTF-8"})}});jQuery(document.body).on("CRTBLoadVideosListPlaylistData",function(e,t){var i=false;if(t.success){$(".tb-video-list-playlists-container").empty();var o=t.data.videoId;var a=DOMPurify.sanitize(t.response,DOMPurifyConfig);jQuery(a).find("li").each(function(){var e=jQuery(this).find(".playlist-name:first").html();var t=jQuery(this).find("button:first").attr("aria-checked");var a=jQuery(this).attr("data-full-list-id");if(t=="checked"){$(".tb-video-list-playlists-container").append('<div style="padding:0 0 10px"><b>Playlist Link - "'+e+'"</b><br /> <input class="tb-material-input tb-videos-list-info-playlist-link" type="text" value="https://www.youtube.com/watch?v='+o+"&list="+a+'" readonly /><button id="tb-video-copy-playlist-'+a+'" class="tb-btn-blue tb-video-playlist-copy" data-clipboard-text="https://www.youtube.com/watch?v='+o+"&list="+a+'" >Copy</button></div>');i=true;new ClipboardJS("#tb-video-copy-playlist-"+a)}});if(!i){$(".tb-video-list-playlists-container").append('<div style="padding:15px 0 10px 5px; color:coral;">This video was not found in any of your Playlists.</div>')}}});jQuery(document.body).on("CRTBVideoListLoadVideoStatus",function(e,t){var i=jQuery("div[data-video-container-id='"+t.data.videoId+"']");jQuery(i).find(".tb-videos-list-notes").hide();jQuery(i).find(".tb-videos-list-thumbnail-generated-date").text("");jQuery(i).find(".tb-videos-list-thumbnail-generated").hide();jQuery(i).find(".tb-videos-list-is-card-template").hide();jQuery(i).find(".tb-videos-list-is-annotation-template").hide();jQuery(i).find(".tb-videos-list-facebook-date").text("");jQuery(i).find(".tb-videos-list-view-facebook").attr("href","");jQuery(i).find(".tb-videos-list-facebook").hide();jQuery(i).find(".tb-videos-list-golive-date").text("");jQuery(i).find(".tb-videos-list-golive").hide();jQuery(i).find(".tb-videos-list-wentlive-date").text("");jQuery(i).find(".tb-videos-list-wentlive").hide();jQuery(i).find(".tb-videos-list-sunset-date").text("");jQuery(i).find(".tb-videos-list-sunset").hide();jQuery(i).find(".tb-videos-list-sunsetted-date").text("");jQuery(i).find(".tb-videos-list-sunsetted").hide();jQuery(i).find(".tb-videos-list-share-tracker-items").hide();if(t.success){var o=JSON.parse(t.response);if(o.DateThumbnailGeneratedLocal){jQuery(i).find(".tb-videos-list-thumbnail-generated-date").text(o.DateThumbnailGeneratedLocal);jQuery(i).find(".tb-videos-list-thumbnail-generated").show();jQuery(i).find(".tb-videos-list-notes").show()}if(o.IsCardTemplate){jQuery(i).find(".tb-videos-list-is-card-template").show();jQuery(i).find(".tb-videos-list-notes").show()}if(o.DateFacebookPostedLocal){jQuery(i).find(".tb-videos-list-facebook-date").text(o.DateFacebookPostedLocal);jQuery(i).find(".tb-videos-list-facebook").show();jQuery(i).find(".tb-videos-list-notes").show();if(!o.FacebookExternalAccountId)jQuery(i).find(".tb-videos-list-view-facebook").hide();else{jQuery(i).find(".tb-videos-list-view-facebook").show();jQuery(i).find(".tb-videos-list-view-facebook").attr("href","https://www.facebook.com/"+o.FacebookExternalAccountId+"/videos/"+o.FacebookVideoId)}}if(o.ScheduledGoLiveLocal){jQuery(i).find(".tb-videos-list-golive-date").text(o.ScheduledGoLiveLocal);jQuery(i).find(".tb-videos-list-golive").show();jQuery(i).find(".tb-videos-list-notes").show()}if(o.DateWentLiveLocal){jQuery(i).find(".tb-videos-list-wentlive-date").text(o.DateWentLiveLocal);jQuery(i).find(".tb-videos-list-wentlive").show();jQuery(i).find(".tb-videos-list-notes").show()}if(o.DateSunsetLocal){jQuery(i).find(".tb-videos-list-sunset-date").text(o.DateSunsetLocal);jQuery(i).find(".tb-videos-list-sunset").show();jQuery(i).find(".tb-videos-list-notes").show()}if(o.DateSunsettedLocal){jQuery(i).find(".tb-videos-list-sunsetted-date").text(o.DateSunsettedLocal);jQuery(i).find(".tb-videos-list-sunsetted").show();jQuery(i).find(".tb-videos-list-notes").show()}if(o.SharedWithNetworks!=null){jQuery(i).find(".tb-videos-list-share-tracker-items").show();jQuery.each(o.SharedWithNetworks,function(e,t){jQuery(i).find(".tb-videos-list-share-tracker-items-list").append('<img src="'+TBGlobal.host+"/images/icons/social/"+t+'.png" style="height:12px;" /> ')});jQuery(i).find(".tb-videos-list-notes").show()}if(o.DateScheduledMetaUpdate){jQuery(i).find(".tb-videos-list-scheduledmetaupdate-date").text(o.DateScheduledMetaUpdateLocal);jQuery(i).find(".tb-videos-list-scheduledmetaupdate").show();jQuery(i).find(".tb-videos-list-notes").show()}if(o.DateScheduledMetaUpdated){jQuery(i).find(".tb-videos-list-scheduledmetaupdated-date").text(o.DateScheduledMetaUpdatedLocal);jQuery(i).find(".tb-videos-list-scheduledmetaupdated").show();jQuery(i).find(".tb-videos-list-notes").show()}}});jQuery(document.body).on("CRTBVideosListDownloadUrl",function(e,t){var i="";for(var o in t.additionalInfo.headers){i+="\n"+o+": "+t.additionalInfo.headers[o]}})};var I=function(e){var t=e.indexOf('window["ytInitialData"] = ');t=t+26;var i=e.substring(t,e.length);var o=i.indexOf("};")+1;var i=i.substring(0,o);var a=jQuery.parseJSON(i);return a};return{Initialize:function(t){if(TBGlobal.IsAuthenticated()){if(!e){_();v();e=true}if(l){TBUtilities.Log("Video list clearing interval");clearInterval(l)}l=setInterval(b,500)}}}}();(function(e,t,i,o){var a="suggestedtags";function s(t,i){this.element=t;this._name=a;this._defaults=e.fn.suggestedtags.defaults;this._pluginHtml='<div class="tb-suggested-tags-container"> <div class="tb-suggested-tags-row1"> <div class="tb-suggested-tags-row1-inner"> <img src="'+TBGlobal.host+'/images/branding/tb-icon-transparent.svg" style="position:relative; top:1px; margin-left:-2px; margin-bottom:0px; display:none;" class="tb-height11 tb-edit-video-studio-show-inline" /> <span style="color:#333; font-weight:500;" class="tb-font-size13"> Recommended Tags <span style="color: rgba(0,0,0,.55);display: inline-block;"> - consider adding if relevant</span> </span> </div> <div title="Loading scores" class="tb-suggested-tags-scores-loading tb-spinner" style="display:none"></div> <div class="tb-suggested-tags-scores-refresh-scores-container" style="display:none;"> <button title="The tags in this list have changed. Click refresh scores to get the latest tag scores." class="tb-suggested-tags-scores-refresh-scores">Refresh scores</button> </div> </div> <div class="tb-suggested-tags-row2" style="display:none"> <div class="tb-suggested-tags-video-topic-container"> <div class="tb-suggested-tags-video-topic-container-doesntexist" style=""> Want more specific tags? <a class="tb-suggested-tags-video-topic">Tell us</a> the Keyword you&#39;re targeting in this video </div> <div class="tb-suggested-tags-video-topic-container-exists tb-margin-left5 tb-margin-right5" style="display:none"> Including tags for Keyword: <a class="tb-suggested-tags-video-topic-modify"></a> <i title="remove keyword" class="tb-suggested-tags-video-topic-delete small material-icons tb-red tb-move-down3 tb-font-size15 tb-cursor-pointer">close</i> </div> </div> <div class="tb-suggested-tags-button-bar" style=""> <div class="tb-suggested-tags-button-container"> <div> <span class="tb-move-down8"> <span style="margin-bottom:5px;margin-left:5px">Sort by:</span> </span> </div> <div> <div class="tb-radio tb-move-down2" style=""> <input disabled="disabled" id="suggestedtagsplugin-radio1" type="radio" name="suggestedtagsplugin" value="Relevance" checked="checked" /> <label for="suggestedtagsplugin-radio1" class="tb-radio-label">Relevance</label> </div> <div class="tb-radio tb-move-down2" style=""> <input disabled="disabled" id="suggestedtagsplugin-radio2" class="tb-radio" type="radio" name="suggestedtagsplugin" value="score" /> <label for="suggestedtagsplugin-radio2" class="tb-radio-label">Score</label> </div> </div> </div> </div> </div> <div class="tb-suggested-tags-loading tb-margin-left10 tb-margin-top15 tb-margin-bottom15" style="max-height:50px;"> <div class="tb-spinner"></div><span class="tb-margin-left4" style="font-weight:normal; color:#777;">Loading Tags...</span> </div> <div class="tb-suggested-tags-results-container tb-suggested-tags-row3"> <div class="tb-suggested-tags-results"></div> <div class="tb-suggested-tags-upgrade" style="display:none"> <div class="tb-suggested-tags-upgrade-text"> <img src="{PLUGIN_FILE_ROOT}/images/icons/lock.png" style="position:relative; top:3px;" /> Only <span class="tb-suggested-tags-upgrade-shown"></span> of <span class="tb-suggested-tags-upgrade-total"></span> total tags are shown. <br />Upgrade your license to view them all. <br /> <a style="cursor:pointer; font-weight:500; padding:2px 0 5px" class="tb-suggested-tags-upgrade-upgrade-link"> UPGRADE NOW! </a> </div> <img class="tb-suggested-tags-upgrade-img" /> </div> </div> <div class="tb-suggested-tags-results-empty" style="max-height:200px; overflow-y:auto; overflow-x:hidden; margin-left:10px; margin-top:5px;display:none;"> <div class="tb-padding-top30 tb-padding-bottom30 tb-padding-left30" style="text-align: left;"> <div style="color:#999;" class="tb-padding-left20 tb-font-size13">Add title or tags to your video for recommendations</div> </div> </div> </div> <div style="display:none" type="text/template" id="tb-suggested-tags-plugin-tag-score-template"><span class="tb-suggested-tags-plugin-tag-score-container" style="border-color:{1}" title="Tag Score"><span class="tb-suggested-tags-plugin-tag-score-text" data-score="{0}">{0}</span></span></div><div style="display:none" type="text/template" id="tb-suggested-tags-plugin-tag-score-template-empty"><span class="tb-suggested-tags-plugin-tag-score-container-empty"><span class="tb-suggested-tags-plugin-tag-score-text-empty" title="Get tag score"><i class="small material-icons">search<i/></span></span></div>';this.options=e.extend({},this._defaults,i);this._suggestionsInitTags=[];this._suggestionsLoadCompleteCount=0;this._suggestionsLoadSteps=0;this._suggestionsTagsProcessed=[];this._suggestionsCollection=[];this._autoCompleteToken;this._loading=false;this._loadScores=false;this._scoresLoaded=false;this._scoresLoading=false;this._cookieKey="tb-suggested-tags-";this._videoId=null;this._videoKeyword=null;this._lastVideoKeyword=null;this.init();this._keywordPromptHtml="It's important that you focus your video optimization around a target keyword phase. Usually 3-5 words. What is your Target Keyword for this video?";this._enabled=true}e.extend(s.prototype,{init:function(){this.buildCache();this.bindEvents();this.populateHtml()},destroy:function(){this.unbindEvents();this.$element.removeData()},buildCache:function(){this.$element=e(this.element);this.randomId=Math.floor(Math.random()*(1e5-1)+1)},getAutoCompleteToken:function(){if(this._autoCompleteToken==null){var e=jQuery("body")[0].outerHTML;var t=e.indexOf('PSUGGEST_TOKEN":"')+'PSUGGEST_TOKEN":"'.length;var i=e.indexOf('"',t);this._autoCompleteToken=e.substring(t,i)}return this._autoCompleteToken},getTagsThatHaveBeenRemoved:function(e){plugin=this;var t=[];jQuery.each(plugin._suggestionsTagsProcessed,function(i,o){var a=jQuery.grep(e,function(e){return o.toLowerCase()===e.toLowerCase()});if(a.length===0&&o!=""){t.push(o)}});return t},removedSuggestionsForRemovedTags:function(e){plugin=this;if(e.length!=0){var t=[];jQuery.each(e,function(e,i){var o=jQuery.grep(plugin._suggestionsCollection,function(e){return e.seed.toLowerCase()===i.toLowerCase()});if(o.length>0){t.push.apply(t,o)}});plugin.removeSuggestedTags(t);plugin.checkForLoading()}},getTagsNotProcessed:function(e){plugin=this;var t=[];jQuery.each(e,function(e,i){var o=jQuery.grep(plugin._suggestionsTagsProcessed,function(e){return i.toLowerCase()===e.toLowerCase()});var a=jQuery.grep(plugin._suggestionsCollection,function(e){if(e.tag){return i.toLowerCase()===e.tag.toLowerCase()}});if(o.length===0&&i!=""&&a.length==0){t.push(i)}});return t},getSuggestions:function(e,t,i,o){TBUtilities.Log("suggestedtagsplugin.js getSuggestions videoId = "+e);this._videoId=e;this._suggestionsInitTags=t;this._suggestionsLoadCompleteCount=0;this._suggestionsLoadSteps=0;plugin=this;if(o&&o==true){this._loadScores=true}var a=plugin.getTagsThatHaveBeenRemoved(t);plugin.removedSuggestionsForRemovedTags(a);var s=plugin.getTagsNotProcessed(t);plugin._suggestionsTagsProcessed.push.apply(plugin._suggestionsTagsProcessed,s);if(!plugin._videoId){if(plugin._suggestionsInitTitle!=i){if(typeof plugin._suggestionsInitTitle!="undefined"){let e=jQuery.grep(plugin._suggestionsCollection,function(e){return e.seed=="title"});plugin.removeSuggestedTags(e);plugin.checkForLoading()}if(i.trim()!=""){plugin._suggestionsInitTitle=i;plugin.getTitleSuggestions(i)}}if(s.length>0){plugin._suggestionsLoadSteps++;plugin.getAutoCompleteSuggestions(s)}plugin._loading=true;plugin.checkForLoading()}else{TBExtension.GetDbValue(plugin._cookieKey+plugin._videoId,function(e,t){if(t&&t!=="-1"){if(t!="-1"){plugin._suggestionsLoadSteps=plugin._suggestionsLoadSteps+1;plugin.getKeywordSuggestions(TBUtilities.GetUrlDecoded(t));if(i.trim()!=""){plugin._suggestionsInitTitle=i}}else{if(plugin._suggestionsInitTitle!=i){plugin._suggestionsLoadSteps=plugin._suggestionsLoadSteps+1;if(typeof plugin._suggestionsInitTitle!="undefined"){var o=jQuery.grep(plugin._suggestionsCollection,function(e){return e.seed=="title"});plugin.removeSuggestedTags(o);plugin.checkForLoading()}if(i.trim()!=""){plugin._suggestionsInitTitle=i;plugin.getTitleSuggestions(i)}}}if(s.length>0){plugin._suggestionsLoadSteps++;plugin.getAutoCompleteSuggestions(s)}plugin._loading=true;plugin.checkForLoading()}else{var a=TBGlobal.host+TBGlobal.apiUrls.seoScoreGetLatestKeyword+"?videoId="+plugin._videoId;TBExtension.Get(a,function(e,t,o){var a=null;try{if(e){var n=JSON.parse(o);if(n){a=n.Keyword}}if(a){plugin._suggestionsLoadSteps=plugin._suggestionsLoadSteps+1;plugin.getKeywordSuggestions(TBUtilities.GetUrlDecoded(a))}else{if(plugin._suggestionsInitTitle!=i){plugin._suggestionsLoadSteps++;if(typeof plugin._suggestionsInitTitle!="undefined"){var r=jQuery.grep(plugin._suggestionsCollection,function(e){return e.seed=="title"});plugin.removeSuggestedTags(r);plugin.checkForLoading()}if(i.trim()!=""){plugin._suggestionsInitTitle=i;plugin.getTitleSuggestions(i)}}}}catch(e){TBUtilities.Log(e)}if(s.length>0){plugin._suggestionsLoadSteps++;plugin.getAutoCompleteSuggestions(s)}plugin._loading=true;plugin.checkForLoading()},null)}})}},saveKeyword:function(e){var t=this;if(e&&t._videoKeyword){TBExtension.SetDbValue(t._cookieKey+e,TBUtilities.GetUrlEncoded(t._videoKeyword))}},getAutoCompleteSuggestions:function(e){try{var t=this;var i=0;var o=[];jQuery.each(e,function(a,s){TubeBuddyYouTubeActions.GetYouTubeAutoComplete(t.getAutoCompleteToken(),s,function(a,s){try{i++;if(a&&a.length>0){jQuery.each(a,function(e,i){var a=t.createSuggestion(i,"autocomplete",4,s);o.push(a)})}if(i>=e.length){t.suggestionsComplete(o)}}catch(e){TBUtilities.Log(e);t.suggestionsComplete(null)}})})}catch(e){TBUtilities.Log(e);t.suggestionsComplete(null)}},getKeywordSuggestions:function(e){var t=this;TBUtilities.Log("suggestedtagsplugin.js getKeywordSuggestions = "+e);if(t._lastVideoKeyword===null||t._lastVideoKeyword!==null&&e.toLowerCase()!==t._lastVideoKeyword.toLowerCase()){t._lastVideoKeyword=e;if(t._videoKeyword&&t._videoKeyword.trim().toLowerCase()!=e.trim().toLowerCase()){let e=jQuery.grep(t._suggestionsCollection,function(e){return e.seed=="topic"});t.removeSuggestedTags(e)}let i=jQuery.grep(t._suggestionsCollection,function(e){return e.seed=="title"});t.removeSuggestedTags(i);t._videoKeyword=e;TBUtilities.GetKeywordRecommendedTags(e).then(function(e){t.suggestionsComplete(e)}).catch(function(e){TBUtilities.Log(e);t.suggestionsComplete(null)})}},getTitleSuggestions:function(e){var t=this;try{var i=[];var o=0;TubeBuddyYouTubeActions.GetVideoSearchResults(e,function(e){if(e&&e.filter(function(e){return e.id!==t._videoId}).length>0){TBUtilities.Log("suggestedtagsplugin.js searchResults length = "+e.length);e=e.slice(0,15);jQuery.each(e,function(a,s){TubeBuddyYouTubeActions.GetVideoTags(s.id,function(a){try{o++;var s=[];jQuery.each(a,function(e,t){if(/\s/.test(t)&&t!=""){var i=t.trim().toLowerCase();if(s.indexOf(i)==-1){s.push(i)}}});i.push.apply(i,s);TBUtilities.Log("suggestedtagsplugin.js get video tags done = "+o);if(o>=e.length){countResult={};for(var n=0;n<i.length;++n){if(!countResult[i[n]])countResult[i[n]]=0;++countResult[i[n]]}var r=Object.keys(countResult).map(function(e){return[e,this[e]]},countResult).sort(function(e,t){return t[1]-e[1]});for(var l in r){if(r[l][1]<=1){delete r[l]}}var u=[];for(var l in r){u.push(r[l][0])}var d=[];jQuery.each(u,function(e,i){if(i){var o=t.createSuggestion(i,"search",3,"title");d.push(o)}});t.suggestionsComplete(d);var c=[];var p=0;if(u.length>0){jQuery.each(u,function(e,i){TubeBuddyYouTubeActions.GetYouTubeAutoComplete(t.getAutoCompleteToken(),i,function(e){p++;if(e&&e.length>0){c.push.apply(c,e)}if(p>=u.length){var i=[];jQuery.each(c,function(e,o){var a=t.createSuggestion(o,"searchautocomplete",3,"title");i.push(a)});t.suggestionsComplete(i)}})})}else{t.suggestionsComplete(null)}}}catch(e){t.suggestionsComplete(null);TBUtilities.Log(e)}})})}else{t.suggestionsComplete(null)}})}catch(e){TBUtilities.Log(e);t.suggestionsComplete(null)}},suggestionsComplete:function(e){var t=this;t._suggestionsLoadCompleteCount++;if(e){t._suggestionsCollection.push.apply(t._suggestionsCollection,e)}if(t._suggestionsLoadCompleteCount>=t._suggestionsLoadSteps){t._loading=false;TBUtilities.Log("suggestionsComplete - done processing");var i=[];jQuery.each(t._suggestionsCollection,function(e,o){if(o.tag){var a=jQuery.grep(t._suggestionsInitTags,function(e){return e.toLowerCase()===o.tag.toLowerCase()});if(a.length===0&&(/\s/.test(o.tag)&&o.tag!="")){i.push(o)}}});i=i.sort(function(e,t){return e.priority-t.priority});t.addSuggestions(i);t.checkForLoading();if(t._loadScores==true&&t._scoresLoading==false&&t._scoresLoaded==false&&t._suggestionsCollection.length>0){t._scoresLoading=true;t._loadScores=false;setTimeout(function(){t.getTagSuggestionScores()},1500)}if(t._scoresLoaded==true&&t._loadScores==false&&t._scoresLoading==false&&TBGlobal.CanAccessLevel1Tools()===true){t.$element.find(".tb-suggested-tags-scores-refresh-scores-container").show();t.$element.find(".tb-suggested-tags-button-bar").show()}t.$element.find(".tb-suggested-tags-row2 ").show();t.showOrHideTopicArea()}},showOrHideTopicArea:function(){var e=this;if(e._videoKeyword){e.$element.find(".tb-suggested-tags-video-topic-container-exists").show();e.$element.find(".tb-suggested-tags-video-topic-container-doesntexist").hide();e.$element.find(".tb-suggested-tags-video-topic-modify").text(TBUtilities.Truncate(e._videoKeyword,60))}else{e.$element.find(".tb-suggested-tags-video-topic-container-exists").hide();e.$element.find(".tb-suggested-tags-video-topic-container-doesntexist").show();e.$element.find(".tb-suggested-tags-video-topic-modify").text("")}},getTagSuggestionScores:function(){var e=this;e.$element.find("#suggestedtagsplugin-radio2").attr("disabled","disabled");e.$element.find("#suggestedtagsplugin-radio1").attr("disabled","disabled");e.$element.find(".tb-suggested-tags-scores-loading").show();var t=new Array;if(TBGlobal.CanAccessLevel1Tools()==false){e.$element.find(".tb-suggested-tags-results:first").find(".tb-suggested-tag").each(function(){var i=jQuery(this).attr("data-tag");var o=decodeURIComponent(i);var a=TBUtilities.GetInArray(e._suggestionsCollection,"tag",o);if(a){t.push(a)}})}else{t=e._suggestionsCollection}var i=new Array;jQuery.each(t,function(e,t){if(t.tag){i.push(t.tag)}});var o=TBGlobal.host+TBGlobal.apiUrls.tagScoreGetStored;var a=TBGlobal.GetPrefCookieObject();var s={Region:"us",Tags:i,Language:"en"};if(a&&a.gl){s.Region=a.gl}if(a&&a.hl){s.Language=a.hl}TBExtension.Post(o,JSON.stringify(s),function(t,i,o){e._scoresLoaded=true;if(t===true){var a=jQuery("#tb-suggested-tags-plugin-tag-score-template").html();var s=jQuery.parseJSON(o);jQuery.each(s,function(t,i){e.setTagScore(i,a)})}var n=e.$element.find(".tb-suggested-tag:not(:has(.tb-suggested-tags-plugin-tag-score-container))");var r=jQuery("#tb-suggested-tags-plugin-tag-score-template-empty").html();jQuery.each(n,function(e,t){jQuery(this).find(".tb-suggested-tags-plugin-tag-score-container-loading").remove();if(jQuery(this).find(".tb-suggested-tags-plugin-tag-score-container-empty").length==0){var i=r.formatTemplate();jQuery(t).append(i)}});e.$element.find(".tb-suggested-tags-scores-loading").hide();e.$element.find("#suggestedtagsplugin-radio2").removeAttr("disabled");e.$element.find("#suggestedtagsplugin-radio1").removeAttr("disabled");e.$element.find("#suggestedtagsplugin-radio1").prop("checked",true);e._scoresLoading=false;e.$element.find('.input[name="suggestedtagsplugin"]').removeAttr("disabled")},null,{contentType:"application/json",dataType:"text"})},setTagScore:function(e,t){var i=e.Score;if(TBGlobal.CanAccessLevel1Tools()==true){i=e.WeightedScore}i=Math.round(i);var o=TBUtilities.FixedEncodeURIComponent(e.Tag);var a="";var s=TubeBuddyTagExplorer.GetScoreColors();if(i<=20){a=s[0]}else if(i>20&&i<40){a=s[1]}else if(i>=40&&i<60){a=s[2]}else if(i>=60&&i<80){a=s[3]}else if(i>=80){a=s[4]}var n=t.formatTemplate(i,a);var r=jQuery('[data-tag="'+o+'"]');r.find(".tb-suggested-tags-plugin-tag-score-container-loading").remove();if(r.find(".tb-suggested-tags-plugin-tag-score-container").length==0){if(r.find(".tb-suggested-tags-plugin-tag-score-container-empty").length>0){r.find(".tb-suggested-tags-plugin-tag-score-container-empty").remove()}r.append(n)}},addSuggestions:function(e){var t=this;var i="<div title='{3}' class='tb-suggested-tag' data-disabled='false' data-tag='{0}' data-seed='{2}' data-priority='{4}'><img title='add tag' class='tb-suggested-tag-image' src='{PLUGIN_FILE_ROOT}/images/icons/add2.png' /> <span class='tb-suggested-tag-text'>{1}</span><img style='{5}' src='{PLUGIN_FILE_ROOT}/images/icons/error.png' class='tb-suggested-tag-demonetization' title='tag may cause demonetization' /><span class='tb-suggested-tags-plugin-tag-score-container-loading'>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp</span></span></div>";i=TBUtilities.FixLocalHtml(i);var o=0;jQuery.each(e,function(e,a){o=t.$element.find(".tb-suggested-tags-results:first").find(".tb-suggested-tag").length;if(TBGlobal.CanAccessLevel1Tools()==true||TBGlobal.CanAccessLevel1Tools()==false&&o<3){var s=TBUtilities.FixedEncodeURIComponent(a.tag);if(t.$element.find(".tb-suggested-tags-results").find('div[data-tag="'+s+'"]').length==0){var n=TBUtilities.FixedEncodeURIComponent(a.seed);var r=TBUtilities.Truncate(a.tag,55,false);var l="display:none";if(a.isCensored===true){l=""}var u="display:none";if(a.isMisSpell===true){u="";r=r.replace(a.misSpelledWord,'<span class="tb-suggested-tag-misspelled" title="Contains a commonly misspelled word">'+a.misSpelledWord+"</span>")}var d=i.formatTemplate(s,r,n,a.tag,a.priority,l);t.$element.find(".tb-suggested-tags-results:first").append(d)}}});var a=t.$element.find(".tb-suggested-tags-results:first");a.find(".tb-suggested-tag").sort(function(e,t){return jQuery(e).attr("data-priority")-jQuery(t).attr("data-priority")}).appendTo(a);t.$element.find(".tb-suggested-tags-upgrade-shown").text(o);t.$element.find(".tb-suggested-tags-upgrade-total").text(e.length);if(o<3){t.$element.find(".tb-suggested-tags-upgrade").hide()}else if(TBGlobal.CanAccessLevel1Tools()==false){var s="{PLUGIN_FILE_ROOT}/images/screenshots/suggestedtagsblur.png";s=TBUtilities.FixLocalHtml(s);t.$element.find(".tb-suggested-tags-upgrade-img").attr("src",s);t.$element.find(".tb-suggested-tags-upgrade").show();var n=t.$element.find(".tb-suggested-tags-upgrade-img").position();var r=200;var l=0;var u=n.left+r-l+"px";var d=n.top+50+"px";t.$element.find(".tb-suggested-tags-upgrade-text").css({position:"absolute",zIndex:5e3,left:u,top:d})}else{t.$element.find(".tb-suggested-tags-upgrade").hide()}},removeSuggestedTags:function(e){var t=this;if(e.length>0){jQuery.each(e,function(e,i){var o=TBUtilities.FixedEncodeURIComponent(i.tag);var a=t.$element.find(".tb-suggested-tags-results").find('div[data-tag="'+o+'"]');if(a){a.remove()}TBUtilities.RemoveFromArray(t._suggestionsCollection,"tag",i.tag)})}},createSuggestion:function(e,t,i,o,a,s){var n=TBUtilities.IsWordCensored(e);var r={tag:e,source:t,priority:i,seed:o,isCensored:n,isMisSpell:a===true,misSpelledWord:s};return r},populateHtml:function(){if(this.$element.hasClass("tb-suggestedtags-element")==false){var e=TBUtilities.FixLocalHtml(DOMPurify.sanitize(this._pluginHtml,DOMPurifyConfig));this.$element.append(e);if(this.options.resultsMaxWidth){this.$element.find(".tb-suggested-tags-results").css("max-width",this.options.resultsMaxWidth)}this.$element.addClass("tb-suggestedtags-element");if(TBGlobal.CanAccessLevel1Tools()===true){this.$element.find(".tb-suggested-tags-button-bar").show();this.$element.find(".tb-suggested-tags-button-container").show()}else{this.$element.find(".tb-suggested-tags-button-container").hide();this.$element.find(".tb-suggested-tags-button-bar").hide()}var t=TBGlobal.GetYouTubeUI();if(t=="default"){this.$element.find(".tb-suggested-tags-row1-inner").addClass("tb-suggested-tags-row1-inner-default");this.$element.find(".tb-suggested-tags-row1").addClass("tb-suggested-tags-row1-default")}}},addTagEvent:function(e){if(this.options.tagAddSender){this.options.onTagsAdd(this.options.tagAddSender,e)}else{this.options.onTagsAdd(e)}},checkForLoading:function(e){if(this._loading==true&&this.$element.find(".tb-suggested-tags-results").find(".tb-suggested-tag").length==0){this.$element.find(".tb-suggested-tags-loading").show();this.$element.find(".tb-suggested-tags-results-container").hide();this.$element.find(".tb-suggested-tags-results-empty").hide()}else if(this._loading==true&&e===true){this.$element.find(".tb-suggested-tags-loading").show();this.$element.find(".tb-suggested-tags-results-container").hide()}else if(this.$element.find(".tb-suggested-tags-results").find(".tb-suggested-tag").length>0){this.$element.find(".tb-suggested-tags-loading").hide();this.$element.find(".tb-suggested-tags-results-container").show();this.$element.find(".tb-suggested-tags-results-empty").hide()}else{this.$element.find(".tb-suggested-tags-loading").hide();this.$element.find(".tb-suggested-tags-results-container").hide();this.$element.find(".tb-suggested-tags-results-empty").show()}},removeSaveKeyword:function(){var e=this;if(e._videoKeyword){let t=jQuery.grep(e._suggestionsCollection,function(e){return e.seed=="keyword"});e.removeSuggestedTags(t);e.checkForLoading()}if(e._videoId){TBExtension.SetDbValue(e._cookieKey+e._videoId,"-1")}e._videoKeyword=null},bindEvents:function(){var e=this;e.$element.on("click",".tb-suggested-tags-video-topic-delete",function(t,i){t.preventDefault();alertify.defaults.maintainFocus=false;TBUtilities.Confirm("Are you sure you want to remove this keyword?",function(){e.removeSaveKeyword();e._suggestionsLoadCompleteCount=0;e._suggestionsLoadSteps=1;e.getTitleSuggestions(e._suggestionsInitTitle);e._videoKeyword=null;e.showOrHideTopicArea();e._loading=true;e.checkForLoading(true)})});e.$element.on("click",".tb-suggested-tags-video-topic-modify",function(t,i){t.preventDefault();alertify.defaults.maintainFocus=false;var o=prompt(e._keywordPromptHtml,e._videoKeyword);if(o===null){e._suggestionsLoadSteps=1;e.removeSaveKeyword();e.getTitleSuggestions(e._suggestionsInitTitle)}else{e._suggestionsLoadSteps=1;if(e._videoId){TBExtension.SetDbValue(e._cookieKey+e._videoId,TBUtilities.GetUrlEncoded(o))}e.getKeywordSuggestions(TBUtilities.GetUrlDecoded(o.trim()));e.showOrHideTopicArea();e.$element.find("#suggestedtagsplugin-radio1").prop("checked",true)}e._loading=true;e.checkForLoading(true)});e.$element.on("click",".tb-suggested-tags-video-topic",function(t,i){t.preventDefault();alertify.defaults.maintainFocus=false;if(TBGlobal.CanAccessLevel1Tools()===true){var o=prompt(e._keywordPromptHtml,"");e._suggestionsLoadCompleteCount=0;e._suggestionsLoadSteps=1;if(o===null){e.removeSaveKeyword();e.getTitleSuggestions(e._suggestionsInitTitle)}else{if(e._videoId){TBExtension.SetDbValue(e._cookieKey+e._videoId,TBUtilities.GetUrlEncoded(o))}e.getKeywordSuggestions(TBUtilities.GetUrlDecoded(o.trim()));e.showOrHideTopicArea();e.$element.find("#suggestedtagsplugin-radio1").prop("checked",true)}e._loading=true;e.checkForLoading(true)}else{TBGlobal.ShowUpgradePage("add a specific video keyword",TBGlobal.limitation.suggestedTags)}});e.$element.on("change","input[name='suggestedtagsplugin']",function(t,i){if(jQuery(this).val().toLowerCase()=="relevance"){var o=e.$element.find(".tb-suggested-tags-results:first");o.find(".tb-suggested-tag").sort(function(e,t){return jQuery(e).attr("data-priority")-jQuery(t).attr("data-priority")}).appendTo(o)}else{var o=e.$element.find(".tb-suggested-tags-results:first");o.find(".tb-suggested-tag").sort(function(e,t){var i=jQuery(e).find(".tb-suggested-tags-plugin-tag-score-text").attr("data-score");var o=jQuery(t).find(".tb-suggested-tags-plugin-tag-score-text").attr("data-score");if(!i){i=0}else{i=parseInt(i)}if(!o){o=0}else{o=parseInt(o)}return o-i}).appendTo(o)}});e.$element.on("click",".tb-suggested-tags-scores-refresh-scores",function(t,i){e._scoresLoading=true;e._loadScores=false;e.$element.find(".tb-suggested-tags-scores-refresh-scores-container").hide();e.getTagSuggestionScores(e._suggestionsCollection);if(TBGlobal.CanAccessLevel1Tools()===true){e.$element.find(".tb-suggested-tags-button-bar").show();e.$element.find(".tb-suggested-tags-button-container").show()}else{e.$element.find(".tb-suggested-tags-button-container").hide();e.$element.find(".tb-suggested-tags-button-bar").hide()}return false});e.$element.on("click",".tb-suggested-tags-plugin-tag-score-text-empty",function(t,o){var a=jQuery(this).closest(".tb-suggested-tag").attr("data-tag");var s=decodeURIComponent(a);TubeBuddyTagExplorer.ShowTagExplorer(s,this,e._suggestionsInitTags);jQuery(i).one("click","#tb-tag-explorer-close, .tb-tag-explorer-closex",function(){var t=TubeBuddyTagExplorer.GetScore();if(t){e.setTagScore(t,jQuery("#tb-suggested-tags-plugin-tag-score-template").html())}});return false});e.$element.on("click",".tb-suggested-tag",function(t,i){var o=jQuery(this).attr("data-tag");var a=jQuery(this).attr("data-disabled");var s=decodeURIComponent(o);if(s&&a=="false"){var n=[];n.push(s);e.addTagEvent(n);var r=TBUtilities.FixLocalHtml("{PLUGIN_FILE_ROOT}/images/icons/check.png");jQuery(this).find("img").first().attr("src",r);jQuery(this).attr("data-disabled","true")}try{TBUtilities.AddAction({tag:s},TBUtilities.ActionTypes.SuggestedTags_Use,"pluginsuggestedtags")}catch(t){TBUtilities.LogError({Exception:t,Location:"[tb-suggested-tags] [addAction]"})}});e.$element.on("click",".tb-suggested-tags-upgrade-upgrade-link",function(e,t){TBUtilities.Log("suggestedtags tb-suggested-tags-upgrade-upgrade-link click");TBGlobal.ShowUpgradePage(null,TBGlobal.limitation.suggestedTags)});e.$element.on("click",".tb-suggested-tags-plugin-tag-score-container",function(t,i){TBUtilities.Log("suggestedtags tb-suggested-tags-plugin-tag-score-container click");var o=jQuery(this).closest(".tb-suggested-tag");var a=o.attr("data-tag");var s=decodeURIComponent(a);TubeBuddyTagExplorer.ShowTagExplorer(s,this,e._suggestionsInitTags);return false})},unbindEvents:function(){this.$element.off("."+this._name)}});e.fn.suggestedtags=function(t){this.each(function(){if(!e.data(this,"plugin_"+a)){e.data(this,"plugin_"+a,new s(this,t))}});return this};e.fn.suggestedtags.defaults={property:"value",onComplete:null}})(jQuery,window,document);(function(e,t,i,o){var a="tagautocomplete";function s(t,i){this.element=t;this._name=a;this._defaults=e.fn.tagautocomplete.defaults;this._pluginHtml='<div class="tb-tagautocomplete-menu-container tb-font-book" style="display:none;background-color:white;" id="tb-tagautocomplete-menu"><div class="tb-tagautocomplete-header tb-font-book" ><img src="{PLUGIN_FILE_ROOT}/images/branding/icon_large.png" style="height: 16px; vertical-align: middle; margin-right: 2px; border-radius: 50%;" /><span style="vertical-align: middle; font-size: 13px;margin-left:5px;">Related Search Terms</span><div title="close" class="tb-tagautocomplete-header-right"><a class="tb-move-up5 tb-margin-right10" style="vertical-align: middle;text-decoration: none;" target="_blank" href="http://localhost:7265/tools?tool=instasuggest"><i class="small material-icons tb-icon-white tb-icon-help">help_outline</i></a><i class="tb-move-up3 medium material-icons tb-icon-white" data-draggable="false">close</i></div> </div> <div class="tb-tagautocomplete-menu-items"></div> <div class="tb-tagautocomplete-menu-upgrade tb-font-medium"> <div class="tb-tagautocomplete-menu-upgrade-text"><img src="{PLUGIN_FILE_ROOT}/images/icons/lock2.png" style="position:relative; top:3px;" /> Only <span class="tb-tagautocomplete-menu-upgrade-shown"></span> of <span class="tb-tagautocomplete-menu-upgrade-total"></span> total results are shown. <br> Upgrade your license to view them all. <br> <a style="cursor:pointer; font-weight:500; padding:2px 0 5px" class="tb-tagautocomplete-menu-upgrade-upgrade-link tb-font-cbold">UPGRADE NOW!</a></div> <img class="tb-tagautocomplete-menu-upgrade-img" /> </div> <div class="tb-tagautocomplete-footer"> <div class="tb-margin-right-5 tb-margin-top-5" style="text-align:left"> <span> <button class="tb-btn tb-btn-sm tb-btn-success tb-tagautocomplete-tag-explorer">EXPLORE</button> this tag in depth...</span> </div><div style="text-align:left" class="tb-margin-right5 tb-margin-top5"> <span><button class="tb-btn tb-btn-sm tb-btn-primary tb-tagautocomplete-suggested-tags">SUGGEST</button> more tags for this video...</span> </div></div><div style="background-color: #ddd;font-size: 11px;padding: 4px 4px;font-weight: 500;text-align: center;background-color: rgb(240, 240, 240);border-top: solid 1px #ddd;">*   Make sure to only select Tags RELEVANT to this video *</div> </div> ';this.options=e.extend({},this._defaults,i);this.init();this._lastValue;this._timeout=null;this._token=null;this._menuLoaded=false;this._itemHighlighted=false;this._suggestedText=null;this._sticky=false;this._inputSelector=".video-settings-add-tag";if(this.options.inputSelector){this._inputSelector=this.options.inputSelector}}e.extend(s.prototype,{init:function(){this.buildCache();this.bindEvents()},destroy:function(){this.unbindEvents();this.$element.removeData()},buildCache:function(){this.$element=e(this.element);this.randomId=Math.floor(Math.random()*(1e5-1)+1);this.$element.addClass("tb-tagautocomplete-element")},bindEvents:function(){var e=this;e.$element.on("click",".tb-tagautocomplete-tag-explorer",function(t,i){TBUtilities.Log("tagautocomplete tb-tagautocomplete-tag-explorer");e.openTagExplorer.call(e)});e.$element.on("click",".tb-tagautocomplete-menu-upgrade-upgrade-link",function(e,t){TBGlobal.ShowUpgradePage(null,TBGlobal.limitation.instasuggest)});e.$element.on("click",".tb-tagautocomplete-header-right",function(t,i){e.hideMenu.call(e)});jQuery(i).bind("click",function(t){TBUtilities.Log("tagautocomplete document click");var i=jQuery(t.target);if(!i.parents().hasClass("tb-tagautocomplete-menu-container")){e.hideMenu.call(e)}});e.$element.on("click",".tb-tagautocomplete-suggested-tags",function(t,i){TBUtilities.Log("tagautocomplete tb-tagautocomplete-suggested-tags click");e.openSuggestedTags.call(e)});e.$element.on("mouseover",".tb-tagautocomplete-menu-item",function(t,i){TBUtilities.Log("tagautocomplete tb-tagautocomplete-menu-item hover");e.$element.find(".tb-tagautocomplete-menu-item").removeClass("tb-tagautocomplete-menu-item-highlight");jQuery(this).addClass("tb-tagautocomplete-menu-item-highlight")});e.$element.on("click",".tb-tagautocomplete-menu-item",function(t,i){TBUtilities.Log("tagautocomplete tb-tagautocomplete-menu-item click");e._sticky=true;e.addTag.call(e,jQuery(this))});e.$element.on("keydown",e._inputSelector,function(t,i){try{clearTimeout(this._timeout);if(t.which==40||t.which==38){if(e._menuLoaded==true){e.highlightSuggestion.call(e,t.which==40)}}if(t.which==13||t.which==9){if(t.which==13&&e._menuLoaded==true&&e._itemHighlighted==true){if(e.options.tagAddSender){tagAddSender.closest(e._inputSelector).val("")}else{e.$element.find(e._inputSelector).val("")}e.addHighlightedSuggestion.call(e);t.preventDefault();t.stopPropagation();return false}else{e.hideMenu.call(e)}}if(t.which==27){e.hideMenu.call()}this._timeout=setTimeout(function(){var i=e.$element.find(e._inputSelector).val();if(e._menuLoaded==false||i!=e._suggestedText){var o=e.validateInput.call(e,i);if(o===true){e.getSuggestions.call(e,i,t)}else{e.hideMenu.call()}}},500);return true}catch(e){TBUtilities.LogError(e)}})},openSuggestedTags:function(){TBUtilities.Log("tagautocomplete openSuggestedTags");this._sticky=false;if(this.options.openSuggestedTags&&this.options.tagAddSender){this.options.openSuggestedTags(this.options.tagAddSender)}else{this.options.openSuggestedTags()}this.hideMenu()},openTagExplorer:function(){TBUtilities.Log("tagautocomplete openTagExplorer");this._sticky=false;if(this.options.openTagExplorer&&this.options.tagAddSender){this.options.openTagExplorer(this._suggestedText,this.options.tagAddSender)}else{this.options.openTagExplorer(this._suggestedText)}this.hideMenu()},addTag:function(e){TBUtilities.Log("tagautocomplete addTag");try{var t=e.attr("data-tag");var i=e.attr("data-disabled");var o=decodeURI(t);if(o&&i=="false"){var a=[];a.push(o);if(this.options.tagAddSender){this.options.onTagsAdd(this.options.tagAddSender,a,this._suggestedText)}else{this.options.onTagsAdd(a,this._suggestedText)}try{TBUtilities.AddAction({tag:o},TBUtilities.ActionTypes.InstaSuggest_Use,"instasuggest")}catch(e){TBUtilities.LogError({Exception:e,Location:"[tagautocomplete] [addAction]"})}var s=TBUtilities.FixLocalHtml("{PLUGIN_FILE_ROOT}/images/icons/check.png");e.find("img").attr("src",s);e.attr("data-disabled","true")}}catch(e){TBUtilities.LogError(e)}finally{if(this._sticky==false){this.hideMenu()}}},addHighlightedSuggestion:function(){TBUtilities.Log("tagautocomplete addHighlightedSuggestion");this._sticky=false;var e=this.$element.find(".tb-tagautocomplete-menu-item.tb-tagautocomplete-menu-item-highlight").first();if(e.length>0){this.addTag(e)}},highlightSuggestion:function(e){TBUtilities.Log("tagautocomplete highlightSuggestion");this._itemHighlighted=true;var t=this.$element.find(".tb-tagautocomplete-menu-item.tb-tagautocomplete-menu-item-highlight");if(t.length>0){var i=null;if(e===true){i=t.nextAll(".tb-tagautocomplete-menu-item:first")}else{i=t.prevAll(".tb-tagautocomplete-menu-item:first")}this.$element.find(".tb-tagautocomplete-menu-item").removeClass("tb-tagautocomplete-menu-item-highlight");i.addClass("tb-tagautocomplete-menu-item-highlight");i.focus()}else{var o=this.$element.find(".tb-tagautocomplete-menu-item:not(.tb-tagautocomplete-menu-item-highlight)").first();this.$element.find(".tb-tagautocomplete-menu-item").removeClass("tb-tagautocomplete-menu-item-highlight");o.addClass("tb-tagautocomplete-menu-item-highlight");o.focus()}},getSuggestions:function(e,t){TBUtilities.Log("tagautocomplete getSuggestions");this._suggestedText=e;this._menuLoaded=true;var i=this;if(this._token==null){var o=jQuery("body")[0].outerHTML;var a=o.indexOf('PSUGGEST_TOKEN":"')+'PSUGGEST_TOKEN":"'.length;var s=o.indexOf('"',a);var n=o.substring(a,s);if(n.length==22){this._token=n}}TubeBuddyYouTubeActions.GetYouTubeAutoComplete(this._token,e,function(o){if(o&&o.length>0){i.showMenu(e,o,t)}else{i.hideMenu()}})},showMenu:function(e,t,i){try{var o=this;this._sticky=false;TBUtilities.Log("tagautocomplete showMenu");if(this.$element.find("#tb-tagautocomplete-menu").length==0){var a=TBUtilities.FixLocalHtml(DOMPurify.sanitize(this._pluginHtml,DOMPurifyConfig));var s=jQuery(a);this.$element.append(s)}var n=jQuery(".tb-tagautocomplete-menu-items");n.empty();var r=0;jQuery.each(t,function(t,i){if(TBGlobal.CanAccessLevel1Tools()==true||TBGlobal.CanAccessLevel1Tools()==false&&r<3){r++;var a=o.unbold(i,e);var s="<span title='add tag' class='tb-tagautocomplete-menu-item tb-tagautocomplete-tag' data-disabled='false' data-tag="+encodeURI(i)+"><img class='tb-tagautocomplete-menu-item-image' src='{PLUGIN_FILE_ROOT}/images/icons/add2.png'/> <span class='tb-tagautocomplete-menu-item-text'>"+a+"</span></span></br>";var l=TBUtilities.FixLocalHtml(s);n.append(l)}});this.$element.find(".tb-tagautocomplete-menu-upgrade-shown").text(r);this.$element.find(".tb-tagautocomplete-menu-upgrade-total").text(t.length);if(r<3){this.$element.find(".tb-tagautocomplete-menu-upgrade").hide()}else if(TBGlobal.CanAccessLevel1Tools()==false){var l="{PLUGIN_FILE_ROOT}/images/screenshots/instasuggestblur.png";l=TBUtilities.FixLocalHtml(l);this.$element.find(".tb-tagautocomplete-menu-upgrade").find(".tb-tagautocomplete-menu-upgrade-img").attr("src",l);this.$element.find(".tb-tagautocomplete-menu-upgrade").show()}var u=this.$element.find("#tb-tagautocomplete-menu");var d=this.$element.find(o._inputSelector);var c=jQuery(d).position();var p=0;var b=0;var h=c.left+p-b+"px";var m=30+c.top+"px";u.css({position:"absolute",zIndex:1e4,left:h,top:m});if(u.is(":visible")==false){u.hide().fadeIn()}}catch(e){TBUtilities.LogError(e)}},hideMenu:function(e,t,i){TBUtilities.Log("tagautocomplete hideMenu");this._itemHighlighted=false;this._menuLoaded=false;var o=jQuery(".tb-tagautocomplete-menu-container");o.hide()},unbold:function(e,t){var i=new RegExp(t,"g");return e.replace(i,'<span style="font-weight:normal !important">'+t+"</span>")},validateInput:function(e){var t=false;if(e&&e.length>=2){t=true}return t},unbindEvents:function(){this.$element.off("."+this._name)}});e.fn.tagautocomplete=function(t){this.each(function(){if(!e.data(this,"plugin_"+a)){e.data(this,"plugin_"+a,new s(this,t))}});return this};e.fn.tagautocomplete.defaults={property:"value",onComplete:null}})(jQuery,window,document);(function(e,t,o,a){var s="playlistSelect";function n(t,i){this.element=t;this._name=s;this._defaults=e.fn.playlistSelect.defaults;this._pluginHtml='<dl class="playlistSelect"> <dt style="width:550px"> <span class="playlistSelectSelectTypeContainer" style="font-size:11px;float:right;margin-right:130px"> <span style="position:relative; top:3px;"> <input disabled type="radio" name="playlistSelectType" value="list" class="playlistSelectTypeList" style="position:relative; top:2px; left:2px;" checked="checked" />List &nbsp; <input type="radio" name="playlistSelectType" disabled value="manual" class="playlistSelectTypeManual" style="position:relative; top:2px; left:2px;" />Manual Entry </span> </span> <input type="text" style="margin-left: 15px; margin-top: 5px; width: 400px; display:none;" class="playlistSelectManualIds" disabled="disabled" /> <input class="playlistSelectInput" disabled="true" readonly style="margin-left: 15px; margin-top: 5px; width: 400px; cursor:pointer;" value="" type="text" /> <span class="playlistSelectCount"></span> </dt> <dd> <div class="playlistSelectMutliSelect"> <div class="playlistSelectMutliSelectLoading"><span>Loading Playlists...</span></div> <div class="playlistSelectMutliSelectContainer"> <ul> </ul> </div> <div class="playlistSelectMutliSelectNoPlaylists"> No Playlists found </div> </div> </dd> </dl>';this._pluginHtmlMaterial='<div class="playlistSelect tb-width400"><div class="playlistSelectSelectTypeContainer" style="display: flex; flex-direction:row;justify-content: flex-end;"><div class="tb-material-radio-container tb-font-size12"><input disabled type="radio" name="playlistSelectType" value="list" id="playlist-select-type-list" class="playlistSelectTypeList tb-material-radio" checked="checked" /><label for="playlist-select-type-list" class="tb-material-radio-label">List</label></div><div class="tb-material-radio-container tb-font-size12"><input type="radio" name="playlistSelectType" disabled value="manual" id="playlist-select-type-manual" class="playlistSelectTypeManual tb-material-radio" /><label for="playlist-select-type-manual"class="tb-material-radio-label">Manual Entry</label></div></div><div><input type="text" style="width: 400px; display:none;" class="playlistSelectManualIds tb-input-textfield" disabled="disabled" placeholder="Playlist ID" /><span id="tb-playlist-select-manual-id-invalid" style="display:none; color:red; font-size:11px">Please enter a valid Playlist ID</span><input class="playlistSelectInput tb-input-textfield" disabled="disabled" readonly style="width: 400px; cursor:pointer;" value="" type="text" /><span class="playlistSelectCount"></span><div class="playlistSelectMutliSelect"> <div class="playlistSelectMutliSelectLoading"><span>Loading Playlists...</span></div> <div class="playlistSelectMutliSelectContainer"> <ul> </ul> </div> <div class="playlistSelectMutliSelectNoPlaylists"> No Playlists found </div> </div></div></div>';this.options=e.extend({},this._defaults,i);this.init()}e.extend(n.prototype,{init:function(){this.buildCache();this.populateHtml();this.bindEvents()},destroy:function(){this.unbindEvents();this.$element.removeData()},buildCache:function(){this.$element=e(this.element);this.playlistsLoaded=false;this.playlists=[];this.selectedPlaylistIds=[];this.randomId=Math.floor(Math.random()*(1e5-1)+1);if(this.options.singleSelectMode){this.singleSelectMode=this.options.singleSelectMode}else{this.singleSelectMode=false}if(this.options.width){this.width=this.options.width;this.$element.css("width",this.options.width+"px")}if(this.options.tbMaterial){this.tbMaterial=true}},bindEvents:function(){var e=this;e.$element.on("click",".playlistSelectInput",function(){e.showDropDown.call(e)});e.$element.on("click",'.playlistSelectMutliSelectContainer input[type="checkbox"]',function(t){var i=jQuery(this);t.stopPropagation();e.playlistClicked.call(e,i)});e.$element.on("click",'.playlistSelectMutliSelectContainer input[type="radio"]',function(t){var i=jQuery(this);t.stopPropagation();e.playlistClicked.call(e,i)});jQuery(o.body).on("TBGetChannelPlaylists"+e.randomId,function(t,i){if(i.success){var o=jQuery.parseJSON(i.response);e.loadPlaylists.call(e,o)}});jQuery(o).bind("click",function(t){var i=jQuery(t.target);if(!i.parents().hasClass("playlistSelect")){e.hideDropDown.call(e)}});e.$element.on("change",".playlistSelectTypeList",function(t){t.stopPropagation();if(jQuery(this).is(":checked")){e.listSelected.call(e)}});e.$element.on("change",".playlistSelectTypeManual",function(t){t.stopPropagation();if(jQuery(this).is(":checked")){e.manualSelected.call(e)}})},populateHtml:function(){if(this.options.tbMaterial){this.$element.append(DOMPurify.sanitize(this._pluginHtmlMaterial,DOMPurifyConfig))}else{this.$element.append(DOMPurify.sanitize(this._pluginHtml,DOMPurifyConfig))}var e=Math.floor(Math.random()*1e5);var t=this.$element.find(".playlistSelectSelectTypeContainer");t.find("input").each(function(){jQuery(this).attr("name",e);jQuery(this).attr("id",jQuery(this).attr("id")+"-"+e)});t.find("label").each(function(){jQuery(this).attr("for",jQuery(this).attr("for")+"-"+e)})},unbindEvents:function(){this.$element.off("."+this._name)},listSelected:function(){this.$element.find(".playlistSelectManualIds").val("");this.$element.find(".playlistSelectInput").show();this.$element.find(".playlistSelectManualIds").hide();this.$element.find(".playlistSelectCount").show()},manualSelected:function(){this.selectedPlaylistIds=[];this.$element.find(".playlistSelectInput").val("");this.$element.find(".playlistSelectInput").attr("placeholder","Click here to select Playlists...");this.$element.find(".playlistSelectCount").text("");this.$element.find('.playlistSelectMutliSelectContainer input[type = "checkbox"]').prop("checked",false);this.$element.find(".playlistSelectInput").hide();this.$element.find(".playlistSelectManualIds").show();this.$element.find(".playlistSelectCount").hide();this.$element.find(".playlistSelectMutliSelect").hide();this.$element.find(".playlistSelectTypeManual").prop("checked",true)},playlistClicked:function(t){var o=t.val();var s=t.next().text();if(t.is(":checked")){if(this.singleSelectMode==false){if(this.selectedPlaylistIds.indexOf(o)===-1){this.selectedPlaylistIds.push(o)}}else{this.selectedPlaylistIds=[];this.selectedPlaylistIds.push(o)}}else{var n=this.selectedPlaylistIds.indexOf(o);if(n>-1){this.selectedPlaylistIds.splice(n,1)}}if(this.selectedPlaylistIds.length==0){this.$element.find(".playlistSelectInput").val("");this.$element.find(".playlistSelectInput").attr("placeholder","Click here to select Playlists...");this.$element.find(".playlistSelectCount").text("")}else{var r=this.selectedPlaylistIds.length;var l=" Playlist";if(r>1){l+="s"}var u=this.$element.find(".playlistSelectCount");u.css("color","green");u.text(r+l+" selected");var d=[];for(i=0;i<this.selectedPlaylistIds.length;i++){var o=this.selectedPlaylistIds[i];var c=e.grep(this.playlists,function(e){return e.Id===o});if(c[0]){d.push(c[0].Title)}}this.$element.find(".playlistSelectInput").val(d.join(", "))}if(this.singleSelectMode==true){if(this.options.onSelect!==a){this.options.onSelect(this.selectedPlaylistIds.join(","))}this.hideDropDown()}},showDropDown:function(){if(this.$element.find(".playlistSelectTypeManual").is(":checked")==true)return;this.$element.find(".playlistSelectMutliSelectLoading").show();this.$element.find(".playlistSelectMutliSelectContainer").hide();this.$element.find(".playlistSelectMutliSelectNoPlaylists").hide();if(this.selectedPlaylistIds.length==0){this.$element.find(".playlistSelectInput").attr("placeholder","Click here to select playlists...");this.$element.find(".playlistSelectCount").text("")}var e=this.$element.position();var t=this.$element.find(".playlistSelectMutliSelect");var i=parseInt(this.$element.css("marginLeft"),10);var o="450px";if(this.width){o=this.width+30+"px"}t.css({position:"absolute",top:e.top+55+"px",left:e.left+i+"px",zIndex:1500,width:o});t.slideToggle("fast");if(this.playlistsLoaded==false){this.playlistsLoaded=true;var a=TBGlobal.host+TBGlobal.apiUrls.youtubeApiGetChannelPlaylists;TBExtension.Get(a,"TBGetChannelPlaylists"+this.randomId)}else{if(this.playlists.length>0){this.$element.find(".playlistSelectMutliSelectLoading").hide();this.$element.find(".playlistSelectMutliSelectContainer").show();this.$element.find(".playlistSelectMutliSelectNoPlaylists").hide()}else{this.$element.find(".playlistSelectMutliSelectLoading").hide();this.$element.find(".playlistSelectMutliSelectContainer").hide();this.$element.find(".playlistSelectMutliSelectNoPlaylists").show()}}},hideDropDown:function(){this.$element.find(".playlistSelectMutliSelect").hide()},loadPlaylists:function(e){this.playlists=e;if(this.playlists.length>0){var t=this.$element.find(".playlistSelectMutliSelectContainer").find("ul");var i=this.randomId;var o="";var a=this.singleSelectMode;var s=this.options.tbMaterial;var n=TBGlobal.host+"/images/icons/external.png";jQuery.each(this.playlists,function(e,t){if(!s){var r="";if(a==true){r='<input class="tb-move-down2 tb-margin-right5" type="radio" name="tbplaylists" value="'+t.Id+'" />'}else{r='<input class="tb-move-down2 tb-margin-right5" type="checkbox" value="'+t.Id+'" />'}var l='<li class="playlistSelectMutliSelectListItem">'+r+"<span>"+t.Title+'</span><a target="_blank" class="tb-margin-left5" href=https://www.youtube.com/playlist?list='+t.Id+"><img src="+n+"></a></li>";o+=l}else{var u="";if(a==true){u='<li class="playlistSelectMutliSelectListItem"><div class="tb-material-radio-container"><input id="tb-playlist-id-'+t.Id+"-"+i+'" type="radio" value="'+t.Id+'" name="tbplaylists" class="tb-material-radio"><label for="tb-playlist-id-'+t.Id+"-"+i+'" class="tb-material-radio-label" style="display:flex; align-items:center;">'+t.Title+'<a class="tb-cursor-pointer tb-margin-left5" href="https://www.youtube.com/playlist?list='+t.Id+'"  target="_blank" style="color:rgb(68, 68, 68);;"><i class="material-icons tb-font-size14">open_in_new</i></a></label></div></li>'}else{u='<li class="playlistSelectMutliSelectListItem"><div class="tb-material-checkbox-container"><label class="tb-material-checkbox-label"><input type="checkbox" class="tb-material-checkbox-input" value="'+t.Id+'"><span class="tb-material-checkbox-box" style="width: 12px; height: 12px;"><span class="tb-material-checkbox-check" style="width: 12px; height: 12px;"></span></span><span class="tb-margin-left5" style="font-weight:500;">'+t.Title+'</span><a class="tb-cursor-pointer tb-margin-left5" href="https://www.youtube.com/playlist?list='+t.Id+'"  target="_blank" style="color:rgb(68, 68, 68);"><i class="material-icons tb-font-size14">open_in_new</i></a></label></div></li>'}o+=u}});this.$element.find(".playlistSelectMutliSelectLoading").hide();this.$element.find(".playlistSelectMutliSelectContainer").append(o);this.$element.find(".playlistSelectMutliSelectContainer").show();this.$element.find(".playlistSelectMutliSelectNoPlaylists").hide()}else{this.$element.find(".playlistSelectMutliSelectLoading").hide();this.$element.find(".playlistSelectMutliSelectContainer").hide();this.$element.find(".playlistSelectMutliSelectNoPlaylists").show()}},enable:function(){this.$element.find(".playlistSelectInput").prop("disabled",false);this.$element.find(".playlistSelectManualIds").prop("disabled",false);this.$element.find(".playlistSelectSelectTypeContainer").find("input").prop("disabled",false);this.showDropDown()},disable:function(){this.$element.find(".playlistSelectInput").prop("disabled",true);this.$element.find(".playlistSelectManualIds").prop("disabled",false);this.selectedPlaylistIds=[];this.$element.find(".playlistSelectCount").text("");this.$element.find(".playlistSelectInput").val("");this.$element.find('.playlistSelectMutliSelectContainer input[type = "checkbox"]').prop("checked",false);this.$element.find(".playlistSelectInput").attr("placeholder","");this.$element.find(".playlistSelectCount").text("");this.$element.find(".playlistSelectSelectTypeContainer").find("input").prop("disabled",true);this.hideDropDown()},getSelectedPlaylistIds:function(){if(this.$element.find(".playlistSelectTypeList").is(":checked"))return this.selectedPlaylistIds;else{var e=[];if(this.$element.find(".playlistSelectManualIds").val()){var t=this.$element.find(".playlistSelectManualIds").val().replace(/\s/g,"");if(t.indexOf("http")==-1){e=t.split(",")}else{var i=new URL(t);var o=i.searchParams.get("list");e.push(o)}}return e}},getSelectedPlaylists:function(){var e=[];var t=this.getSelectedPlaylistIds();var i=this.playlists;if(t&&t.length>0){jQuery.each(t,function(t,o){jQuery.each(i,function(t,i){if(i.Id===o){e.push(i)}})})}return e},showValidationWarning:function(){var e=this.$element.find(".playlistSelectCount");e.text("Playlist required");e.css("color","red")},setIds:function(e){this.enable();this.manualSelected();this.$element.find(".playlistSelectManualIds").val(e)}});e.fn.playlistSelect=function(t){this.each(function(){if(!e.data(this,"plugin_"+s)){e.data(this,"plugin_"+s,new n(this,t))}});return this};e.fn.playlistSelect.defaults={property:"value",onComplete:null}})(jQuery,window,document);var TubeBuddyDemonetizationChecker=function(){var e=false;var t=false;var i=false;var o={apiKey:"",userId:"",clientId:"",pageId:""};var a=[];var s=0;var n={startingIndex:0,totalItems:0,totalCopyright:0,totalMonetized:0,totalNotMonetized:0,totalAdsNotShowingReviewed:0,totalAdsNotShowingNotReviewed:0,totalUnknown:0,showInList:7,currentPage:1,max:9999,cookie:{url:"https://www.youtube.com/my_videos?o=U&vmo=lona&ls=LIMITED_OR_NO_ADS"+TBGlobal.ClassicForceParam(),videos:[],page:0},isFetching:false,startPage:1,currentlUrl:"",onPage:1,startingUrl:"",isLoadingPlaylists:false,cancelled:false};var r=function(){if(jQuery("#tb-bulk-menu").length>0){jQuery(".tb-videos-bulk-list-dropdown").after(jQuery(".tb-trigger-demon-checker")[0].outerHTML);jQuery("#bt-dc-upgrade").attr("href",TBGlobal.host+"/account/upgrade?channelId="+TBGlobal.CurrentChannelId())}else{setTimeout(r,200)}};var l=function(){var e=TBGlobal.host+"/ModuleManager/demonetizationchecker/demonetizationchecker?v="+TBGlobal.versionNumber;if(loadLocalHTML&&(TBExtension.GetType()==="chrome"||TBExtension.GetType()==="firefox")){e=chrome.extension.getURL("modules/demonetizationchecker.html")}else if(loadLocalHTML&&TBExtension.GetType()==="safari"){e="modules/demonetizationchecker.html"}TBExtension.Get(e,"CRTBLoadTubeBuddyDemonetizationCheckerTemplate")};var u=function(){var e="https://studio.youtube.com/youtubei/v1/creator/list_creator_videos?alt=json&key="+o.apiKey;var t='{"filter":{"channelIdIs":{"value":"'+TBGlobal.CurrentChannelId()+'"}},"order":"VIDEO_ORDER_DISPLAY_TIME_DESC","pageSize":30,"mask":{"channelId":true,"videoId":true,"colorPalette":{"all":true},"claimDetails":{"all":true},"lengthSeconds":true,"status":true,"thumbnailDetails":{"all":true},"title":true,"uploadProgress":{"all":true},"timeCreatedSeconds":true,"timePublishedSeconds":true,"permissions":{"all":true},"metrics":{"all":true},"responseStatus":{"all":true},"selfCertification":{"all":true},"description":true,"privacy":true,"watchUrl":true,"downloadUrl":true,"scheduledPublishingDetails":{"all":true},"draftStatus":true,"statusDetails":{"all":true},"monetizationDetails":{"all":true}},"context":{"client":{"clientName":'+o.clientId+',"clientVersion":"creator_latest","hl":"en","gl":"US","experimentIds":[]},"request":{"returnLogEntry":true,"internalExperimentFlags":[{"key":"restudio_onboarding","value":"true"},{"key":"restudio_banners","value":"true"},{"key":"log_window_onerror_fraction","value":"1"},{"key":"log_js_exceptions_fraction","value":"1"},{"key":"restudio_hats","value":"true"},{"key":"json_serialize_service_endpoints2","value":"true"},{"key":"restudio_scheduled_publishing","value":"true"},{"key":"json_serialize_shut_off2","value":"false"},{"key":"analytics_snowball","value":"false"},{"key":"restudio_thumbnails","value":"false"},{"key":"restudio","value":"false"},{"key":"analytics_deep_dive_view","value":"true"},{"key":"content_owner_delegation","value":"false"},{"key":"restudio_upload_link","value":"true"},{"key":"restudio_comments","value":"true"}]},"user":{"onBehalfOfUser":"'+o.userId+'"}}}';TBExtension.Post(e,t,function(e,t,i){alert(i)})};var d=function(){var e="https://studio.youtube.com/channel/"+TBGlobal.CurrentChannelId()+"/videos";TBExtension.Get(e,function(e,t,i){if(e){var a=i.indexOf('"INNERTUBE_API_KEY":"')+'"INNERTUBE_API_KEY":"'.length;var s=i.indexOf('"',a);o.apiKey=i.substring(a,s);a=i.indexOf('"DELEGATED_SESSION_ID":"')+'"DELEGATED_SESSION_ID":"'.length;s=i.indexOf('"',a);o.userId=i.substring(a,s);a=i.indexOf('"INNERTUBE_CONTEXT_CLIENT_NAME":')+'"INNERTUBE_CONTEXT_CLIENT_NAME":'.length;s=i.indexOf(",",a);o.clientId=i.substring(a,s);u()}})};var c=function(){n.isFetching=true;if(n.cookie.url.indexOf("pi=")===-1){n.cookie.url+="&pi=1"}else{n.cookie.url=TBUtilities.ReplaceAll(n.cookie.url,"pi="+n.cookie.page,"pi="+(parseInt(n.cookie.page)+1))}n.cookie.page=parseInt(n.cookie.page)+1;TBUtilities.Log("Next: "+n.cookie.url);n.currentlUrl=n.cookie.url;n.onPage=n.cookie.page;TBExtension.Get(n.cookie.url,function(e,t,i){var o=i;var a=o.indexOf("VIDEO_LIST_DISPLAY_OBJECT");if(o.indexOf("<title>YouTube Studio</title>")>0){TBUtilities.Alert("Sorry, this feature does not work if Studio Beta is set as your Default mode in YouTube.<br><p> We are working on updating TubeBuddy to work in this mode.</p><br><p> In the meantime, you can restore Creator Studio Classic by clicking the button on the bottom left hand corner of this page. </p>");n.isFetching=false;jQuery("#tb-dc-processing").hide();jQuery("#tb-dc-close").css("visibility","visible");return}var s=0;var r=0;while(o.indexOf("data-video-id",a)>-1&&a>s){if(a>s)s=a;var l=o.indexOf("data-video-id",a)+"data-video-id".length+3;var u=o.substring(l,l+11);if(u=="__VIDEO_ID"||u=='"__VIDEO_ID'){}else{var d=o.indexOf("vm-video-item-content-horizontal-divider",a+5);var p=o.indexOf("vm-video-title-content",l);p=o.indexOf("data-sessionlink=",p);p=o.indexOf("u003e",p)+"u003e".length;var b=o.indexOf("u003c",p)-1;var h=o.substring(p,b);if(!h)h="";h=h.trim();var m="";var f=o.indexOf("vm-private",a);var y=o.substring(f,f+25).indexOf("hid")==-1;var g=o.indexOf("yt-thumb-clip",a);g=o.indexOf("https",g);var v=o.indexOf('"',g)-1;var T=o.substring(g,v);T=TBUtilities.ReplaceAll(T,"\\/","\\");T=TBUtilities.ReplaceAll(T,"\\u0026amp;","&");m=T;var j="";var Q=o.indexOf("vm-video-copyright-link",a);if(Q>10&&Q<d){var w=o.indexOf('class=\\"',Q)+'class=\\"'.length;var k=o.indexOf(" ",w);j=o.substring(w,k);TBUtilities.Log("COPYRIGHT: "+j)}var B="";var C=o.indexOf("vm-video-monetization-link",a);w=o.indexOf('class=\\"',C)+'class=\\"'.length;k=o.indexOf(" ",w);var x=o.indexOf('"',w);var S=w;if(x<w)S=x;B=o.substring(w,k);TBUtilities.Log(B);if(B=="vm-video-monetization-limited-or-no-ads"){TBUtilities.Log("in");var L=o.indexOf("vm-video-side-notification-text-item",a);if(L>-1){var _=o.indexOf("\\u003ca",L);TBUtilities.Log(_+" --\x3e  "+d);if(_>d){B="vm-video-monetization-limited-or-no-ads-reviewed"}else{var I=o.indexOf("appeal_policy",a);if(I>0&&I<d){B="vm-video-monetization-limited-or-no-ads-reviewed"}}}}a=o.indexOf("vm-video-item-content-horizontal-divider",a+5);if(j){n.totalCopyright++}else if(B){switch(B){case"vm-video-monetization-limited-or-no-ads":n.totalAdsNotShowingNotReviewed++;var U='<div style="padding-bottom:10px;"> <i class="material-icons tb-dc-video-failed'+u+'" style="display:none; color:red; margin-left:4px; margin-right:5px;" data-video-id="'+u+'">close</i><i class="material-icons tb-dc-video-submitted'+u+'" style="display:none; color:green; margin-right:5px; margin-left:4px;" data-video-id="'+u+'">check</i><input type="checkbox" class="tb-demon-review-check tb-dc-video-waiting'+u+'" checked="checked" data-video-id="'+u+'" style="vertical-align:center" /> <img src="'+m+'" style="height:25px; position:relative; top:5px; " /> <a style="width:300px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; display:inline-block; font-size:.8em;" href="https://www.youtube.com/edit?o=U&show_mt=1&video_id='+u+'">'+h+"</a> </div>";jQuery("#tb-dc-no-ads-list").append(U);break;case"vm-video-monetized":n.totalMonetized++;break;case"vm-video-not-monetized":n.totalNotMonetized++;break;case"vm-video-monetization-limited-or-no-ads-reviewed":n.totalAdsNotShowingReviewed++;break}}else{n.totalUnknown++}var E=TBUtilities.GetInArray(n.cookie.videos,"v",u);if(!E&&h&&h!=="\\n\\n"){n.cookie.videos.push({v:u,t:h,i:m,u:n.currentlUrl,p:n.onPage,c:j,m:B});n.totalItems++;r++}}}n.totalItems=n.totalAdsNotShowingReviewed+n.totalAdsNotShowingNotReviewed;jQuery("#tb-dc-videos-searched").attr("data-auto-count",n.totalItems);TBUtilities.AutoIncrementCount(jQuery("#tb-dc-videos-searched"),50);jQuery("#tb-dc-videos-monetized").attr("data-auto-count",n.totalMonetized);TBUtilities.AutoIncrementCount(jQuery("#tb-dc-videos-monetized"),50);jQuery("#tb-dc-videos-copyright").attr("data-auto-count",n.totalCopyright);TBUtilities.AutoIncrementCount(jQuery("#tb-dc-videos-copyright"),50);jQuery("#tb-dc-videos-not-monetized").attr("data-auto-count",n.totalNotMonetized);TBUtilities.AutoIncrementCount(jQuery("#tb-dc-videos-not-monetized"),50);jQuery("#tb-dc-videos-limited-or-no-ads-reviewed").attr("data-auto-count",n.totalAdsNotShowingReviewed);TBUtilities.AutoIncrementCount(jQuery("#tb-dc-videos-limited-or-no-ads-reviewed"),50);jQuery("#tb-dc-videos-limited-or-no-ads-note-reviewed").attr("data-auto-count",n.totalAdsNotShowingNotReviewed);TBUtilities.AutoIncrementCount(jQuery("#tb-dc-videos-limited-or-no-ads-note-reviewed"),50);jQuery("#tb-dc-no-ads-checked").text(n.totalAdsNotShowingNotReviewed);jQuery("#tb-dc-videos-unkown").attr("data-auto-count",n.totalUnknown);TBUtilities.AutoIncrementCount(jQuery("#tb-dc-videos-unkown"),50);if(n.totalAdsNotShowingNotReviewed>0){if(TBGlobal.CanAccessLevel2Tools()){jQuery("#tb-dc-no-ads-list-container").show()}}if(r==0||n.cancelled){n.isFetching=false;jQuery("#tb-dc-processing").hide();jQuery("#tb-dc-close").css("visibility","visible");if(n.totalAdsNotShowingNotReviewed>0){jQuery("#tb-demon-checker-review-container").slideDown();if(!TBGlobal.CanAccessLevel2Tools()){jQuery("#tb-dc-no-ads-list-container-no").show()}}else{jQuery("#tb-dc-no-ads-list-container-empty").slideDown()}n.max=n.totalItems}else{TBUtilities.Log("FETCHING MORE!");c()}})};var p=function(){TBUtilities.Log("processNextItem");jQuery("#tb-dc-processing-message").text("Processing Video "+(s+1)+" of "+a.length);TBUtilities.Log("currentItemIndex "+s);var e=a[s];s++;var t="https://www.youtube.com/edit?o=U&show_mt=1&video_id="+e;TBUtilities.Log("url: "+t);TBExtension.Get(t,function(t,i,o){TBUtilities.Log("success: "+t);TBUtilities.Log("result: "+o);var r=o.indexOf("XSRF_TOKEN")+"XSRF_TOKEN".length+2;TBUtilities.Log("start: "+r);r=o.indexOf('"',r)+1;var l=o.indexOf('"',r+5);var u=o.substring(r,l);u=TBUtilities.ReplaceAll(u,"=","%3D");TBUtilities.Log("token: "+u);var d="https://www.youtube.com/metadata_ajax?video_id="+e+"&action_create_ad_friendly_appeal=1";var c="encrypted_video_id="+e+"&session_token="+u;TBUtilities.Log("postUrl: "+d);TBUtilities.Log("postData: "+c);TBExtension.Post(d,c,function(t,i,o){TBUtilities.Log("success2: "+t);TBUtilities.Log("result2: "+o);TBUtilities.Log("currentItemIndex: "+s);TBUtilities.Log("itemsToProcess.length: "+a.length);if(t&&o.length<30)jQuery(".tb-dc-video-submitted"+e).show();else{jQuery(".tb-dc-video-failed"+e).attr("onclick",'alert("'+o+'");');jQuery(".tb-dc-video-failed"+e).show()}jQuery(".tb-dc-video-waiting"+e).hide();if(s==a.length||n.cancelled){jQuery("#tb-dc-processing").fadeOut(500,function(){jQuery("#tb-dc-complete").show();jQuery("#tb-dc-close").css("visibility","visible")})}else{p()}},null,{contentType:"application/x-www-form-urlencoded; charset=UTF-8"})})};var b=function(){jQuery(document).on("click",".tb-demon-checker-closex",function(){jQuery("#tb-demon-checker-container").hide();TubeBuddyMenu.HideBackground()});jQuery(document).on("change",".tb-demon-review-check",function(){if(n.isFetching)return;var e=jQuery(".tb-demon-review-check:checked").length;if(e>0){jQuery("#tb-dc-no-ads-checked").text(e);if(!jQuery("#tb-demon-checker-review-container").is(":visible"))jQuery("#tb-demon-checker-review-container").slideDown()}else{jQuery("#tb-demon-checker-review-container").slideUp()}});jQuery(document).on("click","#tb-demon-checker-start",function(){jQuery("#tb-demon-checker-welcome").fadeOut(250,function(){jQuery("#tb-demon-checker-status").fadeIn(500,function(){jQuery("#tb-dc-processing").fadeIn();jQuery("#tb-dc-cancel-process").fadeIn();jQuery("#tb-dc-close").css("visibility","hidden");c()})})});jQuery(document).on("click","#tb-dc-cancel-process",function(){n.cancelled=true;jQuery(this).hide();jQuery("#tb-dc-processing").hide();jQuery("#tb-dc-close").css("visibility","visible")});jQuery(document).on("click","#tb-demon-checker-review",function(){jQuery(".tb-demon-review-check:checked:visible").each(function(){TBUtilities.Log("Adding Video: "+jQuery(this).attr("data-video-id"));var e=jQuery(this).attr("data-video-id");a.push(e)});jQuery(".tb-demon-review-check").prop("disabled",true);jQuery("#tb-demon-checker-review-container").slideUp(500,function(){s=0;jQuery("#tb-dc-processing").fadeIn();p()})});jQuery(document).on("click",".tb-trigger-demon-checker",function(){TubeBuddyMenu.ShowBackgroundSticky();h()})};var h=function(){jQuery("#tb-demon-checker-container").show()};var m=function(){jQuery(document.body).on("CRTBLoadTubeBuddyDemonetizationCheckerTemplate",function(e,i){try{if(i.success){i.response=TBUtilities.FixLocalHtml(DOMPurify.sanitize(i.response,DOMPurifyConfig));jQuery("body").append(i.response);r();if(!t)jQuery("div.tb-trigger-demon-checker").css("display","inline")}else{}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyTubeBuddyDemonetizationChecker] CRTBLoadTubeBuddyDemonetizationCheckerTemplate"})}})};return{Initialize:function(i){if(TBGlobal.IsAuthenticated()){if(!e){t=i;m();l();b();e=true}else{r()}}},Show:function(){h()}}}();(function(e,t,i,o){var a="bestpractices";function s(t,i){this.element=t;this._name=a;this._bestPractices=null;this._tagsLoadingInterval=null;this._tags=[];this._loadingCommentsHtml=false;this._commentsHtml=null;this._defaults=e.fn.bestpractices.defaults;this._tagsCheckCound=0;this._onInfoAndEditPage=false;this._infoAndSettingsHtml="";this._pluginHtml='<div class="tb-best-practices-container tb-target-div">             <div class="tb-best-practices-header" data-draggable="true">                 <div class="tb-best-practices-header-right">                     <span class="tb-margin-right10"> <a style="display:none" class="tb-font-size11 tb-move-up0  tb-best-practices-re-run-all">                         <img src="{PLUGIN_FILE_ROOT}/images/icons/refresh.png" style="height:10px; position:relative; top:1px;" />                         re-check all</a></span>                     <a class="tb-best-practices-checklist-settings tb-best-practices-checklist-enabled tb-margin-right3 tb-move-up1" style="vertical-align: middle;text-decoration: none; position:relative;" target="_blank" data-draggable="false">                         <img src="{PLUGIN_FILE_ROOT}/images/icons/settings.png" title="Best Practices Settings" style="height: 15px; vertical-align: middle;opacity:0.8;" />                     </a>                     <a class="tb-best-practices-checklist-enabled tb-move-up2" style="vertical-align: middle;text-decoration: none; position:relative;" target="_blank" href="https://www.tubebuddy.com/tools?tool=bestpractice" data-draggable="false">                         <img src="{PLUGIN_FILE_ROOT}/images/icons/question.png" title="help" style="height: 18px; vertical-align: middle;" />                     </a>                     <a class="tb-best-practices-header-carret tb-move-down1" style="position:absolute; right:-25px;">                         <img class="tb-best-practices-enabled-img tb-cursor-pointer" data-toggle-img="{PLUGIN_FILE_ROOT}/images/icons/caret-up.png" src="{PLUGIN_FILE_ROOT}/images/icons/caret-down.png" />                     </a>                 </div>                 <img src="{PLUGIN_FILE_ROOT}/images/branding/icon_large.png" style="height: 16px; vertical-align: middle; margin-right: 2px;" />                 <span style="vertical-align: middle; font-size: 13px;">Best Practices</span>             </div>             <div>                 <div class="tb-best-practices-checklist-enabled">                     <div class="tb-best-practices-checklist">                     </div>                     <div class="tb-best-practices-checklist-loading tb-height250 tb-margin-left15">                        <div style="text-align:center; margin:100px 0; font-size:17px; font-weight:normal; color:#777">                             <img src="{PLUGIN_FILE_ROOT}/images/general/loading1.gif" style="position:relative; top:1px;" />                             <span class="tb-move-up2">                                 Checking Best Practices...                             </span>                         </div>                     </div>                     <div class="tb-best-practices-checklist-looking-good">                         <div class="tb-padding-top30 tb-padding-bottom30 tb-padding-left50" style="text-align: left;">                             <img src="{PLUGIN_FILE_ROOT}/images/icons/mountain_top.png" style="margin-right:5px;opacity:.5;vertical-align:middle;float: left;margin-bottom: 40px;"><div style="padding-left: 50px;font-size:18px;">                                 All best practices complete.                                 <div style="font-size:13px;margin-top: 5px;color: #666;">Nice work, you are a rockstar!</div>                             </div>                         </div>                     </div>                     <div class="tb-best-practices-checklist-upgrade tb-font-size12">                         <div class="tb-line-height20">  Found <span class="tb-best-practices-checklist-upgrade-count tb-bold  tb-font-size14"></span> Best Practice<span class="tb-best-practices-checklist-upgrade-count-s">s</span> <span class="tb-best-practices-checklist-upgrade-text" >that have not been completed!</span> <br />  Upgrade your TubeBuddy license to view.</div>                         <div class="tb-margin-top10"> <a class="tb-best-practices-upgrade-now">Upgrade now!</a></div>                     </div>                     <div class="tb-best-practices-completed tb-height15">                         <div class="tb-move-up3 tb-margin-left5 tb-green" style="float:left; font-weight:500;">                             <span>&#10004;</span>                             <span class="tb-best-practices-completed-text tb-font-size13">0</span> <span> of </span> <span class="tb-best-practices-completed-text-of tb-font-size13">0</span> Best Practices Complete                         </div>                         <div class="tb-move-up2 tb-move-left3" style="float:right;"> <a class="tb-font-size10 tb-margin-left10 tb-best-practices-show-completed">show completed</a></div>                         <div style="clear:both"></div>                     </div>                 </div>                 <div class="tb-best-practices-checklist-disabled tb-height75" style="display:none;overflow-y:hidden;">                     <div class="tb-margin-top10 tb-margin-bottom10 tb-padding-left10 padding-right10">                         <span>Have TubeBuddy run automated best practice checks against your video to ensure it is properly set up and optimized.</span>                         <div class="tb-center tb-font-size12" style="padding:10px 0 15px 0;"><a class="tb-practices-enabled-img" style="text-decoration: underline; cursor:pointer">Show Now</a></div>                     </div>                 </div>             </div>         </div>';this._rowHtmlTemplateMaster='<div data-id="{0}" class="tb-padding-bottom5 tb-padding-top5 tb-best-practices-checklist-list-item {9} {11}">             <div class="tb-padding-left10  padding-right5">                 <div class="tb-font-size16 tb-move-down3" style=""><span class="tb-bestpractices-check tb-margin-right3 tb-green {10}">&#10004;</span>{1}</div>                 <div class="tb-margin-top5 tb-margin-left5 tb-padding-right5" style="line-height:15px;"><p class="tb-font-size11" style="color:#848484">{2}</p></div>                 <div class="tb-margin-right10 {3}" style="float:right;"><a class="tb-padding-right5 tb-font-size11" target="_blank" href="{4}"><span class="tb-margin-right3">{5}</span>&#187;</a></div>                 <div class="tb-margin-right10 {6}" style="float:right;"><img class="tb-move-down2 tb-margin-right3 tb-height11 {12}" src="{PLUGIN_FILE_ROOT}/images/branding/tb-icon-transparent.svg" /><a class="tb-padding-right5 {7}"><span class="tb-margin-right3 tb-font-size11">{8}</span><span>&#187;</span></a></div>                 <div style="clear:both"></div>             </div>         </div>';this.options=e.extend({},this._defaults,i);this.init()}e.extend(s.prototype,{init:function(){this.buildCache();this.bindEvents();var e=this;if(t.location.href.indexOf("youtube.com/edit")){e._infoAndSettingsHtml=jQuery(i.body.innerHTML);e._onInfoAndEditPage=true;e.populateHtml()}else{e._onInfoAndEditPage=false;var o="https://www.youtube.com/edit?o=U&"+this.options.videoId;TBExtension.Get(o,function(t,i,o){try{if(t){var a=DOMPurify.sanitize(o,DOMPurifyConfig);e._infoAndSettingsHtml=jQuery(a);e.populateHtml()}else{TBUtilities.LogFailedWebRequest({Location:"bestpracticesplugin.js|init",Data:i,Response:o});e._infoAndSettingsHtml=null}}catch(t){TBUtilities.LogError({Exception:t,Location:"bestpracticesplugin.js|init"});e._infoAndSettingsHtml=null}})}},destroy:function(){this.unbindEvents();this.$element.removeData()},buildCache:function(){this.$element=e(this.element);this.randomId=Math.floor(Math.random()*(1e5-1)+1)},populateHtml:function(){this._rowHtmlTemplateMaster=TBUtilities.FixLocalHtml(this._rowHtmlTemplateMaster);if(this.$element.hasClass("tb-bestpractices-element")==false){var e=TBUtilities.FixLocalHtml(this._pluginHtml);this.$element.append(e);this.$element.addClass("tb-bestpractices-element");this.$element.find(".tb-best-practices-checklist-settings").attr("href",TBGlobal.host+"/launchpad/bestpractices/"+TBGlobal.CurrentChannelId());if(TBGlobal.Profile().SettingsShowBestPractices==true){this.$element.find(".tb-best-practices-checklist-enabled").show();this.$element.find(".tb-best-practices-checklist-disabled").hide();var t=TBGlobal.host+TBGlobal.apiUrls.launchPadGetBestPractices;this.loadBestPractices()}else{var i=this.$element.find(".tb-best-practices-enabled-img");newSrc=i.attr("data-toggle-img");i.attr("data-toggle-img",i.attr("src"));i.attr("src",newSrc);this.$element.find(".tb-best-practices-checklist-enabled").hide();this.$element.find(".tb-best-practices-checklist-disabled").show()}}},loadBestPractices:function(){var e=this;e.$element.find(".tb-best-practices-checklist").hide();e.$element.find(".tb-best-practices-checklist-loading").show();jQuery(i).one("CRTBBestPracticesPluginLoadBestPractices",function(t,i){try{e._bestPractices=jQuery.parseJSON(i.response);e.runBestPractices(e._bestPractices)}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyBestPractices] CRTBBestPracticesPluginLoadBestPractices"})}});var t=TBGlobal.host+TBGlobal.apiUrls.launchPadGetBestPractices;TBExtension.Get(t,"CRTBBestPracticesPluginLoadBestPractices")},runBestPractices:function(e){var t=this;t._checksCompleted=0;t._checksRun=0;t._loadingCommentsHtml=false;t.$element.find(".tb-best-practices-checklist").empty();jQuery.each(e,function(e,i){t.performBestPracticeCheck(i)})},performBestPracticeCheck:function(e){var t=this;switch(e.Type){case 1:{t.performTitleLengthCheck(e);break}case 2:{t.startWatchForTags();break}case 4:{t.performCaptionsCheck(e);break}case 5:{t.performThumbnailResolutionCheck(e);break}case 6:{t.performPlaylistCheck(e);break}case 7:{t.startWatchForTags();break}case 8:{t.performCardsCheck(e);break}case 9:{t.performEndScreenCheck(e);break}case 10:{t.performMonetizationCheck(e);break}case 11:{t.loadCommentsHtml();break}case 13:{t.performFacebookLikeCheck(e);break}case 14:{t.performTwitterCheck(e);break}case 15:{t.performPinnedCommentCheck(e);break}case 100:{t.performReminderCheck(e);break}case 101:{t.startWatchForTags();break}}},checkComplete:function(e,t){var i=this;TBUtilities.Log("TubeBuddyBestPractices checkComplete - "+e.Name);i._checksCompleted++;TBUtilities.Log("TubeBuddyBestPractices complete count = "+i._checksCompleted);TBUtilities.Log("TubeBuddyBestPractices total count = "+i._bestPractices.length);if(i._checksCompleted>=i._bestPractices.length){i.updateCompleteCount();i.$element.find(".tb-best-practices-checklist-loading").hide();i.$element.find(".tb-best-practices-checklist").show();if(i._completeCount==i._checksRun){i.$element.find(".tb-best-practices-checklist-looking-good").show();i.$element.find(".tb-best-practices-checklist").hide();i.$element.find(".tb-best-practices-completed").hide();i.$element.find(".tb-best-practices-re-run-all").hide()}else if(TBGlobal.CanAccessLevel1Tools()==false){i.$element.find(".tb-best-practices-checklist-upgrade").show();var o=i._checksRun-i._completeCount;i.$element.find(".tb-best-practices-checklist-upgrade-count").text(o);if(o==1){i.$element.find(".tb-best-practices-checklist-upgrade-count-s").hide();i.$element.find(".tb-best-practices-checklist-upgrade-text").text("hasn't been completed!")}i.$element.find(".tb-best-practices-re-run-all").hide();i.$element.find(".tb-best-practices-checklist").show();i.$element.find(".tb-best-practices-completed").hide();i.$element.find(".tb-best-practices-checklist").css("max-height","180px")}else{i.$element.find(".tb-best-practices-re-run-all").show();i.$element.find(".tb-best-practices-checklist").show();i.$element.find(".tb-best-practices-completed").show()}}},performFacebookLikeCheck:function(e){var t=this;jQuery(i).one("CRTBBestPracticesPluginFacebookLike",function(i,o){e.Title="Get a like on Facebook";e.Desc="YouTube isn't the only place you should be sharing your video - make sure you tell your connections on Facebook about it. ";e.tbActionActionClass="tb-best-practices-share-tracker";e.tbActionActionText="Share Tracker";var a=e.IsComplete;try{if(o.success){e.IsComplete=false;var s=DOMPurify.sanitize(o.response,DOMPurifyConfig);var n=jQuery(s).find("#u_0_3").text();if(n&&n.indexOf("One")>-1){n="1"}var r=n.match(/\d/g);if(r!=null){r=r.join("");var l=parseInt(r);if(l>0){e.IsComplete=true}}if(a!=null){if(a!=e.IsComplete){t.removeAnyInList(e)}else{return}}t.addBestPracticeRow(e)}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyBestPractices] CRTBBestPracticesPluginFacebookLike"})}t.checkComplete(e)});var o="https://www.facebook.com/v2.7/plugins/like.php?action=like&domain=www.youtube.com&href=https://www.youtube.com/watch?v="+t.options.videoId;TBExtension.Get(o,"CRTBBestPracticesPluginFacebookLike")},performTwitterCheck:function(e){var t=this;TBUtilities.GetVideoTweetCount(t.options.videoId,function(e,i){var o=TBUtilities.GetInArray(t._bestPractices,"Type",14);o.Title="Share on Twitter";o.Desc="Make sure your video gains traction and reaches the Twittersphere by sharing with your followers on Twitter.";o.tbActionActionClass="tb-best-practices-share-tracker";o.tbActionActionText="Share Tracker";var a=o.IsComplete;try{if(e===true){if(i>0){o.IsComplete=true}else{o.IsComplete=false}if(a!=null){if(a!=o.IsComplete){t.removeAnyInList(o)}else{return}}t.addBestPracticeRow(o)}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyBestPractices] GetVideoTweetCount"})}t.checkComplete(o)})},performHeartCommentCheck:function(e){var t=this;e.Title="Heart a Comment";e.Desc='Show some love by "hearting" a top comment on this video. Your audience will appreciate it and your community will be strengthened.';e.YouTubeLink="https://www.youtube.com/comments?filter="+t.options.videoId+TBGlobal.ClassicForceParam();e.YouTubeLinkText="Go to Comments";var i=e.IsComplete;try{var o=jQuery(t._commentsHtml).find(".comment-entry");if(o.length>0){var a=jQuery(t._commentsHtml).find(".creator-heart-small-hearted");if(a.length>0){e.IsComplete=true}else{e.IsComplete=false}if(i!=null){if(i!=e.IsComplete){t.removeAnyInList(e)}else{return}}t.addBestPracticeRow(e)}}catch(e){TBUtilities.Log(e)}t.checkComplete(e)},performRespondToCommentCheck:function(e){var t=this;e.Title="Reply to a Comment";e.Desc="Don't leave your audience hangin'! Get in and respond to as many top comments as you can.";e.YouTubeLink="https://www.youtube.com/comments?filter="+t.options.videoId+TBGlobal.ClassicForceParam();e.YouTubeLinkText="Go to Comments";var i=e.IsComplete;try{var o=jQuery(t._commentsHtml).find(".comment-entry");if(o.length>0){var a=jQuery(t._commentsHtml).find(".reply.channel-owner");if(a.length>0){e.IsComplete=true}else{e.IsComplete=false}if(i!=null){if(i!=e.IsComplete){t.removeAnyInList(e)}else{return}}t.addBestPracticeRow(e)}}catch(e){TBUtilities.Log(e)}t.checkComplete(e)},performReminderCheck:function(e){var t=this;try{e.Title=e.Name;e.IsComplete=false;t.addBestPracticeRow(e)}catch(e){TBUtilities.Log(e)}t.checkComplete(e)},performPinnedCommentCheck:function(e){var t=this;e.Title="Pin a Comment";e.Desc='Take control of your comment section by "pinning" a comment that you choose to the top of the list (usually your own comment).';e.YouTubeLink="https://www.youtube.com/watch?v="+t.options.videoId;e.YouTubeLinkText="Go to Comments";var i=e.IsComplete;var o=t._infoAndSettingsHtml.find(".metadata-privacy-input").attr("data-initial-value");if(o=="private"){t.checkComplete(e)}else{TBExtension.Get("https://www.youtube.com/my_videos?o=U"+TBGlobal.ClassicForceParam(),function(o,a,s){try{if(o){var n=TBUtilities.GetSessionToken(s);var a={session_token:n};var r="https://www.youtube.com/watch?v="+t.options.videoId;TBExtension.Get(r,function(o,a,s){try{if(o){var n=TBUtilities.GetCommentTokenFromWatchPageHtml(s);var r=TBUtilities.GetIdokenFromWatchPageHtml(s);var l=TBUtilities.GetYouTubeUIVersion(s);var u="https://www.youtube.com/comment_service_ajax?action_get_comments=1&pbj=1&ctoken="+encodeURIComponent(n);var d=jQuery.param(a);TBExtension.Post(u,d,function(o,a,s){try{if(o){try{s=jQuery.parseJSON(s);e.IsComplete=false;if(s.response.continuationContents.itemSectionContinuation.contents){jQuery.each(s.response.continuationContents.itemSectionContinuation.contents,function(t,i){if(i.commentThreadRenderer.renderingPriority=="RENDERING_PRIORITY_PINNED_COMMENT"){e.IsComplete=true;return false}})}if(i!=null){if(i!=e.IsComplete){t.removeAnyInList(e)}else{return}}t.addBestPracticeRow(e);t.checkComplete(e)}catch(i){TBUtilities.Log(i);t.checkComplete(e)}}else{TBUtilities.LogFailedWebRequest({Location:"bestpracticesplugin.js|performPinnedCommentCheck",Data:a,Response:s});t.checkComplete(e)}}catch(i){TBUtilities.LogError({Exception:i,Location:"bestpracticesplugin.js|performPinnedCommentCheck"});t.checkComplete(e)}},null,{contentType:"application/x-www-form-urlencoded; charset=UTF-8",cache:false,headers:{"X-YouTube-Identity-Token":r,"X-YouTube-Client-Name":1,"X-YouTube-Client-Version":l}})}else{TBUtilities.LogFailedWebRequest({Location:"bestpracticesplugin.js|performPinnedCommentCheck",Data:a,Response:s});t.checkComplete(e)}}catch(i){TBUtilities.LogError({Exception:i,Location:"bestpracticesplugin.js|performPinnedCommentCheck"});t.checkComplete(e)}},a,{cache:false,contentType:"text/html"})}else{TBUtilities.LogFailedWebRequest({Location:"bestpracticesplugin.js|performPinnedCommentCheck",Data:a,Response:s});t.checkComplete(e)}}catch(i){TBUtilities.LogError({Exception:i,Location:"bestpracticesplugin.js|performPinnedCommentCheck"});t.checkComplete(e)}})}},performMonetizationCheck:function(e){var t=this;e.Title="Turn on Monetization";e.Desc="This video doesn't have monetization turned on which means you're not earning any ad revenue from it.";e.tbActionActionClass="tb-best-practices-monetization";e.tbActionActionText="View Settings";e.IsOnPage=true;var i=e.IsComplete;try{var o=t._infoAndSettingsHtml.find(".monetization-style-field");if(o.length>0){var a=o.val();if(a==="ads"){e.IsComplete=true}else{e.IsComplete=false}if(i!=null){if(i!=e.IsComplete){t.removeAnyInList(e)}else{return}}t.addBestPracticeRow(e)}}catch(e){TBUtilities.Log(e)}t.checkComplete(e)},performTextSearchCheck:function(e){var t=this;e.Title=e.Name;e.Desc=e.Criteria;var i=0;var o=jQuery.parseJSON(e.Data);var a=0;var s=e.IsComplete;try{if(o.SearchInTitle===true){a++;if(t.options.titleElement.val().toLowerCase().indexOf(o.SearchPhrase.toLowerCase())!=-1){i++}}if(o.SearchInDescription===true){a++;if(t.options.descriptionElement.val().toLowerCase().indexOf(o.SearchPhrase.toLowerCase())!=-1){i++}}if(o.SearchInTags===true){a++;jQuery.each(t._tags,function(e,t){if(t.toLowerCase().indexOf(o.SearchPhrase.toLowerCase())!=-1){i++}})}if(s!=null){if(s!=e.IsComplete){t.removeAnyInList(e)}else{return}}if(i>=a){e.IsComplete=true}else{e.IsComplete=false}t.addBestPracticeRow(e)}catch(e){TBUtilities.Log(e)}t.checkComplete(e)},performThumbnailResolutionCheck:function(e){var t=this;e.Title="Upload High Res. Thumbnail";e.Desc="Ensure that your thumbnail shows up crisp and clear on all devices by publishing a high resolution version.";e.tbActionActionClass="tb-best-practices-thumbnail-generator";e.tbActionActionText="Create Thumbnail";var i=e.IsComplete;var o=t._infoAndSettingsHtml.find(".metadata-privacy-input").attr("data-initial-value");if(o=="private"){t.checkComplete(e)}else{var a="https://i.ytimg.com/vi/"+t.options.videoId+"/maxresdefault.jpg";var s=new Image;s.onload=function(){if(s.naturalHeight<720&&s.naturalWidth<1280){e.IsComplete=false}else{e.IsComplete=true}if(i!=null){if(i!=e.IsComplete){t.removeAnyInList(e)}else{return}}t.addBestPracticeRow(e);t.checkComplete(e)};s.onerror=function(){t.checkComplete(e)};s.src=a}},performTitleLengthCheck:function(e){var t=this;try{var i=jQuery.parseJSON(e.Data);e.Title="Title between "+i.MinimumLength+" and "+i.MaximumLength+" characters";e.Desc="You generally want your video title to be long enough to be descriptive but not too long to where it becomes hard to read. ";var o=e.IsComplete;_videoTitle=t.options.titleElement.val();if(_videoTitle.length>=i.MinimumLength&&_videoTitle.length<=i.MaximumLength){e.IsComplete=true}else{e.IsComplete=false}if(o!=null){if(o!=e.IsComplete){t.removeAnyInList(e)}else{return}}t.addBestPracticeRow(e)}catch(e){TBUtilities.Log(e)}t.checkComplete(e)},performTitleContainsTagCheck:function(e){var t=this;e.Title="Add Tags to your Title";e.Desc="It's generally important to have at least 1 or 2 of your tags appear in your title to help with search optimization on those terms.";var i=e.IsComplete;try{_videoTitle=t.options.titleElement.val();var o=false;jQuery.each(t._tags,function(t,i){if(_videoTitle.toLowerCase().indexOf(i.toLowerCase())!=-1){e.IsComplete=true;return false}});if(e.IsComplete==null){e.IsComplete=false}if(i!=null){if(i!=e.IsComplete){t.removeAnyInList(e)}else{return}}t.addBestPracticeRow(e)}catch(e){TBUtilities.Log(e)}t.checkComplete(e)},performTagCheck:function(e){var t=this;e.Title="Add more Tags";e.Desc="YouTube allows up to 500 characters when adding tags. Use as many as possible and keep tags relevant to your video. ";e.tbActionActionClass="tb-best-practices-suggested-tags";e.tbActionActionText="Suggested Tags";var i=e.IsComplete;try{var o=jQuery.parseJSON(e.Data);var a=0;jQuery.each(t._tags,function(e,t){var i=t.trim();i=i.replace(/\s/,"---");a+=i.length;a+=1});if(a>o.MinimumLength){e.IsComplete=true}else{e.IsComplete=false}if(i!=null){if(i!=e.IsComplete){t.removeAnyInList(e)}else{return}}t.addBestPracticeRow(e)}catch(e){TBUtilities.Log(e)}t.checkComplete(e)},performCaptionsCheck:function(e){var t=this;e.Title="Add Captions";e.Desc="Adding captions will not only help hearing impared users consume your content, it can also boost your search rank!";e.tbActionActionClass="tb-best-practices-captions";e.tbActionActionText="Captions Service";e.YouTubeLink="https://www.youtube.com/timedtext_video?v="+t.options.videoId;e.YouTubeLinkText="Go to Subtitles/CC";var i=e.IsComplete;var o=false;var a="https://www.youtube.com/timedtext_video?v="+t.options.videoId;TBExtension.Get(a,function(o,a,s){try{if(o){try{var n=DOMPurify.sanitize(s,DOMPurifyConfig);var r=jQuery(n).find("#tracks-published");if(r&&r.find("li").length>0){e.IsComplete=true}else{e.IsComplete=false}if(i!=null){if(i!=e.IsComplete){t.removeAnyInList(e)}else{return}}t.addBestPracticeRow(e)}catch(e){TBUtilities.Log(e)}t.checkComplete(e)}else{TBUtilities.LogFailedWebRequest({Location:"bestpracticesplugin.js|performCaptionsCheck",Data:a,Response:s});t.checkComplete(e)}}catch(i){TBUtilities.LogError({Exception:i,Location:"bestpracticesplugin.js|performCaptionsCheck"});t.checkComplete(e)}},null,{timeout:18e4})},performPlaylistCheck:function(e){var t=this;e.Title="Add to a Playlist";e.Desc='Increase watch time by adding your video to a playlist of yours. Bonus - make sure it\'s added to a "series playlist". ';e.tbActionActionClass="tb-best-practices-playlist";e.tbActionActionText="Add Now";e.IsOnPage=true;var i=t._infoAndSettingsHtml.find(".playlist-label").text();var o=e.IsComplete;TubeBuddyYouTubeActions.IsVideoInPlaylist(t.options.videoId,function(i){try{if(i==true){e.IsComplete=true}else{e.IsComplete=false}if(o!=null){if(o!=e.IsComplete){t.removeAnyInList(e)}else{return}}t.addBestPracticeRow(e)}catch(e){TBUtilities.Log(e)}t.checkComplete(e)})},performCardsCheck:function(e){var t=this;e.Title="Add Info Cards";e.Desc="Add Info Cards in order to provide relevant external information to your video - a related video of yours or your website, etc.";e.tbActionActionClass="tb-best-practices-cards-templates";e.tbActionActionText="Apply Template";e.YouTubeLink="https://www.youtube.com/cards?v="+t.options.videoId;e.YouTubeLinkText="Go to Cards";var i=e.IsComplete;TubeBuddyYouTubeActions.GetCardsList(t.options.videoId,function(o){try{if(o!=null&&o.feature_templates.length>0){e.IsComplete=true}else{e.IsComplete=false}if(i!=null){if(i!=e.IsComplete){t.removeAnyInList(e)}else{return}}t.addBestPracticeRow(e)}catch(e){TBUtilities.Log(e)}t.checkComplete(e)})},performEndScreenCheck:function(e){var t=this;e.Title="Add an End Screen";e.Desc="When your video is over, help direct the viewer where you want to by linking to other videos or adding a subscribe button.";e.tbActionActionClass="tb-best-practices-endscreen-templates";e.tbActionActionText="Apply Template";e.YouTubeLink="https://www.youtube.com/endscreen?feature=vm&v="+t.options.videoId;e.YouTubeLinkText="Go to End Screen";var i=e.IsComplete;TubeBuddyYouTubeActions.GetEndScreenList(t.options.videoId,function(o){try{if(o!=null&&o.for_editor.elements!=null&&o.for_editor.elements.length>0){e.IsComplete=true}else{e.IsComplete=false}if(i!=null){if(i!=e.IsComplete){t.removeAnyInList(e)}else{return}}t.addBestPracticeRow(e)}catch(e){TBUtilities.Log(e)}t.checkComplete(e)})},startWatchForTags:function(){var e=this;if(e._tagsLoadingInterval==null){e._tagsLoadingInterval=setInterval(function(){e.checkForTags(e)},1e3)}},addBestPracticeRow:function(e){var t=this;var i="";var o="";if(e.IsComplete===true){i="tb-best-practices-success";o="tb-best-practices-greenback"}var a="tb-best-practices-hide";if(e.IsComplete===true){a=""}var s="";if(e.IsOnPage===true){s="tb-best-practices-hide"}var n="tb-best-practices-hide";var r="";var l="";if(e.YouTubeLink&&e.YouTubeLink!=null){n="";r=e.YouTubeLink;l=e.YouTubeLinkText}var u="tb-best-practices-hide";var d="";var c="";if(e.tbActionActionClass&&e.tbActionActionClass!=null){u="";d=e.tbActionActionClass;c=e.tbActionActionText}if(!e.Desc){e.Desc=""}var p=t._rowHtmlTemplateMaster.formatTemplate(e.Id,e.Title,e.Desc,n,r,l,u,d,c,i,a,o,s);var b=true;if(TBGlobal.CanAccessLevel1Tools()==false){b=false;if(e.Type==5||e.Type==8||e.Type==9){b=true}}if(b==true){if(a==""){t.$element.find(".tb-best-practices-checklist").prepend(p)}else{t.$element.find(".tb-best-practices-checklist").append(p)}}},updateCompleteCount:function(){var e=this;e._completeCount=0;e._checksRun=0;jQuery.each(e._bestPractices,function(t,i){if(i.IsComplete&&i.IsComplete===true){e._completeCount++;TBUtilities.Log("Complete - "+i.Name)}else if(i.IsComplete&&i.IsComplete===false){TBUtilities.Log("InComplete - "+i.Name)}else if(i.IsComplete==null){TBUtilities.Log("Not run - "+i.Name)}if(i.IsComplete!=null){e._checksRun++}});e.$element.find(".tb-best-practices-completed-text").text(e._completeCount);e.$element.find(".tb-best-practices-completed-text-of").text(e._checksRun);if(e._completeCount>0){e.$element.find(".tb-best-practices-show-completed").show()}},removeAnyInList:function(e){var t=this;var i=t.$element.find(".tb-best-practices-checklist").find("[data-id='"+e.Id+"']");if(i.length>0){i.slideUp("fast",function(){jQuery(this).remove()})}},loadCommentsHtml:function(){var e=this;if(e._loadingCommentsHtml===false){e._loadingCommentsHtml=true;var t="https://www.youtube.com/comments?filter="+e.options.videoId+TBGlobal.ClassicForceParam();TBExtension.Get(t,function(t,i,o){try{if(t){var a=DOMPurify.sanitize(o,DOMPurifyConfig);e._commentsHtml=a;jQuery.each(e._bestPractices,function(t,i){switch(i.Type){case 11:{e.performRespondToCommentCheck(i);break}}switch(i.Type){case 12:{e.performHeartCommentCheck(i);break}}})}else{TBUtilities.LogFailedWebRequest({Location:"bestpracticesplugin.js|loadCommentsHtml",Data:i,Response:o})}}catch(e){TBUtilities.LogError({Exception:e,Location:"bestpracticesplugin.js|loadCommentsHtml"})}})}},checkForTags:function(e){e._tagsCheckCound++;var t=e.options.tagsContainer.find(".video-settings-tags").val();if(e.options.tagsContainer.find(".yt-chip").length>0||e._tagsCheckCound>=20||t==""){clearInterval(e._tagsLoadingInterval);e._tagsLoadingInterval=null;e.readTags();jQuery.each(e._bestPractices,function(t,i){switch(i.Type){case 2:{e.performTitleContainsTagCheck(i);break}case 7:{e.performTagCheck(i);break}case 101:{e.performTextSearchCheck(i);break}}})}},readTags:function(){var e=this;e._tags=[];e.options.tagsContainer.find(".yt-chip").each(function(t){e._tags.push(jQuery(this).find("span:first").text())})},saveToggleSettings:function(e){var t={Enabled:e};TBUtilities.Log(t);var i=TBGlobal.host+TBGlobal.apiUrls.launchpadBestPracticesToggle;TBExtension.Post(i,JSON.stringify(t),"",null,{contentType:"application/json"})},bindEvents:function(){var e=this;e.$element.on("click",".tb-practices-enabled-img",function(t,i){var o=e.$element.find(".tb-best-practices-enabled-img");newSrc=o.attr("data-toggle-img");o.attr("data-toggle-img",o.attr("src"));o.attr("src",newSrc);TBGlobal.Profile().SettingsShowBestPractices=true;e.$element.find(".tb-best-practices-checklist-enabled").show();e.$element.find(".tb-best-practices-checklist-disabled").hide();e.saveToggleSettings(true);e.loadBestPractices()});e.$element.on("click",".tb-best-practices-enabled-img",function(t,i){var o=jQuery(this);newSrc=o.attr("data-toggle-img");o.attr("data-toggle-img",o.attr("src"));o.attr("src",newSrc);if(TBGlobal.Profile().SettingsShowBestPractices==true){TBGlobal.Profile().SettingsShowBestPractices=false;e.$element.find(".tb-best-practices-checklist-enabled").hide();e.$element.find(".tb-best-practices-checklist-disabled").show();e.saveToggleSettings(false)}else{TBGlobal.Profile().SettingsShowBestPractices=true;e.$element.find(".tb-best-practices-checklist-enabled").show();e.$element.find(".tb-best-practices-checklist-disabled").hide();e.saveToggleSettings(true);e.loadBestPractices()}});e.$element.on("click",".tb-best-practices-re-run-all",function(t,i){e.$element.find(".tb-best-practices-checklist").empty();e.$element.find(".tb-best-practices-checklist").hide();e.$element.find(".tb-best-practices-checklist-enabled").show();e.$element.find(".tb-best-practices-checklist-disabled").hide();e.$element.find(".tb-best-practices-checklist-loading").show();e.$element.find(".tb-best-practices-completed").hide();e.loadBestPractices()});e.$element.on("click",".tb-best-practices-upgrade-now",function(e,t){TBGlobal.ShowUpgradePage(null,TBGlobal.limitation.bestpractices)});e.$element.on("click",".tb-best-practices-upgrade-now",function(t,i){var o=jQuery(this);newSrc=o.attr("data-toggle-img");o.attr("data-toggle-img",o.attr("src"));o.attr("src",newSrc);if(TBGlobal.Profile().SettingsShowBestPractices==true){TBGlobal.Profile().SettingsShowBestPractices=false;e.$element.find(".tb-best-practices-checklist-enabled").hide();e.$element.find(".tb-best-practices-checklist-disabled").show();e.saveToggleSettings(false)}else{TBGlobal.Profile().SettingsShowBestPractices=true;e.$element.find(".tb-best-practices-checklist-enabled").show();e.$element.find(".tb-best-practices-checklist-disabled").hide();e.saveToggleSettings(true);e.loadBestPractices()}});e.$element.on("click",".tb-best-practices-share-tracker",function(t,o){TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyShareTracker.ShowForVideo(e.options.videoId,e.options.videoTitle,e.options.videoThumbnail);jQuery(i).on("click.tbbestpractices",".tb-share-tracker-close, .tb-share-tracker-closex",function(t){jQuery(i).off("click.tbbestpractices");var o=TBUtilities.GetInArray(e._bestPractices,"Type",13);e.performFacebookLikeCheck(o);o=TBUtilities.GetInArray(e._bestPractices,"Type",14);e.performTwitterCheck(o)})});e.$element.on("click",".tb-best-practices-monetization",function(t,i){e.options.onMonitizationClick()});e.$element.on("click",".tb-best-practices-playlist",function(t,i){e.options.onPlaylistClick()});e.$element.on("click",".tb-best-practices-thumbnail-generator",function(t,o){TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyThumbnailCreator.Show(e.options.videoId,e.options.videoTitle,e.options.videoThumbnail);jQuery(i).on("click.tbbestpractices",".tb-thumbnail-creator-close, .tb-thumbnail-creator-closex",function(t){jQuery(i).off("click.tbbestpractices");var o=TBUtilities.GetInArray(e._bestPractices,"Type",5);e.performThumbnailResolutionCheck(o)})});e.$element.on("click",".tb-best-practices-suggested-tags",function(t,o){e.options.onTagsClick();TubeBuddyMenu.ShowBackgroundSticky();TubeBuddySuggestedTags.Show(e.options.videoId,e.options.videoTitle,e.options.suggestedTagsButton,e._tags);jQuery(i).on("click.tbbestpractices",".tb-suggested-tags-close, .tb-suggested-tags-closex",function(t){jQuery(i).off("click.tbbestpractices");var o=TBUtilities.GetInArray(e._bestPractices,"Type",7);e.performTagCheck(o)})});e.$element.on("click",".tb-best-practices-captions",function(t,o){TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyTranscriptions.Show(e.options.videoId,e.options.videoTitle,e.options.videoThumbnail);jQuery(i).on("click.tbbestpractices",".tb-transcriptions-close, .tb-transcriptions-closex",function(t){jQuery(i).off("click.tbbestpractices");var o=TBUtilities.GetInArray(e._bestPractices,"Type",4);e.performCaptionsCheck(o)})});e.$element.on("click",".tb-best-practices-cards-templates",function(t,o){TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyCardTemplates.Show(e.options.videoId,e.options.videoTitle,e.options.videoThumbnail);jQuery(i).on("click.tbbestpractices","#tb-card-templates-close, .tb-card-templates-closex",function(t){jQuery(i).off("click.tbbestpractices");var o=TBUtilities.GetInArray(e._bestPractices,"Type",8);e.performCardsCheck(o)})});e.$element.on("click",".tb-best-practices-endscreen-templates",function(t,o){TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyEndScreenTemplates.Show(e.options.videoId,e.options.videoTitle,e.options.videoThumbnail);jQuery(i).on("click.tbbestpractices","#tb-endscreen-templates-close, .tb-endscreen-templates-closex",function(t){jQuery(i).off("click.tbbestpractices");var o=TBUtilities.GetInArray(e._bestPractices,"Type",9);e.performEndScreenCheck(o)})});e.$element.on("click",".tb-best-practices-show-completed",function(t,i){if(jQuery(this).text()=="show completed"){jQuery(this).text("hide completed");e.$element.find(".tb-best-practices-success").show()}else{jQuery(this).text("show completed");e.$element.find(".tb-best-practices-success").hide()}})},unbindEvents:function(){this.$element.off("."+this._name)}});e.fn.bestpractices=function(t){this.each(function(){if(!e.data(this,"plugin_"+a)){e.data(this,"plugin_"+a,new s(this,t))}});return this};e.fn.bestpractices.defaults={property:"value",onComplete:null}})(jQuery,window,document);(function(e,t,i,o){var a="bestpracticesstudio";function s(t,i){this.element=t;this._name=a;this._bestPractices=null;this._tagsLoadingInterval=null;this._tags=[];this._commentsHtml=null;this._defaults=e.fn.bestpracticesstudio.defaults;this._tagsCheckCound=0;this._isPrivateOrUnlisted=true;this._pluginHtml='<div class="tb-best-practices-studio-container tb-target-div" style="position:inherit">             <div class="tb-best-practices-studio-header" data-draggable="true">                 <div class="tb-best-practices-header-right">                     <span class="tb-margin-right10"> <a style="display:none" class="tb-font-size11 tb-move-up0  tb-best-practices-re-run-all">                         <img src="{PLUGIN_FILE_ROOT}/images/icons/refresh.png" style="height:10px; position:relative; top:1px;" />                         re-check all</a></span>                     <a class="tb-best-practices-checklist-settings tb-best-practices-checklist-enabled tb-margin-right3 tb-move-up1" style="vertical-align: middle;text-decoration: none; position:relative;" target="_blank" data-draggable="false">                         <img src="{PLUGIN_FILE_ROOT}/images/icons/settings.png" title="Best Practices Settings" style="height: 15px; vertical-align: middle;opacity:0.8;" />                     </a>                     <a class="tb-best-practices-checklist-enabled tb-move-up2" style="vertical-align: middle;text-decoration: none; position:relative;" target="_blank" href="https://www.tubebuddy.com/tools?tool=bestpractice" data-draggable="false">                         <img src="{PLUGIN_FILE_ROOT}/images/icons/question.png" title="help" style="height: 18px; vertical-align: middle;" />                     </a>                     <a class="tb-best-practices-header-carret tb-move-down1" style="position:absolute; right:-30px;">                         <img class="tb-best-practices-enabled-img tb-cursor-pointer" data-toggle-img="{PLUGIN_FILE_ROOT}/images/icons/caret-up.png" src="{PLUGIN_FILE_ROOT}/images/icons/caret-down.png" />                     </a>                 </div>                 <img class="tb-height11" src="{PLUGIN_FILE_ROOT}/images/branding/tb-icon-transparent.svg" style="vertical-align: middle; margin-right: 2px; margin-left: 4px;" />                 <span style="vertical-align: middle; font-size: 13px;color: rgba(0,0,0,.55);">Best Practices</span>             </div>             <div>                 <div class="tb-best-practices-checklist-enabled">                     <div class="tb-best-practices-checklist">                     </div>                     <div class="tb-best-practices-checklist-loading tb-height250 tb-margin-left15">                        <div style="text-align:center; margin:100px 0; font-size:17px; font-weight:normal; color:#777">                             <img src="{PLUGIN_FILE_ROOT}/images/general/loading1.gif" style="position:relative; top:1px;" />                             <span class="tb-move-up2">                                 Checking Best Practices...                             </span>                         </div>                     </div>                     <div class="tb-best-practices-checklist-looking-good">                         <div class="tb-padding-top30 tb-padding-bottom30 tb-padding-left50" style="text-align: left;">                             <img src="{PLUGIN_FILE_ROOT}/images/icons/mountain_top.png" style="margin-right:5px;opacity:.5;vertical-align:middle;float: left;margin-bottom: 40px;"><div style="padding-left: 50px;font-size:18px;">                                 All best practices complete.                                 <div style="font-size:13px;margin-top: 5px;color: #666;">Nice work, you are a rockstar!</div>                             </div>                         </div>                     </div>                     <div class="tb-best-practices-checklist-upgrade tb-font-size12">                         <div class="tb-line-height20">  Found <span class="tb-best-practices-checklist-upgrade-count tb-bold  tb-font-size14"></span> Best Practice<span class="tb-best-practices-checklist-upgrade-count-s">s</span> <span class="tb-best-practices-checklist-upgrade-text" >that have not been completed!</span> <br />  Upgrade your TubeBuddy license to view.</div>                         <div class="tb-margin-top10"> <a class="tb-best-practices-upgrade-now">Upgrade now!</a></div>                     </div>                     <div class="tb-best-practices-studio-completed tb-height15">                         <div class="tb-move-up3 tb-margin-left5 " style="float:left; font-weight:500;">                             <span class="tb-green">&#10004;</span>                             <span style="color:#666666"><span class="tb-best-practices-studio-completed-text tb-font-size13">0</span> <span> of </span> <span class="tb-best-practices-studio-completed-text-of tb-font-size13">0</span> Best Practices Complete</span>                         </div>                         <div class="tb-move-up2 tb-move-left3" style="float:right;"> <a class="tb-font-size10 tb-margin-left10 tb-best-practices-show-completed">show completed</a></div>                         <div style="clear:both"></div>                     </div>                 </div>                 <div class="tb-best-practices-checklist-disabled tb-height75" style="display:none;overflow-y:hidden;">                     <div class="tb-margin-top10 tb-margin-bottom10 tb-padding-left10 padding-right10">                         <span>Have TubeBuddy run automated best practice checks against your video to ensure it is properly set up and optimized.</span>                         <div class="tb-center tb-font-size12" style="padding:10px 0 15px 0;"><a class="tb-practices-enabled-img" style="text-decoration: underline; cursor:pointer">Show Now</a></div>                     </div>                 </div>             </div>         </div>';this._rowHtmlTemplateMaster='<div data-id="{0}" class="tb-padding-bottom5 tb-padding-top5 tb-best-practices-checklist-list-item {9} {11}">             <div class="tb-padding-left10  padding-right5">                 <div class="tb-font-size16 tb-move-down3" style=""><span class="tb-bestpractices-check tb-margin-right3 tb-green {10}">&#10004;</span>{1}</div>                 <div class="tb-margin-top5 tb-margin-left5 tb-padding-right5" style="line-height:15px;"><p class="tb-font-size11" style="color:#848484">{2}</p></div>                 <div class="tb-margin-right10 {3}" style="float:right;"><a class="tb-padding-right5 tb-font-size11" target="_blank" href="{4}"><span class="tb-margin-right3">{5}</span>&#187;</a></div>                 <div class="tb-margin-right10 {6}" style="float:right;"><img class="tb-move-down2 tb-margin-right3 tb-height11 {12}" src="{PLUGIN_FILE_ROOT}/images/branding/tb-icon-transparent.svg" /><a class="tb-padding-right5 {7}"><span class="tb-margin-right3 tb-font-size11">{8}</span><span>&#187;</span></a></div>                 <div style="clear:both"></div>             </div>         </div>';this.options=e.extend({},this._defaults,i);this.init()}e.extend(s.prototype,{init:function(){this.buildCache();this.bindEvents();var e=this;var t=jQuery(".visibility-visible").find("#privacy-icon").css("color");if(!t){this._isPrivateOrUnlisted=true}else{this._isPrivateOrUnlisted=false}e.populateHtml()},destroy:function(){this.unbindEvents();this.$element.removeData()},buildCache:function(){this.$element=e(this.element);this.randomId=Math.floor(Math.random()*(1e5-1)+1)},populateHtml:function(){this._rowHtmlTemplateMaster=TBUtilities.FixLocalHtml(this._rowHtmlTemplateMaster);if(this.$element.hasClass("tb-bestpractices-element")==false){var e=TBUtilities.FixLocalHtml(DOMPurify.sanitize(this._pluginHtml,DOMPurifyConfig));this.$element.append(e);this.$element.addClass("tb-bestpractices-element");this.$element.find(".tb-best-practices-checklist-settings").attr("href",TBGlobal.host+"/launchpad/bestpractices/"+TBGlobal.CurrentChannelId());if(TBGlobal.Profile().SettingsShowBestPractices==true){this.$element.find(".tb-best-practices-checklist-enabled").show();this.$element.find(".tb-best-practices-checklist-disabled").hide();var t=TBGlobal.host+TBGlobal.apiUrls.launchPadGetBestPractices;this.loadBestPractices()}else{var i=this.$element.find(".tb-best-practices-enabled-img");newSrc=i.attr("data-toggle-img");i.attr("data-toggle-img",i.attr("src"));i.attr("src",newSrc);this.$element.find(".tb-best-practices-checklist-enabled").hide();this.$element.find(".tb-best-practices-checklist-disabled").show()}}},loadBestPractices:function(){var e=this;e.$element.find(".tb-best-practices-checklist").hide();e.$element.find(".tb-best-practices-checklist-loading").show();jQuery(i).one("CRTBBestPracticesPluginLoadBestPractices",function(t,i){try{e._bestPractices=jQuery.parseJSON(i.response);e.runBestPractices(e._bestPractices)}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyBestPractices] CRTBBestPracticesPluginLoadBestPractices"})}});var t=TBGlobal.host+TBGlobal.apiUrls.launchPadGetBestPractices;TBExtension.Get(t,"CRTBBestPracticesPluginLoadBestPractices")},runBestPractices:function(e){var t=this;t._checksCompleted=0;t._checksRun=0;t.$element.find(".tb-best-practices-checklist").empty();jQuery.each(e,function(e,i){t.performBestPracticeCheck(i)})},performBestPracticeCheck:function(e){var t=this;switch(e.Type){case 1:{t.performTitleLengthCheck(e);break}case 2:{t.startWatchForTags();break}case 4:{t.performCaptionsCheck(e);break}case 5:{t.performThumbnailResolutionCheck(e);break}case 6:{t.performPlaylistCheck(e);break}case 7:{t.startWatchForTags();break}case 8:{t.performCardsCheck(e);break}case 9:{t.performEndScreenCheck(e);break}case 10:{t.performMonetizationCheck(e);break}case 11:{t.performRespondToCommentCheck(e);break}case 12:{t.performHeartCommentCheck(e);break}case 13:{t.performFacebookLikeCheck(e);break}case 14:{t.performTwitterCheck(e);break}case 15:{t.performPinnedCommentCheck(e);break}case 100:{t.performReminderCheck(e);break}case 101:{t.startWatchForTags();break}}},checkComplete:function(e,t){var i=this;TBUtilities.Log("TubeBuddyBestPractices checkComplete - "+e.Name);i._checksCompleted++;TBUtilities.Log("TubeBuddyBestPractices complete count = "+i._checksCompleted);TBUtilities.Log("TubeBuddyBestPractices total count = "+i._bestPractices.length);if(i._checksCompleted>=i._bestPractices.length){i.updateCompleteCount();i.$element.find(".tb-best-practices-checklist-loading").hide();i.$element.find(".tb-best-practices-checklist").show();if(i._completeCount==i._checksRun){i.$element.find(".tb-best-practices-checklist-looking-good").show();i.$element.find(".tb-best-practices-checklist").hide();i.$element.find(".tb-best-practices-studio-completed").hide();i.$element.find(".tb-best-practices-re-run-all").hide()}else if(TBGlobal.CanAccessLevel1Tools()==false){i.$element.find(".tb-best-practices-checklist-upgrade").show();var o=i._checksRun-i._completeCount;i.$element.find(".tb-best-practices-checklist-upgrade-count").text(o);if(o==1){i.$element.find(".tb-best-practices-checklist-upgrade-count-s").hide();i.$element.find(".tb-best-practices-checklist-upgrade-text").text("hasn't been completed!")}i.$element.find(".tb-best-practices-re-run-all").hide();i.$element.find(".tb-best-practices-checklist").show();i.$element.find(".tb-best-practices-studio-completed").hide();i.$element.find(".tb-best-practices-checklist").css("max-height","180px")}else{i.$element.find(".tb-best-practices-re-run-all").show();i.$element.find(".tb-best-practices-checklist").show();i.$element.find(".tb-best-practices-studio-completed").show()}}},performFacebookLikeCheck:function(e){var t=this;jQuery(i).one("CRTBBestPracticesPluginFacebookLike",function(i,o){e.Title="Get a like on Facebook";e.Desc="YouTube isn't the only place you should be sharing your video - make sure you tell your connections on Facebook about it. ";e.tbActionActionClass="tb-best-practices-share-tracker";e.tbActionActionText="Share Tracker";var a=e.IsComplete;try{if(o.success){e.IsComplete=false;var s=DOMPurify.sanitize(o.response,DOMPurifyConfig);var n=jQuery(s).find("#u_0_3").text();if(n&&n.indexOf("One")>-1){n="1"}var r=n.match(/\d/g);if(r!=null){r=r.join("");var l=parseInt(r);if(l>0){e.IsComplete=true}}if(a!=null){if(a!=e.IsComplete){t.removeAnyInList(e)}else{return}}t.addBestPracticeRow(e)}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyBestPractices] CRTBBestPracticesPluginFacebookLike"})}t.checkComplete(e)});var o="https://www.facebook.com/v2.9/plugins/like.php?action=like&domain=www.youtube.com&href=https://www.youtube.com/watch?v="+t.options.videoId;TBExtension.Get(o,"CRTBBestPracticesPluginFacebookLike")},performTwitterCheck:function(e){var t=this;TBUtilities.GetVideoTweetCount(t.options.videoId,function(e,i){var o=TBUtilities.GetInArray(t._bestPractices,"Type",14);o.Title="Share on Twitter";o.Desc="Make sure your video gains traction and reaches the Twittersphere by sharing with your followers on Twitter.";o.tbActionActionClass="tb-best-practices-share-tracker";o.tbActionActionText="Share Tracker";var a=o.IsComplete;try{if(e===true){if(i>0){o.IsComplete=true}else{o.IsComplete=false}if(a!=null){if(a!=o.IsComplete){t.removeAnyInList(o)}else{return}}t.addBestPracticeRow(o)}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyBestPractices] GetVideoTweetCount"})}t.checkComplete(o)})},performHeartCommentCheck:function(e){var t=this;e.Title="Heart a Comment";e.Desc='Show some love by "hearting" a top comment on this video. Your audience will appreciate it and your community will be strengthened.';e.YouTubeLink="https://studio.youtube.com/video/"+t.options.videoId+"/comments/inbox";e.YouTubeLinkText="Go to Comments";var i=e.IsComplete;try{TubeBuddyYouTubeActions.GetVideoCommentsStudio(t.options.videoId,null,"BEST").then(function(o){if(o.contents.itemSectionRenderer.contents.length>1){var a=0;o.contents.itemSectionRenderer.contents.forEach(function(e){if(e.commentThreadRenderer&&e.commentThreadRenderer.comment.commentRenderer.actionButtons.commentActionButtonsRenderer.creatorHeart.creatorHeartRenderer.isHearted==true){a++}});if(a>0){e.IsComplete=true}else{e.IsComplete=false}if(i!=null){if(i!=e.IsComplete){t.removeAnyInList(e)}else{return}}t.addBestPracticeRow(e)}})}catch(e){TBUtilities.LogError({Exception:e,Location:"bestpracticesstudioplugin.js|performHeartCommentCheck"})}t.checkComplete(e)},performRespondToCommentCheck:function(e){var t=this;e.Title="Reply to a Comment";e.Desc="Don't leave your audience hangin'! Get in and respond to as many top comments as you can.";e.YouTubeLink="https://studio.youtube.com/video/"+t.options.videoId+"/comments/inbox";e.YouTubeLinkText="Go to Comments";var i=e.IsComplete;try{TubeBuddyYouTubeActions.GetVideoCommentsStudio(t.options.videoId,null,"NEWEST").then(function(o){if(o.contents.itemSectionRenderer.contents.length>1){TubeBuddyYouTubeActions.GetVideoCommentsStudio(t.options.videoId,"responded","NEWEST").then(function(o){if(o&&o.contents.itemSectionRenderer.contents.length>1){e.IsComplete=true}else{e.IsComplete=false}if(i!=null){if(i!=e.IsComplete){t.removeAnyInList(e)}else{return}}t.addBestPracticeRow(e)})}})}catch(e){TBUtilities.LogError({Exception:e,Location:"bestpracticesstudioplugin.js|performRespondToCommentCheck"})}t.checkComplete(e)},performReminderCheck:function(e){var t=this;try{e.Title=e.Name;e.IsComplete=false;t.addBestPracticeRow(e)}catch(e){TBUtilities.Log(e)}t.checkComplete(e)},performPinnedCommentCheck:function(e){var t=this;e.Title="Pin a Comment";e.Desc='Take control of your comment section by "pinning" a comment that you choose to the top of the list (usually your own comment).';e.YouTubeLink="https://www.youtube.com/watch?v="+t.options.videoId;e.YouTubeLinkText="Go to Comments";var i=e.IsComplete;if(t._isPrivateOrUnlisted==true){t.checkComplete(e)}else{try{TubeBuddyYouTubeActions.GetVideoCommentsStudio(t.options.videoId,null,"BEST").then(function(o){if(o.contents.itemSectionRenderer.contents.length>1){var a=false;o.contents.itemSectionRenderer.contents.forEach(function(e){if(e.commentThreadRenderer&&e.commentThreadRenderer.renderingPriority==="RENDERING_PRIORITY_PINNED_COMMENT"){a=true;return}});if(a===true){e.IsComplete=true}else{e.IsComplete=false}if(i!=null){if(i!=e.IsComplete){t.removeAnyInList(e)}else{return}}t.addBestPracticeRow(e)}})}catch(e){TBUtilities.LogError({Exception:e,Location:"bestpracticesstudioplugin.js|performPinnedCommentCheck"})}t.checkComplete(e)}},performMonetizationCheck:function(e){var t=this;e.Title="Turn on Monetization";e.Desc="This video doesn't have monetization turned on which means you're not earning any ad revenue from it.";e.tbActionActionClass="tb-best-practices-monetization";e.tbActionActionText="View Settings";e.IsOnPage=false;var i=e.IsComplete;t.checkComplete(e)},performTextSearchCheck:function(e){var t=this;e.Title=e.Name;e.Desc=e.Criteria;var i=0;var o=jQuery.parseJSON(e.Data);var a=0;var s=e.IsComplete;try{if(o.SearchInTitle===true){a++;var n=t.options.titleElement.prop("tagName")==="DIV"?t.options.titleElement.text().trim():t.options.titleElement.val();if(n.toLowerCase().indexOf(o.SearchPhrase.toLowerCase())!=-1){i++}}if(o.SearchInDescription===true){a++;var r=t.options.descriptionElement.prop("tagName")==="DIV"?t.options.descriptionElement.text().trim():t.options.descriptionElement.val();if(r.toLowerCase().indexOf(o.SearchPhrase.toLowerCase())!=-1){i++}}if(o.SearchInTags===true){a++;jQuery.each(t._tags,function(e,t){if(t.toLowerCase().indexOf(o.SearchPhrase.toLowerCase())!=-1){i++}})}if(s!=null){if(s!=e.IsComplete){t.removeAnyInList(e)}else{return}}if(i>=a){e.IsComplete=true}else{e.IsComplete=false}t.addBestPracticeRow(e)}catch(e){TBUtilities.Log(e)}t.checkComplete(e)},performThumbnailResolutionCheck:function(e){var t=this;e.Title="Upload High Res. Thumbnail";e.Desc="Ensure that your thumbnail shows up crisp and clear on all devices by publishing a high resolution version.";e.tbActionActionClass="tb-best-practices-thumbnail-generator";e.tbActionActionText="Create Thumbnail";var i=e.IsComplete;if(t._isPrivateOrUnlisted==true){t.checkComplete(e)}else{var o="https://i.ytimg.com/vi/"+t.options.videoId+"/maxresdefault.jpg";var a=new Image;a.onload=function(){if(a.naturalHeight<720&&a.naturalWidth<1280){e.IsComplete=false}else{e.IsComplete=true}if(i!=null){if(i!=e.IsComplete){t.removeAnyInList(e)}else{return}}t.addBestPracticeRow(e);t.checkComplete(e)};a.onerror=function(){t.checkComplete(e)};a.src=o}},performTitleLengthCheck:function(e){var t=this;try{var i=jQuery.parseJSON(e.Data);e.Title="Title between "+i.MinimumLength+" and "+i.MaximumLength+" characters";e.Desc="You generally want your video title to be long enough to be descriptive but not too long to where it becomes hard to read. ";var o=e.IsComplete;_videoTitle=t.options.titleElement.prop("tagName")==="DIV"?t.options.titleElement.text().trim():t.options.titleElement.val();if(_videoTitle.length>=i.MinimumLength&&_videoTitle.length<=i.MaximumLength){e.IsComplete=true}else{e.IsComplete=false}if(o!=null){if(o!=e.IsComplete){t.removeAnyInList(e)}else{return}}t.addBestPracticeRow(e)}catch(e){TBUtilities.Log(e)}t.checkComplete(e)},performTitleContainsTagCheck:function(e){var t=this;e.Title="Add Tags to your Title";e.Desc="It's generally important to have at least 1 or 2 of your tags appear in your title to help with search optimization on those terms.";var i=e.IsComplete;try{_videoTitle=t.options.titleElement.prop("tagName")==="DIV"?t.options.titleElement.text().trim():t.options.titleElement.val();var o=false;jQuery.each(t._tags,function(t,i){if(_videoTitle.toLowerCase().indexOf(i.toLowerCase())!=-1){e.IsComplete=true;return false}});if(e.IsComplete==null){e.IsComplete=false}if(i!=null){if(i!=e.IsComplete){t.removeAnyInList(e)}else{return}}t.addBestPracticeRow(e)}catch(e){TBUtilities.Log(e)}t.checkComplete(e)},performTagCheck:function(e){var t=this;e.Title="Add more Tags";e.Desc="YouTube allows up to 500 characters when adding tags. Use as many as possible and keep tags relevant to your video. Use the TubeBuddy related tags area.";var i=e.IsComplete;try{var o=jQuery.parseJSON(e.Data);var a=0;jQuery.each(t._tags,function(e,t){var i=t.trim();i=i.replace(/\s/,"---");a+=i.length;a+=1});if(a>o.MinimumLength){e.IsComplete=true}else{e.IsComplete=false}if(i!=null){if(i!=e.IsComplete){t.removeAnyInList(e)}else{return}}t.addBestPracticeRow(e)}catch(e){TBUtilities.Log(e)}t.checkComplete(e)},performCaptionsCheck:function(e){var t=this;e.Title="Add Captions";e.Desc="Adding captions will not only help hearing impared users consume your content, it can also boost your search rank!";e.tbActionActionClass="tb-best-practices-captions";e.tbActionActionText="Captions Service";e.YouTubeLink="https://www.youtube.com/timedtext_video?v="+t.options.videoId;e.YouTubeLinkText="Go to Subtitles/CC";var i=e.IsComplete;var o=false;var a="https://www.youtube.com/timedtext_video?v="+t.options.videoId;TBExtension.Get(a,function(o,a,s){try{if(o){try{var n=DOMPurify.sanitize(s,DOMPurifyConfig);var r=jQuery(n).find("#tracks-published");if(r&&r.find("li").length>0){e.IsComplete=true}else{e.IsComplete=false}if(i!=null){if(i!=e.IsComplete){t.removeAnyInList(e)}else{return}}t.addBestPracticeRow(e)}catch(e){TBUtilities.Log(e)}t.checkComplete(e)}else{TBUtilities.LogFailedWebRequest({Location:"bestpracticesstudioplugin.js|performCaptionsCheck",Data:a,Response:s});t.checkComplete(e)}}catch(i){TBUtilities.LogError({Exception:i,Location:"bestpracticesstudioplugin.js|performCaptionsCheck"});t.checkComplete(e)}},null,{timeout:18e4})},performPlaylistCheck:function(e){var t=this;e.Title="Add to a Playlist";e.Desc='Increase watch time by adding your video to a playlist of yours. Bonus - make sure it\'s added to a "series playlist". Click the Playlists button above to add.';var i=e.IsComplete;TubeBuddyYouTubeActions.IsVideoInPlaylist(t.options.videoId,function(o){try{if(o==true){e.IsComplete=true}else{e.IsComplete=false}if(i!=null){if(i!=e.IsComplete){t.removeAnyInList(e)}else{return}}t.addBestPracticeRow(e)}catch(e){TBUtilities.Log(e)}t.checkComplete(e)})},performCardsCheck:function(e){var t=this;e.Title="Add Info Cards";e.Desc="Add Info Cards in order to provide relevant external information to your video - a related video of yours or your website, etc.";e.tbActionActionClass="tb-best-practices-cards-templates";e.tbActionActionText="Apply Template";e.YouTubeLink="https://www.youtube.com/cards?v="+t.options.videoId;e.YouTubeLinkText="Go to Cards";var i=e.IsComplete;TubeBuddyYouTubeActions.GetCardsList(t.options.videoId,function(o){try{if(o!=null&&o.feature_templates.length>0){e.IsComplete=true}else{e.IsComplete=false}if(i!=null){if(i!=e.IsComplete){t.removeAnyInList(e)}else{return}}t.addBestPracticeRow(e)}catch(e){TBUtilities.Log(e)}t.checkComplete(e)})},performEndScreenCheck:function(e){var t=this;e.Title="Add an End Screen";e.Desc="When your video is over, help direct the viewer where you want to by linking to other videos or adding a subscribe button.";e.tbActionActionClass="tb-best-practices-endscreen-templates";e.tbActionActionText="Apply Template";e.YouTubeLink="https://studio.youtube.com/video/"+t.options.videoId+"/editor";e.YouTubeLinkText="Go to End Screen";var i=e.IsComplete;TubeBuddyYouTubeActions.GetEndScreenList(t.options.videoId,function(o){try{if(o!=null&&o.for_editor.elements!=null&&o.for_editor.elements.length>0){e.IsComplete=true}else{e.IsComplete=false}if(i!=null){if(i!=e.IsComplete){t.removeAnyInList(e)}else{return}}t.addBestPracticeRow(e)}catch(e){TBUtilities.Log(e)}t.checkComplete(e)})},startWatchForTags:function(){var e=this;if(e._tagsLoadingInterval==null){e._tagsLoadingInterval=setInterval(function(){e.checkForTags(e)},1e3)}},addBestPracticeRow:function(e){var t=this;var i="";var o="";if(e.IsComplete===true){i="tb-best-practices-success";o="tb-best-practices-greenback"}var a="tb-best-practices-hide";if(e.IsComplete===true){a=""}var s="";if(e.IsOnPage===true){s="tb-best-practices-hide"}var n="tb-best-practices-hide";var r="";var l="";if(e.YouTubeLink&&e.YouTubeLink!=null){n="";r=e.YouTubeLink;l=e.YouTubeLinkText}var u="tb-best-practices-hide";var d="";var c="";if(e.tbActionActionClass&&e.tbActionActionClass!=null){u="";d=e.tbActionActionClass;c=e.tbActionActionText}if(!e.Desc){e.Desc=""}var p=t._rowHtmlTemplateMaster.formatTemplate(e.Id,e.Title,e.Desc,n,r,l,u,d,c,i,a,o,s);var b=true;if(TBGlobal.CanAccessLevel1Tools()==false){b=false;if(e.Type==5||e.Type==8||e.Type==9){b=true}}if(b==true){if(a==""){t.$element.find(".tb-best-practices-checklist").prepend(p)}else{t.$element.find(".tb-best-practices-checklist").append(p)}}},updateCompleteCount:function(){var e=this;e._completeCount=0;e._checksRun=0;jQuery.each(e._bestPractices,function(t,i){if(i.IsComplete&&i.IsComplete===true){e._completeCount++;TBUtilities.Log("Complete - "+i.Name)}else if(i.IsComplete&&i.IsComplete===false){TBUtilities.Log("InComplete - "+i.Name)}else if(i.IsComplete==null){TBUtilities.Log("Not run - "+i.Name)}if(i.IsComplete!=null){e._checksRun++}});e.$element.find(".tb-best-practices-studio-completed-text").text(e._completeCount);e.$element.find(".tb-best-practices-studio-completed-text-of").text(e._checksRun);if(e._completeCount>0){e.$element.find(".tb-best-practices-show-completed").show()}},removeAnyInList:function(e){var t=this;var i=t.$element.find(".tb-best-practices-checklist").find("[data-id='"+e.Id+"']");if(i.length>0){i.slideUp("fast",function(){jQuery(this).remove()})}},checkForTags:function(e){e._tagsCheckCound++;var t=e.options.tagsContainer.find("#text-input").val();if(e.options.tagsContainer.find(".chip").length>0||e._tagsCheckCound>=20||t==""){clearInterval(e._tagsLoadingInterval);e._tagsLoadingInterval=null;e.readTags();jQuery.each(e._bestPractices,function(t,i){switch(i.Type){case 2:{e.performTitleContainsTagCheck(i);break}case 7:{e.performTagCheck(i);break}case 101:{e.performTextSearchCheck(i);break}}})}},readTags:function(){var e=this;e._tags=[];e.options.tagsContainer.find(".chip").each(function(t){e._tags.push(jQuery(this).find("div.ytcp-chip:first").text())})},saveToggleSettings:function(e){var t={Enabled:e};TBUtilities.Log(t);var i=TBGlobal.host+TBGlobal.apiUrls.launchpadBestPracticesToggle;TBExtension.Post(i,JSON.stringify(t),"",null,{contentType:"application/json"})},bindEvents:function(){var e=this;e.$element.on("click",".tb-practices-enabled-img",function(t,i){var o=e.$element.find(".tb-best-practices-enabled-img");newSrc=o.attr("data-toggle-img");o.attr("data-toggle-img",o.attr("src"));o.attr("src",newSrc);TBGlobal.Profile().SettingsShowBestPractices=true;e.$element.find(".tb-best-practices-checklist-enabled").show();e.$element.find(".tb-best-practices-checklist-disabled").hide();e.saveToggleSettings(true);e.loadBestPractices()});e.$element.on("click",".tb-best-practices-enabled-img",function(t,i){var o=jQuery(this);newSrc=o.attr("data-toggle-img");o.attr("data-toggle-img",o.attr("src"));o.attr("src",newSrc);if(TBGlobal.Profile().SettingsShowBestPractices==true){TBGlobal.Profile().SettingsShowBestPractices=false;e.$element.find(".tb-best-practices-checklist-enabled").hide();e.$element.find(".tb-best-practices-checklist-disabled").show();e.saveToggleSettings(false)}else{TBGlobal.Profile().SettingsShowBestPractices=true;e.$element.find(".tb-best-practices-checklist-enabled").show();e.$element.find(".tb-best-practices-checklist-disabled").hide();e.saveToggleSettings(true);e.loadBestPractices()}});e.$element.on("click",".tb-best-practices-re-run-all",function(t,i){e.$element.find(".tb-best-practices-checklist").empty();e.$element.find(".tb-best-practices-checklist").hide();e.$element.find(".tb-best-practices-checklist-enabled").show();e.$element.find(".tb-best-practices-checklist-disabled").hide();e.$element.find(".tb-best-practices-checklist-loading").show();e.$element.find(".tb-best-practices-studio-completed").hide();e.loadBestPractices()});e.$element.on("click",".tb-best-practices-upgrade-now",function(e,t){TBGlobal.ShowUpgradePage(null,TBGlobal.limitation.bestpractices)});e.$element.on("click",".tb-best-practices-upgrade-now",function(t,i){var o=jQuery(this);newSrc=o.attr("data-toggle-img");o.attr("data-toggle-img",o.attr("src"));o.attr("src",newSrc);if(TBGlobal.Profile().SettingsShowBestPractices==true){TBGlobal.Profile().SettingsShowBestPractices=false;e.$element.find(".tb-best-practices-checklist-enabled").hide();e.$element.find(".tb-best-practices-checklist-disabled").show();e.saveToggleSettings(false)}else{TBGlobal.Profile().SettingsShowBestPractices=true;e.$element.find(".tb-best-practices-checklist-enabled").show();e.$element.find(".tb-best-practices-checklist-disabled").hide();e.saveToggleSettings(true);e.loadBestPractices()}});e.$element.on("click",".tb-best-practices-share-tracker",function(t,o){var a=jQuery("ytcp-thumbnail img.ytcp-img-with-fallback").attr("src");TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyShareTracker.ShowForVideo(e.options.videoId,e.options.videoTitle,a);jQuery(i).on("click.tbbestpractices",".tb-share-tracker-close, .tb-share-tracker-closex",function(t){jQuery(i).off("click.tbbestpractices");var o=TBUtilities.GetInArray(e._bestPractices,"Type",13);e.performFacebookLikeCheck(o);o=TBUtilities.GetInArray(e._bestPractices,"Type",14);e.performTwitterCheck(o)})});e.$element.on("click",".tb-best-practices-monetization",function(t,i){e.options.onMonitizationClick()});e.$element.on("click",".tb-best-practices-playlist",function(t,i){e.options.onPlaylistClick()});e.$element.on("click",".tb-best-practices-thumbnail-generator",function(t,o){var a=jQuery("ytcp-thumbnail img.ytcp-img-with-fallback").attr("src");TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyThumbnailCreator.Show(e.options.videoId,e.options.videoTitle,a);jQuery(i).on("click.tbbestpractices",".tb-thumbnail-creator-close, .tb-thumbnail-creator-closex",function(t){jQuery(i).off("click.tbbestpractices");var o=TBUtilities.GetInArray(e._bestPractices,"Type",5);e.performThumbnailResolutionCheck(o)})});e.$element.on("click",".tb-best-practices-suggested-tags",function(t,o){e.options.onTagsClick();TubeBuddyMenu.ShowBackgroundSticky();TubeBuddySuggestedTags.Show(e.options.videoId,e.options.videoTitle,e.options.suggestedTagsButton,e._tags);jQuery(i).on("click.tbbestpractices",".tb-suggested-tags-close, .tb-suggested-tags-closex",function(t){jQuery(i).off("click.tbbestpractices");var o=TBUtilities.GetInArray(e._bestPractices,"Type",7);e.performTagCheck(o)})});e.$element.on("click",".tb-best-practices-captions",function(t,o){var a=jQuery("ytcp-thumbnail img.ytcp-img-with-fallback").attr("src");TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyTranscriptions.Show(e.options.videoId,e.options.videoTitle,a);jQuery(i).on("click.tbbestpractices",".tb-transcriptions-close, .tb-transcriptions-closex",function(t){jQuery(i).off("click.tbbestpractices");var o=TBUtilities.GetInArray(e._bestPractices,"Type",4);e.performCaptionsCheck(o)})});e.$element.on("click",".tb-best-practices-cards-templates",function(t,o){var a=jQuery("ytcp-thumbnail img.ytcp-img-with-fallback").attr("src");TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyCardTemplates.Show(e.options.videoId,e.options.videoTitle,a);jQuery(i).on("click.tbbestpractices","#tb-card-templates-close, .tb-card-templates-closex",function(t){jQuery(i).off("click.tbbestpractices");var o=TBUtilities.GetInArray(e._bestPractices,"Type",8);e.performCardsCheck(o)})});e.$element.on("click",".tb-best-practices-endscreen-templates",function(t,o){var a=jQuery("ytcp-thumbnail img.ytcp-img-with-fallback").attr("src");TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyEndScreenTemplates.Show(e.options.videoId,e.options.videoTitle,a);jQuery(i).on("click.tbbestpractices","#tb-endscreen-templates-close, .tb-endscreen-templates-closex",function(t){jQuery(i).off("click.tbbestpractices");var o=TBUtilities.GetInArray(e._bestPractices,"Type",9);e.performEndScreenCheck(o)})});e.$element.on("click",".tb-best-practices-show-completed",function(t,i){if(jQuery(this).text()=="show completed"){jQuery(this).text("hide completed");e.$element.find(".tb-best-practices-success").show()}else{jQuery(this).text("show completed");e.$element.find(".tb-best-practices-success").hide()}})},unbindEvents:function(){this.$element.off("."+this._name)}});e.fn.bestpracticesstudio=function(t){this.each(function(){if(!e.data(this,"plugin_"+a)){e.data(this,"plugin_"+a,new s(this,t))}});return this};e.fn.bestpracticesstudio.defaults={property:"value",onComplete:null}})(jQuery,window,document);(function(e,t,i,o){var a="demonetizationaudit";function s(t,i){this.$element=null;this.element=t;this._name=a;this._defaults=e.fn.demonetizationaudit.defaults;this._pluginHtml="";this.options=e.extend({},this._defaults,i);this._timeout=null;this._displayedCensoredWords=[];this.init();this._loading=true}e.extend(s.prototype,{init:function(){var e=this;this.buildCache();e.bindEvents();this.populateHtml()},destroy:function(){this.unbindEvents();this.$element.removeData()},buildCache:function(){this.$element=e(this.element);this.randomId=Math.floor(Math.random()*(1e5-1)+1)},bindEvents:function(){var e=this;jQuery(i.body).on("CRTBLoadDemonetizationAuditTemplate",function(t,i){try{if(i.success){i.response=TBUtilities.FixLocalHtml(DOMPurify.sanitize(i.response,DOMPurifyConfig));e.$element.append(i.response);e._loading=false}else{TBUtilities.LogFailedWebRequest({Location:"demonetizationauditplugin.js|CRTBLoadDemonetizationAuditTemplate",Response:i.response})}}catch(e){TBUtilities.LogError({Exception:e,Location:"demonetizationauditplugin.js|CRTBLoadDemonetizationAuditTemplate"})}})},populateHtml:function(e){var t=this;var i=TBGlobal.host+"/ModuleManager/Demonetization/DemonetizationAudit?v="+TBGlobal.versionNumber;if(loadLocalHTML&&(TBExtension.GetType()=="chrome"||TBExtension.GetType()=="firefox")){i=chrome.extension.getURL("modules/demonetizationauditplugin.html")}else if(loadLocalHTML&&TBExtension.GetType()=="safari"){i="modules/demonetizationauditplugin.html"}TBExtension.Get(i,"CRTBLoadDemonetizationAuditTemplate")},unbindEvents:function(){var e=this;e.$element.off("."+this._name)},auditMetaData:function(e,t,i){var o=this;if(o._loading===true){setTimeout(function(){o.auditMetaData(e,t,i)},500);return}try{var a=[];if(e!=""){var s=e.match(/\S+/g);for(var n=0;n<s.length;n++){var r=TBUtilities.IsWordCensored(s[n]);if(r===true){var l=o.createdCensoredWord(s[n],"title");a.push(l);o.displayCensoredWord(l)}}}if(t!=""){var u=TBUtilities.GetCensoredWords();for(var n=0;n<u.length;n++){var d=new RegExp("\\b"+u[n]+"\\b");if(d.test(t)){var l=o.createdCensoredWord(u[n],"description");a.push(l);o.displayCensoredWord(l)}}}for(var n=0;n<i.length;n++){var r=TBUtilities.IsWordCensored(i[n]);if(r===true){var l=o.createdCensoredWord(i[n],"tags");a.push(l);o.displayCensoredWord(l)}}jQuery.each(o._displayedCensoredWords,function(e,t){var i=false;for(var s=0;s<a.length;s++){if(a[s].word==t.word&&a[s].source==t.source){i=true}}if(i===false){o.$element.find('[data-word="'+encodeURI(t.word)+'"][data-source="'+encodeURI(t.source)+'"]').remove()}});o._displayedCensoredWords=[];o._displayedCensoredWords=a.slice(0);if(o._displayedCensoredWords.length>0){o.$element.find(".tb-demonetization-no-problems").hide();o.$element.find(".tb-demonetization-content-container").slideDown("fast");o.$element.find(".tb-demonetization-shadow-header").attr("style","")}else{o.$element.find(".tb-demonetization-no-problems").show();o.$element.find(".tb-demonetization-content-container").slideUp("fast");o.$element.find(".tb-demonetization-shadow-header").attr("style","border:none;")}o.hideEmptyRows()}catch(e){TBUtilities.LogError(e)}},hideEmptyRows:function(t){var i=this;var o=i.$element.find(".tb-demonetization-audit-plugin-title");if(o.find("li").length==0){o.closest("li").hide()}else{o.closest("li").show()}var a=i.$element.find(".tb-demonetization-audit-plugin-description");if(a.find("li").length==0){a.closest("li").hide()}else{a.closest("li").show()}var s=i.$element.find(".tb-demonetization-audit-plugin-tags");if(s.find("li").length==0){s.closest("li").hide()}else{s.closest("li").show()}e(".tb-demonetization-settings").attr("href",TBGlobal.host+"/channel/preferences/"+TBGlobal.CurrentChannelId())},createdCensoredWord:function(e,t){return{word:e,source:t}},displayCensoredWord:function(e){var t=this;var i="<li data-word='"+encodeURI(e.word)+"' data-source='"+encodeURI(e.source)+"'>"+e.word+"</li>";switch(e.source){case"title":{var o=t.$element.find(".tb-demonetization-audit-plugin-title");if(o.find('li[data-word="'+encodeURI(e.word)+'"]').length==0){o.append(i)}break}case"description":{var a=t.$element.find(".tb-demonetization-audit-plugin-description");if(a.find('li[data-word="'+encodeURI(e.word)+'"]').length==0){a.append(i)}break}case"tags":{var s=t.$element.find(".tb-demonetization-audit-plugin-tags");if(s.find('li[data-word="'+encodeURI(e.word)+'"]').length==0){s.append(i)}break}}}});e.fn.demonetizationaudit=function(t){this.each(function(){if(!e.data(this,"plugin_"+a)){e.data(this,"plugin_"+a,new s(this,t))}});return this};e.fn.demonetizationaudit.defaults={property:"value",onComplete:null}})(jQuery,window,document);(function(e,t,i,o){var a="demonetizationauditstudio";function s(t,i){this.$element=null;this.element=t;this._name=a;this._defaults=e.fn.demonetizationauditstudio.defaults;this._pluginHtml="";this.options=e.extend({},this._defaults,i);this._timeout=null;this._displayedCensoredWords=[];this.init();this._loading=true}e.extend(s.prototype,{init:function(){var e=this;this.buildCache();e.bindEvents();this.populateHtml()},destroy:function(){this.unbindEvents();this.$element.removeData()},buildCache:function(){this.$element=e(this.element);this.randomId=Math.floor(Math.random()*(1e5-1)+1)},bindEvents:function(){var e=this;jQuery(i.body).on("CRTBLoadDemonetizationAuditStudioTemplate",function(t,i){try{if(i.success){i.response=TBUtilities.FixLocalHtml(DOMPurify.sanitize(i.response,DOMPurifyConfig));e.$element.append(i.response);e._loading=false}else{TBUtilities.LogFailedWebRequest({Location:"demonetizationauditstudioplugin.js|CRTBLoadDemonetizationAuditStudioTemplate",Response:i.response})}}catch(e){TBUtilities.LogError({Exception:e,Location:"demonetizationauditstudioplugin.js|CRTBLoadDemonetizationAuditStudioTemplate"})}})},populateHtml:function(e){var t=this;var i=TBGlobal.host+"/ModuleManager/Demonetization/demonetizationauditstudio?v="+TBGlobal.versionNumber;if(loadLocalHTML&&(TBExtension.GetType()=="chrome"||TBExtension.GetType()=="firefox")){i=chrome.extension.getURL("modules/demonetizationauditstudioplugin.html")}else if(loadLocalHTML&&TBExtension.GetType()=="safari"){i="modules/demonetizationauditstudioplugin.html"}TBExtension.Get(i,"CRTBLoadDemonetizationAuditStudioTemplate")},unbindEvents:function(){var e=this;e.$element.off("."+this._name)},auditMetaData:function(e,t,i){var o=this;if(o._loading===true){setTimeout(function(){o.auditMetaData(e,t,i)},500);return}try{var a=[];if(e!=""){var s=e.match(/\S+/g);for(var n=0;n<s.length;n++){var r=TBUtilities.IsWordCensored(s[n]);if(r===true){var l=o.createdCensoredWord(s[n],"title");a.push(l);o.displayCensoredWord(l)}}}if(t!=""){var u=TBUtilities.GetCensoredWords();for(var n=0;n<u.length;n++){var d=new RegExp("\\b"+u[n]+"\\b");if(d.test(t)){var l=o.createdCensoredWord(u[n],"description");a.push(l);o.displayCensoredWord(l)}}}for(var n=0;n<i.length;n++){var r=TBUtilities.IsWordCensored(i[n]);if(r===true){var l=o.createdCensoredWord(i[n],"tags");a.push(l);o.displayCensoredWord(l)}}jQuery.each(o._displayedCensoredWords,function(e,t){var i=false;for(var s=0;s<a.length;s++){if(a[s].word==t.word&&a[s].source==t.source){i=true}}if(i===false){o.$element.find('[data-word="'+encodeURI(t.word)+'"][data-source="'+encodeURI(t.source)+'"]').remove()}});o._displayedCensoredWords=[];o._displayedCensoredWords=a.slice(0);if(o._displayedCensoredWords.length>0){o.$element.find(".tb-demonetization-studio-no-problems").hide();o.$element.find(".tb-demonetization-studio-potential-problems").show();o.$element.find(".tb-demonetization-studio-content-container").slideDown("fast")}else{o.$element.find(".tb-demonetization-studio-potential-problems").hide();o.$element.find(".tb-demonetization-studio-no-problems").show();o.$element.find(".tb-demonetization-studio-content-container").slideUp("fast")}o.hideEmptyRows()}catch(e){TBUtilities.LogError(e)}},hideEmptyRows:function(t){var i=this;var o=i.$element.find(".tb-demonetization-audit-studio-plugin-title");if(o.find("li").length==0){o.closest("li").hide()}else{o.closest("li").show()}var a=i.$element.find(".tb-demonetization-audit-studio-plugin-description");if(a.find("li").length==0){a.closest("li").hide()}else{a.closest("li").show()}var s=i.$element.find(".tb-demonetization-audit-studio-plugin-tags");if(s.find("li").length==0){s.closest("li").hide()}else{s.closest("li").show()}e(".tb-demonetization-studio-settings").attr("href",TBGlobal.host+"/channel/preferences/"+TBGlobal.CurrentChannelId())},createdCensoredWord:function(e,t){return{word:e,source:t}},displayCensoredWord:function(e){var t=this;var i="<li data-word='"+encodeURI(e.word)+"' data-source='"+encodeURI(e.source)+"'>"+e.word+"</li>";switch(e.source){case"title":{var o=t.$element.find(".tb-demonetization-audit-studio-plugin-title");if(o.find('li[data-word="'+encodeURI(e.word)+'"]').length==0){o.append(i)}break}case"description":{var a=t.$element.find(".tb-demonetization-audit-studio-plugin-description");if(a.find('li[data-word="'+encodeURI(e.word)+'"]').length==0){a.append(i)}break}case"tags":{var s=t.$element.find(".tb-demonetization-audit-studio-plugin-tags");if(s.find('li[data-word="'+encodeURI(e.word)+'"]').length==0){s.append(i)}break}}}});e.fn.demonetizationauditstudio=function(t){this.each(function(){if(!e.data(this,"plugin_"+a)){e.data(this,"plugin_"+a,new s(this,t))}});return this};e.fn.demonetizationauditstudio.defaults={property:"value",onComplete:null}})(jQuery,window,document);var TubeBuddyEditVideoStudio=function(){var e=false;var t=false;var i=[];var o=null;var a=0;var s=null;var n=null;var r=null;var l=null;var u=false;var d=0;var c=null;var p=null;var b=true;var h=null;var m=null;var f=false;var y=null;var g=function(){j();_();var e=false;var t=setInterval(function(){var a;if(jQuery("#edit").find("textarea:first").length>0){f=false;a=jQuery("#edit textarea:first").find("textarea:first")}else if(jQuery("#edit .title #textbox").length>0){f=true;a=jQuery("#edit .title #textbox")}if(a&&a.is(":visible")===true&&(a.val().length>0||a.text().trim().length>0)){clearInterval(t);j();jQuery("div.input-container.tags").after(jQuery(".tb-edit-video-studio-legend:last")[0].outerHTML);Q();I();w(e);if(TBGlobal.Profile().SettingsShowInstaSuggest==true){var s=f?jQuery(".tags.input-container"):jQuery("#outer").parent();s.tagautocomplete({inputSelector:"input:not([type=radio]):last",onTagsAdd:function(e,t){var i=jQuery(".ytcp-chip").filter(function(){return jQuery(this).html()==t});var o=i.parent();if(i.length>0&&o.is(jQuery(".chip:last"))){i.siblings(".delete-icon").one("click",function(e){e.stopPropagation()});i.siblings(".delete-icon").click()}TubeBuddyEditVideoStudio.AddTags(e)},openSuggestedTags:function(){var e="https://www.youtube.com/edit?video_id="+o+"&tbaction=suggestedtags";window.open(e)},openTagExplorer:function(e){TubeBuddyMenu.ShowBackgroundSticky();if(f){TubeBuddyTagExplorer.ShowTagExplorer(e,jQuery(".tags.input-container ytcp-form-input-container"),i)}else{TubeBuddyTagExplorer.ShowTagExplorer(e,jQuery("#outer"),i)}}}).data("plugin_tagautocomplete")}if(TBGlobal.Profile().SettingsShowSuggestedTags==true){jQuery(".tb-edit-video-studio-suggested-tags-plugin").suggestedtags({onTagsAdd:function(e){TubeBuddyEditVideoStudio.AddTags(e)},resultsMaxWidth:"100%"}).data("plugin_suggestedtags");v(true)}if(jQuery("#tb-ke-notice").length===0)jQuery(".tb-tagautocomplete-element:first").prepend('<div id="tb-ke-notice" style="float: left;position: absolute;left: 25%;font-size: 11px;font-weight: 500;color: #666;top: 1px;"><img src="'+TBGlobal.host+'/images/branding/tb-icon.svg" class="tb-height15" style="border-radius:50%; position:relative; top:3px;"> Double-Click any tag to run Keyword Explorer on the tag.</div>');if(jQuery(".tb-best-practices-plugin-container").length===0)jQuery("a.ytcp-video-metadata-basics:last").after('<div class="tb-best-practices-plugin-container"><div>');jQuery(".tb-best-practices-plugin-container").bestpracticesstudio({videoId:o,videoTitle:f?jQuery(".title #textbox").text().trim():jQuery(".title").find("textarea").val(),videoThumbnail:"https://i.ytimg.com/vi/"+o+"/mqdefault.jpg",tagsContainer:f?jQuery(".tags.input-container ytcp-form-input-container"):jQuery("#outer"),titleElement:f?jQuery(".title #textbox"):jQuery(".title").find("textarea"),descriptionElement:f?jQuery(".description #textbox"):jQuery(".description").find("textarea"),suggestedTagsButton:jQuery(".tb-edit-video-tag-suggestions-button:first"),onMonitizationClick:function(){},onPlaylistClick:function(){},onTagsClick:function(){}}).data("plugin_bestpracticesstudio");if(TBGlobal.Profile().SettingsShowDemonetizationAudit==true){if(jQuery(".tb-demonetization-audit-studio-container").length===0)jQuery(".tb-best-practices-plugin-container").after('<div class="tb-demonetization-audit-studio-container"><div>');jQuery(".tb-demonetization-audit-studio-container").demonetizationauditstudio({}).data("plugin_demonetizationAuditStudio");T()}if(jQuery("#autogen-thumb-label").find(".tb-edit-video-studio-thumbnail-generator").length==0){jQuery(".tb-edit-video-studio-thumbnail-generator:first").appendTo("#autogen-thumb-label");jQuery(".tb-edit-video-studio-thumbnail-generator:first").show()}}},100)};var v=function(e){if(TBGlobal.Profile().SettingsShowSuggestedTags==true){if(h!=null){clearTimeout(h)}h=setTimeout(function(){h=null;Q();var t=f?jQuery(".title #textbox").text().trim():jQuery(".title").find("textarea:first").val();var a=jQuery(".tb-edit-video-studio-suggested-tags-plugin").suggestedtags().data("plugin_suggestedtags");a.getSuggestions(o,i,t,e);I()},1500)}};var T=function(){if(TBGlobal.Profile().SettingsShowDemonetizationAudit==true){clearTimeout(p);p=setTimeout(function(){Q();var e=f?jQuery(".title #textbox").text().trim():jQuery(".title").find("textarea:first").val();var t=f?jQuery(".description #textbox").text().trim():jQuery(".description").find("textarea").val();if(b){var o=jQuery(".tb-demonetization-audit-studio-container").demonetizationauditstudio().data("plugin_demonetizationauditstudio");if(o){o.auditMetaData(e,t,i)}}},1e3)}};var j=function(){var e=location.pathname;var t=[];var t=e.substring(1).split("/");for(var i=0;i<5-t.length;i++){t.push("")}o=t[1]};var Q=function(){i=[];var e=f?jQuery(".tags.input-container"):jQuery("#outer");e.find("div.ytcp-chip").each(function(e){i.push(jQuery(this).text())})};var w=function(e){if(TBGlobal.Profile().SettingsTagSearchRanking===true){if(e||!t){jQuery(".tb-edit-video-studio-loading-tag-rankings").show();jQuery(".tb-edit-video-studio-loading-tag-rankings-legend").hide();jQuery(".tb-edit-video-studio-tag-ranking").hide();TubeBuddyYouTubeActions.GetVideoDetailStudio(o).then(function(e){y=e;k()}).catch(function(e){y=null;k();TBUtilities.LogError(e)})}}else{jQuery(".tb-edit-video-studio-tag-ranking").show()}};var k=function(){if(i.length>0){jQuery(".tb-edit-video-studio-loading-tag-rankings").show();jQuery(".tb-edit-video-studio-loading-tag-rankings-legend").hide();jQuery(".tb-edit-video-studio-tag-ranking").hide();t=true;var e=false;if(y&&y.timePublishedSeconds&&y.timePublishedSeconds!=="0"&&y.privacy==="VIDEO_PRIVACY_PUBLIC"){var s=moment.unix(y.timePublishedSeconds);var n=moment.utc().diff(s,"hours");if(n<=72){e=true}}else{e=true}try{a=0;var r=0;jQuery.each(i,function(t,s){setTimeout(function(){TubeBuddyYouTubeActions.GetVideoSearchRank(o,s,function(e,t,s,n){a++;TBUtilities.Log("_tagRankCompleteCount = "+a);if(s>0){x(t,s)}if(s==-1){TBUtilities.Log("Search term "+t+" returned -1");jQuery(".tb-edit-video-studio-loading-tag-rankings-error").show()}if(s!=-1){var r=TBGlobal.host+TBGlobal.apiUrls.searchRankAddRankings;var l={VideoId:o,SearchTerm:t,Rank:s};var u=jQuery.param({Rankings:[l]});TBExtension.Post(r,u,"CREditVideoStudioAddRank_NOTUSED",null,{contentType:"application/x-www-form-urlencoded; charset=UTF-8"})}if(a>=i.length){TBUtilities.Log("rankingsComplete = "+a);S()}},1,null,e)},r);r+=10})}catch(e){TBUtilities.LogError({Exception:e,Location:"[EditVideoStudio] loadTagSearchRankings"})}}else{jQuery(".tb-edit-video-studio-loading-tag-rankings").hide()}};var B=function(e){var t=JSON.parse(window.localStorage.getItem("tb-videos-list-studio-video-info"+TBGlobal.CurrentChannelId()));if(t&&t.length>0){var i=t.filter(function(t){return t.videoId==e});if(i.length>0){return i[0].views}else{return null}}else{return null}};var C=function(){var e=TBGlobal.host+"/ModuleManager/EditVideoStudio/EditVideoStudio?v="+TBGlobal.versionNumber;if(loadLocalHTML&&(TBExtension.GetType()=="chrome"||TBExtension.GetType()=="firefox")){e=chrome.extension.getURL("modules/editvideostudio.html")}else if(loadLocalHTML&&TBExtension.GetType()=="safari"){e="modules/editvideostudio.html"}TBExtension.Get(e,"CRTBLoadEditVideoStudioTemplate")};var x=function(e,t){L();var i=jQuery(".ytcp-chip").filter(function(){return jQuery(this).html()==e});if(i.parent().find(".tb-edit-video-studio-tag-rank-studio").length===0){var o=s.formatTemplate(t);i.after(o)}};var S=function(){jQuery(".tb-edit-video-studio-loading-tag-rankings").hide();jQuery(".tb-edit-video-studio-loading-tag-rankings-legend").show();if(TBGlobal.Profile().IncognitoSearch==true)jQuery(".tb-edit-video-studio-loading-tag-rankings-legend").html('<span style="margin-right:1px;" class="tb-edit-video-studio-tag-rank">X</span> = Where this video ranks in YouTube Search Results (<a style="text-decoration:underline;font-weight:500" href="https://www.tubebuddy.com/channel/preferences/'+TBGlobal.CurrentChannelId()+'?change=rank" target="_blank">* Incognito Mode</a>)');else jQuery(".tb-edit-video-studio-loading-tag-rankings-legend").html('<span style="margin-right:1px;" class="tb-edit-video-studio-tag-rank">X</span> = Where this video ranks in YouTube Search Results (<a style="text-decoration:underline;font-weight:500" href="https://www.tubebuddy.com/channel/preferences/'+TBGlobal.CurrentChannelId()+'?change=rank" target="_blank">* For You</a>)')};var L=function(){if(s==null){s=jQuery("#tb-edit-video-studio-loading-tag").html()}};var _=function(){var e=document.querySelector("title");r=new MutationObserver(function(e){if(n!=window.location.toString()){n=window.location.toString();TBUtilities.Log("page updated - editvideostudio unloading");E()}});var t={subtree:true,characterData:true,childList:true};r.observe(e,t)};var I=function(){var e=0;jQuery.each(i,function(t,i){var o=i.trim();o=o.replace(/\s/,"---");e+=o.length;e+=1});if(e>0)e--;var t=jQuery(".text-input").val();t=t.replace(/\s+/g,"---");e+=t.length;jQuery(".tb-edit-video-studio-tags-length").text(e);if(e>500){jQuery(".tb-edit-video-studio-tags-length").css("color","red")}else{jQuery(".tb-edit-video-studio-tags-length").css("color","#666");jQuery(".tb-edit-video-studio-tags-length").css("font-weight","normal")}};var U=function(){jQuery(document).on("click",".tb-edit-video-studio-thumbnail-generator-button",function(e){var t=f?jQuery(".title #textbox").text().trim():jQuery(".title").find("textarea").val();var i=jQuery("#img-with-fallback").attr("src");var a=f?jQuery(".description #textbox").text().trim():jQuery(".description").find("textarea").val();var s=B(o);TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyThumbnailCreator.Show(o,t,i,a,s)});jQuery(document).on("focusout",".title textarea:first, .title #textbox",function(e){v(false);T()});jQuery(document).on("focusout",".description textarea, .description #textbox",function(e){T()});jQuery(document).on("click",".ytcp-video-metadata-basics .delete-icon",function(e){v(false);T();t=false});jQuery(document).on("focusout","#outer input:last, .tags.input-container #text-input",function(){v(false);T()});jQuery(document).on("click",".remove-defaults",function(){Q();I();T()});jQuery(document).on("focus",".title textarea:first, .title #textbox, .description textarea:first, .description #textbox, #outer input:last",function(){jQuery(".tb-emoji-toggle").hide();jQuery(this).before('<span style="position:absolute; right:5px; top:0; opacity:.7" class="tb-emoji-toggle tb-emoji-studio"><img src="'+TBGlobal.host+'/images/modules/emoji/face.png" style=" cursor:pointer; position:relative; top:5px;" /></span>')});jQuery(document).on("dblclick","ytcp-chip",function(e){TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyTagExplorer.ShowTagExplorer(jQuery(this).find("div.ytcp-chip:first").text().trim(),jQuery(this),i)});jQuery(document).on("change keyup keypress paste",".text-input",function(e){Q();I();T()});jQuery(document).on("click",".tb-edit-video-studio-tag-button",function(e){var t=jQuery(this).attr("data-action");switch(t){case"copy":{e.stopPropagation();Q();TubeBuddyCopyTo.ShowMenu(jQuery(this),i,false,jQuery("#main"));break}case"sort":{var a=[];var s=[];var n=f?jQuery(".tags.input-container"):jQuery("#outer");n.find("div.ytcp-chip").each(function(e){a.push(jQuery(this).text());s.push({tag:jQuery(this).text(),rank:jQuery(this).siblings(".tb-edit-video-studio-tag-rank-studio").text().trim()})});TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyTagSorter.Show(a,s,null,function(e){var t=e[e.length-1];var i=t.charAt(0);if(i==i.toUpperCase()){t=TBUtilities.LowerCaseFirstLetterString(t)}if(i==i.toLowerCase()){t=TBUtilities.CapitlizeFirstLetterString(t)}e[e.length-1]=t;l=e;n.find("#clear-button").click();u=true;d=0;c=setTimeout(G,10)});break}case"suggested":{var r=f?jQuery(".title #textbox").text().trim():jQuery(".title").find("textarea").val();TubeBuddyMenu.ShowBackgroundSticky();TubeBuddySuggestedTags.Show(o,r,jQuery(this),i,function(e){var t=[];t.push(e);l=t;u=true;d=0;c=setTimeout(G,10)});break}case"explore":{TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyTagExplorer.ShowTagExplorer(null,jQuery(this),i);break}case"translate":{Q();TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyTagTranslator.Show(i,function(e){var t=[];t.push(e);l=t;u=true;d=0;c=setTimeout(G,10)});break}case"import":{TubeBuddyMenu.ShowBackgroundSticky();TubeBuddyTagLists.Show(true,function(e){l=e;u=true;d=0;c=setTimeout(G,10)});break}}});jQuery(document).on("click",".tb-edit-video-studio-tag-ranking",function(){jQuery(this).hide();k()});jQuery(document).on("click","#save",function(){if(m){var e={ThumbnailId:m,VideoId:o};var t=TBGlobal.host+TBGlobal.apiUrls.seoScorePublishSavedThumbnailData;TBExtension.Post(t,JSON.stringify(e),function(e,t,i){try{if(e){m=null;jQuery(".ytcp-img-with-fallback").each(function(){if(jQuery(this).attr("src")&&jQuery(this).attr("src").indexOf(o)>0)jQuery(this).attr("src","https://i.ytimg.com/vi/"+o+"/0.jpg?time="+Math.random())})}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyEditVideoStudio] publishOptimizationThumbnail"})}},null,{contentType:"application/json"})}});jQuery(document).on("click",".ytcp-banner#animatable-content ytcp-button",function(){TubeBuddyUploadStudio.LoadTubeBuddyTools()})};var E=function(){r.disconnect();t=false;i=[];o=null;a=0;n=null};var A=function(){jQuery(document.body).on("CRTBLoadEditVideoStudioTemplate",function(e,t){try{if(t.success){t.response=TBUtilities.FixLocalHtml(DOMPurify.sanitize(t.response,DOMPurifyConfig));jQuery("body").append(t.response);g()}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyEditVideoStudio] CRTBLoadEditVideoStudioTemplate"})}})};var G=function(){try{if(d>=l.length){clearTimeout(c);c=null;u=false;v(false);T();t=false;w();return}var e=f?jQuery(".tags.input-container ytcp-form-input-container #text-input"):jQuery("#outer").find("input:last:not([type=radio])");e.val(l[d++]);e.trigger("focus");e.trigger("blur");c=setTimeout(G,100)}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyEditVideoStudio] addTagsOneAtATime"})}};return{Initialize:function(){TBUtilities.Log("TubeBuddyEditVideoStudio - Init");if(TBGlobal.IsAuthenticated()){if(!e){m=null;n=window.location.toString();A();C();U();e=true}else{g()}}},AddTags:function(e){l=e;u=true;d=0;c=setTimeout(G,10)},ApplyOptimizedThumbnail:function(e){m=e},GetTags:function(){Q();return i}}}();var TubeBuddyMenu=function(){var t=false;var i=false;var o=false;var a=false;var s=-1;var n=false;var r=false;var l=null;var u;var d=null;var c=false;var p="";var b=true;var h=function(){TBUtilities.Log("TubeBuddyMenu - loadHtml");var e=TBGlobal.host+"/ModuleManager/Menu/Menu?v="+TBGlobal.versionNumber;if(loadLocalHTML&&(TBExtension.GetType()=="chrome"||TBExtension.GetType()=="firefox")){e=chrome.extension.getURL("modules/menu.html")}else if(loadLocalHTML&&TBExtension.GetType()=="safari"){e="modules/menu.html"}TBExtension.Get(e,"TBMenuLayoutTemplate")};var m=function(){jQuery(".tb-pop-out-token-error").show()};var f=function(){jQuery(".tb-pop-out-token-error").hide();jQuery(".tb-main-portal-container").css("width","0px")};var y=function(){if(jQuery(".tb-menu-milestones-loading").css("display")!="none"){TBUtilities.Log("Loading Milestones");TBExtension.Get(TBGlobal.host+TBGlobal.apiUrls.youtubeChannelGetMilestones,"TBMenuLoadMileStones")}};var g=function(){jQuery(".tb-menu-industry-news-container").empty();var e=jQuery("#tb-menu-news-template").html();jQuery.each(TBGlobal.Profile().NewsItems,function(t,i){var o=e.formatTemplate(TBGlobal.host+"/images/mobile/industrynews/"+i.SourceNameNoSpace+".png",i.ShortenedUrl,i.Title,i.Preview,i.DateFriendly);jQuery(".tb-menu-industry-news-container").append(o)})};var v=function(){jQuery(".tb-menu-channel-launch-pad-link").attr("href",TBGlobal.host+"/launchpad/dashboard/"+TBGlobal.CurrentChannelId());jQuery(".tb-menu-channel-health-report-link").attr("href",TBGlobal.host+"/channel/healthreport/"+TBGlobal.CurrentChannelId());jQuery(".tb-menu-channel-valuation-link").attr("href",TBGlobal.host+"/channel/valuation/"+TBGlobal.CurrentChannelId());jQuery(".tb-menu-channel-competitor-scorecard-link").attr("href",TBGlobal.host+"/channel/competitors/"+TBGlobal.CurrentChannelId());jQuery(".tb-menu-channel-brand-alerts-link").attr("href",TBGlobal.host+"/channel/brandalertlist/"+TBGlobal.CurrentChannelId());jQuery(".tb-menu-channel-ab-tests-link").attr("href",TBGlobal.host+"/channel/abtestlist/"+TBGlobal.CurrentChannelId());jQuery(".tb-menu-channel-retention-analyzer-link").attr("href",TBGlobal.host+"/channel/retention/"+TBGlobal.CurrentChannelId());jQuery(".tb-menu-channel-backups-and-export-link").attr("href",TBGlobal.host+"/channel/backup/"+TBGlobal.CurrentChannelId());jQuery(".tb-menu-channel-canned-responses-link").attr("href",TBGlobal.host+"/channel/cannedresponses/"+TBGlobal.CurrentChannelId());jQuery(".tb-menu-channel-settings-link").attr("href",TBGlobal.host+"/channel/preferences/"+TBGlobal.CurrentChannelId());jQuery(".tb-menu-channel-promo-materials-link").attr("href",TBGlobal.host+"/promomaterials/channel/"+TBGlobal.CurrentChannelId());jQuery(".tb-menu-channel-search-rank-tracking-link").attr("href",TBGlobal.host+"/keywordranktracking/keywordrankingreport/"+TBGlobal.CurrentChannelId());jQuery(".tb-menu-channel-usage-statistics-link").attr("href",TBGlobal.host+"/channel/usage/"+TBGlobal.CurrentChannelId())};var T=function(){if(TBGlobal.Profile()==null){TBGlobal.ReloadProfile();TBYouTubeApi.GetChannelDetails(TBGlobal.CurrentChannelId(),null,function(e){try{if(!e||!e.Snippet||!e.Snippet.Thumbnails)return;TBUtilities.Log(e);jQuery(".tb-menu-channel-thumbnail").attr("src",e.Snippet.Thumbnails.ThumbnailDefault);jQuery(".tb-menu-channel-title").text(e.Snippet.Title)}catch(t){TBUtilities.LogError({Exception:t,Location:"[TubeBuddyLayout] gotChannelDetails [[[Channel Results: "+JSON.stringify(e)+"]]]"})}});var e=TBUtilities.GetCookie("GdprApprovalDate");if(!e){B()}return}jQuery(".tb-menu-channel-thumbnail").attr("src",TBGlobal.Profile().ThumbnailUrl);jQuery(".tb-menu-channel-title").text(TBGlobal.Profile().Title);jQuery(".tb-menu-channel-title").attr("href","https://www.youtube.com/channel/"+TBGlobal.CurrentChannelId());var t=TBGlobal.Profile().LicenseName;if(TBGlobal.Profile().NetworkType>=1){t+=' | <img style="height:16px; position:relative; top:2px;" src="'+TBGlobal.host+TBGlobal.Profile().NetworkLogoUrl+'" /> <a target="_blank" href="'+TBGlobal.Profile().NetworkWebsite+'">'+TBGlobal.Profile().NetworkName+"</a>"}jQuery(".tb-menu-license-name").html(t);if(TBGlobal.Profile().ThumbnailUrl==null||TBGlobal.Profile().ThumbnailUrl==""){TBYouTubeApi.GetChannelDetails(TBGlobal.CurrentChannelId(),null,function(e){try{if(!e||!e.Snippet||!e.Snippet.Thumbnails)return;TBUtilities.Log(e);jQuery(".tb-menu-channel-thumbnail").attr("src",e.Snippet.Thumbnails.ThumbnailDefault);jQuery(".tb-menu-channel-title").text(e.Snippet.Title)}catch(t){TBUtilities.LogError({Exception:t,Location:"[TubeBuddyLayout] gotChannelDetails [[[Channel Results: "+JSON.stringify(e)+"]]]"})}})}if(TBGlobal.Profile().UserIdForLoginLink!=null){jQuery(".tb-menu-my-account").attr("href",TBGlobal.host+"/account?UserIdForLoginLink="+TBGlobal.Profile().UserIdForLoginLink)}else{jQuery(".tb-menu-my-account").attr("href",TBGlobal.host+"/account?EmailHint="+TBGlobal.Profile().GoogleEmail)}if(TBGlobal.Profile().EnableDebug&&TBGlobal.Profile().EnableDebug==true){jQuery(".tb-menu-debug-container").show()}else{jQuery(".tb-menu-debug-container").hide()}};var j=function(){jQuery(".tb-main-content-reveal").css("max-height","628px")};var Q=function(){if(TBGlobal.Profile().IsSubscribedToTubeBuddy==null||TBGlobal.Profile().IsSubscribedToTubeBuddy===false){jQuery(".tb-main-content-reveal").css("max-height","370px");jQuery(".tb-main-content-reveal").css("min-height","370px");jQuery(".tb-main-content-reveal").css("height","370px")}};var w=function(){TBUtilities.Log("TB - Menu LOOKING FOR SYSTEM MESSAGES");if(TBGlobal.Profile()!=null&&TBGlobal.IsAuthenticated()==true&&TBGlobal.Profile().SystemMessages.length>0){jQuery(".tb-main-content-tabs-messages").show();jQuery(".tb-main-content-tabs-messages").find(".tb-main-content-tab").addClass("tb-main-content-tabs-active");jQuery(".tb-menu-messages-list").empty();if(TBGlobal.Profile().SystemMessageAlerts.length>0){var e=jQuery("#tb-menu-system-message-template").html();o=true;var t='<div class="tb-menu-messages-system-alert-header"> <span >TubeBuddy Alerts</span></div>';jQuery(".tb-menu-messages-list").append(t);jQuery.each(TBGlobal.Profile().SystemMessageAlerts,function(t,i){var o=e.formatTemplate(i.Message,i.DisplayOnDateFriendly);jQuery(".tb-menu-messages-list").append(o)})}jQuery.each(TBGlobal.Profile().SystemMessageProductUpdates,function(e,t){TBExtension.GetDbValue("tbMessage"+t.Id,function(e,i){TBUtilities.Log("Unread blue: "+t.Id+": "+i);if(!i){a=true;jQuery(".tb-menu-messages-image").attr("src",TBGlobal.host+"/images/icons/button-blue.png");jQuery(".tb-menu-image").css("display","none");jQuery(".tb-menu-messages-image").show()}})});if(TBGlobal.Profile().SystemMessageProductUpdates.length>0){var e=jQuery("#tb-menu-system-message-template").html();jQuery(".tb-menu-messages-icon").attr("src",TBGlobal.host+"/images/icons/button-blue.png");jQuery(".tb-menu-messages-icon").show();var t='<div class="tb-menu-messages-product-updates-header"> <span >TubeBuddy Updates</span></div>';jQuery(".tb-menu-messages-list").append(t);jQuery.each(TBGlobal.Profile().SystemMessageProductUpdates,function(t,i){var o=e.formatTemplate(i.Message,i.DisplayOnDateFriendly);jQuery(".tb-menu-messages-list").append(o)})}TBUtilities.Log("Buddont");if(o){jQuery(".tb-menu-messages-icon").attr("src",TBGlobal.host+"/images/icons/button-red.png");jQuery(".tb-menu-messages-image").attr("src",TBGlobal.host+"/images/icons/button-red.png");jQuery(".tb-menu-image").css("display","none");jQuery(".tb-menu-messages-icon").show();jQuery(".tb-menu-messages-image").show()}else if(a){TBUtilities.Log("blue");jQuery(".tb-menu-messages-image").attr("src",TBGlobal.host+"/images/icons/button-blue.png");jQuery(".tb-menu-image").css("display","none");jQuery(".tb-menu-messages-image").show()}}else{jQuery(".tb-main-content-tabs-messages").hide();jQuery(".tb-main-content-tabs-messages").find(".tb-main-content-tab").removeClass("tb-main-content-tabs-active");jQuery(".tb-menu-messages-list").empty()}};var k=function(){TBUtilities.Log("TubeBuddyMenu - checkIfSignedIn");if(TBGlobal.IsAuthenticated()==true){jQuery(".tb-menu-signed-out").hide();jQuery(".tb-menu-signed-in").show()}else{jQuery(".tb-menu-signed-out").show();jQuery(".tb-menu-signed-in").hide();jQuery(".tb-main-menu-accordian-content-support").stop().show();jQuery(".tb-main-tab").hide();jQuery(".tb-tab-signin").show();jQuery(".tb-menu-review-us-container").css("visibility","hidden");jQuery(".tb-main-content-tabs-signin").addClass("tb-main-content-tabs-active")}};var B=function(){if(b&&Math.floor(Math.random()*100)<=25){jQuery("#tb-subscribe").show()}b=false;var e="Please review our Privacy Policy and Terms of Use and check the box that you agree before logging in.";jQuery("#tb-sign-in-link").css("cursor","default");jQuery("#tb-sign-in-link").attr("title",e);var t=jQuery("#tb-sign-in-img").attr("src");jQuery("#tb-sign-in-img").attr("src",t.replace("login.png","login-disabled.png"));jQuery("#tb-privacy").css("display","block");jQuery("#tb-sign-in-link").off("click");jQuery("#tb-sign-in-link").click(function(t){t.preventDefault();TBUtilities.Alert(e);jQuery(".required-checkbox-container").css("background-color","yellow");return false})};var C=function(e){jQuery(".tb-menu-debug-toggle").addClass("tb-btn-red");jQuery(".tb-menu-debug-togglee").removeClass("tb-btn-green");jQuery(".tb-menu-debug-toggle").find("span").text("Debug mode OFF");var t=jQuery("html").html();var i=TBUtilities.GetDebugEntries();html2canvas(document.body,{onrendered:function(e){var o=jQuery.param({StartingHTML:_debugStartingHtml,EndingHTML:t,ScreenShot:e.toDataURL(),Logs:i});TBExtension.Post(TBGlobal.host+TBGlobal.apiUrls.debugAddLog,o,null,null,{contentType:"application/x-www-form-urlencoded; charset=UTF-8"});jQuery("#tb-debug-modal:first").remove();_debugStartingHtml="";TBUtilities.Alert("Thanks! We will review the info and get back to you.")}})};var x=function(){TBUtilities.Log("TubeBuddyMenu - wireUpPageEvents");TBGlobal.AddProfileUpdateListener(T);var e=document.querySelector("title");if(d==null){d=window.location.toString()}var t=new MutationObserver(function(e){if(e&&e.length>0){console.log(e[0].target.nodeValue)}if(d!=window.location.toString()){d=window.location.toString();TBUtilities.Log("tile and url updated");TBGlobal.LoadModules(null,true)}});var i={subtree:true,characterData:true,childList:true};t.observe(e,i);jQuery(document).on("click","[data-action]",function(){_(jQuery(this).data("action"))});jQuery(document).on("click","#tb-sign-in-link",function(){jQuery(".tb-logging-in-spinner").show();jQuery(this).hide();if(jQuery("#tb-subscribe-to-tb").is(":checked")){TubeBuddyYouTubeActions.SubscribeToChannel("UCo33niDKpTpgwZ_dohqvylg",TubeBuddyMenu.SubscribedNowLogin);setTimeout(function(){window.location=p},7500)}else{window.location=p}});jQuery(document).on("focus",".yt-commentbox-text, .comment-simplebox-text, textarea.iron-autogrow-textarea",function(){jQuery(".tb-emoji-toggle").hide();jQuery(this).before('<span style="position:absolute; right:2px; top:-1px; opacity:.7; z-index:99999999" class="tb-emoji-toggle"><img src="'+TBGlobal.host+'/images/modules/emoji/face.png" style=" cursor:pointer; position:relative; top:5px;" /></span>')});jQuery(document).on("click",".tb-emoji-toggle",function(e){var t=$(e.target).parent().hasClass("tb-emoji-studio");if(TBExtension.GetType()=="safari"){window.open("http://getemoji.com")}else{var i=jQuery(this).next();if(i.attr("tb-emoji-added")!=="1"){i.emojiPicker({height:"300px",width:"450px",button:false,container:t?"main":"body"});i.attr("tb-emoji-added","1")}i.emojiPicker("toggle")}});jQuery(document).on("click",".tb-menu-upgrade-now",function(e){TBUtilities.Log("Clicked Upgrade");TBGlobal.ShowUpgradePage(null,"featured");e.preventDefault();return false});jQuery(document).on("click",".tb-menu-subscribe-button",function(){TBUtilities.Log("Clicked Subscirbe");TBExtension.Get(TBGlobal.host+TBGlobal.apiUrls.youtubeChannelMarkAsSubscribedToTubeBuddy,"");j();jQuery(".tb-menu-subscribe-tb").hide()});jQuery(document).on("click",".tb-menu-goto-rating",function(){TBExtension.SetDbValue("tb-rating-store",true);jQuery(".tb-menu-review-us-container").hide()});jQuery(document).on("click",".tb-module-close",function(){jQuery(this).closest(".tb-module-template").hide();TubeBuddyMenu.HideBackground()});jQuery(document).on("click","#tb-modal-background",function(){if(n){A()}if(!r){P()}});jQuery(document).on("click",".ytd-notification-topbar-button-renderer",function(){TBUtilities.Log("clicked ytd-notification-topbar-button-renderer");if(c==true)return;c=true;setTimeout(function(){jQuery("ytd-notification-renderer").each(function(){if(jQuery(this).parent().attr("id")!="items")return;TBUtilities.Log("BB");var e=jQuery(this).find("a").attr("href");if(!e){TBUtilities.Log("No link");return}var t=e.indexOf("lc=")+3;var i=e.length;var o=e.substring(t,i);TBUtilities.Log("Link: "+e);TBUtilities.Log(o);if(!o)return;if(o.indexOf("?")>=0)return;if(o.indexOf("=")>=0)return;var a=TBUtilities.ReplaceAll(o,".","_");if(jQuery("#tb-layout-notification-item-"+a).length>0)return;var s=jQuery(this).find(".text.style-scope.ytd-notification-renderer").height()+15;jQuery(this).prepend('<div id="tb-layout-notification-reply-'+a+'" class="tb-layout-notification-reply" data-comment-id="'+a+'" style="position:absolute; text-align:center; height:20px; top:'+(s-15)+'px; left:13px; cursor:pointer; width:50px; color:blue; background-color:white;"><img id="tb-layout-notification-'+a+'" src="'+TBGlobal.host+'/images/branding/icon_tiny.png" style="margin-right: 2px; vertical-align: text-bottom; position:relative; top:-1px;" /> <span style="opacity:.5">reply</span></div>');TBUtilities.Log(s);var n=" ";try{var r=jQuery(this).find("yt-formatted-string.message:first").text();r=r.substring(0,r.indexOf(":"));var l=r.split(" ");for(var u=0;u<l.length-1;u++)n+=l[u]+" "}catch(e){}var d=jQuery(".tb-layout-notification2-comment-block:last")[0].outerHTML;d=TBUtilities.ReplaceAll(d,"#COMMENT_ID#",a);d=TBUtilities.ReplaceAll(d,"#TOP#",s-20+"px");d=TBUtilities.ReplaceAll(d,"#COMMENTER#",n);jQuery(this).prepend(d)});jQuery(".feed-item-container").removeClass("yt-uix-tile");jQuery(".feed-item-container").each(function(){jQuery(this).removeClass("yt-uix-tile")})},1050)});jQuery(document).on("click",".tb-notification-comment-reply",function(e){e.stopPropagation()});jQuery(document).on("click",".tb-layout-notification-reply",function(e){TBUtilities.Log(".tb-layout-notification-reply");var t=jQuery(this).attr("data-comment-id");TBUtilities.Log(t);if(jQuery("#tb-layout-notification-item-"+t).is(":visible")){jQuery("#tb-layout-notification-item-"+t).hide()}else{jQuery("#tb-layout-notification-item-"+t).show()}TBUtilities.Log("#tb-layout-notification-item-"+t);TBUtilities.Log(jQuery("#tb-layout-notification-item-"+t).length);e.stopPropagation()});jQuery(document).on("click",".tb-layout-notification-cancel-button",function(e){TBUtilities.Log(".tb-layout-notification-cancel-button");jQuery(this).closest(".tb-layout-notification-comment-block").hide();jQuery(this).closest(".tb-layout-notification2-comment-block").hide();e.stopPropagation()});jQuery(document).on("click",".tb-layout-notification-reply-button",function(e){TBUtilities.Log(".tb-layout-notification-reply-button");var t=jQuery(this).attr("data-comment-id");var i=jQuery("#tb-notification-comment-reply-"+t).val();TBUtilities.Log(i);TBUtilities.Log(t);if(!i){TBUtilities.Alert("You must enter a Comment");return}var o=TBUtilities.ReplaceAll(t,"_",".");jQuery(this).attr("disabled","disabled");var a=jQuery.param({ParentCommentId:o,CommentText:i});TBExtension.Post(TBGlobal.host+TBGlobal.apiUrls.youtubeApiPostCommentReply,a,"TBLayoutPostCommentReply",{commentId:t},{contentType:"application/x-www-form-urlencoded; charset=UTF-8"});jQuery("#tb-layout-notification-reply-loading-"+t).show();TBUtilities.AddAction(null,TBUtilities.ActionTypes.NotificationMenu_PostCommentReply,"navwindowcomments");e.stopPropagation()});jQuery(document).on("click","#yt-masthead-notifications-button",function(){setTimeout(function(){jQuery(".feed-item-container").each(function(){TBUtilities.Log("BB");var e=jQuery(this).find(".yt-lockup-content:first").find("h3").find("a").attr("href");if(!e){TBUtilities.Log("No link");return}var t=e.indexOf("lc=")+3;var i=e.length;var o=e.substring(t,i);TBUtilities.Log("Link: "+e);TBUtilities.Log(o);if(!o)return;if(o.indexOf("?")>=0)return;if(o.indexOf("=")>=0)return;var a=TBUtilities.ReplaceAll(o,".","_");if(jQuery("#tb-layout-notification-item-"+a+"-post").length>0)return;jQuery(this).find(".yt-lockup-byline").first("li").append('&nbsp; <img id="tb-layout-notification-'+a+'" src="'+TBGlobal.host+'/images/branding/icon_tiny.png" style="margin-right: 2px; vertical-align: text-bottom; position:relative; top:-1px;"><a id="tb-layout-notification-reply-'+a+'" class="tb-layout-notification-reply" data-comment-id="'+a+'">Reply</a>');var s=jQuery(".tb-layout-notification-comment-block:first")[0].outerHTML;s=TBUtilities.ReplaceAll(s,"#COMMENT_ID#",a);jQuery(this).find(".yt-lockup-byline").after(s)});jQuery(".feed-item-container").removeClass("yt-uix-tile");jQuery(".feed-item-container").each(function(){jQuery(this).removeClass("yt-uix-tile")})},1050)});jQuery(document.body).on("TBLayoutPostCommentReply",function(e,t){TBUtilities.Log("TBLayoutPostCommentReply");TBUtilities.Log(e);TBUtilities.Log(t);try{if(t.success){var i=t.data.commentId;if(t.response=='"success"'){jQuery("#tb-layout-notification-item-"+i+"-post").hide();jQuery("#tb-layout-notification-item-"+i+"-posted").show();jQuery("#tb-layout-notification-reply-"+i).hide();jQuery("#tb-layout-notification-reply-loading-"+i).hide();jQuery("#tb-layout-notification-"+i).hide()}else{TBUtilities.Alert("Sorry, there was a problem posting your comment.\r\n\r\nError: "+t.response)}}else{TBUtilities.Alert("Sorry, there was a problem posting your comment.\r\n\r\nIf this continues, contact TubeBuddy")}}catch(e){TBUtilities.LogError(e)}});jQuery(document).on("click",".tb-menu-debug-toggle",function(){if(jQuery(this).hasClass("tb-btn-red")){jQuery(this).removeClass("tb-btn-red");jQuery(this).addClass("tb-btn-green");jQuery(this).find("span").text("Debug mode ON");jQuery("body").append(jQuery("#tb-menu-debug-modal-template").html());_debugStartingHtml=jQuery("html").html()}else{jQuery(this).addClass("tb-btn-red");jQuery(this).removeClass("tb-btn-green");jQuery(this).find("span").text("Debug mode OFF");jQuery("#tb-menu-debug-modal-template:first").remove()}});jQuery(document).on("click",".tb-menu-debug-send",function(){jQuery(this).prop("disabled",true);jQuery(this).find("span").text("Sending....");C()});jQuery(document).on("change",".requiredCheckbox",function(){if(jQuery(".requiredCheckbox:checked").length==1){jQuery("#tb-sign-in-link").css("cursor","pointer");jQuery("#tb-sign-in-link").attr("title","");var e=jQuery("#tb-sign-in-img").attr("src");jQuery("#tb-sign-in-img").attr("src",e.replace("login-disabled.png","login.png"));jQuery("#tb-sign-in-link").off("click");jQuery("#tb-sign-in-link").click(function(){var e=new Date;e.setFullYear(e.getFullYear()+10);TBUtilities.CreateCookie("GdprApprovalDate","true",10*365)})}else{B()}});jQuery(document).on("click",".tb-main-content-tab",function(){TBUtilities.Log("TubeBuddyMenu - click .tb-main-content-tab");var e=jQuery(this).attr("data-tabid");jQuery(".tb-main-tab").hide();jQuery("."+e).show();jQuery(".tb-main-content-tab").removeClass("tb-main-content-tabs-active");jQuery(this).addClass("tb-main-content-tabs-active");j();switch(e){case"tb-tab-tools":{break}case"tb-tab-messages":{jQuery.each(TBGlobal.Profile().SystemMessageProductUpdates,function(e,t){TBExtension.SetDbValue("tbMessage"+t.Id,true)});break}case"tb-popout-home-tab":{break}case"tb-tab-news":{g();break}case"tb-tab-milestones":{y();break}}});jQuery(document).on("click",".tb-my-videos, .tb-pop-out-token-error",function(){TBUtilities.Log("TubeBuddyMenu - click .tb-my-videos, .tb-pop-out-token-error");if(n===true){A();D()}else{O();U(a||o)}});jQuery(document).on("click","#tb-menu-background",function(){TBUtilities.Log("TubeBuddyMenu - click #tb-menu-background");if(n===true){A()}if(r===false){D()}});jQuery(document).on("click",".tb-menu-extension-open",function(){var e=jQuery(this).data("action");switch(e){case"QuickLinksMenu_TagExplorer":{A();G();var t=jQuery(this);TBUtilities.Log(jQuery(".video-settings-tag-chips-container").length);if(jQuery(".video-settings-tag-chips-container").length>0)t=jQuery(".video-settings-add-tag:first");TBUtilities.Log(jQuery(".video-settings-add-tag:first").length);TubeBuddyTagExplorer.ShowTagExplorer(null,t);break}case"QuickLinksMenu_CoppaCenter":{if(window.location.href.indexOf("studio.youtube.com")!==-1){A();G();TubeBuddyKidsCenter.Show()}else{var i="tb-coppa-open-"+TBGlobal.CurrentChannelId();TBExtension.SetDbValue(i,1);window.open("https://studio.youtube.com/channel/"+TBGlobal.CurrentChannelId())}break}case"QuickLinksMenu_SeoStudio":{A();G();TubeBuddySeoStudio.ShowSeoStudio(null);break}case"QuickLinksMenu_VideoTopicPlanner":{A();G();TubeBuddyTopicGenerator.Show();break}case"QuickLinksMenu_TagLists":{A();G();TubeBuddyTagLists.Show();break}case"QuickLinksMenu_BestTimeToPublish":{A();G();TubeBuddyBestTimeToPublish.ShowBestTimeToPublish();break}}})};var S=function(){window.location=p};var L=function(){jQuery(document.body).on("TBMenuLoadMileStones",function(e,t){try{if(t.success===true){TBExtension.SetDbValue("tb-last-milestone-fetch-"+TBGlobal.CurrentChannelId(),(new Date).toString(),"");TBUtilities.Log("Added DB Value - "+new Date);var i=JSON.parse(t.response);if(i.Milestones.length>0){var o=false;var a=0;jQuery.each(i.Milestones,function(e,t){TBUtilities.Log("Loop : foundRecent="+o+"   and newItems="+a);TBUtilities.Log(t.MilestoneText);TBUtilities.Log("_recentMilestoneItem: "+l);if(l==t.MilestoneText)o=true;if(!o)a++;var i=jQuery("#tb-milestone-item-template").html();var s=i.formatTemplate(TBGlobal.host+"/content/images/mobile/icons/Milestone"+t.MilestoneTypeFriendly+".png",t.MilestoneValueFriendly+" "+t.MilestoneTypeFriendly,t.MilestoneText,TBGlobal.host+t.CertificateUrl,"https://www.facebook.com/sharer/sharer.php?u="+TBUtilities.GetUrlEncoded(TBGlobal.host+t.CertificateUrl),"https://twitter.com/intent/tweet?text="+"My channel reached the "+t.MilestoneValueFriendly+" "+t.MilestoneTypeFriendly+" Milestone! &#x1f3c6; via @TubeBuddy "+TBUtilities.GetUrlEncoded(TBGlobal.host+t.CertificateUrl));jQuery(".tb-menu-milestones-container").append(s)});TBExtension.SetDbValue("tb-last-milestone-fetch-item-"+TBGlobal.CurrentChannelId(),i.Milestones[0].MilestoneText,"");if(a>0){jQuery(".tb-popout-milestones-tab-header-count").text(a);jQuery(".tb-popout-milestones-tab-header-count").css("display","inline");jQuery(".tb-popout-milestones-tab-header-count").fadeIn(1e3)}}else{jQuery(".tb-menu-milestones-container").append('<div style="padding:10px 14px">Sorry, no Milestones found in the last 30 days. <div style="padding-top:6px;">Come back when you hit your next Milestone (listed below)</div></div>')}jQuery(".tb-menu-views-next").html(i.NextViewsMilestone.MilestoneValueFriendly);jQuery(".tb-menu-sub-next").html(i.NextSubscribersMilestone.MilestoneValueFriendly);jQuery(".tb-menu-uploads-next").html(i.NextUploadsMilestone.MilestoneValueFriendly);jQuery(".tb-menu-views-to-go").html("~"+i.NextViewsMilestone.MilestoneToGoValueFriendly+" to go");jQuery(".tb-menu-sub-to-go").html("~"+i.NextSubscribersMilestone.MilestoneToGoValueFriendly+" to go");jQuery(".tb-menu-uploads-to-go").html("~"+i.NextUploadsMilestone.MilestoneToGoValueFriendly+" to go");jQuery(".tb-menu-milestones-loading").hide();jQuery(".tb-menu-milestones-container").show();jQuery(".tb-menu-milestones-container-next").show()}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyMenu] TBMenuLoadMileStones"})}});jQuery(document.body).on("TBMenuLayoutTemplate",function(e,t){try{var i=TBUtilities.GetUrlParameter("tbft");u=i==1||i=="1";TBUtilities.Log("TubeBuddyMenu - loadHtml load success = "+t.success);if(t.success===true){var o=TBUtilities.FixLocalHtml(DOMPurify.sanitize(t.response,DOMPurifyConfig));jQuery("body").append(o);var a=jQuery(".tb-main-portal-container");var s=jstz.determine_timezone();var n=s.timezone;if(n!="undefined"){n.ambiguity_check()}var r=n.utc_offset;jQuery("#tb-menu-login-webiste").attr("href",TBGlobal.host+"/oauth/AuthRedirectLogin/?channelid="+TBGlobal.CurrentChannelId()+"&redirectUrl="+encodeURIComponent(window.location)+"&timeZoneOffset="+encodeURIComponent(r)+"&via=extension&channelId="+TBGlobal.CurrentChannelId());p=TBGlobal.host+"/oauth/AuthRedirectLogin/?channelid="+TBGlobal.CurrentChannelId()+"&redirectUrl="+encodeURIComponent(window.location)+"&timeZoneOffset="+encodeURIComponent(r)+"&via=extension&channelId="+TBGlobal.CurrentChannelId();var l=TBGlobal.GetYouTubeUI();TBUtilities.Log("TBLayout - TBLoadLayoutTemplate YouTubeUI = "+l);switch(l){case"material":{if(jQuery("#end").length>0){a.prependTo("#end");jQuery("#tb-menu-background").css("z-index",2e3)}else{a.prependTo("#yt-masthead-user")}break}case"default":{a.prependTo("#yt-masthead-user");break}case"studio":{jQuery(".tb-menu-dashboard-link").attr("href","https://studio.youtube.com/channel/"+TBGlobal.CurrentChannelId());jQuery(".tb-menu-myvideos-link").attr("href","https://studio.youtube.com/channel/"+TBGlobal.CurrentChannelId()+"/videos/upload");jQuery(".tb-menu-playlists-link").attr("href","https://www.youtube.com/view_all_playlists");jQuery(".tb-menu-livedashboard-link").attr("href","https://studio.youtube.com/channel/"+TBGlobal.CurrentChannelId()+"/videos/live");jQuery(".tb-menu-comments-link").attr("href","https://studio.youtube.com/channel/"+TBGlobal.CurrentChannelId()+"/comments");jQuery(".tb-menu-subscribers-link").attr("href","https://www.youtube.com/subscribers");jQuery(".tb-menu-analytics-link").attr("href","https://studio.youtube.com/channel/"+TBGlobal.CurrentChannelId()+"/analytics/tab-overview/period-4_weeks");jQuery(".tb-menu-realtime-link").attr("href","https://www.youtube.com/analytics?o=U#r=realtime");jQuery(".tb-menu-playlists-link").text("Playlists (Classic)");jQuery(".tb-menu-subscribers-link").text("Subscribers (Classic)");jQuery(".tb-menu-realtime-link").css("display","none");jQuery(".tb-menu-analytics-link-spacer").hide();jQuery(document).on("click",".tb-menu-item",function(){D();A()});jQuery("#left-nav").css("border-right","0");jQuery("#video-list").css("border-left","solid 1px #ddd");var d=jQuery("ytcp-icon-button#search-icon").css("visibility");if(d=="hidden"){a.insertAfter("ytcp-icon-button#search-icon")}else{a.insertBefore("ytcp-icon-button#search-icon")}var c=jQuery("#tb-menu-background");c.prependTo("#main-container");c.css("z-index","2");a.css("bottom","-5px");a.find(".tb-my-videos").removeClass("tb-button-default");var b=TBExtension.GetFilePath("images/branding/tb-icon-white-transparent.svg");a.find(".tb-menu-image-logo").attr("src",b);jQuery(".tb-menu-image").css("color","white");jQuery("#main-container").prepend("<style type='text/css'> #tb-main-menu { background-color:#bf3730 !important; border:0px !important; border-radius:2px; }</style>");break}}jQuery(".tb-my-videos").show();var h="";if(TBGlobal.Profile()!=null)h="&agencyid="+encodeURIComponent(TBGlobal.Profile().AgencyId);if(h==null)h="";jQuery(".tb-missing-token-oauth-link").attr("data-url",TBGlobal.host+"/oauth/AuthRedirect?channelid="+TBGlobal.CurrentChannelId()+"&redirectUrl="+encodeURIComponent(window.location)+"&timeZoneOffset="+encodeURIComponent(r)+h+"&via=extension&channelId="+TBGlobal.CurrentChannelId());p=TBGlobal.host+"/oauth/AuthRedirect?channelid="+TBGlobal.CurrentChannelId()+"&redirectUrl="+encodeURIComponent(window.location)+"&timeZoneOffset="+encodeURIComponent(r)+h+"&via=extension&channelId="+TBGlobal.CurrentChannelId();if(TBGlobal.Profile()==null||!TBGlobal.Profile().HasAccessToken){if(TBGlobal.Profile()==null)TBGlobal.AddDiagnostic("lllt:PN");else if(!TBGlobal.Profile().HasAccessToken)TBGlobal.AddDiagnostic("lllt:NAT");m()}else{f()}if(u){jQuery("#tb-layout-logged-in").show();if(TBGlobal.GetYouTubeUI()=="studio"){jQuery("#tb-layout-logged-in-link").css("color","white")}jQuery("#tb-layout-logged-in-link").attr("href","https://www.youtube.com/channel/"+TBUtilities.GetUrlParameter("cid"));jQuery(".tb-main-portal-container").css("width","250px");if(jQuery("#tb-pop-out-token-error-id").is(":visible")){jQuery("#tb-layout-logged-in").hide();var y='<div><b style="color:red; font-size:1.2em">Oops! You selected the wrong channel.</b></div>';y+='<div style="padding:13px 0 10px;">Here is a link to the channel you selected: <br><a target="_blank" href="https://www.youtube.com/channel/'+TBUtilities.GetUrlParameter("cid")+'">https://www.youtube.com/channel/'+TBUtilities.GetUrlParameter("cid")+"</a></div>";y+='<div style="padding:13px 0 10px;">This is the channel you\'re logged into YouTube with and should be selecting: <br><a target="_blank" href="https://www.youtube.com/channel/'+TBGlobal.CurrentChannelId()+'">https://www.youtube.com/channel/'+TBGlobal.CurrentChannelId()+"</a></div>";y+="<div style=\"padding:3px 0 10px;\">Sometimes the channel you select has the same logo and/or name so you think it's the same channel but it's actually not. So please try signing in again and selecting the channel that you're currently logged into YouTube with.</div>";TBUtilities.Alert(y)}}T();w();v();if(TBExtension.GetType()=="chrome"){jQuery(".tb-menu-review-us-container-chrome-container").show();TBExtension.GetDbValue("tb-rating-store",function(e,t){TBUtilities.Log("tb-rated-store: "+t);if(t==true)jQuery(".tb-menu-review-us-container-chrome-container").hide()})}else if(TBExtension.GetType()=="firefox"){jQuery(".tb-menu-review-us-container-firefox-container").show();TBExtension.GetDbValue("tb-rating-store",function(e,t){TBUtilities.Log("tb-rated-store: "+t);if(t==true)jQuery(".tb-menu-review-us-container-firefox-container").hide()})}}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyMenu] loadHtml"})}});jQuery(document.body).on("tbMenuGetLastMilestone",function(e,t){TBUtilities.Log("tbMenuGetLastMilestone response");TBUtilities.Log(t);if(t){var i=new Date(new Date(t.value).getTime()+60*60*12*1e3);TBUtilities.Log(i);if(new Date<i){TBUtilities.Log("Done since yesterday");return}}TBUtilities.Log("tbMenuGetLastMilestone loading from DB");y()});jQuery(document.body).on("tbMenuGetLastMilestoneItem",function(e,t){TBUtilities.Log("tbMenuGetLastMilestoneItem response");TBUtilities.Log(t);if(t){l=t.value}})};var _=function(e){var t=TBUtilities.GetActivityLogTypeValueFromString(e);switch(t){case TBUtilities.ActivityLogTypes.QuickLinksMenu_MyAccount:case TBUtilities.ActivityLogTypes.QuickLinksMenu_HealthReport:case TBUtilities.ActivityLogTypes.QuickLinksMenu_CompetitorScorecard:case TBUtilities.ActivityLogTypes.QuickLinksMenu_BrandAlerts:case TBUtilities.ActivityLogTypes.QuickLinksMenu_ABTests:case TBUtilities.ActivityLogTypes.QuickLinksMenu_BackupsAndExports:case TBUtilities.ActivityLogTypes.QuickLinksMenu_CannedResponses:case TBUtilities.ActivityLogTypes.QuickLinksMenu_Settings:case TBUtilities.ActivityLogTypes.QuickLinksMenu_CommunityForums:case TBUtilities.ActivityLogTypes.QuickLinksMenu_TipsAndTricks:case TBUtilities.ActivityLogTypes.QuickLinksMenu_SuggestAFeature:case TBUtilities.ActivityLogTypes.QuickLinksMenu_KnowledgeBase:case TBUtilities.ActivityLogTypes.QuickLinksMenu_TagExplorer:case TBUtilities.ActivityLogTypes.QuickLinksMenu_VideoTopicPlanner:case TBUtilities.ActivityLogTypes.QuickLinksMenu_BestTimeToPublish:case TBUtilities.ActivityLogTypes.QuickLinksMenu_PrivacyPolicy:case TBUtilities.ActivityLogTypes.QuickLinksMenu_TermsOfUse:TBUtilities.AddActivityLog(null,e,"quicklinksmenu");break;case TBUtilities.ActivityLogTypes.QuickLinksMenu_Dashboard:case TBUtilities.ActivityLogTypes.QuickLinksMenu_MyVideos:case TBUtilities.ActivityLogTypes.QuickLinksMenu_Playlists:case TBUtilities.ActivityLogTypes.QuickLinksMenu_LiveStreaming:case TBUtilities.ActivityLogTypes.QuickLinksMenu_Comments:case TBUtilities.ActivityLogTypes.QuickLinksMenu_Subscribers:case TBUtilities.ActivityLogTypes.QuickLinksMenu_Analytics:case TBUtilities.ActivityLogTypes.QuickLinksMenu_Realtime:TBUtilities.AddAction(null,TBUtilities.ActionTypes.QuickLinksMenu_Click,"quicklinksmenu");TBUtilities.AddActivityLog(null,e,"quicklinksmenu");break}};var I=function(){var e=TBGlobal.GetYouTubeUI();if(!i){i=true;TBUtilities.Log(e)}switch(e){case"material":{var t=jQuery("#yt-masthead-user").is(":visible");var o=jQuery("#end").length>0;if(t===true||o===true){h()}else{setTimeout(I,500)}break}case"studio":{var a=jQuery("div.ytcp-header").is(":visible");if(a===true){h()}else{setTimeout(I,500)}break}case"default":{h();break}}};var U=function(t){TBUtilities.Log("TubeBuddyMenu - showMenu");try{jQuery(".tb-main-menu-version-text").text("v"+TBExtension.GetExtensionVersion());try{var i=jQuery("#player").length>0;var o=navigator.userAgent.indexOf("Firefox")>-1;var a=document.location.href.indexOf("/watch")>-1;if(i&&o&&a){jQuery("#watch-header")[0].scrollIntoView()}}catch(e){}N();n=true;if(s==-1){if(TBGlobal.IsAuthenticated())if(t==true)E(TubeBuddyMenu.Tabs.Messages,true);else E(TubeBuddyMenu.Tabs.ThisPage,true);else E(TubeBuddyLayout.Tabs.Profile,true)}var r=jQuery(".tb-main-menu-accordian .tb-main-menu-accordian-content");var l=jQuery(".tb-main-menu-accordian .tb-main-menu-accordian-header");var u=jQuery(".tb-main-menu-accordian");r.hide();u.find(".tb-main-menu-accordian-content").eq(0).show();l.unbind("click");l.on("click",function(){jQuery(this).parents(".tb-main-menu-collapsible").find(".tb-main-menu-accordian-content").stop().slideUp();jQuery(this).next(".tb-main-menu-accordian-content").stop().slideToggle()});var d=jQuery(".tb-menu");var c=jQuery("#tb-main-menu");var p=jQuery(c).offset();var b=p.left-800+"px";d.css({left:b});k();if(TBGlobal.CanAccessLevel1Tools()==false){jQuery(".tb-menu-upgrade-now-container").show()}else{jQuery(".tb-menu-upgrade-now-container").hide()}}catch(t){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyMenu] showMenu"})}finally{jQuery(".tb-menu").show()}};var E=function(e,t){try{n=true;if(t==null)O();if(e==null)e=8;if(!TBGlobal.IsAuthenticated()){jQuery("#tb-popout-profile-missing-tab-header").show();jQuery("#tb-popout-submit-idea-tab-header").hide();jQuery("#tb-popout-settings-tab-header").hide();jQuery("#tb-popout-this-page-tab-header").hide()}if(e!=s){switch(e){case 0:if(TBGlobal.IsAuthenticated()){jQuery("#tb-popout-account-tabs-missing-token").hide();jQuery(".tb-tab-welcome").show();jQuery(".tb-main-content-tabs-welcome").find("span").trigger("click")}else{jQuery("#tb-popout-account-tabs-missing-token").show();jQuery(".tb-tab-welcome").hide();jQuery(".tb-main-content-tabs").hide();jQuery(".tb-main-content-tabs-signin").show();jQuery(".tb-main-content-tabs-signin").find("span").trigger("click")}break;case 4:jQuery(".tb-main-content-tabs-welcome").find("span").trigger("click");break;case 8:jQuery(".tb-main-content-tabs-tools").find("span").trigger("click");break;case 9:jQuery(".tb-main-content-tabs-messages").find("span").trigger("click");break}}if(TBGlobal.Profile()!=null){if(TBGlobal.Profile().IsBanned==true){jQuery("#tb-popout-profile-missing-tab-header").hide();jQuery("#tb-popout-submit-idea-tab-header").hide();jQuery("#tb-popout-settings-tab-header").hide();jQuery("#tb-popout-this-page-tab-header").hide();jQuery(".tb-layout-menu-links-list").hide();jQuery("#tb-popout-banned-tab-header").show();jQuery("#tb-popout-banned-tab-header").trigger("click")}}jQuery(".tb-layout-menu-dropdown").find('li[style*="display:none"], li[style*="display: none"]').each(function(e,t){jQuery(t).remove()});jQuery(".tb-layout-menu-dropdown:first").show();s=e}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyMenu] showTab"})}};var A=function(e){TBUtilities.Log("TubeBuddyMenu - hideMenu");n=false;jQuery(".tb-menu").hide()};var G=function(){r=true;jQuery("#tb-modal-background").css("cursor","no-drop");jQuery("#tb-modal-background").show();D()};var R=function(){r=false;jQuery("#tb-modal-background").css("cursor","no-drop");jQuery("#tb-modal-background").show();D()};var P=function(){r=false;jQuery("#tb-modal-background").hide();D()};var O=function(){TBUtilities.Log("TubeBuddyMenu - showMenuBackground");jQuery("#tb-menu-background").show()};var D=function(){TBUtilities.Log("TubeBuddyMenu - hideMenuBackground");jQuery("#tb-menu-background").hide()};var M=function(){try{var e=jQuery(".tb-menu");var t=e.css("z-index");t=parseInt(t);var i=jQuery("#tb-menu-background");var o=i.css("z-index");o=parseInt(o);if(o>=t){i.css("z-index",t-1)}}catch(e){TBUtilities.LogError(e)}};var N=function(e){TBUtilities.Log("Checking Milestones");TBExtension.GetDbValue("tb-last-milestone-fetch-"+TBGlobal.CurrentChannelId(),"tbMenuGetLastMilestone");TBExtension.GetDbValue("tb-last-milestone-fetch-item-"+TBGlobal.CurrentChannelId(),"tbMenuGetLastMilestoneItem")};var V=function(){try{if(TBGlobal.GetToken()==null||TBGlobal.GetToken().trim()==""){if(TBGlobal.GetToken()==null)TBGlobal.AddDiagnostic("lrte:GT");if(TBGlobal.GetToken()=="")TBGlobal.AddDiagnostic("lrte:ES");m()}else{f()}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyMenu] refreshTokenError"})}};var z=function(){var e='<a target="_blank" href="http://status.tubebuddy.com" onclick="TBUtilities.Alert(\'Sorry, it looks like the TubeBuddy.com website is currently down. This can temporarily happen while we publish updates to our tools.\\n\\nThis message will automatically go away and TubeBuddy functionality will come back when the site is back online.\\n\\nIn the meantime, you can visit http://status.tubebuddy.com to get the current status.\');" class="tb-button tb-button-default" style="margin-right: 10px; padding-right:5px;"><span class="yt-uix-button-content" style="vertical-align: middle; color:red; font-size:11px; font-weight:500">TubeBuddy &#9888;&nbsp;</span></a>';var t=TBGlobal.GetYouTubeUI();switch(t){case"material":{if(jQuery("#end").length>0){jQuery("#end").prepend(e)}else{jQuery("#yt-masthead-user").prepend(e)}break}case"default":{jQuery("#yt-masthead-user").prepend(e);break}case"studio":{var i=jQuery("ytcp-icon-button#search-icon").css("visibility");if(i=="hidden"){jQuery("ytcp-icon-button#search-icon").after(e)}else{jQuery("ytcp-icon-button#search-icon").before(e)}break}}};return{Initialize:function(){if(document.URL.indexOf("youtube.com")==-1||document.URL.indexOf("tubebuddy.com")>=0||document.URL.indexOf("localhost")>=0)return;if(!t){if(TBGlobal.CurrentChannelId()=="U"+"C"+"jbhDmV6Yl-nS7OQOnmgdSA"||TBGlobal.CurrentChannelId()=="U"+"C"+"b6EhLOlLuL2PkJYGfmslGw"||TBGlobal.CurrentChannelId()=="U"+"C"+"4S0693-QVZqxBKLj7vq0Zw"){TBUtilities.ForceDebugging()}I();x();L();t=true;var e=TBExtension.GetExtensionVersion();TBUtilities.Log("TubeBuddyLayout - Extension Version: "+e)}},Tabs:{Welcome:0,Support:3,Features:4,Insiders:5,SubmitIdea:6,Home:7,ThisPage:8,Messages:9},ShowBackground:function(){R()},ShowBackgroundSticky:function(){G()},HideBackground:function(){P()},ShowTubeBuddyPanel:function(e){showTubeBuddyPanel(e)},RefreshTokenError:function(){V()},FailedToLoadProfile:function(){z()},SubscribedNowLogin:function(){S()}}}();!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e(require("jquery")):e(jQuery)}(function(e){function t(t,i){this.element=t,this.$element=e(this.element),this.doc=e(document),this.win=e(window),this.settings=e.extend({},n,i),"object"==typeof this.$element.data("tipso")&&e.extend(this.settings,this.$element.data("tipso"));for(var o=Object.keys(this.$element.data()),a={},l=0;l<o.length;l++){var u=o[l].replace(s,"");if(""!==u){u=u.charAt(0).toLowerCase()+u.slice(1),a[u]=this.$element.data(o[l]);for(var d in this.settings)d.toLowerCase()==u&&(this.settings[d]=a[u])}}this._defaults=n,this._name=s,this._title=this.$element.attr("title"),this.mode="hide",this.ieFade=!r,this.settings.preferedPosition=this.settings.position,this.init()}function i(t){var i=t.clone();i.css("visibility","hidden"),e("body").append(i);var o=i.outerHeight(),a=i.outerWidth();return i.remove(),{width:a,height:o}}function o(e){e.removeClass("top_right_corner bottom_right_corner top_left_corner bottom_left_corner"),e.find(".tipso_title").removeClass("top_right_corner bottom_right_corner top_left_corner bottom_left_corner")}function a(t){var s,n,r,l=t.tooltip(),u=t.$element,d=t,c=e(window),p=10,b=d.settings.background,h=d.titleContent();switch(void 0!==h&&""!==h&&(b=d.settings.titleBackground),u.parent().outerWidth()>c.outerWidth()&&(c=u.parent()),d.settings.position){case"top-right":n=u.offset().left+u.outerWidth(),s=u.offset().top-i(l).height-p,l.find(".tipso_arrow").css({marginLeft:-d.settings.arrowWidth,marginTop:""}),s<c.scrollTop()?(s=u.offset().top+u.outerHeight()+p,l.find(".tipso_arrow").css({"border-bottom-color":b,"border-top-color":"transparent","border-left-color":"transparent","border-right-color":"transparent"}),o(l),l.addClass("bottom_right_corner"),l.find(".tipso_title").addClass("bottom_right_corner"),l.find(".tipso_arrow").css({"border-left-color":b}),l.removeClass("top-right top bottom left right"),l.addClass("bottom")):(l.find(".tipso_arrow").css({"border-top-color":d.settings.background,"border-bottom-color":"transparent ","border-left-color":"transparent","border-right-color":"transparent"}),o(l),l.addClass("top_right_corner"),l.find(".tipso_arrow").css({"border-left-color":d.settings.background}),l.removeClass("top bottom left right"),l.addClass("top"));break;case"top-left":n=u.offset().left-i(l).width,s=u.offset().top-i(l).height-p,l.find(".tipso_arrow").css({marginLeft:-d.settings.arrowWidth,marginTop:""}),s<c.scrollTop()?(s=u.offset().top+u.outerHeight()+p,l.find(".tipso_arrow").css({"border-bottom-color":b,"border-top-color":"transparent","border-left-color":"transparent","border-right-color":"transparent"}),o(l),l.addClass("bottom_left_corner"),l.find(".tipso_title").addClass("bottom_left_corner"),l.find(".tipso_arrow").css({"border-right-color":b}),l.removeClass("top-right top bottom left right"),l.addClass("bottom")):(l.find(".tipso_arrow").css({"border-top-color":d.settings.background,"border-bottom-color":"transparent ","border-left-color":"transparent","border-right-color":"transparent"}),o(l),l.addClass("top_left_corner"),l.find(".tipso_arrow").css({"border-right-color":d.settings.background}),l.removeClass("top bottom left right"),l.addClass("top"));break;case"bottom-right":n=u.offset().left+u.outerWidth(),s=u.offset().top+u.outerHeight()+p,l.find(".tipso_arrow").css({marginLeft:-d.settings.arrowWidth,marginTop:""}),s+i(l).height>c.scrollTop()+c.outerHeight()?(s=u.offset().top-i(l).height-p,l.find(".tipso_arrow").css({"border-bottom-color":"transparent","border-top-color":d.settings.background,"border-left-color":"transparent","border-right-color":"transparent"}),o(l),l.addClass("top_right_corner"),l.find(".tipso_title").addClass("top_left_corner"),l.find(".tipso_arrow").css({"border-left-color":d.settings.background}),l.removeClass("top-right top bottom left right"),l.addClass("top")):(l.find(".tipso_arrow").css({"border-top-color":"transparent","border-bottom-color":b,"border-left-color":"transparent","border-right-color":"transparent"}),o(l),l.addClass("bottom_right_corner"),l.find(".tipso_title").addClass("bottom_right_corner"),l.find(".tipso_arrow").css({"border-left-color":b}),l.removeClass("top bottom left right"),l.addClass("bottom"));break;case"bottom-left":n=u.offset().left-i(l).width,s=u.offset().top+u.outerHeight()+p,l.find(".tipso_arrow").css({marginLeft:-d.settings.arrowWidth,marginTop:""}),s+i(l).height>c.scrollTop()+c.outerHeight()?(s=u.offset().top-i(l).height-p,l.find(".tipso_arrow").css({"border-bottom-color":"transparent","border-top-color":d.settings.background,"border-left-color":"transparent","border-right-color":"transparent"}),o(l),l.addClass("top_left_corner"),l.find(".tipso_title").addClass("top_left_corner"),l.find(".tipso_arrow").css({"border-right-color":d.settings.background}),l.removeClass("top-right top bottom left right"),l.addClass("top")):(l.find(".tipso_arrow").css({"border-top-color":"transparent","border-bottom-color":b,"border-left-color":"transparent","border-right-color":"transparent"}),o(l),l.addClass("bottom_left_corner"),l.find(".tipso_title").addClass("bottom_left_corner"),l.find(".tipso_arrow").css({"border-right-color":b}),l.removeClass("top bottom left right"),l.addClass("bottom"));break;case"top":n=u.offset().left+u.outerWidth()/2-i(l).width/2,s=u.offset().top-i(l).height-p,l.find(".tipso_arrow").css({marginLeft:-d.settings.arrowWidth,marginTop:""}),s<c.scrollTop()?(s=u.offset().top+u.outerHeight()+p,l.find(".tipso_arrow").css({"border-bottom-color":b,"border-top-color":"transparent","border-left-color":"transparent","border-right-color":"transparent"}),l.removeClass("top bottom left right"),l.addClass("bottom")):(l.find(".tipso_arrow").css({"border-top-color":d.settings.background,"border-bottom-color":"transparent","border-left-color":"transparent","border-right-color":"transparent"}),l.removeClass("top bottom left right"),l.addClass("top"));break;case"bottom":n=u.offset().left+u.outerWidth()/2-i(l).width/2,s=u.offset().top+u.outerHeight()+p,l.find(".tipso_arrow").css({marginLeft:-d.settings.arrowWidth,marginTop:""}),s+i(l).height>c.scrollTop()+c.outerHeight()?(s=u.offset().top-i(l).height-p,l.find(".tipso_arrow").css({"border-top-color":d.settings.background,"border-bottom-color":"transparent","border-left-color":"transparent","border-right-color":"transparent"}),l.removeClass("top bottom left right"),l.addClass("top")):(l.find(".tipso_arrow").css({"border-bottom-color":b,"border-top-color":"transparent","border-left-color":"transparent","border-right-color":"transparent"}),l.removeClass("top bottom left right"),l.addClass(d.settings.position));break;case"left":n=u.offset().left-i(l).width-p,s=u.offset().top+u.outerHeight()/2-i(l).height/2,l.find(".tipso_arrow").css({marginTop:-d.settings.arrowWidth,marginLeft:""}),n<c.scrollLeft()?(n=u.offset().left+u.outerWidth()+p,l.find(".tipso_arrow").css({"border-right-color":d.settings.background,"border-left-color":"transparent","border-top-color":"transparent","border-bottom-color":"transparent"}),l.removeClass("top bottom left right"),l.addClass("right")):(l.find(".tipso_arrow").css({"border-left-color":d.settings.background,"border-right-color":"transparent","border-top-color":"transparent","border-bottom-color":"transparent"}),l.removeClass("top bottom left right"),l.addClass(d.settings.position));break;case"right":n=u.offset().left+u.outerWidth()+p,s=u.offset().top+u.outerHeight()/2-i(l).height/2,l.find(".tipso_arrow").css({marginTop:-d.settings.arrowWidth,marginLeft:""}),n+p+d.settings.width>c.scrollLeft()+c.outerWidth()?(n=u.offset().left-i(l).width-p,l.find(".tipso_arrow").css({"border-left-color":d.settings.background,"border-right-color":"transparent","border-top-color":"transparent","border-bottom-color":"transparent"}),l.removeClass("top bottom left right"),l.addClass("left")):(l.find(".tipso_arrow").css({"border-right-color":d.settings.background,"border-left-color":"transparent","border-top-color":"transparent","border-bottom-color":"transparent"}),l.removeClass("top bottom left right"),l.addClass(d.settings.position))}if("top-right"===d.settings.position&&l.find(".tipso_arrow").css({"margin-left":-d.settings.width/2}),"top-left"===d.settings.position){var m=l.find(".tipso_arrow").eq(0);m.css({"margin-left":d.settings.width/2-2*d.settings.arrowWidth})}if("bottom-right"===d.settings.position){var m=l.find(".tipso_arrow").eq(0);m.css({"margin-left":-d.settings.width/2,"margin-top":""})}if("bottom-left"===d.settings.position){var m=l.find(".tipso_arrow").eq(0);m.css({"margin-left":d.settings.width/2-2*d.settings.arrowWidth,"margin-top":""})}n<c.scrollLeft()&&("bottom"===d.settings.position||"top"===d.settings.position)&&(l.find(".tipso_arrow").css({marginLeft:n-d.settings.arrowWidth}),n=0),n+d.settings.width>c.outerWidth()&&("bottom"===d.settings.position||"top"===d.settings.position)&&(r=c.outerWidth()-(n+d.settings.width),l.find(".tipso_arrow").css({marginLeft:-r-d.settings.arrowWidth,marginTop:""}),n+=r),n<c.scrollLeft()&&("left"===d.settings.position||"right"===d.settings.position||"top-right"===d.settings.position||"top-left"===d.settings.position||"bottom-right"===d.settings.position||"bottom-left"===d.settings.position)&&(n=u.offset().left+u.outerWidth()/2-i(l).width/2,l.find(".tipso_arrow").css({marginLeft:-d.settings.arrowWidth,marginTop:""}),s=u.offset().top-i(l).height-p,s<c.scrollTop()?(s=u.offset().top+u.outerHeight()+p,l.find(".tipso_arrow").css({"border-bottom-color":b,"border-top-color":"transparent","border-left-color":"transparent","border-right-color":"transparent"}),l.removeClass("top bottom left right"),o(l),l.addClass("bottom")):(l.find(".tipso_arrow").css({"border-top-color":d.settings.background,"border-bottom-color":"transparent","border-left-color":"transparent","border-right-color":"transparent"}),l.removeClass("top bottom left right"),o(l),l.addClass("top")),n+d.settings.width>c.outerWidth()&&(r=c.outerWidth()-(n+d.settings.width),l.find(".tipso_arrow").css({marginLeft:-r-d.settings.arrowWidth,marginTop:""}),n+=r),n<c.scrollLeft()&&(l.find(".tipso_arrow").css({marginLeft:n-d.settings.arrowWidth}),n=0)),n+d.settings.width>c.outerWidth()&&("left"===d.settings.position||"right"===d.settings.position||"top-right"===d.settings.position||"top-left"===d.settings.position||"bottom-right"===d.settings.position||"bottom-right"===d.settings.position)&&(n=u.offset().left+u.outerWidth()/2-i(l).width/2,l.find(".tipso_arrow").css({marginLeft:-d.settings.arrowWidth,marginTop:""}),s=u.offset().top-i(l).height-p,s<c.scrollTop()?(s=u.offset().top+u.outerHeight()+p,l.find(".tipso_arrow").css({"border-bottom-color":b,"border-top-color":"transparent","border-left-color":"transparent","border-right-color":"transparent"}),o(l),l.removeClass("top bottom left right"),l.addClass("bottom")):(l.find(".tipso_arrow").css({"border-top-color":d.settings.background,"border-bottom-color":"transparent","border-left-color":"transparent","border-right-color":"transparent"}),o(l),l.removeClass("top bottom left right"),l.addClass("top")),n+d.settings.width>c.outerWidth()&&(r=c.outerWidth()-(n+d.settings.width),l.find(".tipso_arrow").css({marginLeft:-r-d.settings.arrowWidth,marginTop:""}),n+=r),n<c.scrollLeft()&&(l.find(".tipso_arrow").css({marginLeft:n-d.settings.arrowWidth}),n=0)),l.css({left:n+d.settings.offsetX,top:s+d.settings.offsetY}),s<c.scrollTop()&&("right"===d.settings.position||"left"===d.settings.position)&&(u.tipso("update","position","bottom"),a(d)),s+i(l).height>c.scrollTop()+c.outerHeight()&&("right"===d.settings.position||"left"===d.settings.position)&&(u.tipso("update","position","top"),a(d))}var s="tipso",n={speed:400,background:"#55b555",titleBackground:"#333333",color:"#ffffff",titleColor:"#ffffff",titleContent:"",showArrow:!0,position:"top",width:200,maxWidth:"",delay:200,hideDelay:0,animationIn:"",animationOut:"",offsetX:0,offsetY:0,arrowWidth:8,tooltipHover:!1,content:null,ajaxContentUrl:null,ajaxContentBuffer:0,contentElementId:null,useTitle:!1,templateEngineFunc:null,onBeforeShow:null,onShow:null,onHide:null};e.extend(t.prototype,{init:function(){{var e=this,t=this.$element;this.doc}if(t.addClass("tipso_style").removeAttr("title"),e.settings.tooltipHover){var i=null,o=null;t.on("mouseover."+s,function(){clearTimeout(i),clearTimeout(o),o=setTimeout(function(){e.show()},150)}),t.on("mouseout."+s,function(){clearTimeout(i),clearTimeout(o),i=setTimeout(function(){e.hide()},200),e.tooltip().on("mouseover."+s,function(){e.mode="tooltipHover"}).on("mouseout."+s,function(){e.mode="show",clearTimeout(i),i=setTimeout(function(){e.hide()},200)})})}else t.on("mouseover."+s,function(){e.show()}),t.on("mouseout."+s,function(){e.hide()});e.settings.ajaxContentUrl&&(e.ajaxContent=null)},tooltip:function(){return this.tipso_bubble||(this.tipso_bubble=e('<div class="tipso_bubble"><div class="tipso_title"></div><div class="tipso_content"></div><div class="tipso_arrow"></div></div>')),this.tipso_bubble},show:function(){var t=this.tooltip(),i=this,o=this.win;i.settings.showArrow===!1?t.find(".tipso_arrow").hide():t.find(".tipso_arrow").show(),"hide"===i.mode&&(e.isFunction(i.settings.onBeforeShow)&&i.settings.onBeforeShow(i.$element,i.element,i),i.settings.size&&t.addClass(i.settings.size),i.settings.width?t.css({background:i.settings.background,color:i.settings.color,width:i.settings.width}).hide():i.settings.maxWidth?t.css({background:i.settings.background,color:i.settings.color,maxWidth:i.settings.maxWidth}).hide():t.css({background:i.settings.background,color:i.settings.color,width:200}).hide(),t.find(".tipso_title").css({background:i.settings.titleBackground,color:i.settings.titleColor}),t.find(".tipso_content").html(i.content()),t.find(".tipso_title").html(i.titleContent()),a(i),o.on("resize."+s,function(){i.settings.position=i.settings.preferedPosition,a(i)}),window.clearTimeout(i.timeout),i.timeout=null,i.timeout=window.setTimeout(function(){i.ieFade||""===i.settings.animationIn||""===i.settings.animationOut?t.appendTo("body").stop(!0,!0).fadeIn(i.settings.speed,function(){i.mode="show",e.isFunction(i.settings.onShow)&&i.settings.onShow(i.$element,i.element,i)}):t.remove().appendTo("body").stop(!0,!0).removeClass("animated "+i.settings.animationOut).addClass("noAnimation").removeClass("noAnimation").addClass("animated "+i.settings.animationIn).fadeIn(i.settings.speed,function(){e(this).one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){e(this).removeClass("animated "+i.settings.animationIn)}),i.mode="show",e.isFunction(i.settings.onShow)&&i.settings.onShow(i.$element,i.element,i),o.off("resize."+s,null,"tipsoResizeHandler")})},i.settings.delay))},hide:function(t){var i=this,o=this.win,a=this.tooltip(),n=i.settings.hideDelay;t&&(n=0,i.mode="show"),window.clearTimeout(i.timeout),i.timeout=null,i.timeout=window.setTimeout(function(){"tooltipHover"!==i.mode&&(i.ieFade||""===i.settings.animationIn||""===i.settings.animationOut?a.stop(!0,!0).fadeOut(i.settings.speed,function(){e(this).remove(),e.isFunction(i.settings.onHide)&&"show"===i.mode&&i.settings.onHide(i.$element,i.element,i),i.mode="hide",o.off("resize."+s,null,"tipsoResizeHandler")}):a.stop(!0,!0).removeClass("animated "+i.settings.animationIn).addClass("noAnimation").removeClass("noAnimation").addClass("animated "+i.settings.animationOut).one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){e(this).removeClass("animated "+i.settings.animationOut).remove(),e.isFunction(i.settings.onHide)&&"show"===i.mode&&i.settings.onHide(i.$element,i.element,i),i.mode="hide",o.off("resize."+s,null,"tipsoResizeHandler")}))},n)},close:function(){this.hide(!0)},destroy:function(){{var e=this.$element,t=this.win;this.doc}e.off("."+s),t.off("resize."+s,null,"tipsoResizeHandler"),e.removeData(s),e.removeClass("tipso_style").attr("title",this._title)},titleContent:function(){var e,t=this.$element,i=this;return e=i.settings.titleContent?i.settings.titleContent:t.data("tipso-title")},content:function(){var t,i=this.$element,o=this,a=this._title;return o.settings.ajaxContentUrl?o._ajaxContent?t=o._ajaxContent:(o._ajaxContent=t=e.ajax({type:"GET",url:o.settings.ajaxContentUrl,async:!1}).responseText,o.settings.ajaxContentBuffer>0?setTimeout(function(){o._ajaxContent=null},o.settings.ajaxContentBuffer):o._ajaxContent=null):o.settings.contentElementId?t=e("#"+o.settings.contentElementId).text():o.settings.content?t=o.settings.content:o.settings.useTitle===!0?t=a:"string"==typeof i.data("tipso")&&(t=i.data("tipso")),null!==o.settings.templateEngineFunc&&(t=o.settings.templateEngineFunc(t)),t},update:function(e,t){var i=this;return t?void(i.settings[e]=t):i.settings[e]}});var r=function(){var e=document.createElement("p").style,t=["ms","O","Moz","Webkit"];if(""===e.transition)return!0;for(;t.length;)if(t.pop()+"Transition"in e)return!0;return!1}();e[s]=e.fn[s]=function(i){var o=arguments;if(void 0===i||"object"==typeof i)return this instanceof e||e.extend(n,i),this.each(function(){e.data(this,"plugin_"+s)||e.data(this,"plugin_"+s,new t(this,i))});if("string"==typeof i&&"_"!==i[0]&&"init"!==i){var a;return this.each(function(){var n=e.data(this,"plugin_"+s);n||(n=e.data(this,"plugin_"+s,new t(this,i))),n instanceof t&&"function"==typeof n[i]&&(a=n[i].apply(n,Array.prototype.slice.call(o,1))),"destroy"===i&&e.data(this,"plugin_"+s,null)}),void 0!==a?a:this}}});var ManageSubscriberCache=function(){var e=false;var t;var i=[];var o=function(i,o){if(!e){a();e=true}var s=new Date;var n=new Date;var r=lscache.get("tbLastSubsCacheUpdateDate"+TBGlobal.CurrentChannelId());if(r==null){t=new Date;lscache.set("tbLastSubsCacheUpdateDate"+TBGlobal.CurrentChannelId(),t);var l=TBGlobal.host+"/api/youtubechannel/GetChannelSubscribers?channelId="+i+"&maxSubscribers="+o;TBExtension.Get(l,"CRTBupdateCache")}else{var u=r;n=new Date(u);n.setDate(n.getDate()+1);if(n<s){TBUtilities.Log("Cache storage needs to be updated.");t=new Date;lscache.remove("tbLastSubsCacheUpdateDate"+TBGlobal.CurrentChannelId());t=new Date;lscache.set("tbLastSubsCacheUpdateDate"+TBGlobal.CurrentChannelId(),t);var l=TBGlobal.host+"/api/youtubechannel/GetChannelSubscribers?channelId="+i+"&maxSubscribers="+o;TBExtension.Get(l,"CRTBupdateCache")}}};var a=function(){jQuery(document.body).on("CRTBupdateCache",function(e,t){if(t.success){i=JSON.parse(t.response);lscache.remove("tbSubscriberCache"+TBGlobal.CurrentChannelId());lscache.set("tbSubscriberCache"+TBGlobal.CurrentChannelId(),i,2880)}})};return{Initialize:function(){if(!e){a();e=true}},RefreshSubscribersCache:function(e,t){o(e,t)}}}();var TubeBuddyChannelytics=function(){var e=false;var t=false;var i=null;var o=null;var a=null;var s=null;var n=null;var r=null;var l=null;var u=null;var d=null;var c=null;var p=null;var b=null;var h=null;var m=null;var f=null;var y=null;var g=[];var v=null;var T=null;var j=null;var Q=null;var w;var k=[];var B=null;var C=null;var x=null;var S=null;var L=null;var _=null;var I=false;var U=null;var E=null;var A=function(){var e=TBGlobal.GetYouTubeUI();switch(e){case"studio":case"material":{var i=jQuery("ytd-expandable-tab-renderer:not(.channelytics__tab-material):last");var o=i.find(".channelytics__tab-material").length;if(o<1){var a=DOMPurify.sanitize(jQuery(".channelytics__tab-material:last")[0].outerHTML,DOMPurifyConfig);i.append(a);_=i.find(".channelytics__tab-material")}break}case"default":{jQuery("#channel-search").parent().before(DOMPurify.sanitize(jQuery(".channelytics__tab-item:last")[0].outerHTML,DOMPurifyConfig));_=jQuery("#channel-search").parent().siblings(".channelytics__tab-item");jQuery(".appbar-nav-menu").append(jQuery(".channelytics__tab-item:last")[0].outerHTML);break}}var s=window.location.pathname.split("/");var n=s.toString().toLowerCase().split(",");var r=n.indexOf("user");var l=n.indexOf("channel");var u=n.indexOf("c");if(r!==-1){channel=s[r+1];T="https://www.youtube.com/user/"+channel}else if(l!==-1){channel=s[l+1];T="https://www.youtube.com/channel/"+channel}else if(u!==-1){channel=s[u+1];T="https://www.youtube.com/c/"+channel}else if(s.length==2&&s[0]===""&&s[1]!==""&&n[1]!=="watch"){channel=s[1];T="https://www.youtube.com/"+channel}else{channel=null}if(channel===null){TBUtilities.Log("Channelytics Unknown channel - cleaning page");oe(true)}else{if(C!==null&&C!==channel){oe(true)}C=channel;if(TBGlobal.Profile().SettingsShowChannelytics===false){jQuery("#tubebuddyChannelytics").hide();t=false;_.show();return}else{_.hide()}G()}};var G=function(){var e=O();if(e===true){if(jQuery("ytd-channel-featured-content-renderer").length>0){TBUtilities.Log("loadCharts - 1st method");jQuery("ytd-channel-featured-content-renderer:first").before(jQuery("#tubebuddyChannelytics")[0].outerHTML);B=jQuery("ytd-channel-featured-content-renderer").siblings("#tubebuddyChannelytics");var t=B.parent();B.prependTo(t)}else{TBUtilities.Log("loadCharts - 2nd method");var i=jQuery('ytd-two-column-browse-results-renderer[page-subtype="channels"]');var o=i.find("#header-container");o.before(jQuery("#tubebuddyChannelytics")[0].outerHTML);B=o.siblings("#tubebuddyChannelytics")}TubeBuddyYouTubeActions.GetChannelInfoFromPage(window.location.href,z);X()}else{oe()}};var R=function(e,t){return Math.floor(Math.random()*(1+t-e))+e};var P=function(){var e=false;var t=window.location.hostname;if(t==="studio.youtube.com"){e=false}else{var i=window.location.pathname.split("/");var o=i.toString().toLowerCase().split(",");var a=o.indexOf("channel");var s=o.indexOf("c");var n=o.indexOf("user");if(n!==-1){e=true}else if(a!==-1){e=true}else if(s!==-1){e=true}else if(o.length==2&&o[0]===""&&o[1]!==""&&o[1]!=="watch"){e=true}}TBUtilities.Log("Channelytics - On channel page = "+e);return e};var O=function(){var e=false;var t=window.location.hostname;if(t==="studio.youtube.com"){e=false}else{e=jQuery("#tabsContent").find("paper-tab:first").hasClass("iron-selected")}TBUtilities.Log("Channelytics - On home tab selected = "+e);return e};var D=function(){var e=TBGlobal.host+"/ModuleManager/Channelytics/Channelytics?v="+TBGlobal.versionNumber;if(loadLocalHTML&&(TBExtension.GetType()==="chrome"||TBExtension.GetType()==="firefox")){e=chrome.extension.getURL("modules/channelytics.html")}else if(loadLocalHTML&&TBExtension.GetType()==="safari"){e="modules/channelytics.html"}TBExtension.Get(e,"ChannelyticsTemplate")};var M=function(){if(g.length>0){jQuery(".channel__tags--copy").show();jQuery("#channel__tags").empty();jQuery.each(g,function(e,t){if(t.length>0){jQuery("#channel__tags").append("<li class='channel__tags--tag'>"+t+"</li>");return e}else{jQuery(".channelytics-tags").hide();return false}})}else{jQuery(".channel__tags--copy").hide()}};var N=function(){jQuery(document).on("click",".channelytics__tab-material",function(e){e.stopPropagation();jQuery("#tubebuddyChannelytics").show();V(true);if(t===false){I=true;oe(true);TBGlobal.Profile().SettingsShowChannelytics=true;A()}_.hide()});jQuery(document).on("click",".compare__header--close",function(e){e.stopPropagation();jQuery("#tubebuddyChannelytics").hide();V(false);oe(true);t=false;_.show()});jQuery(document).on("click",".channel__tags--copy",function(e){e.stopPropagation();TubeBuddyCopyTo.ShowMenu(jQuery(this),g,true,null,150)});jQuery(document).on("change","#tb-channelytics-chart-type",function(){q(1);K()})};var V=function(e){var t={Enabled:e};TBUtilities.Log(t);var i=TBGlobal.host+TBGlobal.apiUrls.youtubeChannelToggleChannelytics;TBExtension.Post(i,JSON.stringify(t),"",null,{contentType:"application/json"})};var z=function(e){TBUtilities.Log("Got Channel Info");TBUtilities.Log(e);if(e){try{v=e.Title;i=e.ChannelId;jQuery("#channel__id").text(i);jQuery(".channelytics-id--target").html(i);jQuery(".channelytics-id--target").attr("data-clipboard-text",i);var o=new ClipboardJS(".channelytics-id--target");g=[];var a=e.Tags.match(/\w+|"(?:\\"|[^"])+"/g);if(a){jQuery.each(a,function(e,t){t=t.replace(/['"]+/g,"");g.push(t)})}M();if(t===false||I===true){t=true;I=false;K();q(1)}}catch(e){TBUtilities.Log(e)}}else{oe(true)}};var F=function(e,t,i){x=jQuery(".tb-channelytics-subscribers:first").highcharts({chart:{type:"spline",animation:Highcharts.svg,marginTop:10,marginRight:10,width:null,backgroundColor:"transparent",height:200},title:{text:null},credits:{enabled:false},xAxis:{categories:i,labels:{rotation:60},tickInterval:3},yAxis:{title:{text:null},gridLineDashStyle:"longdash",endOnTick:false,maxPadding:.2,plotLines:[{value:0,width:1,color:"#808080"}],min:0},plotOptions:{spline:{marker:{enabled:false}}},tooltip:{formatter:function(){var e="gained";var t="subscribers ";var i=Math.abs(this.y);if(this.y<0){e="lost"}if(i===1){t="subscriber "}return this.x+"<br> <b>"+TBUtilities.FormatNumberAbbreviated(i)+"</b>  "+t+e}},legend:{enabled:false,layout:"horizontal",align:"center",verticalAlign:"bottom",borderWidth:0},series:[{name:TBGlobal.Profile().Title,data:e,color:"#4A90E2"},{name:v,data:t,color:"#c62828"}],responsive:{rules:[{condition:{minWidth:400},chartOptions:{legend:{align:"center",verticalAlign:"bottom"},yAxis:{labels:{align:"left",x:0,y:-5},title:{text:null}},subtitle:{text:null},credits:{enabled:false}}}]}});jQuery(".tb-statfire-subscribers-loading:first").hide()};var $=function(e,t,i){S=jQuery(".tb-channelytics-views:first").highcharts({chart:{type:"spline",animation:Highcharts.svg,marginRight:10,width:null,backgroundColor:"transparent",height:200},title:{text:""},credits:{enabled:false},xAxis:{categories:i,labels:{rotation:60},tickInterval:3},yAxis:{title:{text:null},min:0,gridLineDashStyle:"longdash",endOnTick:false,maxPadding:.3,plotLines:[{value:0,width:0,color:"#808080"}]},plotOptions:{spline:{marker:{enabled:false}}},tooltip:{formatter:function(){var e="gained";var t=Math.abs(this.y);if(this.y<0){e="lost"}return this.x+"<br> <b>"+TBUtilities.FormatNumberAbbreviated(t)+"</b> views "+e}},legend:{enabled:false,layout:"horizontal",align:"center",verticalAlign:"bottom",borderWidth:0},series:[{name:TBGlobal.Profile().Title,data:e,color:"#4A90E2"},{name:v,data:t,color:"#c62828"}],responsive:{rules:[{condition:{minWidth:400},chartOptions:{legend:{align:"center",verticalAlign:"bottom",layout:"horizontal"},yAxis:{labels:{align:"left",x:0,y:-5},title:{text:null}},subtitle:{text:null},credits:{enabled:false}}}]}});jQuery(".tb-statfire-views-loading:first").hide()};var H=function(e,t,i){L=jQuery(".tb-channelytics-videos:first").highcharts({chart:{type:"spline",animation:Highcharts.svg,marginRight:10,width:null,backgroundColor:"transparent",height:200},title:{text:null},credits:{enabled:false},xAxis:{categories:i,labels:{rotation:60},tickInterval:3},yAxis:{allowDecimals:false,title:{text:"Videos Uploaded"},gridLineDashStyle:"longdash",endOnTick:false,maxPadding:.5,plotLines:[{value:0,width:0,color:"#808080"}],min:0},plotOptions:{spline:{marker:{enabled:false}}},tooltip:{formatter:function(){var e="uploaded";var t="videos ";var i=Math.abs(this.y);if(this.y<0){e="lost"}if(i===1){t="video "}return this.x+" <br><b>"+TBUtilities.FormatNumberAbbreviated(this.y)+"</b>  "+t+e}},legend:{enabled:false,layout:"horizontal",align:"center",verticalAlign:"bottom",borderWidth:0},series:[{name:TBGlobal.Profile().Title,data:e,color:"#4A90E2"},{name:v,data:t,color:"#c62828"}],responsive:{rules:[{condition:{minWidth:400},chartOptions:{legend:{align:"center",verticalAlign:"bottom",layout:"horizontal"},yAxis:{labels:{align:"left",x:0,y:-5},title:{text:null}},subtitle:{text:null},credits:{enabled:false}}}]}});jQuery(".tb-statfire-videos-loading:first").hide()};var Y=function(){jQuery(document.body).on("ChannelyticsTemplate",function(e,t){try{if(t.success){t.response=TBUtilities.FixLocalHtml(t.response);jQuery("body").append(t.response);A()}}catch(e){TBUtilities.LogError({Exception:e,Location:"[Channelytics] ChannelyticsTemplate"})}})};var W=function(e,t,i){var o="";if(e.indexOf("UC")===0&&e.length==="UCo33niDKpTpgwZ_dohqvylg".length){o="https://www.youtube.com/channel/"+e}else{o="https://www.youtube.com/user/"+e}var a=window.open(o,"_blank")};var K=function(){var e=jQuery("#tb-channelytics-chart-type").val();jQuery(".tb-channelytics-chart").hide();switch(e){case"subscribers":if(!jQuery(".tb-channelytics-subscribers").highcharts()){jQuery(".tb-channelytics-subscribers-container").show();jQuery(".tb-channelytics-subscribers-loading").show()}else{jQuery(".tb-channelytics-subscribers-container").show();jQuery(".tb-channelytics-subscribers").highcharts().redraw()}break;case"views":if(!jQuery(".tb-channelytics-views").highcharts()){jQuery(".tb-channelytics-views-container").show();jQuery(".tb-channelytics-views-loading").show()}else{jQuery(".tb-channelytics-views-container").show();jQuery(".tb-channelytics-views").highcharts().redraw()}break;case"videos":if(!jQuery(".tb-channelytics-videos").highcharts()){jQuery(".tb-channelytics-videos-container").show();jQuery(".tb-channelytics-videos-loading").show()}else{jQuery(".tb-channelytics-videos-container").show();jQuery(".tb-channelytics-videos").highcharts().redraw()}break}};var q=function(e){if(U==null||o===null||o!==i){o=i;TubeBuddyStatFire.GetCompetitorChannelStats(TBGlobal.CurrentChannelId(),i,e,30,TubeBuddyChannelytics.GotChannelStats)}else{ee(U,E)}};var J=function(e){var t=jQuery("#tb-channelytics-chart-type").val();var i=new Array;jQuery.each(e,function(e,o){switch(t){case"subscribers":{i.push(o.SubscribersGained);break}case"views":{i.push(o.ViewsGained);break}case"videos":{i.push(o.VideosUploaded);break}}});TBUtilities.Log("createDataPoints results");TBUtilities.Log(i);return i};var X=function(){TubeBuddyYouTubeActions.GetChannelInfoFromAboutPage(T,Z,true)};var Z=function(e){TBUtilities.Log("info");TBUtilities.Log(e);if(e&&e.channelViews){Q=e.channelViews}};var ee=function(e,t){U=e;E=t;if(t.CompetitorStats.length>0){var o=t.CompetitorStats.slice(0);var n=o.reverse();var r=null;for(var d=0,c=n.length;d<c;d++){var h=n[d];if(h.VideoCount){r=h;break}}if(r!=null)j=r.VideoCount}a=J(t.ChannelStats);s=J(t.CompetitorStats);F(a,s,t.Labels);p=a;b=s;$(a,s,t.Labels);l=a;u=s;H(a,s,t.Labels);f=a;y=s;te();if(TBGlobal.CurrentChannelId()===i){x.highcharts().series[1].hide();S.highcharts().series[0].hide();L.highcharts().series[0].hide();jQuery(".compare__header--data").hide();jQuery(".compare__header--you").parent().show()}else{x.highcharts().series[1].show();S.highcharts().series[0].show();L.highcharts().series[0].show();jQuery(".compare__header--data").show();jQuery(".compare__header--them").parent().show()}ie()};var te=function(){if(Q&&Q>0)jQuery("#tb-channelytics-stat-views").text(TBUtilities.FormatNumberAbbreviated(Q));if(j&&j>0)jQuery("#tb-channelytics-stat-videos").text(TBUtilities.FormatNumberAbbreviated(j));if(E.CompetitorStats&&E.CompetitorStats.length>0){var e=E.CompetitorStats.reduce(function(e,t){return e+t.ViewsGained},0);var t=E.CompetitorStats.reduce(function(e,t){return e+t.VideosUploaded},0);if(e&&e>0)jQuery("#tb-channelytics-stat-views-last30").text(TBUtilities.FormatNumberAbbreviated(e));if(t&&t>0)jQuery("#tb-channelytics-stat-videos-last30").text(TBUtilities.FormatNumberAbbreviated(t))}jQuery("#tb-channelytics-stat-grid-container").show();S.highcharts().reflow();L.highcharts().reflow();x.highcharts().reflow()};var ie=function(){var e=0;var t=0;var i=jQuery("#tb-channelytics-chart-type").val();switch(i){case"subscribers":jQuery.each(p,function(t,i){e+=i});jQuery.each(b,function(e,i){t+=i});break;case"views":jQuery.each(l,function(t,i){e+=i});jQuery.each(u,function(e,i){t+=i});break;case"videos":jQuery.each(f,function(t,i){e+=i});jQuery.each(y,function(e,i){t+=i});break}jQuery("#compare__you").text(TBUtilities.FormatNumberAbbreviated(e));jQuery("#compare__them").text(TBUtilities.FormatNumberAbbreviated(t))};var oe=function(e){var i=P();var a=O();if(i===false&&t===true||i===true&&a===false&&t===true||e===true){try{TBUtilities.Log("Channelytics - cleaning page ");o=null;U=null;E=null;g=[];if(B){B.remove()}if(L&&L.highcharts()){L.highcharts().destroy()}if(x&&x.highcharts()){x.highcharts().destroy()}if(S&&S.highcharts()){S.highcharts().destroy()}}catch(e){TBUtilities.Log(e)}finally{t=false}}};return{Initialize:function(t){w=t;TBUtilities.Log("TubeBuddyChannelytics Initialize");if(TBGlobal.IsAuthenticated()){if(!e){Y();D();N();e=true;if(TBExtension.GetType()==="firefox"){window.requestAnimationFrame=window.requestAnimationFrame.bind(window)}}else{TBUtilities.Log("TubeBuddyChannelytics partial load");A()}}},CleanPage:function(){oe()},GotChannelStats:function(e,t){ee(e,t)},GotChannelInfo:function(e,t){gotChannelInfo(e,t)},ShowForChannel:function(e,t,i){W(e,t,i)}}}();const TubeBuddyTwitterPost=function(){let e=false;let t;let i=false;const o={selectedVideo:{Id:"",Title:"",Thumbnail:"",Link:"",IncludeThumbnail:true}};const a=function(){TBUtilities.Log("populateContent");if(TBGlobal.Profile().IsLoggedIn===true){jQuery(".twitter-post__account-login").hide();if(TBGlobal.Profile().TwitterAccounts!==null&&TBGlobal.Profile().TwitterAccounts.length>0){var e=jQuery(".tweet__form:last")[0].outerHTML;jQuery(".twitter-post-share").html(e);jQuery("#tb-twitter-post-message").val('Check out my latest video "'+o.selectedVideo.Title+'"\n\nWatch Now: https://youtu.be/'+o.selectedVideo.Id+"\n\n");jQuery("#tb-twitter-post-link").attr("href","https://www.youtube.com/watch?v="+o.selectedVideo.Id);jQuery.each(TBGlobal.Profile().TwitterAccounts,function(e,t){var i=jQuery(".tb-twitter-post-account-item:last")[0].outerHTML;if(i.length>0){i=TBUtilities.ReplaceAll(i,"#TWITTER_ID#",t.Id);i=TBUtilities.ReplaceAll(i,"#ACCOUNT_ID#",t.Id);i=TBUtilities.ReplaceAll(i,"#SCREEN_NAME#",t.ScreenName);i=TBUtilities.ReplaceAll(i,"#THUMBNAIL_URL#",t.ThumbnailUrl);jQuery("#tb-twitter-post-accounts").append(i)}else{}});t=TBGlobal.Profile().TwitterAccounts[0];jQuery(".account__dropdown--btn").empty();jQuery(".account__dropdown--btn").append('<img class="account__dropdown--avatar" src="'+t.ThumbnailUrl+'" /> @'+t.ScreenName+'<i class="material-icons account__arrow">keyboard_arrow_down</i>').attr("data-account-id",t.Id);jQuery(".account__headline").remove();jQuery(".dropdown__list").prepend('<span class="account__headline">Accounts</span>');jQuery(".dropdown__list").append('<li class="switch__account"><a class="switch__link" href="https://www.tubebuddy.com/account/Integrations" target="_blank"><i class="material-icons account__swap--icon">swap_vert</i> Manage Accounts</a></li>');jQuery(".dropdown__list").append('<li class="refresh__account"><a class="refresh__link"><i class="material-icons account__swap--icon">refresh</i> Refresh</a></li>');var i=jQuery(".account__dropdown--btn").attr("data-account-id");jQuery('[data-twit-id="'+i+'"]').hide();r();if(TBGlobal.Profile().IsLoggedIn===false){jQuery(".twitter-post-share").hide()}}else{jQuery(".twitter-post-share").html(jQuery(".twitter-post__link-account:last")[0].outerHTML);jQuery(".link-account-button").attr("href",TBGlobal.host+"/socialaccounts/twitteroauthredirect?redirectUrl="+encodeURIComponent(window.location))}}else{var a=jstz.determine_timezone();var s=a.timezone;if(s!=="undefined"){s.ambiguity_check()}var n=s.utc_offset;jQuery(".twitter-post-share").html(jQuery(".twitter-post__account-login:last")[0].outerHTML);jQuery(".account-login-button").attr("href",TBGlobal.host+"/oauth/AuthRedirectLogin/?channelid="+TBGlobal.CurrentChannelId()+"&redirectUrl="+encodeURIComponent(window.location)+"&timeZoneOffset="+encodeURIComponent(n)+"&via=extension&channelId="+TBGlobal.CurrentChannelId())}jQuery(".tb-twitter-post-switch").hide();jQuery(".twitter-post-share").show();jQuery('[data-tbtooltip!=""]').qtip({content:{attr:"data-tbtooltip"},style:{classes:"qtip-youtube-tubebuddy"}})};const s=function(){let e=TBGlobal.host+"/ModuleManager/twitterpost/twitterpost?v="+TBGlobal.versionNumber;if(loadLocalHTML&&(TBExtension.GetType()==="chrome"||TBExtension.GetType()==="firefox")){e=chrome.extension.getURL("modules/twitterpost.html")}else if(loadLocalHTML&&TBExtension.GetType()==="safari"){e="modules/twitterpost.html"}TBExtension.Get(e,"CRTBLoadTwitterPostTemplate")};const n=function(){try{jQuery("#tb-twitter-post").fadeIn();jQuery("#tb-twitter-post-title").text(o.selectedVideo.Title);jQuery("#tb-twitter-post-thumbnail").attr("src",o.selectedVideo.Thumbnail);jQuery("#tb-twitter-post-message").val('New upload - "'+o.selectedVideo.Title+'"\n\nWatch Now: https://youtu.be/'+o.selectedVideo.Id+"\n\n");jQuery("#tb-twitter-post-link").attr("href","https://www.youtube.com/watch?v="+o.selectedVideo.Id);if(TBGlobal.CanAccessLevel1Tools()){jQuery(".tb-twitter-post-via-checkbox").prop("checked",false);jQuery(".tb-twitter-post-via-checkbox").removeAttr("checked")}else{jQuery(".tb-twitter-post-via-checkbox").prop("checked",true);jQuery(".tb-twitter-post-via-checkbox").attr("checked","checked")}}catch(e){TBUtilities.LogError({Exception:e,Location:"[CRTBLoadTwitterPostTemplate] prepareDialog"})}};var r=function(){var e=jQuery("#tb-twitter-post-submit");var t=jQuery("#tb-twitter-post-count");var i=jQuery("#tb-twitter-post-message").val();if(jQuery("#tb-twitter-post-via-checkbox").is(":checked")){i+="\n(Posted via TubeBuddy.com)"}var o=280;var a=twttr.txt.parseTweet(i).weightedLength;if(a>0&&a<=o){e.css("opacity","1");e.css("cursor","pointer")}else{e.css("opacity",".5");e.css("cursor","not-allowed")}t.text(o-a);if(parseInt(t.text())<0){t.css("color","#F00");e.attr("disabled",true)}else{t.css("color","#d3d2d1");e.attr("disabled",false)}jQuery("#tb-twitter-post-message").css("height","150px");jQuery("#tb-twitter-post-message")[0].style.height="80px";jQuery("#tb-twitter-post-message")[0].style.height=jQuery("#tb-twitter-post-message")[0].scrollHeight+"px"};var l=function(){jQuery(document).on("click",".account__dropdown--btn",function(e){if(jQuery(".dropdown__list").length!==0){jQuery(".dropdown__list").toggle()}});jQuery(document).on("click",".refresh__account",function(e){jQuery(this).html('<div class="tb-spinner tb-margin-left15 tb-margin-bottom15"></div>');TBGlobal.ReloadProfile("TBLayoutTwitterReloadProfile")});jQuery(document).on("change","#tb-twitter-post-via-checkbox",function(e){if(!jQuery(this).is(":checked")&&!TBGlobal.CanAccessLevel1Tools()){TBGlobal.ShowUpgradePage("remove TubeBuddy branding","Pro");jQuery(this).prop("checked",true);jQuery(this).attr("checked","checked")}else{r()}});jQuery(document).on("click","#tb-twitter-check-sign-in",function(e){jQuery(".account-login--refresh").hide();jQuery(".account-login--refresh-icon-spinner").show();TBGlobal.ReloadProfile("TBLayoutTwitterReloadProfile")});jQuery(document).on("click",".account-login--action",function(e){jQuery(this).hide();jQuery(".account-login--refresh").show()});jQuery(document).on("click",".tweet__form-success-new-tweet",function(e){jQuery(".tweet__form-success").hide();jQuery(".tweet__form-entry").show();jQuery(".twitter-post-account").show()});jQuery(document).on("click",".dropdown__list--items",function(e){e.preventDefault();var i=jQuery(this).attr("data-account-id");t=TBUtilities.GetInArray(TBGlobal.Profile().TwitterAccounts,"Id",i);jQuery(".account__dropdown--btn").empty();jQuery(".account__dropdown--btn").append('<img class="account__dropdown--avatar" src="'+t.ThumbnailUrl+'" /> @'+t.ScreenName+'<i class="material-icons account__arrow">keyboard_arrow_down</i>').attr("data-account-id",t.Id);jQuery(".dropdown__list").fadeOut();jQuery(".twitter-account-identifier").show();jQuery('[data-twit-id="'+i+'"]').hide()});jQuery(document).on("mouseup",function(e){const t=jQuery(".dropdown__list");if(!t.is(e.target)&&t.has(e.target).length===0){t.fadeOut()}});jQuery(document).on("keyup paste keypress","#tb-twitter-post-message",function(e){r()});jQuery(document).on("change","#tb-twitter-post-checkbox:checkbox",function(e){if(jQuery(this).is(":checked")){o.selectedVideo.IncludeThumbnail=true}else if(jQuery(this).is(":not(:checked)")){o.selectedVideo.IncludeThumbnail=false}});jQuery(document).on("click","#tb-twitter-post-submit",function(e){var i=jQuery("#tb-twitter-post-message").val();console.log(twttr.txt.parseTweet(i));if(!i){alertify.alert("Please enter a Message");return}if(jQuery("#tb-twitter-post-via-checkbox").is(":checked")){i+="\n(Posted via TubeBuddy.com)"}TBUtilities.Log(i);jQuery("#tb-twitter-post-checkbox").prop("disabled",true);jQuery("#tb-twitter-post-message").prop("disabled",true);jQuery(".tweet__form-spinner").show();jQuery(this).hide();var a=jQuery.param({SocialAccountId:t.Id,IncludeThumbnail:o.selectedVideo.IncludeThumbnail,Message:i,VideoId:o.selectedVideo.Id});TBUtilities.Log(a);var s=TBGlobal.host+TBGlobal.apiUrls.twitterPost;TBUtilities.Log(s);TBExtension.Post(s,a,"TBLayoutTwitterPost",null,{contentType:"application/x-www-form-urlencoded; charset=UTF-8"})})};var u=function(){jQuery(document.body).on("TBLayoutTwitterPost",function(e,t){try{jQuery(".tweet__form-spinner").hide();jQuery("#tb-twitter-post-checkbox").prop("disabled",false);jQuery("#tb-twitter-post-message").prop("disabled",false);if(t.success){TBUtilities.Log(t);jQuery(".tweet__form-success").show();jQuery(".tweet__form-entry").hide();jQuery(".twitter-post-account").hide();jQuery("#tb-twitter-post-success-link").attr("href",TBUtilities.ReplaceAll(t.response,'"',""));jQuery("#tb-twitter-post-success-link").text(TBUtilities.ReplaceAll(t.response,'"',""));jQuery("#tb-twitter-post-success").fadeIn("fast",function(){jQuery(this).delay(7e3).slideUp("slow")});jQuery("#tb-twitter-post-submit").show()}else{jQuery(function(){jQuery("#tb-twitter-post-error").fadeIn("fast",function(){jQuery(this).delay(8e3).fadeOut("slow")})});jQuery("#tb-twitter-post-submit").show()}}catch(e){jQuery("#tb-twitter-post-submit").show();TBUtilities.LogError({Exception:e,Location:"[TubeBuddyTwitterPost] CRTBLoadTwitterPost"})}});jQuery(document.body).on("CRTBLoadTwitterPostTemplate",function(e,t){try{if(t.success){t.response=TBUtilities.FixLocalHtml(DOMPurify.sanitize(t.response,DOMPurifyConfig));jQuery("body").append(t.response);d();a();r()}else{}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyTwitterPost] CRTBLoadTwitterPostTemplate"})}})};const d=function(){try{n();jQuery("#tb-twitter-post-message").trigger("keyup")}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyTwitterPost] show"})}};return{Show:function(t,i,a){if(TBGlobal.IsAuthenticated()){o.selectedVideo.Id=t;o.selectedVideo.Title=i;o.selectedVideo.Thumbnail=a;o.selectedVideo.IncludeThumbnail=true;if(!e){u();s();l();e=true}else{d()}}},Reload:function(){if(TBGlobal.Profile().IsLoggedIn==true){jQuery(".account-login--refresh-icon-spinner").hide();jQuery(".dropdown__list").empty();a();r()}else{jQuery(".account-login--refresh-icon-spinner").hide();jQuery(".account-login--refresh").show();TBUtilities.Alert("You still do not seem to be signed into the TubeBuddy.com website. Please open a new Tab on your browser and sign into TubeBuddy.com then come back to this page.")}}}}();var TubeBuddyCommentFilterStudio=function(){var e=false;var t=null;var o=null;var a=null;var s=null;var n=null;var r=null;var l=null;var u=null;var d=null;var c=false;var p=[];var b=true;var h=0;var m=null;var f=false;var y=true;var g=false;var v="who ,what ,why ,where ,when ,how ,does ,can ,do ,does ,wat ,have ,has ,may ,must ,should ,would ,are ";var T="admire,admired,admires,admiring,adorable,adore,adored,adores,affection,affectionate,amuse,amused,amusement,amusements,astound,astounded,astounding,astoundingly,astounds,audacious,award,awarded,awards,beatific,beauties,beautiful,beautifully,beautify,beloved,best,blessing,bliss,blissful,blockbuster,breakthrough,captivated,celebrate,celebrated,celebrates,celebrating,charm,charming,cheery,classy,cool stuff,dearly,delight,delighted,delighting,delights,devoted,elated,elation,enrapture,enthral,enthusiastic,euphoria,excellence,excellent,excite,excited,excitement,exciting,exhilarated,exhilarates,exhilarating,exultant,exultantly,faithful,fan,fascinate,fascinated,fascinates,fascinating,ftw,gallant,gallantly,gallantry,genial,glad,glamorous,glamourous,glee,gleeful,good,goodness,gracious,grand,grateful,great,greater,greatest,haha,hahaha,hahahah,happiness,happy,heartfelt,heroic,humerous,impress,impressed,impresses,impressive,inspiring,joy,joyful,joyfully,joyous,jubilant,kudos,lawl,lol,lovable,love,loved,lovelies,lovely,loyal,loyalty,luck,luckily,lucky,marvel,marvelous,marvels,medal,merry,mirth,mirthful,mirthfully,nice,ominous,once-in-a-lifetime,paradise,perfect,perfectly,pleasant,pleased,pleasure,popular,praise,praised,praises,praising,prosperous,right direction,rigorous,rigorously,scoop,sexy,soothe,soothed,soothing,sparkle,sparkles,sparkling,splendid,successful,super,vibrant,vigilant,visionary,vitality,vivacious,wealth,winwin,won,woo,woohoo,worshiped,yummy,amazing,awesome,brilliant,ecstatic,euphoric,exuberant,fabulous,fantastic,fun,funnier,funny,godsend,heavenly,lifesaver,lmao,lmfao,masterpiece,masterpieces,miracle,overjoyed,rapturous,rejoice,rejoiced,rejoices,rejoicing,rofl,roflcopter,roflmao,rotfl,rotflmfao,rotflol,stunning,terrific,triumph,triumphant,win,winner,winning,wins,wonderful,wooo,woow,wow,wowow,wowww,breathtaking,hurrah,outstanding,superb,thrilled";var j="bastard, bastards, bitch, bitches, cock, cocksucker, wrong, cocksuckers, cunt, motherfucker, motherfucking, niggas, nigger, prick, slut, son-of - a - bitch, twat, ass, assfucking, asshole, skeptical, bullshit, catastrophic, damn, damned, damnit, dick, dickhead, fraud, frauds, fraudster, fraudsters, fraudulence, fraudulent, fuck, fucked, fucker, fuckers, fuckface, fuckhead, fucking, fucktard, fuked, fuking, hell, jackass, jackasses, piss, pissed, rape, rapist, scumbag, shit, shithead, shrew, torture, tortured, tortures, torturing, whore, wtf, abhor, abhorred, abhorrent, abhors, abuse, abused, abuses, abusive, acrimonious, agonise, agonised, agonises, agonising, agonize, agonized, agonizes, agonizing, anger, angers, angry, anguish, anguished, apathetic, apathy, apeshit, arrested, assassination, assassinations, awful, bad, badass, badly, bankrupt, bankster, betray, betrayal, betrayed, betraying, betrays, bloody, boring, brainwashing, bribe, can't stand,catastrophe,charged,charmless,chastise,chastised,chastises,chastising,cheat,cheated,cheater,cheaters,cheats,colluding,conspiracy,cover-up,crap,crime,criminal,criminals,crisis,cruel,cruelty,damage,damages,dead,deceit,deceitful,deceive,deceived,deceives,deceiving,deception,defect,defects,despair,despairing,despairs,desperate,desperately,despondent,destroy,destroyed,destroying,destroys,destruction,destructive,die,died,dipshit,dire,direful,disastrous,disgust,disgusted,disgusting,distrust,distrustful,does not work,douche,douchebag,dreadful,dumb,dumbass,evil,fag,faggot,faggots,fake,fakes,faking,falsified,falsify,fatalities,fatality,fed up,felonies,felony,fiasco,frenzy,frightening,fud,furious,goddamn,greed,green wash,green washing,greenwash,greenwasher,greenwashers,greenwashing,guilt,guilty,hate,hated,haters,hates,hating,heartbreaking,heartbroken,horrendous,horrible,horrific,horrified,humiliated,humiliation,hysteria,hysterical,hysterics,idiot,idiotic,illegal,imbecile,irate,irritate,irritated,irritating,jerk,kill,killed,killing,kills,liar,liars,loathe,loathed,loathes,loathing,loose,looses,loser,losing,loss,lost,lunatic,lunatics,mad,maddening,madly,madness,mediocrity,miserable,misleading,moron,murdering,murderous,nasty,no fun,not working,nuts,obnoxious,outrage,outraged,panic,panicked,panics,perjury,pissing,pseudoscience,racism,racist,racists,rant,ranter,ranters,rants,ridiculous,scandal,scandalous,scandals,screwed up,selfish,selfishness,shitty,sinful,slavery,spammer,spammers,suck,sucks,swindle,swindles,swindling,terrible,terribly,terrified,terror,terrorize,terrorized,terrorizes,trauma,traumatic,treason,treasonous,ugly,victim,victimize,victimized,victimizes,victimizing,victims,vile,violence,violent,vitriolic,wanker,warning,warnings,whitewash,withdrawal,woeful,worried,worry,worrying,worse,worsen,worsened,worsening,worsens,worst,wrathful";var Q="anal,anus,arse,ass,ballsack,balls,bastard,bitch,biatch,blowjob,blow job,bollock,bollok,boner,boob,butt,buttplug,clitoris,cock,coon,crap,cunt,dam,damn,dick,dildo,dyke,fag,feck,fellate,fellatio,felching,fuck,fucker,f u c k,fudgepacker,fudge packer,flange,Goddamn,God damn,homo,jerk,jizz,knobend,knob end,lmao,lmfao,muff,nigger,nigga,penis,piss,poop,prick,pube,pussy,queer,scrotum,sex,shit,sh1t,slut,smegma,spunk,tit,tosser,turd,twat,vagina,wank,whore,wtf";var w=[];var k=[];var B=[];var C=[];var x=null;var S=false;var L=null;var _=0;var I=500;var U=[];var E=false;var A=null;var G=[" a.ytcp-author-comment-badge"," a.ytcp-author-comment-badge"," a.ytcp-author-comment-badge"," a.ytcp-author-comment-badge-1"," a.ytcp-author-comment-badge-0"];var R="";var P="yt-icon#hearted-border";var O=[];var D=[];var M=[];var N=false;var V=250;var z=null;var F=null;var $=false;var H;var Y={isBasic:true,onlyQuestions:false,hasNoReplyFromAnyone:false,hasNoReplyFromMe:false,hasHasReplyFromMe:false,ratings:false,positive:false,negative:false,wordsFilter:false,words:"",startedBySomeoneElse:false,startedByMe:false,startedBy:true,profanity:false,links:false,onlyLinked:false,onlyYouTube:false,startedByWho:"me",replyTypeSelected:"meno",replyType:true,withType:true,withSelected:"questions",loadingMoreInterval:null,changeSortInterval:null,threadType:true,threadSelected:"youtube",needsFollowUp:false,loadRepliesTries:0,loadRepliesTimer:null,hideReadComments:true,pagesToLoad:0,currentPage:0,isPatreonSupporter:false,isSubscriber:false,questionsHasNoReplyFromMe:false,hearted:false};var W=function(){var e=setInterval(function(){var t=jQuery("#contents").is(":visible");if(t===true){clearInterval(e);y=TBGlobal.Profile().SettingsShowCommentCannedResponses;h=ce();ve();K();Y.hideReadComments=true;ye();be();M=lscache.get("tbSubscriberCache"+TBGlobal.CurrentChannelId());if(TBGlobal.CanAccessLevel3Tools()===true){ManageSubscriberCache.RefreshSubscribersCache(TBGlobal.CurrentChannelId(),1e3)}}},1e3);var t=setInterval(function(){var e=ce();if(e>h&&N===false){h=e;ve();ye();if(jQuery(".tb-comment-filter-studio-refresh:visible").length>0){TBUtilities.Log("Comment Filter Studio - Applying filter to new comments found");J()}}},2e3);var i=TBGlobal.host+TBGlobal.apiUrls.topicsGetCommentAudienceSuggestedTopic+"?commentId="+" ";TBExtension.Get(i,"CommentFilterStudioGetCannedResponsesCanAddSuggestion",null)};var K=function(){var e=".ytcp-comments-filter-0";if(jQuery(e).length===0){e=".ytcp-comments-filter:first"}if(jQuery(e).siblings(".tb-comment-filter-studio-container").length===0){jQuery(e).after(jQuery(".tb-comment-filter-studio-container:last")[0].outerHTML);z=jQuery(e).nextAll(".tb-comment-filter-studio-container")}jQuery(".tb-comment-filter-studio-advanced").hide();jQuery(".tb-comment-filter-studio-select-auto-load-basic-container").show();jQuery(".tb-comment-filter-studio-message-container").hide();jQuery(".tb-comment-filter-studio-message").hide();jQuery(".tb-comment-filter-studio-select-basic").val("all");jQuery(".tb-comment-filter-studio-shown-container").hide();jQuery(".tb-comment-filter-studio-shown").text("0");jQuery(".tb-comment-filter-studio-shown-of").text("0");jQuery(".tb-comment-filter-studio-refresh").hide();jQuery(".tb-comment-filter-studio-go").show()};var q=function(){Y.startedByMe=false;Y.startedBySomeoneElse=false;Y.startedByPatreon=false;Y.startedBySubscriber=false;Y.onlyLinked=false;Y.onlyYouTube=false;Y.hasNoReplyFromMe=false;Y.hasHasReplyFromMe=false;Y.hasNoReplyFromAnyone=false;Y.needsFollowUp=false;Y.onlyQuestions=false;Y.positive=false;Y.negative=false;Y.profanity=false;Y.links=false;Y.wordsFilter=false;Y.isPatreonSupporter=false;Y.isSubscriber=false;Y.questionsHasNoReplyFromMe=false;Y.words="";Y.hearted=false};var J=function(){TBUtilities.Log("Comment Filter Studio - applyFilter");var e=0;var t=0;try{ne();var i=le();TBUtilities.Log("applyFilter unfiltered count = "+i.length);var o=te();var a;for(a=0;a<i.length;a++){var s=i[a];s.filtered=true;var n=true;if(Y.onlyQuestions){TBUtilities.Log("onlyQuestions = true");hasFilter=true;var r=false;var d=s.text;if(s.channelId!=TBGlobal.CurrentChannelId()){jQuery.each(w,function(e,t){r=r||d.trim().toLowerCase().indexOf(t)==0||d.indexOf("?")>-1})}if(!r)n=false}if(Y.questionsHasNoReplyFromMe){TBUtilities.Log("questionsHasNoReplyFromMe = true");hasFilter=true;var r=false;var d=s.text;if(s.$commentRow.find(R).length===0){jQuery.each(w,function(e,t){r=r||d.trim().toLowerCase().indexOf(t)==0||d.indexOf("?")>-1})}var c=s.$entireRepliesContainer.find(R);var p=c.length;if(r===false||p>0)n=false}if(Y.hasNoReplyFromAnyone){TBUtilities.Log("hasNoReplyFromAnyone = true");hasFilter=true;if(s.replyCount>0){n=false}}if(Y.isPatreonSupporter){TBUtilities.Log("isPatreonSupporter = true");hasFilter=true;if(s.patreonId&&s.$commentRow.find(".tb-comment-filter-studio-patreon-logo").length===0){var b=l.formatTemplate(s.patreonId);s.$commentRow.find("span.metadata-divider").after(b)}else{n=false}}if(Y.isSubscriber){TBUtilities.Log("isSubscriber = true");hasFilter=true;if(s.isSubscriber===true&&s.$commentRow.find(".tb-comment-filter-studio-subscribe-logo").length===0){var h=u.formatTemplate();s.$commentRow.find("span.metadata-divider").after(h)}else{n=false}}if(Y.hasNoReplyFromMe){TBUtilities.Log("hasNoReplyFromMe = true");hasFilter=true;if(s.$entireRepliesContainer.find(R).length>0||s.$entireThreadContainer.find(R).length>0){n=false}}if(Y.hasHasReplyFromMe){TBUtilities.Log("hasHasReplyFromMe = true");hasFilter=true;if(s.$entireRepliesContainer.find(R).length===0){n=false}}if(Y.needsFollowUp){TBUtilities.Log("needsFollowUp = true");hasFilter=true;if(s.replyCount===0||s.$entireRepliesContainer.find("ytcp-comment:last").find(G.join(",")).length>0){n=false}}if(Y.startedByMe){TBUtilities.Log("startedByMe = true");hasFilter=true;if(s.channelId!=TBGlobal.CurrentChannelId()){n=false}}if(Y.startedBySomeoneElse){TBUtilities.Log("startedBySomeoneElse = true");hasFilter=true;if(s.channelId===TBGlobal.CurrentChannelId()){n=false}}if(Y.startedByPatreon){TBUtilities.Log("startedByPatreon = true");hasFilter=true;if(s.patreonId&&s.$commentRow.find(".tb-comment-filter-studio-patreon-logo").length===0){var b=l.formatTemplate(s.patreonId);s.$commentRow.find("span.metadata-divider").after(b)}else{n=false}}if(Y.startedBySubscriber){TBUtilities.Log("startedBySubscriber = true");hasFilter=true;if(s.isSubscriber===true&&s.$commentRow.find(".tb-comment-filter-studio-subscribe-logo").length===0){var h=u.formatTemplate();s.$commentRow.find("span.metadata-divider").after(h)}else{n=false}}if(Y.positive){TBUtilities.Log("positive = true");hasFilter=true;var r=false;jQuery.each(k,function(e,t){if(TBUtilities.CountMatches(s.allText,t.trim(),true,true)>0){r=true;jQuery(s.$entireThreadContainer).find("#content-text").each(function(e,i){TBUtilities.Log(jQuery(this).html()+"< this");jQuery(this).html(TBUtilities.ReplaceAll(jQuery(this).html(),t.trim(),'<span class="tb-comment-filter-studio-highlighted">'+t.trim()+"</span>",true,false))})}});if(!r)n=false}if(Y.negative){TBUtilities.Log("negative = true");hasFilter=true;var m=false;jQuery.each(B,function(e,t){if(TBUtilities.CountMatches(s.allText,t.trim(),true,true)>0){m=true;jQuery(s.$entireThreadContainer).find("#content-text").each(function(e,i){TBUtilities.Log(jQuery(this).html()+"< this");jQuery(this).html(TBUtilities.ReplaceAll(jQuery(this).html(),t.trim(),'<span class="tb-comment-filter-studio-highlighted">'+t.trim()+"</span>",true,false))})}});if(!m)n=false}if(Y.profanity){TBUtilities.Log("profanity = true");hasFilter=true;var f=false;jQuery.each(C,function(e,t){if(TBUtilities.CountMatches(s.allText,t.trim(),true,true)>0){f=true;jQuery(s.$entireThreadContainer).find("#content-text").each(function(e,i){TBUtilities.Log(jQuery(this).html()+"< this");jQuery(this).html(TBUtilities.ReplaceAll(jQuery(this).html(),t.trim(),'<span class="tb-comment-filter-studio-highlighted">'+t.trim()+"</span>",true,false))})}});if(!f){n=false}}if(Y.links){TBUtilities.Log("links = true");var r=false;hasFilter=true;TBUtilities.Log("Check Links");TBUtilities.Log(s.text);if(s.text.indexOf("www.")>-1)r=true;if(s.text.indexOf("http:")>-1)r=true;if(s.text.indexOf(".com")>-1)r=true;if(s.text.indexOf(".net")>-1)r=true;if(s.text.indexOf(".edu")>-1)r=true;if(s.text.indexOf(".be")>-1)r=true;if(s.text.indexOf(".ly")>-1)r=true;if(s.text.indexOf(".gl")>-1)r=true;if(!r){n=false}else{TBUtilities.Log("FOUND link in "+s.text)}}if(Y.wordsFilter&&Y.words.length>2){TBUtilities.Log("wordsFilter = true");var y=Y.words.split(",");var g=false;TBUtilities.Log(y.length);jQuery.each(y,function(e,t){hasFilter=true;if(t.trim().length<3)return;if(TBUtilities.CountMatches(s.allText,t.trim(),true,false)>0){g=true;s.$entireThreadContainer.find("#content-text").each(function(e,i){jQuery(this).html(TBUtilities.ReplaceAll(jQuery(this).html(),t.trim(),'<span class="tb-comment-filter-studio-highlighted" style="padding:2px 1px; background-color:#ffff66">'+t.trim()+"</span>",true,false))})}if(TBUtilities.CountMatches(s.headerText,t.trim(),true,false)>0){g=true;s.$entireThreadContainer.find("#name").each(function(e,i){jQuery(this).html(TBUtilities.ReplaceAll(jQuery(this).html(),t.trim(),'<span class="tb-comment-filter-studio-highlighted" style="padding:2px 1px; background-color:#ffff66">'+t.trim()+"</span>",true,false))})}});if(!g)n=false}if(Y.hearted==true){TBUtilities.Log("hearted = true");hasFilter=true;if(s.$entireThreadContainer.find(P).length===0){n=false}}if(Y.hideReadComments==true){if(s.$entireThreadContainer.hasClass("tb-comment-is-read-studio"))n=false}if(n===true&&ie()<o){s.shown=true;if(s.$entireThreadContainer.is(":visible")===false){s.$entireThreadContainer.show()}}else{s.shown=false;if(s.$entireThreadContainer.is(":visible")===true){s.$entireThreadContainer.hide()}}}if(e===0)t=1;else t=e;try{TBUtilities.AddAction({FilteredCommentCount:t},TBUtilities.ActionTypes.CommentFilters_ApplyFilter,"commentfilters")}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyCommentFilterStudio] [addAction]"})}var v=ie();TBUtilities.Log("shown count = "+v);TBUtilities.Log("total count = "+O.length);var T=O.length-v;TBUtilities.Log("hiddenCount count = "+T);if(jQuery(".tb-comment-filter-studio-select-basic").val()!=="all"){jQuery(".tb-comment-filter-studio-shown-container").show();jQuery(".tb-comment-filter-studio-shown").text(v);jQuery(".tb-comment-filter-studio-shown-of").text(O.length);jQuery(".tb-comment-filter-studio-refresh").show();if(v===1){jQuery(".tb-comment-filter-studio-comment-text").text("result")}else{jQuery(".tb-comment-filter-studio-comment-text").text("results")}}else{jQuery(".tb-comment-filter-studio-refresh").hide();jQuery(".tb-comment-filter-studio-shown-container").hide()}var j=oe();var Q=se();if(j===true&&Q===false){X()}else{ae()}}catch(e){ae();TBUtilities.LogError(e)}};var X=function(){TBUtilities.Log("Comment filter - loadMoreComments");var e=jQuery("#entity-page");if(e.hasClass("loaded")===true){var t=z.closest("#main");t.scrollTop(t.prop("scrollHeight"));clearTimeout(H);e.one("DOMSubtreeModified",function(){clearTimeout(H);TBUtilities.Log("Comment filter - DOMSubtreeModified");Z()});H=setTimeout(function(){Z()},1e4)}else{ae()}};var Z=function(){var e=jQuery("#entity-page");A=setInterval(function(){var t=se();if(t===true){clearInterval(A);ae()}else if(e.hasClass("loaded")===true){clearInterval(A);setTimeout(function(){J()},V)}},1e3)};var ee=function(){TBUtilities.Log("newFilterSelected");F=null;$=true;for(var e=0;e<O.length;e++){O[e].filtered=false;O[e].shown=false}jQuery("#main").find(".tb-comment-filter-studio-flag").remove();jQuery(".tb-comment-filter-studio-highlighted").each(function(e,t){jQuery(this).replaceWith(jQuery(this).html())});jQuery(".tb-comment-filter-studio-empty-results").hide();jQuery(".tb-comment-filter-studio-empty-results-subscribers").hide()};var te=function(){var e=20;if(jQuery(".tb-comment-filter-studio-select-auto-load").is(":visible")==true){e=parseInt(jQuery(".tb-comment-filter-studio-select-auto-load").val())}else if(jQuery(".tb-comment-filter-studio-select-auto-load-advanced").is(":visible")==true){e=parseInt(jQuery(".tb-comment-filter-studio-select-auto-load-advanced").val())}return e};var ie=function(){var e=O.filter(e=>e.shown===true);return e.length};var oe=function(){var e=false;var t=20;if(jQuery(".tb-comment-filter-studio-select-auto-load").is(":visible")===true){t=parseInt(jQuery(".tb-comment-filter-studio-select-auto-load").val())}else{t=parseInt(jQuery(".tb-comment-filter-studio-select-auto-load-advanced").val())}var i=ie();if(i<t){e=true}return e};var ae=function(){clearInterval(A);var e=document.getElementById("main");e.scrollTop=0;re();if(ie()===0){jQuery(".tb-comment-filter-studio-empty-results").show();if(Y.isSubscriber==true){jQuery(".tb-comment-filter-studio-empty-results-subscribers").show()}if(jQuery(".tb-comment-filter-studio-select-basic").val()==="all"){jQuery(".tb-comment-filter-studio-empty-results").hide()}}else{jQuery(".tb-comment-filter-studio-empty-results").hide();jQuery(".tb-comment-filter-studio-empty-results-subscribers").hide()}E=false;N=false};var se=function(){var e=false;if(O.length>=I||E===true||F===0){e=true;TBUtilities.Log("stop loading");TBUtilities.Log("_forceStop = "+E);TBUtilities.Log("_commentsCollection.length = "+O.length);TBUtilities.Log("_maxComments = "+I);TBUtilities.Log("_newComments = "+F);if(O.length>=I){jQuery(".tb-comment-filter-studio-max-seached-container").show()}else{jQuery(".tb-comment-filter-studio-max-seached-container").hide()}}return e};var ne=function(){try{var e=jQuery("#tb-comment-filter-studio-loading-screen-template").html();var t=jQuery("div.nav-and-main-content").data();if(t["blockUI.isBlocked"]!=1){TBUtilities.Log("showing loading");jQuery("div.nav-and-main-content").block({message:e,css:{padding:"30px 20px;",border:"2px solid #77889",backgroundColor:"transparent"},overlayCSS:{backgroundColor:"#fff",opacity:.8,cursor:"unavailable"},fadeIn:0})}N=true}catch(e){TBUtilities.Log(e)}};var re=function(){try{TBUtilities.Log("hide loading");jQuery("div.nav-and-main-content ").unblock()}catch(e){TBUtilities.Log(e)}};var le=function(){F=0;var e=jQuery("#contents").find("ytcp-comment-thread:not([tb-comment-id])");jQuery.each(e,function(e,t){jQuery(t).attr("tb-comment-id",TBUtilities.CreateGuid());var i=jQuery(t).find("#comment");var o=jQuery(t);var a={$entireThreadContainer:o,$entireRepliesContainer:o,$commentRow:i,replyCount:0,replies:[],filtered:false,shown:false,channelId:null,patreonId:null,isSubscriber:false};O.push(a);F++;a.$entireRepliesContainer=jQuery(t).find("#replies");a.replyCount=jQuery(t).find("#replies").find("ytcp-comment").length;a.text=a.$commentRow.find("#content-text").text();a.allText=a.$entireThreadContainer.find("#content-text").text();a.headerText=a.$entireThreadContainer.find("#name").text().trim();var s=a.$commentRow.find("a#name:first");if(s&&s.attr("href")){var n=s.attr("href");a.channelId=ue(n)}var r=de(a.channelId);if(r){a.patreonId=r}if(a.channelId&&M){var l=M.indexOf(a.channelId);if(l!=-1){a.isSubscriber=true}}});var t=O.filter(e=>e.filtered===false);if($===true){F=10;$=false}return t};var ue=function(e){var t=e.split("/");var i=t[t.length-1];return i};var de=function(e){var t=null;if(TBGlobal.Profile().HasPatreonIntegration===true&&e){var i=TBUtilities.GetInArray(U,"ChannelId",e);if(i){t=i.PatreonId}}return t};var ce=function(){return jQuery("#contents").find("ytcp-comment-thread").length};var pe=function(){ManageSubscriberCache.RefreshSubscribersCache(TBGlobal.CurrentChannelId(),1e3)};var be=function(){if(TBGlobal.Profile().HasPatreonIntegration===true){var e=TBGlobal.host+TBGlobal.apiUrls.highlightGetHighlights+"?highlightType=1";TBUtilities.Log(e);TBExtension.Get(e,"CommentFilterStudioPatreonGet",1)}};var he=async function(e){var t=await window.crypto.subtle.digest("SHA-256",(new TextEncoder).encode(e));var i=Array.prototype.map.call(new Uint8Array(t),e=>String.fromCharCode(e)).join("");return btoa(i)};var me=async function(){D.forEach(async function(e,t){e.YouTubeCommentId=await he(e.CommentStringForHash);jQuery('.tb-comment-filter-studio-hide-comment-toggle[data-id-temp="'+e.CommentStringForHash+'"]').attr("data-id",e.YouTubeCommentId);if(TBGlobal.CanAccessLevel1Tools()&&t==D.length-1){var i=jQuery.param({Comments:D});TBExtension.Post(TBGlobal.host+TBGlobal.apiUrls.commentsGetReadComments,i,"TBCommentsGotRead",null,{contentType:"application/x-www-form-urlencoded; charset=UTF-8"})}})};var fe=function(){var e=0;var t=jQuery("#contents").find("ytcp-comment-thread:visible");var i=window.location.href.indexOf("/video/")!=-1;var o=i?jQuery("#img-with-fallback").attr("src"):null;jQuery.each(t,function(t,a){var s=jQuery(a).find("#comment").find("#video-thumbnail img");if(s.length>0||i&&o)e+=1;if(jQuery(a).find("#replies").length>0&&s.length>0){var n=jQuery(a).find("#replies").find("ytcp-comment");jQuery.each(n,function(t,i){e+=1})}});return e};var ye=function(){var e=jQuery("#contents").find("ytcp-comment-thread:visible");var t=fe();var i=window.location.href.indexOf("/video/")>-1;jQuery.each(e,function(e,t){var o=setInterval(function(){var e=jQuery(t).find("#comment");var a=e.find(".tb-comment-filter-studio-hide-comment-toggle");if(a.length>0||i){clearInterval(o)}var s=ue(e.find("#avatar").attr("href"));var n=e.find("#video-thumbnail img");var r=null;if(!i){if(n.length>0)r=jQuery(n[0]).attr("src")}else{r=jQuery("#img-with-fallback").attr("src")}var l=r?r.split("/")[4]:null;if(l&&a.length===0){clearInterval(o);var u=e.find("#content-text").text();var c=l+s+u.slice(0,20);var p=d.formatTemplate(c,null);e.find(".tb-comment-filter-studio-menu-container").before(p);if(TBUtilities.GetInArray(D,"YouTubeCommentId",c)==null){D.push({YouTubeCommentId:null,CommentStringForHash:c,YouTubeVideoId:l,read:false,fetched:false})}if(l&&jQuery(t).find("#replies").length>0){var b=jQuery(t).find("#replies").find("ytcp-comment");jQuery.each(b,function(e,t){var i=jQuery(t);var o=ue(i.find("#avatar").attr("href"));var a=i.find("#content-text").text();var s=l+o+a.slice(0,20);var n=d.formatTemplate(s,null);i.find("#action-menu").after(n);if(TBUtilities.GetInArray(D,"YouTubeCommentId",s)==null){D.push({YouTubeCommentId:null,CommentStringForHash:s,YouTubeVideoId:l,read:false,fetched:false})}})}}},1e3)});var o=setInterval(function(){if(D.length>=t){clearInterval(o);me();ge()}},1e3)};var ge=function(){jQuery('[data-tbtooltip!=""]').qtip({content:{attr:"data-tbtooltip"},style:{classes:"tb-comment-filter-studio-qtip",tip:false},position:{at:"bottom left",adjust:{x:-40,y:5}}})};var ve=function(){var e=jQuery("#contents").find("ytcp-comment-thread:visible");var t=0;jQuery.each(e,function(e,i){t+=150;if(jQuery(i).find(".tb-comment-filter-studio-menu-container").length>0){return}else{var o=jQuery(i).find("#comment");var a=o.find("#avatar").attr("href");var s=r.formatTemplate(TBUtilities.CreateGuid());o.find("#action-menu").after(s);if(jQuery(i).find("#replies").length>0){var n=jQuery(i).find("#replies").find("ytcp-comment");jQuery.each(n,function(e,i){var o=jQuery(i);if(o.find(R).length==0){if(y===true){var a=r.formatTemplate(TBUtilities.CreateGuid());o.find(".tb-comment-filter-studio-hide-comment-toggle").after(a)}var s=o.find("#avatar").attr("href");Te(s,o,t)}})}}Te(a,o,t)});jQuery(".tb-comment-filter-studio-menu-container").qtip({content:{text:jQuery(".tb-comment-filter-studio-comment-menu-container").html()},position:{at:"bottom center",container:jQuery("#main")},show:"click",hide:"unfocus",style:{classes:"qtip-youtube-tubebuddy-menu",tip:false},events:{show:function(e,t){var i=jQuery(t.target[0]).attr("data-id");jQuery(e.target).attr("data-target-id",i);m=jQuery(this);Ce()}}})};var Te=function(e,r,l){if(jQuery(r).find(".tb-comment-filter-studio-channelInfo").length==0){setTimeout(function(){TubeBuddyYouTubeActions.GetChannelInfoFromAboutPage(e,function(e){if(e.success==true){var l="";if(e.subscribersFormatted!=null&&e.subscribersFormatted!=""){l=o.formatTemplate(e.subscribersFormatted)}var u="";var d="";var c="";for(i=0;i<e.socialProfiles.length;i++){var p=e.socialProfiles[i];if(p.url!==undefined&&p.url.indexOf("twitter.com")!==-1){d=s.formatTemplate("http://youtube.com"+p.url)}else if(p.url!==undefined&&p.url.indexOf("facebook.com")!==-1&&p.url.indexOf("youtube.com")===-1){u=a.formatTemplate("http://youtube.com"+p.url)}else if(p.url!==undefined&&p.url.indexOf("instagram.com")!==-1){c=n.formatTemplate("http://youtube.com"+p.url)}}var b=TBGlobal.GetYouTubeUI();var h="";if(b=="material"){h="tb-move-up4"}var m=t.formatTemplate(l,u,d,c,h);jQuery(r).find(".published-time-text").after(m)}})},l)}};var je=function(){var e=TBGlobal.host+"/ModuleManager/CommentFilterStudio/CommentFilterStudio?v="+TBGlobal.versionNumber;if(loadLocalHTML&&(TBExtension.GetType()=="chrome"||TBExtension.GetType()=="firefox")){e=chrome.extension.getURL("modules/commentfilterstudio.html")}else if(loadLocalHTML&&TBExtension.GetType()=="safari"){e="modules/CommentFilterStudio.html"}TBExtension.Get(e,"CRTBLoadCommentFilterStudioTemplate")};var Qe=function(e){jQuery(".tb-comment-filter-studio-menu-container").qtip("toggle",false)};var we=function(){var e=jQuery(".tb-comment-is-read-studio").length;jQuery("#tb-comment-filter-studio-hidden-comment-count").text(e>0?e:"-")};var ke=function(){jQuery(document).on("click",".tb-comment-filter-studio-refresh",function(){var e=window.location.href.indexOf("/video/")!=-1;if(e&&!TBGlobal.CanAccessLevel1Tools()){jQuery(".tb-comment-filter-studio-select-basic").val("all");TBGlobal.ShowUpgradePage("use Comment Filters on individual videos",TBGlobal.limitation.commentFilters);return}Y.isBasic=jQuery(".tb-comment-filter-studio-select-basic").val()!="advanced";if(Y.isBasic){jQuery(".tb-comment-filter-studio-advanced").hide();jQuery(".tb-comment-filter-studio-select-auto-load-basic-container").show();jQuery(".tb-comment-filter-studio-message-container").hide();jQuery(".tb-comment-filter-studio-message").hide();var t=Be();if(t===true){ne();J()}}else{jQuery(".tb-comment-filter-studio-advanced-go").click()}});jQuery(document).on("click","#comments-section div.paper-tab",function(){var e=_e();if(e===false){jQuery("ytcp-filter-bar#filter-bar").siblings(".tb-comment-filter-studio-container").hide()}else{jQuery("ytcp-filter-bar#filter-bar").siblings(".tb-comment-filter-studio-container").show()}});jQuery(document).on("click",".tb-comment-filter-studio-loading-stop",function(){TBUtilities.Log("tb-comment-filter-studio-loading-stop stop");re();E=true});jQuery(document).on("click",".tb-comment-filter-studio-advanced-go",function(){if(!TBGlobal.CanAccessLevel1Tools()){TBGlobal.ShowUpgradePage("use Advanced Comment Filters",TBGlobal.limitation.commentFilters);return}if(jQuery(".tb-comment-filter-studio-started-by-select").val()==="patreon"&&TBGlobal.CanAccessLevel3Tools()===false){TBGlobal.ShowUpgradePage("use the Patreon Supporter option",TBGlobal.limitation.commentFilters);return}if(jQuery(".tb-comment-filter-studio-started-by-select").val()==="subscriber"&&TBGlobal.CanAccessLevel3Tools()===false){TBGlobal.ShowUpgradePage("use the Recent Subscriber option",TBGlobal.limitation.commentFilters);return}jQuery(".tb-comment-filter-studio-message-container").hide();jQuery(".tb-comment-filter-studio-message").hide();if(TBGlobal.Profile().HasPatreonIntegration===false&&jQuery(".tb-comment-filter-studio-started-by-select").val()==="patreon"){jQuery(".tb-comment-filter-studio-message-container").show();jQuery(".tb-comment-filter-studio-patreon-not-linked-container").show();return}else if(jQuery(".tb-comment-filter-studio-started-by-select").val()==="patreon"){jQuery(".tb-comment-filter-studio-message-container").show();jQuery(".tb-comment-filter-studio-patreon-refresh").show()}ne();setTimeout(function(){ee();Y.startedByWho=jQuery(".tb-comment-filter-studio-started-by-select").val();Y.startedByMe=Y.startedByWho=="me"&&Y.startedBy;Y.startedBySomeoneElse=Y.startedByWho=="else"&&Y.startedBy;Y.startedByPatreon=Y.startedByWho=="patreon"&&Y.startedBy;Y.startedBySubscriber=Y.startedByWho=="subscriber"&&Y.startedBy;Y.replyTypeSelected=jQuery(".tb-comment-filter-studio-reply-select").val();Y.hasNoReplyFromMe=Y.replyTypeSelected=="meno"&&Y.replyType;Y.hasHasReplyFromMe=Y.replyTypeSelected=="meyes"&&Y.replyType;Y.hasNoReplyFromAnyone=Y.replyTypeSelected=="noone"&&Y.replyType;Y.needsFollowUp=Y.replyTypeSelected=="followup"&&Y.replyType;Y.withSelected=jQuery(".tb-comment-filter-studio-with-select").val();Y.onlyQuestions=Y.withSelected=="questions"&&Y.withType;Y.positive=Y.withSelected=="positive"&&Y.withType;Y.negative=Y.withSelected=="negative"&&Y.withType;Y.profanity=Y.withSelected=="profanity"&&Y.withType;Y.links=Y.withSelected=="links"&&Y.withType;Y.hearted=Y.withSelected=="hearted"&&Y.withType;Y.wordsFilter=Y.withSelected=="words";if(Y.wordsFilter)Y.words=jQuery(".tb-comment-filter-studio-words-advanced").val();else Y.words="";J()},V)});jQuery(document).on("change",".tb-comment-filter-studio-select-basic",function(){Y.isBasic=jQuery(".tb-comment-filter-studio-select-basic").val()!="advanced";jQuery(".tb-comment-filter-studio-advanced").hide();jQuery(".tb-comment-filter-studio-select-auto-load-basic-container").hide();jQuery(".tb-comment-filter-studio-go-container").hide();jQuery(".tb-comment-filter-studio-words-input").hide();if(Y.isBasic){jQuery(".tb-comment-filter-studio-select-auto-load-basic-container").show();jQuery(".tb-comment-filter-studio-go-container").show();if(jQuery(".tb-comment-filter-studio-select-basic").val()==="haswords"){jQuery(".tb-comment-filter-studio-words-input").show()}else{jQuery(".tb-comment-filter-studio-words-input").val("");Y.words=""}}else{if(TBGlobal.CanAccessLevel1Tools()===false){jQuery(".tb-comment-filter-studio-select-basic").val("all");TBGlobal.ShowUpgradePage("use Advanced Comment Filters",TBGlobal.limitation.commentFilters)}else{jQuery(".tb-comment-filter-studio-advanced").show()}}});jQuery(document).on("click",".tb-comment-filter-studio-go",function(){var e=window.location.href.indexOf("/video/")!=-1;if(e===true&&!TBGlobal.CanAccessLevel1Tools()){jQuery(".tb-comment-filter-studio-select-basic").val("all");TBGlobal.ShowUpgradePage("use Comment Filters on individual videos",TBGlobal.limitation.commentFilters);return}jQuery(".tb-comment-filter-studio-message-container").hide();jQuery(".tb-comment-filter-studio-message").hide();if(Y.isBasic){var t=Be();if(t===true){ne();setTimeout(function(){J()},V)}}});jQuery(document).on("change",".tb-comment-filter-studio-with-select",function(){if(!TBGlobal.CanAccessLevel1Tools()){TBGlobal.ShowUpgradePage("use Advanced Comment Filters",TBGlobal.limitation.commentFilters);return}if(jQuery(this).val()==="words")jQuery(".tb-comment-filter-studio-words-advanced ").show();else jQuery(".tb-comment-filter-studio-words-advanced").hide()});jQuery(document).on("click",".tb-comment-filter-studio-topic-planner-text",function(e){TBUtilities.Log("tb-comment-filter-studio-menu-input click");try{if(g===false){TBGlobal.ShowUpgradePage("have more than 5 comment suggestions",TBGlobal.limitation.videotopicplanner);return}TBUtilities.AddAction(null,TBUtilities.ActionTypes.VideoTopicPlanner_SaveComment,"videotopicplanner");var t=jQuery(this).closest(".qtip[data-target-id]");var i=t.attr("data-target-id");var o=jQuery("[data-id='"+i+"']");var a=o.closest("#comment-actions");var s=a.parent().find(".author-text").text();var n=a.parent().find("#content-text").text();var r={VideoId:"",CommentId:"",CommentorChannelId:"",CommentorName:s,Comment:n,CommentorPhoto:""};TBUtilities.Log(r);var l=TBGlobal.host+TBGlobal.apiUrls.topicsToggleCommentAudienceSuggestedTopic;TBExtension.Post(l,JSON.stringify(r),null,null,{contentType:"application/json"});Qe()}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyCommentsCannedResponse] tb-commentsCannedResponse-topicgenerator-input change"})}});jQuery(document).on("click",".tb-comment-filter-studio-menu-cannedResponseEmpty",function(e){jQuery(".tb-comment-filter-studio-menu-cannedResponseEmpty-refresh").show();var t=window.open(TBGlobal.host+"/channel/cannedresponses/"+TBGlobal.CurrentChannelId(),"_blank");t.focus();e.stopPropagation()});jQuery(document).on("click",".tb-comment-filter-studio-comment-menu-header-tools-refresh, .tb-comment-filter-studio-menu-cannedResponseEmpty-refresh",function(e){c=false;Ce();e.stopPropagation()});jQuery(document).on("click",".tb-comment-filter-studio-menu-cannedResponse",function(e){TBUtilities.Log("Commnet filter studio - tb-comment-filter-studio-menu-cannedResponse click");try{TBUtilities.AddAction(null,TBUtilities.ActionTypes.CannedResponses_Use,"cannedresponses");Qe();var t=jQuery(this).closest(".qtip[data-target-id]");var i=t.attr("data-target-id");var o=jQuery("[data-id='"+i+"']");var a=o.closest("#comment-actions");var s=a.closest("ytcp-comment#comment").find("textarea");if(s.length==0){var n=a.find("paper-button.ytcp-comment-button").first();n.click()}var r=jQuery(this).attr("data-id");var l=TBUtilities.GetInArray(p,"Id",r);TBUtilities.Log(l);var u=l.Template;var d=a.parent().find(".author-text").text();TBUtilities.Log(d);if(d){u=TBUtilities.ReplaceAll(u,"{N}",d);u=TBUtilities.ReplaceAll(u,"{n}",d)}TBUtilities.Log(u);s=a.closest("ytcp-comment#comment").find("textarea");var c=s.val();if(c==""){s.val(u)}else{var b=c+" "+u;s.val(b)}var h=s.parent().siblings("#mirror");s.parent().siblings("#mirror").text(s.val()+u);s.closest(".label-and-input-container").find("#placeholder").hide();s.sendkeys(" ");e.stopPropagation()}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyCommentsCannedResponse] tb-commentsCannedResponse-menu-cannedResponse click"})}});jQuery(document).on("click",".tb-emoji-toggle",function(e){var t=jQuery(this).closest("ytcp-commentbox").position();var i=jQuery("body").height();if(t.top>i-430){jQuery(".emojiPicker").css("top",t.top-290+"px")}});jQuery(document).on("click",".tb-comment-filter-studio-mark-as-read",function(e){if(!TBGlobal.CanAccessLevel1Tools()){TBGlobal.ShowUpgradePage("use the Hidden Comments tool",TBGlobal.limitation.hideComments);return}TBUtilities.Log("tb-comment-mark-as-read: click");var t=window.location.href.indexOf("/video/")>-1;var i=jQuery(this).closest("#comment-row").parent().hasClass("ytcp-comment-replies");var o=jQuery(this).parent().attr("data-id");var a=t?jQuery("#img-with-fallback").attr("src"):null;var s;if(!i){if(!a)a=jQuery(this).closest("#comment-row").children("#video-thumbnail").find("img").attr("src");s=jQuery(this).closest("#comment-row").parent().parent().hasClass("tb-comment-is-read-studio")}else{if(!a)a=jQuery(this).closest("#comment-row").parentsUntil("#contents").find("#video-thumbnail img").attr("src");s=jQuery(this).closest("#comment-row").parent().hasClass("tb-comment-is-read-studio")}var n=a.split("/")[4];TBUtilities.Log("Comment Id: "+o);if(s==false){var r=jQuery.param({YouTubeCommentId:o,YouTubeChannelId:TBGlobal.CurrentChannelId(),YouTubeVideoId:n});TBExtension.Post(TBGlobal.host+TBGlobal.apiUrls.commentsMarkAsRead,r,"TBCommentsMarkedAsRead",{commentId:o},{contentType:"application/x-www-form-urlencoded; charset=UTF-8"})}else{var r=jQuery.param({YouTubeCommentId:o,YouTubeChannelId:TBGlobal.CurrentChannelId(),YouTubeVideoId:n});TBExtension.Post(TBGlobal.host+TBGlobal.apiUrls.commentsMarkAsUnRead,r,"TBCommentsMarkedAsUnRead",{commentId:o},{contentType:"application/x-www-form-urlencoded; charset=UTF-8"})}});jQuery(document).on("click","#tb-comment-filter-studio-show-hidden-toggle",function(e){if(!TBGlobal.CanAccessLevel1Tools()){TBGlobal.ShowUpgradePage("use the Hidden Comments tool",TBGlobal.limitation.commentFilters);return}TBUtilities.Log("clicked#tb-comment-filter-studio-show-hidden-toggle");if(Y.hideReadComments){jQuery(".tb-comment-is-read-studio").show();jQuery(this).removeClass("tb-btn-grey");jQuery(this).addClass("tb-btn-green")}else{jQuery(".tb-comment-is-read-studio").hide();jQuery(this).removeClass("tb-btn-green");jQuery(this).addClass("tb-btn-grey")}Y.hideReadComments=!Y.hideReadComments;J();if(jQuery(".tb-comment-filter-studio-select-basic").val()!=="all")jQuery(".tb-comment-filter-studio-refresh").trigger("click")});jQuery(document).on("click","#tb-comment-filter-studio-word-cloud",function(e){var t="";var i="";var o=TBGlobal.CurrentChannelId();var a=0;jQuery("div#contents").find("ytcp-comment.ytcp-comment-thread").each(function(){i=jQuery(this).find("div#metadata a#name").attr("href");if(i=="http://www.youtube.com/channel/"+o){return}else{t+=jQuery(this).find("yt-formatted-string#content-text").text()}a=a+1;TBUtilities.Log("Comment #"+a+" - This comment channel's Id is: "+i)});TBGlobal.ShowWordCloud(t)})};var Be=function(){var e=true;jQuery(".tb-comment-filter-studio-patreon-container").hide();var t=jQuery(".tb-comment-filter-studio-select-basic");var i=t.val();switch(i){case"all":q();break;case"notreplied":q();Y.hasNoReplyFromMe=true;break;case"needfollowup":q();Y.needsFollowUp=true;break;case"replydisabled":q();Y.onlyLinked=true;break;case"questions":q();Y.onlyQuestions=true;break;case"profanity":q();Y.profanity=true;break;case"links":q();Y.links=true;break;case"positive":q();Y.positive=true;break;case"negative":q();Y.negative=true;break;case"haswords":q();Y.wordsFilter=true;Y.words=jQuery(".tb-comment-filter-studio-words-input").val();break;case"patreon":if(!TBGlobal.CanAccessLevel3Tools()){TBGlobal.ShowUpgradePage("use this option",TBGlobal.limitation.commentFilters);e=false}else{q();jQuery(".tb-comment-filter-studio-message-container").hide();jQuery(".tb-comment-filter-studio-message").hide();if(TBGlobal.Profile().HasPatreonIntegration===false){jQuery(".tb-comment-filter-studio-message-container").show();jQuery(".tb-comment-filter-studio-patreon-not-linked-container").show();e=false}else{Y.isPatreonSupporter=true;jQuery(".tb-comment-filter-studio-message-container").show();jQuery(".tb-comment-filter-studio-patreon-refresh").show()}}break;case"subscriber":if(!TBGlobal.CanAccessLevel3Tools()){TBGlobal.ShowUpgradePage("use this option",TBGlobal.limitation.commentFilters);e=false}else{q();Y.isSubscriber=true}break;case"questionsnoreplies":if(!TBGlobal.CanAccessLevel1Tools()){TBGlobal.ShowUpgradePage("use this option",TBGlobal.limitation.commentFilters);e=false}else{q();Y.questionsHasNoReplyFromMe=true}break;case"advanced":if(!TBGlobal.CanAccessLevel1Tools()){TBGlobal.ShowUpgradePage("use Advanced Comment Filters",TBGlobal.limitation.commentFilters);e=false}else{q();Y.startedByWho=jQuery(".tb-comments-filter-started-by-select:first").val();Y.startedByMe=Y.startedByWho=="me"&&Y.startedBy;Y.startedBySomeoneElse=Y.startedByWho=="else"&&Y.startedBy;Y.startedByPatreon=Y.startedByWho=="patreon"&&Y.startedBy;Y.startedBySubscriber=Y.startedByWho=="subscriber"&&Y.startedBy;Y.onlyLinked=jQuery(".tb-comments-filter-thread-select:first").val()=="linked";Y.onlyYouTube=jQuery(".tb-comments-filter-thread-select:first").val()=="youtube";Y.replyTypeSelected=jQuery(".tb-comments-filter-reply-select").val();Y.hasNoReplyFromMe=Y.replyTypeSelected=="meno"&&Y.replyType;Y.hasHasReplyFromMe=Y.replyTypeSelected=="meyes"&&Y.replyType;Y.hasNoReplyFromAnyone=Y.replyTypeSelected=="noone"&&Y.replyType;Y.needsFollowUp=Y.replyTypeSelected=="followup"&&Y.replyType;Y.withSelected=jQuery(".tb-comments-filter-with-select").val();Y.onlyQuestions=Y.withSelected=="questions"&&Y.withType;Y.positive=Y.withSelected=="positive"&&Y.withType;Y.negative=Y.withSelected=="negative"&&Y.withType;Y.profanity=Y.withSelected=="profanity"&&Y.withType;Y.links=Y.withSelected=="links"&&Y.withType;Y.wordsFilter=Y.withSelected=="words";Y.isPatreonSupporter=Y.withSelected=="patreon";Y.isSubscriber=Y.withSelected=="subscriber";Y.questionsHasNoReplyFromMe=false}break;case"hearted":Y.hearted=true;break}if(Y.wordsFilter)jQuery(".tb-comment-filter-studio-words").show();else jQuery(".tb-comment-filter-studio-words").hide();ee();return e};var Ce=function(){if(c===false){var e=TBGlobal.host+TBGlobal.apiUrls.campaignGetByYouTubeChannelId+"?id="+TBGlobal.CurrentChannelId();TBExtension.Get(e,"CommentFilterStudioGetCannedResponses");jQuery(".tb-comment-filter-studio-comment-menu-body").hide();jQuery(".tb-comment-filter-studio-comment-menu-loading").show()}else{Se()}};var xe=function(){var e="";if(b==true){var t=jQuery("#tb-comment-filter-studio-menuButtonTemplate").html();if(p.length>0){jQuery.each(p,function(i,o){e+=t.formatTemplate(o.Id,o.Name)})}else{e=jQuery("#tb-comment-filter-studio-menuButtonTemplateEmpty").html()}}else{e=jQuery("#tb-comment-filter-studio-menuButtonTemplateEmpty").html()}return e};var Se=function(){m.find(".tb-comment-filter-studio-comment-menu-loading").hide();var e=xe();m.find(".tb-comment-filter-studio-comment-menu-body").empty();m.find(".tb-comment-filter-studio-comment-menu-body").html(e);_menuHtml=null;m.find(".tb-comment-filter-studio-comment-menu-body").show();m.find(".tb-comment-filter-studio-comment-menu-header-tools-settings").attr("href",TBGlobal.host+"/channel/cannedresponses/"+TBGlobal.CurrentChannelId())};var Le=function(){jQuery(document.body).on("CRTBupdateCache",function(e,t){try{if(t.success){M=JSON.parse(t.response);lscache.set("tbSubscriberCache"+TBGlobal.CurrentChannelId(),M,2880)}else{M=[]}}catch(e){M=[];TBUtilities.LogError({Exception:e,Location:"[TubeBuddyCommentFilterStudio] CommentFilterStudioUpdateCache"})}});jQuery(document.body).on("CommentFilterStudioPatreonGet",function(e,t){TBUtilities.Log("back:TBCommentsGotPatron");TBUtilities.Log(t);try{if(t.success){U=[];var i=JSON.parse(t.response);TBUtilities.Log(i);jQuery.each(i.PatreonAccounts,function(e,t){jQuery.each(t.Pledges,function(e,t){U.push(t)})})}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyCommentFilterStudio] CommentFilterStudioPatreonGet"})}});jQuery(document.body).on("CommentFilterStudioGetCannedResponsesCanAddSuggestion",function(e,t){try{if(t.success){var i=JSON.parse(t.response);g=i.CanAdd}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyCommentsCannedResponse] CRTBCannedResponseGetCommentAudienceSuggestedTopic"})}});jQuery(document.body).on("CommentFilterStudioGetCannedResponses",function(e,t){c=true;try{if(t.success){p=JSON.parse(t.response);Se();jQuery(".tb-comment-filter-studio-comment-menu-body").show()}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyCommentsCannedResponse] CRTBCannedResponseGetCannedResponses"})}});jQuery(document.body).on("CRTBLoadCommentFilterStudioTemplate",function(e,i){try{if(i.success){i.response=TBUtilities.FixLocalHtml(DOMPurify.sanitize(i.response,DOMPurifyConfig));jQuery("body").append(i.response);o=jQuery("#tb-comment-filter-studio-subscriberCountTemplate").html();t=jQuery("#tb-comment-filter-studio-channelInfoTemplate").html();o=jQuery("#tb-comment-filter-studio-subscriberCountTemplate").html();a=jQuery("#tb-comment-filter-studio-facebookTemplate").html();s=jQuery("#tb-comment-filter-studio-twitterTemplate").html();n=jQuery("#tb-comment-filter-studio-instagramTemplate").html();r=jQuery("#tb-comment-filter-studio-comment-menu").html();d=jQuery("#tb-comment-filter-studio-hide-commentTemplate").html();l=jQuery("#tb-comment-filter-studio-patreonTemplate").html();u=jQuery("#tb-comment-filter-studio-subscriberTemplate").html();W()}else{}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyCommentFilterStudio] CRTBLoadCommentFilterStudioTemplate"})}});jQuery(document.body).on("TBCommentsGotRead",function(e,t){TBUtilities.Log("back:TBCommentsGotRead");TBUtilities.Log(t);try{if(t.success){var i=JSON.parse(t.response);TBUtilities.Log(i);jQuery.each(i.Data,function(e,t){TBUtilities.Log("Read Comment: "+t);if(!jQuery('.tb-comment-filter-studio-hide-comment-toggle[data-id="'+t+'"]').closest("#comment-row").parent().hasClass("ytcp-comment-replies")){TBUtilities.Log("Top Level");TBUtilities.Log("Children: "+jQuery('.tb-comment-filter-studio-hide-comment-toggle[data-id="'+t+'"]').closest(".ytcp-comments-section"));if(Y.hideReadComments)jQuery('.tb-comment-filter-studio-hide-comment-toggle[data-id="'+t+'"]').closest(".ytcp-comments-section").hide();jQuery('.tb-comment-filter-studio-hide-comment-toggle[data-id="'+t+'"]').closest(".ytcp-comments-section").addClass("tb-comment-is-read-studio")}else{TBUtilities.Log("Not Top Level");if(Y.hideReadComments)jQuery('.tb-comment-filter-studio-hide-comment-toggle[data-id="'+t+'"]').closest(".ytcp-comment-replies").hide();jQuery('.tb-comment-filter-studio-hide-comment-toggle[data-id="'+t+'"]').closest(".ytcp-comment-replies").addClass("tb-comment-is-read-studio")}jQuery('.tb-comment-filter-studio-hide-comment-toggle[data-id="'+t+'"]').find(".tb-comment-filter-hide-comment-toggle-icon").attr("data-tbtooltip","Unhide Comment *powered by TubeBuddy");jQuery('.tb-comment-filter-studio-hide-comment-toggle[data-id="'+t+'"]').find(".tb-comment-filter-hide-comment-toggle-icon").addClass("tb-hidden-comment-icon");we()});ge();jQuery("#tb-comment-filter-studio-show-hidden-toggle").removeAttr("disabled")}}catch(e){}});jQuery(document.body).on("TBCommentsMarkedAsRead",function(e,t){TBUtilities.Log("back:TBCommentsMarkedAsRead");TBUtilities.Log(t);try{if(t.success){TBUtilities.Log(t.data.commentId);TBUtilities.Log(jQuery('.tb-comment-filter-studio-hide-comment-toggle[data-id="'+t.data.commentId+'"]').length);if(!jQuery('.tb-comment-filter-studio-hide-comment-toggle[data-id="'+t.data.commentId+'"]').closest("#comment-row").parent().hasClass("ytcp-comment-replies")){TBUtilities.Log("Top Level");TBUtilities.Log("Children: "+jQuery('.tb-comment-filter-studio-hide-comment-toggle[data-id="'+t.data.commentId+'"]').closest(".ytcp-comments-section"));jQuery('.tb-comment-filter-studio-hide-comment-toggle[data-id="'+t.data.commentId+'"]').closest(".ytcp-comments-section").addClass("tb-comment-is-read-studio");if(Y.hideReadComments)jQuery('.tb-comment-filter-studio-hide-comment-toggle[data-id="'+t.data.commentId+'"]').closest(".ytcp-comments-section").slideUp(1e3)}else{TBUtilities.Log("Not Top Level");jQuery('.tb-comment-filter-studio-hide-comment-toggle[data-id="'+t.data.commentId+'"]').closest(".ytcp-comment-replies").addClass("tb-comment-is-read-studio");if(Y.hideReadComments)jQuery('.tb-comment-filter-studio-hide-comment-toggle[data-id="'+t.data.commentId+'"]').closest(".ytcp-comment-replies").slideUp(1e3)}jQuery('.tb-comment-filter-studio-hide-comment-toggle[data-id="'+t.data.commentId+'"]').find(".tb-comment-filter-hide-comment-toggle-icon").attr("data-tbtooltip","Unhide Comment *powered by TubeBuddy");jQuery('.tb-comment-filter-studio-hide-comment-toggle[data-id="'+t.data.commentId+'"]').find(".tb-comment-filter-hide-comment-toggle-icon").addClass("tb-hidden-comment-icon");ge();we()}}catch(e){}});jQuery(document.body).on("TBCommentsMarkedAsUnRead",function(e,t){TBUtilities.Log("back:TBCommentsMarkedAsUnRead");TBUtilities.Log(t);try{if(t.success){TBUtilities.Log(t.data.commentId);TBUtilities.Log(jQuery('.tb-comment-filter-studio-hide-comment-toggle[data-id="'+t.data.commentId+'"]').length);jQuery('.tb-comment-filter-studio-hide-comment-toggle[data-id="'+t.data.commentId+'"]').closest(".tb-comment-is-read-studio").removeClass("tb-comment-is-read-studio");jQuery('.tb-comment-filter-studio-hide-comment-toggle[data-id="'+t.data.commentId+'"]').find(".tb-comment-filter-hide-comment-toggle-icon").attr("data-tbtooltip","Hide Comment *powered by TubeBuddy");jQuery('.tb-comment-filter-studio-hide-comment-toggle[data-id="'+t.data.commentId+'"]').find(".tb-comment-filter-hide-comment-toggle-icon").removeClass("tb-hidden-comment-icon");ge();we()}}catch(e){}})};var _e=function(){var e=false;if(jQuery("#tabsContent paper-tab#public").length>0&&jQuery("#tabsContent paper-tab#public").hasClass("iron-selected")){e=true}return e};return{Initialize:function(t){_=0;E=false;f=t;O=[];C=[];k=[];B=[];w=[];C=Q.split(",");k=T.split(",");B=j.split(",");w=v.split(",");R="";R=G.join(",");if(TBGlobal.IsAuthenticated()){if(!e){Le();je();ke();e=true}else{W()}}}}}();var TubeBuddyUploadDefaultsStudio=function(){var e=false;var t="default";var i="[YouTube]";var o=[];var a=null;var s=null;var n=function(){try{TBUtilities.Log("TubeBuddyUploadDefaultsStudio - populateUploadDefaultsStudio");var e=TBUtilities.GetInArray(o,"Id",t);var i=null;if(e.CommunityContributions==true){i="checked"}else{i="unchecked"}jQuery("#tb-upload-defaults-studio-title-textarea").val(e.Title);jQuery("#tb-upload-defaults-studio-description-textarea").val(e.Description);jQuery("#tb-upload-defaults-studio-visibility").val(e.Privacy);r(e.Tags);jQuery("#tb-upload-defaults-studio-overlay-ads").prop("checked",e.OverlayInVideoAds);jQuery("#tb-upload-defaults-studio-sponsored-cards").prop("checked",e.SponsoredCards);jQuery("#tb-upload-defaults-studio-skippable-ads").prop("checked",e.SkippableVideoAds);jQuery("#tb-upload-defaults-studio-non-skippable-ads").prop("checked",e.NonSkipableVideoAds);jQuery("#tb-upload-defaults-studio-yt-license").val(e.License);jQuery("#tb-upload-defaults-studio-category").val(e.Category=="0"?"":e.Category);jQuery("#tb-upload-defaults-studio-language").val(e.VideoLanguageAbbreviation);jQuery("#tb-upload-defaults-studio-caption-certification").val(e.CaptionCertification=="0"?"":e.CaptionCertification);jQuery("#tb-upload-defaults-studio-community").val(i==null?"unchecked":i);if(e.AllowComments==true){jQuery(".tb-upload-defaults-studio-comments-section input").each(function(){if(jQuery(this).attr("data-value")==e.AllowCommentsDetail){jQuery(this).prop("checked",true);return false}})}else{jQuery(".tb-upload-defaults-studio-comments-section input#tb-upload-defaults-studio-disable-comments").prop("checked",true)}jQuery("#tb-upload-defaults-studio-view-ratings").prop("checked",e.UsersCanViewRatingsForThisVideo)}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyUploadDefaultsStudio] populateUploadDefaultsStudio"})}};var r=function(e){try{TBUtilities.Log("TubeBuddyUploadDefaultsStudio - addTags");jQuery("#tb-upload-defaults-studio-tags-input-container").find("div.tb-ud-tag").each(function(){jQuery(this).remove()});if(e=="")return;if(jQuery.isArray(e)){jQuery.each(e,function(e,t){jQuery("#tb-upload-defaults-studio-tags-entered").append('<div class="tb-ud-tag tb-font-medium tb-inline-block"><div class="tb-ud-tag-text" style="display: inline-block;">'+t+'</div><input class="tb-ud-tag-input tb-font-book" value="'+t+'" style="display: none;"><i class="medium material-icons tb-icon-white tb-up-tag-remove" data-draggable="false">close</i></div>')})}else{var t=[];if(e.indexOf('"')>=0){var i=/[^\s"]+|"([^"]*)"/gi;do{var o=i.exec(e);if(o!=null){t.push(o[1]?o[1]:o[0])}}while(o!=null)}else t=e.split(",");jQuery.each(t,function(e,t){jQuery("#tb-upload-defaults-studio-tags-entered").append('<div class="tb-ud-tag tb-font-medium tb-inline-block"><div class="tb-ud-tag-text" style="display: inline-block;">'+t+'</div><input class="tb-ud-tag-input tb-font-book" value="'+t+'" style="display: none;"><i class="medium material-icons tb-icon-white tb-up-tag-remove" data-draggable="false">close</i></div>')})}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyUploadDefaultsStudio] addTags"})}};var l=function(){try{TBUtilities.Log("TubeBuddyUploadDefaultsStudio - readTags");if(jQuery("#tb-upload-defaults-studio-tags-entered div.tb-ud-tag").length!=0){TBUtilities.Log("TubeBuddyUploadDefaultsStudio - READING TAGS");var e=[];var t=jQuery("#tb-upload-defaults-studio-tags-entered div.tb-ud-tag-text");t.each(function(){e.push(jQuery(this)[0].childNodes[0].nodeValue)});var i=e.toString();return i}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyUploadDefaultsStudio] readTags"})}};var u=function(){var e=TBGlobal.host+"/ModuleManager/UploadDefaultsStudio/UploadDefaultsStudio?v="+TBGlobal.versionNumber;if(loadLocalHTML&&(TBExtension.GetType()=="chrome"||TBExtension.GetType()=="firefox")){e=chrome.extension.getURL("modules/uploaddefaultsstudio.html")}else if(loadLocalHTML&&TBExtension.GetType()=="safari"){e="modules/UploadDefaultsStudio.html"}TBExtension.Get(e,"CRTBLoadUploadDefaultsStudioTemplate")};var d=function(){var e=jQuery("#tb-upload-defaults-studio-title-textarea").val().length;var t=jQuery("#tb-upload-defaults-studio-description-textarea").val().length;jQuery(".tb-upload-defaults-studio-title-count").text(e);jQuery(".tb-upload-defaults-studio-description-count").text(t);if(e>100){jQuery(".tb-upload-defaults-studio-title-count").css("color","#FA3535")}if(t>5e3){jQuery(".tb-upload-defaults-studio-description-count").css("color","#FA3535")}};var c=function(){var e=0;jQuery("#tb-upload-defaults-studio-tags-entered div.tb-ud-tag-text").each(function(t,i){var o=jQuery(this).text();o=o.replace(/\s/,"---");e+=o.length;e+=1});jQuery(".tb-upload-defaults-studio-tags-count").text(e);if(e>500){jQuery(".tb-upload-defaults-studio-tags-count").css("color","#FA3535")}else{jQuery(".tb-upload-defaults-studio-tags-count").css("color","rgba(66,66,66,0.5)")}};var p=function(){try{TBUtilities.Log("TubeBuddyUploadDefaultsStudio - loadProfiles");var e=TBGlobal.host+TBGlobal.apiUrls.uploadDefaultsList;TBExtension.Get(e,function(e,t,i){TBUtilities.Log("TubeBuddyUploadDefaultsStudio - Get Upload Defaults Profiles list");if(e===true){var t=JSON.parse(i);TBUtilities.Log("TB UploadDefaultsStudio data: "+t);jQuery.each(t,function(e,t){o.push(t);TBUtilities.Log(e+o)})}})}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyUploadDefaultsStudio] loadProfiles"})}};var b=function(){try{TBUtilities.Log("TubeBuddyUploadDefaultsStudio - populateUploadDefaultsStudioList");jQuery("#tb-upload-defaults-studio-main-list").empty();jQuery.each(o,function(e,t){jQuery("#tb-upload-defaults-studio-main-list:first").append(jQuery("<li></li>").attr("data-value",t.Id).text(t.Name))});jQuery("#tb-upload-defaults-studio-main-list:first").prepend(jQuery('<li class="tb-upload-defaults-active" data-value="default">[ YouTube ]</li>'))}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyUploadDefaultsStudio] populateUploadDefaultStudioList"})}};var h=function(){if(jQuery("ytcp-settings-dialog.ytcp-channel-settings-dialog .footer").find(".tb-upload-defaults-studio-btn-container").length==0){jQuery("ytcp-settings-dialog.ytcp-channel-settings-dialog .footer").prepend(jQuery(".tb-upload-defaults-studio-btn-container"));jQuery(".tb-upload-defaults-studio-btn-container").show()}else{jQuery(".tb-upload-defaults-studio-btn-container").show();jQuery("#tb-upload-defaults-studio-new-profile-btn").show()}};var m=function(){jQuery(document).on("click","paper-icon-item#settings-item",function(){jQuery('[data-tbtooltip!=""]').qtip({content:{attr:"data-tbtooltip"},style:{classes:"qtip-youtube-tubebuddy"}});var e=setInterval(function(){if(jQuery("ytcp-settings-dialog.ytcp-channel-settings-dialog").length>0&&jQuery("ytcp-settings-dialog.ytcp-channel-settings-dialog").find("paper-dialog#dialog").is(":visible")){clearInterval(e);TBUtilities.Log("TubeBuddyUploadDefaultsStudio - Settings Dialog visible");var t=setInterval(function(){if(jQuery("ytcp-settings-dialog.ytcp-channel-settings-dialog").length>0&&jQuery("ytcp-settings-dialog.ytcp-channel-settings-dialog").find("#uploads").is(":visible")){clearInterval(t);TBUtilities.Log("TubeBuddyUploadDefaultsStudio - Settings Menu visible");p();var e=jQuery("ytcp-settings-dialog.ytcp-channel-settings-dialog");var i=e.find("#uploads");jQuery(i).find("span.ytcp-navigation").css({"white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis",width:"210px"});i.append(jQuery(".tb-upload-defaults-studio-dropdown-container").html());jQuery(".tb-upload-defaults-studio-form-container").appendTo("ytcp-navigation.ytcp-settings-dialog div#content");jQuery("ytcp-settings-dialog.ytcp-channel-settings-dialog ytcp-navigation.ytcp-settings-dialog").find("div.nav-drawer").css("overflow-x","hidden")}},100)}},100)});jQuery(document).on("click","ytcp-settings-dialog.ytcp-channel-settings-dialog li#uploads",function(e){TBUtilities.Log("TubeBuddyUploadDefaultsStudio - UPLOAD DEFAULTS click");h();jQuery(".tb-upload-defaults-studio-label-icon").show();jQuery(".tb-upload-defaults-studio-label").show();if(jQuery("ytcp-settings-dialog.ytcp-channel-settings-dialog #uploads").find(".tb-upload-defaults-studio-list").length==0){jQuery("ytcp-settings-dialog.ytcp-channel-settings-dialog #uploads").parent().append(jQuery(".tb-upload-defaults-studio-list"))}if(jQuery("#tb-upload-defaults-studio-main-list li").length==0){b()}if(jQuery("ytcp-primary-action-bar div#tabsContent").find('paper-tab span:contains("Monetization")').length==0){jQuery(".tb-tab-3").hide()}jQuery(".tb-upload-defaults-studio-save-cancel-container").hide();jQuery("#tb-upload-defaults-studio-copy-btn").hide();jQuery("#tb-upload-defaults-studio-save-btn").hide();jQuery("#tb-upload-defaults-studio-cancel-btn").hide();jQuery("#tb-upload-defaults-studio-delete-btn").hide();jQuery(".tb-upload-defaults-studio-form-container").hide();jQuery("#tb-upload-defaults-studio-save-btn-newprofile").hide();jQuery("#tb-upload-defaults-studio-main-list li").each(function(){if(jQuery(this).hasClass("tb-upload-defaults-active")){jQuery(this).removeClass("tb-upload-defaults-active");return false}});jQuery("#tb-upload-defaults-studio-main-list li:contains([ YouTube ])").addClass("tb-upload-defaults-active");e.stopImmediatePropagation()});jQuery(document).on("click","ytcp-settings-dialog.ytcp-channel-settings-dialog .tb-upload-defaults-studio-videos-list",function(e){jQuery(".tb-upload-defaults-studio-label-icon").show();jQuery(".tb-upload-defaults-studio-label").show();if(jQuery("ytcp-settings-dialog.ytcp-channel-settings-dialog #uploads").find(".tb-upload-defaults-studio-list").length==0){jQuery("ytcp-settings-dialog.ytcp-channel-settings-dialog #uploads").parent().append(jQuery(".tb-upload-defaults-studio-list"));if(jQuery("#tb-upload-defaults-studio-main-list li").length==0){b()}}if(jQuery("ytcp-settings-dialog.ytcp-channel-settings-dialog #uploads").parent().find(".tb-upload-defaults-studio-list").is(":visible")){jQuery("ytcp-settings-dialog.ytcp-channel-settings-dialog #uploads").parent().find(".tb-upload-defaults-studio-list").fadeOut()}else{jQuery("ytcp-settings-dialog.ytcp-channel-settings-dialog #uploads").parent().find(".tb-upload-defaults-studio-list").fadeIn()}if(jQuery("ytcp-upload-defaults-settings").length!=0&&jQuery(".tb-upload-defaults-studio-form-container").is(":hidden")){h()}e.stopImmediatePropagation()});jQuery(document).on("click","ytcp-settings-dialog.ytcp-channel-settings-dialog li.menu-item",function(){if(jQuery(this).attr("id")!="uploads"&&jQuery(this).attr("id")!="missing-features-item"){jQuery(".tb-upload-defaults-studio-btn-container").hide();jQuery(".tb-upload-defaults-studio-list").hide();jQuery(".tb-upload-defaults-studio-form-container").hide();jQuery("#tb-upload-defaults-studio-save-btn").hide();jQuery("#tb-upload-defaults-studio-save-btn-newprofile").hide();jQuery("#tb-upload-defaults-studio-cancel-btn").hide();jQuery("#tb-upload-defaults-studio-delete-btn").hide();jQuery("#tb-upload-defaults-studio-copy-btn").hide();jQuery(".tb-upload-defaults-studio-label-icon").hide();jQuery(".tb-upload-defaults-studio-label").hide()}TBUtilities.Log("Another menu item was clicked")});jQuery(document).on("click",".tb-tabs-menu-item-container",function(){jQuery(this).parent().find(".tb-tabs-selected-menu-item").removeClass("tb-tabs-selected-menu-item");jQuery(this).parents().find(".tb-tabs-content").addClass("tb-hid");jQuery(this).addClass("tb-tabs-selected-menu-item");jQuery(this).find(".tb-tabs-menu-item-icon").addClass("tb-tabs-selected-menu-icon");jQuery(this).parents().find("#"+jQuery(this).attr("data-tab")).removeClass("tb-hid")});jQuery(document).on("click","#tb-upload-defaults-studio-main-list li",function(){try{jQuery("#tb-upload-defaults-studio-main-list li").each(function(){if(jQuery(this).hasClass("tb-upload-defaults-active")){jQuery(this).removeClass("tb-upload-defaults-active");return false}});jQuery(this).addClass("tb-upload-defaults-active");if(jQuery(this).attr("data-value")!=="default"){jQuery(".tb-upload-defaults-studio-save-cancel-container").show();jQuery("#tb-upload-defaults-studio-save-btn").show();jQuery("#tb-upload-defaults-studio-save-btn-newprofile").hide();jQuery("#tb-upload-defaults-studio-copy-btn").show();jQuery("#tb-upload-defaults-studio-delete-btn").show();jQuery("#tb-upload-defaults-studio-new-profile-btn").hide();jQuery("#tb-upload-defaults-studio-cancel-btn").show();jQuery(".tb-upload-defaults-studio-form-container").show();jQuery(".tb-upload-defaults-studio-label-icon").show();jQuery(".tb-upload-defaults-studio-label").show();t=jQuery(this).attr("data-value");i=jQuery(this).text();TBUtilities.Log(t);TBUtilities.Log(i);n();d();c()}else{jQuery(".tb-upload-defaults-studio-save-cancel-container").hide();jQuery("#tb-upload-defaults-studio-copy-btn").hide();jQuery("#tb-upload-defaults-studio-save-btn").hide();jQuery("#tb-upload-defaults-studio-cancel-btn").hide();jQuery("#tb-upload-defaults-studio-delete-btn").hide();jQuery("#tb-upload-defaults-studio-new-profile-btn").show();jQuery(".tb-upload-defaults-studio-form-container").hide();jQuery("#tb-upload-defaults-studio-save-btn-newprofile").hide();jQuery(".tb-upload-defaults-studio-label-icon").show();jQuery(".tb-upload-defaults-studio-label").show()}TBUtilities.Log("TubeBuddyUploadDefaultsStudio - Profile selected")}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyUploadDefaultsStudio] #tb-upload-defaults-studio-main-list item select"})}});jQuery(document).on("change keyup keypress","#tb-upload-defaults-studio-tags-input",function(e){if(jQuery("#tb-upload-defaults-studio-tags-input").val()==" "||jQuery("#tb-upload-defaults-studio-tags-input").val()=="")return;if(e.which=="60"||e.which=="62"){setTimeout(function(){jQuery("#tb-upload-defaults-studio-tags-input").val("")},100)}if(e.keyCode==13||e.which=="13"||e.which=="188"||e.keyCode==188){var t=jQuery("#tb-upload-defaults-studio-tags-input").val();if(t.includes(">")||t.includes("<")||t==",")return;if(t.includes(","))t=t.replace(",","");jQuery("#tb-upload-defaults-studio-tags-entered").append('<div class="tb-ud-tag tb-font-medium tb-inline-block"><div class="tb-ud-tag-text" style="display: inline-block;">'+t+'</div><input class="tb-ud-tag-input tb-font-book" value="'+t+'" style="display: none;"><i class="medium material-icons tb-icon-white tb-up-tag-remove" data-draggable="false">close</i></div>');jQuery("#tb-upload-defaults-studio-tags-input").val("");c()}if(jQuery("#tb-upload-defaults-studio-tags-input").is(":focus")){return}else{t=jQuery("#tb-upload-defaults-studio-tags-input").val();if(t.includes(">")||t.includes("<"))return;jQuery("#tb-upload-defaults-studio-tags-entered").append('<div class="tb-ud-tag tb-font-medium tb-inline-block"><div class="tb-ud-tag-text" style="display: inline-block;">'+t+'</div><input class="tb-ud-tag-input tb-font-book" value="'+t+'" style="display: none;"><i class="medium material-icons tb-icon-white tb-up-tag-remove" data-draggable="false">close</i></div>');jQuery("#tb-upload-defaults-studio-tags-input").val("");c()}});jQuery(document).on("click",".tb-ud-tag-text",function(){var e=jQuery(this).width();jQuery(this).hide();jQuery(this).parent().find(".tb-ud-tag-input").css("width",e+2);jQuery(this).parent().find(".tb-ud-tag-input").show();jQuery(this).parent().find(".tb-ud-tag-input").focus();jQuery(this).parent().addClass("tb-ud-tag-focus")});jQuery(document).on("change keyup keypress",".tb-ud-tag-input",function(e){if(e.keyCode==13||e.which=="13"||e.which=="188"||e.keyCode==188){if(jQuery(this).val()==" "||jQuery(this).val()==""){jQuery(this).parent().remove();c()}else{var t=jQuery(this).val();if(t.includes(">")||t.includes("<"))return;if(t.includes(","))t=t.replace(",","");jQuery(this).parent().removeClass("tb-ud-tag-focus");jQuery(this).hide();jQuery(this).parent().find(".tb-ud-tag-text").text(t);jQuery(this).parent().find(".tb-ud-tag-text").show();c()}}});jQuery(document).on("focusout",".tb-ud-tag-input",function(){var e=jQuery(this).val();if(e.includes(">")||e.includes("<")){currentTag=jQuery(this).parent();jQuery(currentTag).removeClass("tb-ud-tag-focus");jQuery(currentTag).addClass("tb-ud-tag-focus-warning");setTimeout(function(){jQuery(currentTag).removeClass("tb-ud-tag-focus-warning");jQuery(currentTag).addClass("tb-ud-tag-focus");jQuery(this).focus()},2e3);return}if(e.includes(","))e=e.replace(",","");jQuery(this).parent().removeClass("tb-ud-tag-focus");jQuery(this).hide();jQuery(this).parent().find(".tb-ud-tag-text").text(e);jQuery(this).parent().find(".tb-ud-tag-text").show();c()});jQuery(document).on("click",".tb-up-tag-remove",function(){jQuery(this).parent().remove();c()});jQuery(document).on("click",".tb-upload-defaults-studio-clear-tags",function(){jQuery("#tb-upload-defaults-studio-tags-entered div.tb-ud-tag").each(function(){jQuery(this).remove()});c()});jQuery(document).on("click","#tb-upload-defaults-studio-new-profile-btn",function(){try{TBUtilities.Log("TubeBuddyUploadDefaultsStudio - NEW PROFILE button click");if(o.length>=1&&!TBGlobal.CanAccessLevel1Tools()){TBGlobal.ShowUpgradePage("create more than one custom Default Upload Profile",TBGlobal.limitation.defaultuploadprofiles);return}s=prompt("Please enter a name for the new Profile","New Profile");if(s===null){return}jQuery(".tb-upload-defaults-studio-save-cancel-container").show();jQuery("#tb-upload-defaults-studio-save-btn-newprofile").show();jQuery("#tb-upload-defaults-studio-cancel-btn").show();jQuery("#tb-upload-defaults-studio-delete-btn").hide();jQuery("#tb-upload-defaults-studio-new-profile-btn").hide();jQuery(".tb-upload-defaults-studio-form-container").show();jQuery(".tb-upload-defaults-studio-form-container").show();jQuery("#tb-upload-defaults-studio-title-textarea").val("");jQuery("#tb-upload-defaults-studio-description-textarea").val("");jQuery("#tb-upload-defaults-studio-tags-input-container").find("div.tb-ud-tag").each(function(){jQuery(this).remove()});var e=jQuery("html").attr("lang");jQuery("#tb-upload-defaults-studio-language").val(e);d();c()}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyUploadDefaultsStudio] CREATE NEW PROFILE button [click]"})}});jQuery(document).on("click","#tb-upload-defaults-studio-save-btn-newprofile",function(){TBUtilities.Log("TubeBuddyUploadDefaultsStudio - Save New Profile");f(s)});jQuery(document).on("click","#tb-upload-defaults-studio-save-btn",function(){try{TBUtilities.Log("TubeBuddyUploadDefaultsStudio - SAVE click");if(jQuery("#description").val().length>5e3){TBUtilities.Alert("Sorry, your Description is too long (YouTube only allows up to 5,000 characters).<Br><br>You have "+TBUtilities.FormatNumberWithCommas(jQuery("#description").val().length)+" characters. Please reduce it to 5,000 or fewer.");return}var e=l();var o=null;if(jQuery("#tb-upload-defaults-studio-community option:selected").val()=="checked"){o=true}else{o=false}var a=null;var s=null;if(jQuery("#tb-upload-defaults-studio-disable-comments").is(":checked")){a=false;s=false}else{a=true;jQuery(".tb-upload-defaults-studio-comments-section input").each(function(){if(jQuery(this).is(":checked")){s=jQuery(this).attr("data-value")}})}var n=TBGlobal.host+TBGlobal.apiUrls.uploadDefaultsUpdate;var r=jQuery.param({Id:t,YouTubeChannelId:TBGlobal.CurrentChannelId(),Title:jQuery("#tb-upload-defaults-studio-title-textarea").val(),Description:jQuery("#tb-upload-defaults-studio-description-textarea").val(),Privacy:jQuery("#tb-upload-defaults-studio-visibility").val(),Tags:e,OverlayInVideoAds:jQuery("#tb-upload-defaults-studio-overlay-ads").is(":checked"),SponsoredCards:jQuery("#tb-upload-defaults-studio-sponsored-cards").is(":checked"),SkippableVideoAds:jQuery("#tb-upload-defaults-studio-skippable-ads").is(":checked"),NonSkipableVideoAds:jQuery("#tb-upload-defaults-studio-non-skippable-ads").is(":checked"),License:jQuery("#tb-upload-defaults-studio-yt-license").val(),Category:jQuery("#tb-upload-defaults-studio-category").val(),VideoLanguageAbbreviation:jQuery("#tb-upload-defaults-studio-language").val(),VideoLanguage:jQuery("#tb-upload-defaults-studio-language option:selected").text(),CaptionCertification:jQuery("#tb-upload-defaults-studio-caption-certification").val(),CommunityContributions:o,AllowComments:a,AllowCommentsDetail:s,UsersCanViewRatingsForThisVideo:jQuery("#tb-upload-defaults-studio-view-ratings").is(":checked"),Name:i});TBExtension.Post(n,r,"CRUploadDefaultsUpdate",null,{contentType:"application/x-www-form-urlencoded; charset=UTF-8"})}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyUploadDefaultsStudio] SAVE button [click]"})}});jQuery(document).on("click","#tb-upload-defaults-studio-copy-btn",function(){TBUtilities.Log("TubeBuddyUploadDefaultsStudio - Copy Profile");if(o.length>=1&&!TBGlobal.CanAccessLevel1Tools()){TBGlobal.ShowUpgradePage("create more than one custom Default Upload Profile",TBGlobal.limitation.defaultuploadprofiles);return}s=prompt("Please enter a name for the new Profile",i+" - Copy");f(s)});jQuery(document).on("click","#tb-upload-defaults-studio-delete-btn",function(){try{TBUtilities.Log("TubeBuddyUploadDefaultsStudio -  tb-upload-default-delete-btn click");if(jQuery(this).attr("disabled")==="disabled")return;TBUtilities.Confirm('Are you sure you want to delete the profile?\n\n"'+jQuery("#tb-upload-defaults-studio-main-list li.tb-upload-defaults-active").text()+'"',function(){var e=TBGlobal.host+TBGlobal.apiUrls.uploadDefaultsDelete;var i=jQuery.param({Id:t});TBExtension.Post(e,i,"CRUploadDefaultsDelete",null,{contentType:"application/x-www-form-urlencoded; charset=UTF-8"});jQuery("#tb-upload-defaults-studio-main-list li.tb-upload-defaults-active").remove();jQuery(".tb-upload-defaults-studio-form-container").hide();jQuery("#tb-upload-defaults-studio-copy-btn").hide();jQuery("#tb-upload-defaults-studio-delete-btn").hide();jQuery(".tb-upload-defaults-studio-save-cancel-container").hide();jQuery("#tb-upload-defaults-studio-save-btn-newprofile").hide();jQuery("#tb-upload-defaults-studio-new-profile-btn").show()},function(){})}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyUploadDefaults] .tb-upload-default-delete-button [change]"})}});jQuery(document).on("click","#tb-upload-defaults-studio-cancel-btn",function(){jQuery("#tb-upload-defaults-studio-copy-btn").hide();jQuery("#tb-upload-defaults-studio-save-btn").hide();jQuery("#tb-upload-defaults-studio-cancel-btn").hide();jQuery("#tb-upload-defaults-studio-delete-btn").hide();jQuery("#tb-upload-defaults-studio-new-profile-btn").show();jQuery(".tb-upload-defaults-studio-form-container").hide();jQuery("#tb-upload-defaults-studio-save-btn-newprofile").hide();jQuery(".tb-upload-defaults-studio-save-cancel-container").hide();jQuery("#tb-upload-defaults-studio-main-list li").each(function(){if(jQuery(this).hasClass("tb-upload-defaults-active")){jQuery(this).removeClass("tb-upload-defaults-active");return false}});jQuery("#tb-upload-defaults-studio-main-list li:contains([ YouTube ])").addClass("tb-upload-defaults-active")});jQuery(document).on("change keyup keypress paste","#tb-upload-defaults-studio-title-textarea",function(e){var t=jQuery(this).val().length;jQuery(".tb-upload-defaults-studio-title-count").text(t);if(t>100){jQuery(".tb-upload-defaults-studio-title-count").css("color","#FA3535")}else{jQuery(".tb-upload-defaults-studio-title-count").css("color","rgba(66,66,66,0.5)")}if(e.which=="60"||e.which=="62"){jQuery(this).parent().removeClass("tb-upload-defaults-studio-focus");jQuery(this).parent().addClass("tb-upload-defaults-studio-focus-warning");jQuery("#tb-upload-defaults-studio-save-btn").attr("disabled","disabled");jQuery("#tb-upload-defaults-studio-copy-btn").attr("disabled","disabled")}setTimeout(function(){var e=jQuery("#tb-upload-defaults-studio-title-textarea").val();if(e.includes(">")||e.includes("<")){return false}else{jQuery("#tb-upload-defaults-studio-title-textarea").parent().removeClass("tb-upload-defaults-studio-focus-warning");jQuery("#tb-upload-defaults-studio-title-textarea").parent().addClass("tb-upload-defaults-studio-focus");jQuery("#tb-upload-defaults-studio-save-btn").attr("disabled",false);jQuery("#tb-upload-defaults-studio-copy-btn").attr("disabled",false)}},300);TBUtilities.Log(e.which)});jQuery(document).on("change keyup keypress paste","#tb-upload-defaults-studio-description-textarea",function(e){var t=jQuery(this).val().length;jQuery(".tb-upload-defaults-studio-description-count").text(t);if(t>5e3){jQuery(".tb-upload-defaults-studio-description-count").css("color","#FA3535")}else{jQuery(".tb-upload-defaults-studio-description-count").css("color","rgba(66,66,66,0.5)")}if(e.which=="60"||e.which=="62"){jQuery(this).parent().removeClass("tb-upload-defaults-studio-focus");jQuery(this).parent().addClass("tb-upload-defaults-studio-focus-warning");jQuery("#tb-upload-defaults-studio-save-btn").attr("disabled","disabled");jQuery("#tb-upload-defaults-studio-copy-btn").attr("disabled","disabled")}setTimeout(function(){var e=jQuery("#tb-upload-defaults-studio-description-textarea").val();if(e.includes(">")||e.includes("<")){return false}else{jQuery("#tb-upload-defaults-studio-description-textarea").parent().removeClass("tb-upload-defaults-studio-focus-warning");jQuery("#tb-upload-defaults-studio-description-textarea").parent().addClass("tb-upload-defaults-studio-focus");jQuery("#tb-upload-defaults-studio-save-btn").attr("disabled",false);jQuery("#tb-upload-defaults-studio-copy-btn").attr("disabled",false)}},300);TBUtilities.Log(e.which)});jQuery(document).on("click",function(){if(jQuery("#tb-upload-defaults-studio-title-textarea").is(":focus")){jQuery("#tb-upload-defaults-studio-title-textarea-container").addClass("tb-upload-defaults-studio-focus")}else{jQuery("#tb-upload-defaults-studio-title-textarea-container").removeClass("tb-upload-defaults-studio-focus")}if(jQuery("#tb-upload-defaults-studio-description-textarea").is(":focus")){jQuery("#tb-upload-defaults-studio-description-textarea-container").addClass("tb-upload-defaults-studio-focus")}else{jQuery("#tb-upload-defaults-studio-description-textarea-container").removeClass("tb-upload-defaults-studio-focus")}if(jQuery("#tb-upload-defaults-studio-tags-input").is(":focus")){jQuery("#tb-upload-defaults-studio-tags-input-container").addClass("tb-upload-defaults-studio-focus")}else{jQuery("#tb-upload-defaults-studio-tags-input-container").removeClass("tb-upload-defaults-studio-focus")}});jQuery(document).on("click","ytcp-button#cancel-button",function(){o=[];jQuery("#tb-upload-defaults-studio-main-list").empty();u();TBUtilities.Log("YouTube CANCEL button was clicked")})};var f=function(e){try{TBUtilities.Log("TubeBuddyUploadDefaultsStudio - newProfile()");var t=l();var i=null;if(jQuery("#tb-upload-defaults-studio-community option:selected").val()=="checked"){i=true}else{i=false}var o=null;var a=null;if(jQuery("#tb-upload-defaults-studio-disable-comments").is(":checked")){o=false;a=false}else{o=true;jQuery(".tb-upload-defaults-studio-comments-section input").each(function(){if(jQuery(this).is(":checked")){a=jQuery(this).attr("data-value")}})}if(e!=null){if(e.length>74)e=e.substring(0,74);var s=TBGlobal.host+TBGlobal.apiUrls.uploadDefaultsAdd;var n=jQuery.param({YouTubeChannelId:TBGlobal.CurrentChannelId(),Title:jQuery("#tb-upload-defaults-studio-title-textarea").val(),Description:jQuery("#tb-upload-defaults-studio-description-textarea").val(),Privacy:jQuery("#tb-upload-defaults-studio-visibility").val(),Tags:t,OverlayInVideoAds:jQuery("#tb-upload-defaults-studio-overlay-ads").is(":checked"),SponsoredCards:jQuery("#tb-upload-defaults-studio-sponsored-cards").is(":checked"),SkippableVideoAds:jQuery("#tb-upload-defaults-studio-skippable-ads").is(":checked"),NonSkipableVideoAds:jQuery("#tb-upload-defaults-studio-non-skippable-ads").is(":checked"),License:jQuery("#tb-upload-defaults-studio-yt-license").val(),Category:jQuery("#tb-upload-defaults-studio-category").val(),VideoLanguageAbbreviation:jQuery("#tb-upload-defaults-studio-language").val(),VideoLanguage:jQuery("#tb-upload-defaults-studio-language option:selected").text(),CaptionCertification:jQuery("#tb-upload-defaults-studio-caption-certification").val(),CommunityContributions:i,AllowComments:o,AllowCommentsDetail:a,UsersCanViewRatingsForThisVideo:jQuery("#tb-upload-defaults-studio-view-ratings").is(":checked"),Name:e});TBUtilities.Log("TubeBuddyUploadDefaults - calling CRUploadDefaultsAdd");TBUtilities.Log(n);TBExtension.Post(s,n,"CRUploadDefaultsAdd",null,{contentType:"application/x-www-form-urlencoded; charset=UTF-8"})}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyUploadDefaultsStudio] newProfile()"})}};var y=function(e){o=[];p();setTimeout(function(){b();jQuery("#tb-upload-defaults-studio-main-list li").each(function(){if(jQuery(this).hasClass("tb-upload-defaults-active")){jQuery(this).removeClass("tb-upload-defaults-active");return false}});jQuery("#tb-upload-defaults-studio-main-list li").each(function(){if(jQuery(this).text()==e){jQuery(this).addClass("tb-upload-defaults-active");return false}})},200)};var g=function(){jQuery(document.body).on("CRTBLoadUploadDefaultsStudioTemplate",function(e,t){try{if(t.success){t.response=TBUtilities.FixLocalHtml(DOMPurify.sanitize(t.response,DOMPurifyConfig));jQuery("body").append(t.response)}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyUploadDefaultsStudio] CRTBLoadUploadDefaultsStudioTemplate"})}});jQuery(document.body).on("CRUploadDefaultsAdd",function(e,a){try{TBUtilities.Log("TubeBuddyUploadDefaults - CRUploadDefaultsAdd");TBUtilities.Log(a);if(a.success){var s=JSON.parse(a.response);TBUtilities.Log(s);o.push(s);t=s.Id;i=s.Name;b();jQuery("#tb-upload-defaults-studio-main-list li").each(function(){if(jQuery(this).hasClass("tb-upload-defaults-active")){jQuery(this).removeClass("tb-upload-defaults-active")}});jQuery("#tb-upload-defaults-studio-main-list li:last").addClass("tb-upload-defaults-active");jQuery("#tb-upload-defaults-studio-save-btn-newprofile").hide();jQuery("#tb-upload-defaults-studio-save-btn").show();jQuery("#tb-upload-defaults-studio-delete-btn").show();jQuery("#tb-upload-defaults-studio-copy-btn").show();jQuery("ytcp-settings-dialog.ytcp-channel-settings-dialog #uploads").parent().find(".tb-upload-defaults-studio-list").fadeIn();TBUtilities.Alert("Your new Profile was successfully created!")}else{}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyUploadDefaultsStudio] CRUploadDefaultsAdd"})}});jQuery(document.body).on("CRUploadDefaultsUpdate",function(e,t){try{TBUtilities.Log("TubeBuddyUploadDefaultsStudio - CRUploadDefaultsUpdate");if(t.success){TBUtilities.Alert("Your changes were successfully saved!");var i=t.response;var o=JSON.parse(i);TBUtilities.Log("Changes were made to: "+o.Name+" profile");var a=o.Name;y(a)}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyUploadDefaultsStudio] CRUploadDefaultsUpdate"})}});jQuery(document.body).on("CRUploadDefaultsDelete",function(e,a){try{TBUtilities.Log("TubeBuddyUploadDefaults - CRUploadDefaultsDelete");if(a.success){t="default";i="[YouTube]";TBUtilities.Alert("Profile successfully deleted!")}o=[];p();setTimeout(function(){b()},200)}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyUploadDefaults] CRUploadDefaultsUpdate"})}})};return{Initialize:function(){if(TBGlobal.IsAuthenticated()){if(!e){g();u();m();e=true}}}}}();var TubeBuddySeoStudio=function(){var e=false;var t=null;var i=null;var o=null;var a=null;var s=null;var n=[];var r=null;var l=null;var u=0;var d=null;var c=[];var p=[];var b=[];var h=[];var m=["#dea85d","#dcde5d","#6cc861"];var f=null;var y=null;var g=false;var v=[{id:"title-exact",completed:false,improveText:"Include your target keyword in the title.",improveDetail:"Include an exact match of your Target Keyword somewhere in your title. That means all of the words in your Target Keyword, in the same order.",score:20,weighted:12,isPartialCheck:false,dataTabId:"step2"},{id:"title-80-percent",completed:false,improveText:"Include 80% of your target keyword in the title.",improveDetail:"If including an exact match of your Target Keyword doesn't sound natural or make sense in this case, make sure that at least a good portion of your Target Keyword is included.",score:30,weighted:18,isPartialCheck:true,dataTabId:"step2"},{id:"title-first-60",completed:false,improveText:"Include your target keyword in the first 60 characters of the title.",improveDetail:"YouTube may weigh keywords closer to the beginning of your title more than words at the end so try to include your Target Keyword up front.",score:10,weighted:6,isPartialCheck:false,dataTabId:"step2"},{id:"title-exact-natural",completed:false,improveText:"Include your target keyword naturally in the title.",improveDetail:"Your title should include your Target Keyword in a way that sounds natural, not forced, in order to make it human-readable and compelling. This also means your title should include more words than just your target keyword alone.",score:40,weighted:24,isPartialCheck:false,dataTabId:"step2"},{id:"description-exact",completed:false,improveText:"Include your target keyword in the first 200 characters of the description.",improveDetail:"Not only will the first 200 characters carry more weight in YouTube's search algorithm, it's what people see in search result listings. Show people exactly what they are looking for.",score:70,weighted:21,isPartialCheck:false,dataTabId:"step2"},{id:"description-partial",completed:false,improveText:"Include partial matches of your target keyword in the description.",improveDetail:"Give an overview of your video with natural language using related and similar keywords to your Target Keyword. That means breaking the words up and using them individually in addition to the entire Target Keyword.",score:30,weighted:9,isPartialCheck:true,dataTabId:"step2"},{id:"tags-exact-first",completed:false,improveText:"Include your exact target keyword as the first tag.",improveDetail:"Let YouTube know what you are targeting by putting your Target Keyword as the first tag.",score:50,weighted:5,isPartialCheck:false,dataTabId:"step3"},{id:"tags-partial",completed:false,improveText:"Include partial matches of your target keyword.",improveDetail:"Similar to descriptions, it's important to include different variations (longer or shorter) versions of your Taget Keyword in order to reinforce its importance.",score:40,weighted:4,isPartialCheck:true,dataTabId:"step3"},{id:"tags-multiple-relevant",completed:false,improveText:"Include more relevant tags.",improveDetail:"YouTube gives you up 500 characters for tags. Make sure to use a good amount of those with words and phrases that accurately describe your content and focus on tags related to your Target Keyword.",score:10,weighted:1,isPartialCheck:false,dataTabId:"step3"}];var T=function(){F(1);V();R();if(jQuery(_initButton).attr("id")==="tb-tag-explorer-copy-to-copy-button"||jQuery(_initButton).attr("id")==="tb-tag-explorer-action-dropup-menu"){jQuery("#tb-seo-studio-target-keyword-input").val(l);if(TBGlobal.CanAccessLevel1Tools()){jQuery("#tb-seo-studio-start-optimization").trigger("click")}}else if(o){TBExtension.GetDbValue("tb-suggested-tags-"+o,function(e,t){if(t&&t!=="-1"){l=TBUtilities.GetUrlDecoded(t);jQuery("#tb-seo-studio-target-keyword-input").val(l)}})}};var j=function(){var e=TBGlobal.host+"/ModuleManager/SeoStudio/SeoStudio?v="+TBGlobal.versionNumber;if(loadLocalHTML&&(TBExtension.GetType()=="chrome"||TBExtension.GetType()=="firefox")){e=chrome.extension.getURL("modules/seostudio.html")}else if(loadLocalHTML&&TBExtension.GetType()=="safari"){e="modules/SeoStudio.html"}TBExtension.Get(e,"CRTBLoadSeoStudioTemplate")};var Q=function(){jQuery(document).on("click","#tb-seo-studio-start-optimization",function(){var e=jQuery("#tb-seo-studio-target-keyword-input").val();d=null;if(!TBGlobal.CanAccessLevel1Tools()){TBGlobal.ShowUpgradePage("use SEO Studio",TBGlobal.limitation.seostudio);C()}else{if(!e||e.length===0){var t=o?"Please enter a Target Keyword or click on a suggestion or saved optimization.":"Please enter a Target Keyword or click on a saved optimization.";TBUtilities.Alert(t,null)}else{l=e;jQuery(".tb-seo-studio-tags-container .tb-seo-studio-tag--added").remove();if(le()){if(!a){var i=TubeBuddyUploadStudio.GetVideoMetadata();a=i.videoTitle;s=i.videoDescription;n=i.videoTags}w(a,s,n)}else if(!ne()){w(e,e,[e])}else{ue().then(function(){w(a,s,n)})}jQuery("#tb-seo-studio-thumbnail-search-input").val(e);H();F(2)}}});jQuery(document).on("click",".tb-seo-studio-step-1-option",function(e){var t=jQuery(this).attr("data-start-option");jQuery(".tb-seo-studio-step1-option-detail").hide();jQuery("#tb-seo-studio-serch-results-screenshot").hide();jQuery("#tb-seo-studio-step1-"+t).show()});jQuery(document).on("click","#tb-seo-studio-launch-keyword-explorer",function(){var e=jQuery(this);C();if(t){TubeBuddyTagExplorer.ShowTagExplorer(null,e,null,t)}else{TubeBuddyTagExplorer.ShowTagExplorer(null,e,null)}});jQuery(document).on("keydown","#tb-seo-studio-target-keyword-input",function(e){if(e.keyCode==13)jQuery("#tb-seo-studio-start-optimization").click()});jQuery(document).on("keypress keydown keyup","#tb-seo-studio-optimized-title",function(e){if(e.keyCode==13){return false}});jQuery(document).on("click","#tb-seo-studio-kt-explain",function(e){TBUtilities.Alert('A "Target Keyword" is generally a 3-6 word phrase that is the core search term you want your video to rank for in YouTube search results.<br><br>As an example, your entire video title might be "How to find your niche on YouTube in 2020 (Must watch!)" but the Target Keyword within that, is "find your niche on YouTube".')});jQuery(document).on("click",".tb-seo-studio-saved-optimization",function(){if(!TBGlobal.CanAccessLevel1Tools()){TBGlobal.ShowUpgradePage("use SEO Studio",TBGlobal.limitation.seostudio);C()}else{l=jQuery(this).attr("data-kw");d=jQuery(this).attr("data-id");var e=p.filter(function(e){return e.Id==d});var t=e[0].Tags&&e[0].Tags.length>0?e[0].Tags.split(","):[];w(e[0].Title,e[0].Description,t);r=e[0].ThumbnailUrl;if(e[0].ThumbnailUrl){g=true;jQuery("#tb-SeoStudio-video-thumbnail").attr("src",e[0].ThumbnailUrl);jQuery(".tb-seo-studio-search-preview--this-video img").attr("src",e[0].ThumbnailUrl)}F(2)}});jQuery(document).on("click",".tb-seo-studio-suggested-keyword",function(){if(!TBGlobal.CanAccessLevel1Tools()){TBGlobal.ShowUpgradePage("use SEO Studio",TBGlobal.limitation.seostudio);C()}else{jQuery("#tb-seo-studio-target-keyword-input").val(jQuery(this).text().trim());jQuery("#tb-seo-studio-start-optimization").trigger("click")}});jQuery(document).on("click",".tb-seo-studio-saved-optimization-tab-header",function(){var e=jQuery(this).attr("data-tab-id");jQuery("#tb-seo-studio-optimization-saved-message").hide();jQuery(".tb-seo-studio-saved-optimization-tab-header").removeClass("tb-seo-studio-tab-header--active");jQuery(".tb-seo-studio-saved-optimization-tab-content").hide();jQuery(this).addClass("tb-seo-studio-tab-header--active");jQuery("#tb-seo-studio-saved-optimizations-list--"+e).show()});jQuery(document).on("click",".tb-seo-studio-close",function(){C()});jQuery(document).on("change","#tb-seo-studio-upload-default-select",function(){var e=jQuery(this).val();if(e!=0)jQuery("#tb-seo-studio-apply-upload-defaults").show();else jQuery("#tb-seo-studio-apply-upload-defaults").hide()});jQuery(document).on("click","#tb-seo-studio-apply-upload-defaults",function(){var e=jQuery("#tb-seo-studio-upload-default-select").val();var t=c.filter(t=>t.Id===e)[0];var i=jQuery("#tb-seo-studio-optimized-title").val()+" "+t.Title;var o=jQuery("#tb-seo-studio-optimized-description").val()+" "+t.Description;var a=[];if(t.Tags.indexOf('"')>=0){var s=/[^\s"]+|"([^"]*)"/gi;do{var n=s.exec(t.Tags);if(n!=null){a.push(n[1]?n[1]:n[0])}}while(n!=null)}else{a=t.Tags.split(",")}w(i,o,a)});jQuery(document).on("click",".tb-seo-studio-metadata-tab",function(){var e=parseInt(jQuery(this).attr("data-step-id"));F(e)});jQuery(document).on("click",".tb-seo-studio-next",function(){var e=jQuery(".tb-seo-studio-metadata-tab.tb-seo-studio-tab-header--active").attr("data-step-id");F(parseInt(e)+1)});jQuery(document).on("click","#tb-seo-studio-back",function(){var e=jQuery(".tb-seo-studio-metadata-tab.tb-seo-studio-tab-header--active").attr("data-step-id");if(parseInt(e)===2){k()}else{F(parseInt(e)-1)}});jQuery(document).on("change keypress keyup paste keydown blur","#tb-seo-studio-optimized-title",function(e){var t=100;var i=jQuery(this).val();jQuery("#tb-seo-studio-optimized-title-char-count").text(i.length+"/"+t);if(i.length>t){jQuery(this).closest(".tb-seo-studio-textarea-outer").addClass("tb-seo-studio-textarea-outer--error");jQuery("#tb-seo-studio-optimized-title-char-count").addClass("tb-seo-studio-char-count--error");jQuery("#tb-seo-studio-title-error-text").text("Your title is too long");jQuery("#tb-seo-studio-title-error").show()}else{jQuery(this).closest(".tb-seo-studio-textarea-outer").removeClass("tb-seo-studio-textarea-outer--error");jQuery("#tb-seo-studio-optimized-title-char-count").removeClass("tb-seo-studio-char-count--error");jQuery("#tb-seo-studio-title-error").hide()}we();O(i);jQuery("#tb-SeoStudio-video-link").text(i)});jQuery(document).on("change keypress keyup paste keydown blur input","#tb-seo-studio-optimized-description",function(e){var t=5e3;var i=jQuery(this).val();jQuery("#tb-seo-studio-optimized-description-char-count").text(i.length+"/"+t);if(i.length>t){jQuery(this).closest(".tb-seo-studio-textarea-outer").addClass("tb-seo-studio-textarea-outer--error");jQuery("#tb-seo-studio-optimized-description-char-count").addClass("tb-seo-studio-char-count--error");jQuery("#tb-seo-studio-description-error-text").text("Your description is too long");jQuery("#tb-seo-studio-description-error").show()}else{jQuery(this).closest(".tb-seo-studio-textarea-outer").removeClass("tb-seo-studio-textarea-outer--error");jQuery("#tb-seo-studio-optimized-description-char-count").removeClass("tb-seo-studio-char-count--error");jQuery("#tb-seo-studio-description-error").hide()}ke();D(i)});jQuery(document).on("focus focusin","#tb-seo-studio-optimized-description, #tb-seo-studio-optimized-title",function(){jQuery(this).closest(".tb-seo-studio-textarea-outer").addClass("tb-seo-studio-textarea-outer--active")});jQuery(document).on("blur focusout","#tb-seo-studio-optimized-title",function(){jQuery("#tb-seo-studio-title-container").removeClass("tb-seo-studio-textarea-outer--active");we()});jQuery(document).on("blur focusout","#tb-seo-studio-optimized-description",function(){jQuery("#tb-seo-studio-description-container").removeClass("tb-seo-studio-textarea-outer--active");ke()});jQuery(document).on("click",".tb-seo-studio-textarea-container",function(){jQuery(this).find("textarea").trigger("focus")});jQuery(document).on("click","#tb-seo-studio-tags-input-container",function(e){e.stopPropagation();oe();jQuery(this).find("#tb-seo-studio-optimized-tags-input").trigger("focus");jQuery(this).addClass("tb-seo-studio-tags-container--active")});jQuery(document).on("click","#tb-seo-studio-step3-container",function(){jQuery(".tb-seo-studio-tags-container").removeClass("tb-seo-studio-tags-container--active")});jQuery(document).on("keypress keydown","#tb-seo-studio-optimized-tags-input",function(e){if((e.keyCode==13||e.keyCode==9||e.keyCode==44)&&jQuery(this).val().length>0){e.preventDefault();var t=jQuery(this).val().split(",");t.forEach(function(e){N(e)});H();jQuery(this).trigger("focus")}});jQuery(document).on("keyup","#tb-seo-studio-optimized-tags-input",function(){se()});jQuery(document).on("click",".tb-seo-studio-tag-remove",function(){jQuery(this).parent().remove();se();Be();if(jQuery(this).parent(".tb-seo-studio-tag").attr("data-is-suggested")==="true"){var e=jQuery(this).siblings(".tb-seo-studio-tag-text").text().trim();jQuery(".tb-seo-studio-tag--suggested").each(function(){if(jQuery(this).find(".tb-seo-studio-tag-text").text().trim()==e)jQuery(this).find(".material-icons").text("add")})}});jQuery(document).on("click",".tb-seo-studio-tag-add-suggested",function(){var e=jQuery(this).siblings(".tb-seo-studio-tag-text").text().trim();if(ie(e)){TBUtilities.Alert('"'+e+'"'+" has already been added.",null);return}else{N(e,true);jQuery(this).find(".material-icons").text("check");se();H()}});jQuery(document).on("click","#tb-seo-studio-add-to-tag-limit",function(){jQuery("#tb-seo-studio-suggested-tags-list .tb-seo-studio-tag--suggested").each(function(){var e=jQuery(this).find(".tb-seo-studio-tag-text").text().trim();var t=e.replace(/\s/,"---").length;if(t>=500-ae()){return}else{if(!ie(e))jQuery(this).find(".tb-seo-studio-tag-add-suggested").trigger("click")}})});jQuery(document).on("click",".tb-seo-studio-tags-container .tb-seo-studio-tag--added",function(e){oe();e.stopPropagation();var t=jQuery(this).find(".tb-seo-studio-tag-edit-input");jQuery(this).addClass("tb-seo-studio-tag--editing");jQuery(this).find(".tb-seo-studio-tag-text").hide();t.css("width",jQuery(this).find(".tb-seo-studio-tag-edit-input").val().length+3+"ch");t.show();t.focus();t[0].setSelectionRange(t.val().length,t.val().length);Be()});jQuery(document).on("keypress keydown",".tb-seo-studio-tag-edit-input",function(e){if(e.keyCode==13||e.keyCode==9||e.keyCode==44){e.preventDefault();oe()}});jQuery(document).on("click","#tb-seo-studio-thumbnail-search-btn",function(){W(jQuery("#tb-seo-studio-thumbnail-search-input").val())});jQuery(document).on("keypress keydown","#tb-seo-studio-thumbnail-search-input",function(e){if(e.keyCode==13)W(jQuery(this).val())});jQuery(document).on("click",".tb-seo-studio-suggested-tags-sortby",function(){var e=jQuery(this).attr("data-sort-type");te(e)});jQuery(document).on("click",".tb-seo-studio-save-draft",function(){B()});jQuery(document).on("click",".tb-seo-studio-message-close",function(){jQuery(this).closest(".tb-seo-studio-message").fadeOut("slow")});jQuery(document).on("click",".tb-seo-studio-saved-optimization-delete",function(e){d=jQuery(this).closest(".tb-seo-studio-saved-optimization").attr("data-id");var t=jQuery(this).closest(".tb-seo-studio-saved-optimization").attr("data-kw");var i="Are you sure you want to delete the saved optimization for "+t+"?";e.stopPropagation();TBUtilities.Confirm(i,U,null)});jQuery(document).on("click",".tb-seo-studio-launch-thumbnail-generator",function(){if(jQuery(this).hasClass("tb-btn-disabled"))return;var e=jQuery("#tb-seo-studio-optimized-title").val();var t=jQuery("#tb-seo-studio-optimized-description").val();var i=r?r:TBGlobal.host+"/images/modules/seostudio/seostudio-thumbnail-placeholder.png";jQuery("#tb-SeoStudio-container").hide();if(!o&&le()){o=TubeBuddyUploadStudio.GetVideoId()}TubeBuddyThumbnailCreator.ShowForSeoStudio(o,e,i,t,null,function(e,t){if(e===true){jQuery("#tb-SeoStudio-container").show()}if(t){y=t;g=true;jQuery(".tb-seo-studio-search-preview--this-video img").attr("src",t);L(true,null)}})});jQuery(document).on("click",".tb-seo-studio-apply-to-video",function(){var e=jQuery("#tb-seo-studio-optimized-title").val();var t=jQuery("#tb-seo-studio-optimized-description").val();var a=g?d:null;var s=[];jQuery(".tb-seo-studio-tags-container .tb-seo-studio-tag-text--added").each(function(){s.push(jQuery(this).text())});TBExtension.GetDbValue("tb-seo-studio-apply-save-reminder-"+TBGlobal.CurrentChannelId(),function(e,t){if(!t){TBUtilities.Alert("Populating Title, Description and Tags with optimized metadata. Be sure to click Save to keep changes.",null);TBExtension.SetDbValue("tb-seo-studio-apply-save-reminder-"+TBGlobal.CurrentChannelId(),true)}});if(!o&&le()){o=TubeBuddyUploadStudio.GetVideoId()}L(true,o).then(function(n){if(le()){TubeBuddyUploadStudio.ApplyOptimization(e,t,s,o,a);C()}else if(i){C();i(e,t,s,o,a)}else{var r='<span class="tb-spinner"></span>'+'<span style="margin-left:10px; font-size: 130%">Populating Title, Description and Tags with optimized metadata...<span class="tb-seo-studio-applying-status-detail"></span></span>';jQuery("#tb-SeoStudio-container").block({message:r,css:{padding:"30px 20px",border:"2px solid #77889"},overlayCSS:{backgroundColor:"#fff",opacity:.8,cursor:"unavailable"}});var l=setTimeout(function(){jQuery(".tb-seo-studio-applying-status-detail").after('<a class="tb-seo-studio-apply-cancel tb-margin-left5">cancel</a>');clearTimeout(l)},6e4);if(ne()){if(window.location.href.indexOf("studio.youtube")>-1){var u=jQuery(".title #textbox").length>0;var d=u?jQuery(".title #textbox")[0]:jQuery(".title").find("textarea")[0];var c=u?jQuery(".description #textbox")[0]:jQuery(".description").find("textarea")[0];jQuery(".tb-seo-studio-applying-status-detail").text("Updating title");jQuery(d).text(e);d.focus();var p=document.createEvent("HTMLEvents");p.initEvent("input",true,true);d.dispatchEvent(p);jQuery(".tb-seo-studio-applying-status-detail").text("Updating description");jQuery(c).text(t);c.focus();var p=document.createEvent("HTMLEvents");p.initEvent("input",true,true);c.dispatchEvent(p);jQuery('#clear-button[aria-label="Delete all"]').click();TubeBuddyEditVideoStudio.AddTags(s);TubeBuddyEditVideoStudio.ApplyOptimizedThumbnail(a);var b=setInterval(function(){if(jQuery("ytcp-chip.chip").length==s.length){clearInterval(b);jQuery(".tb-seo-studio-applying-status-detail").text("");jQuery("#tb-SeoStudio-container").unblock();F(6)}else{jQuery(".tb-seo-studio-applying-status-detail").text("Adding tag "+jQuery("ytcp-chip.chip").length+" of "+s.length+" total")}},500)}else{var d=jQuery(".video-settings-title");var c=jQuery(".video-settings-description");jQuery(".tb-seo-studio-applying-status-detail").text("Updating title");d.val(e);d.trigger("keyup");jQuery(".tb-seo-studio-applying-status-detail").text("Updating description");c.val(t);c.trigger("keyup");jQuery(".video-settings-tag-chips-container .yt-chip .yt-delete-chip").trigger("click");TubeBuddyEditVideo.AddTags(s);TubeBuddyEditVideo.ApplyOptimizedThumbnail(a);var b=setInterval(function(){if(jQuery("span.yt-chip").length==s.length){clearInterval(b);jQuery(".tb-seo-studio-applying-status-detail").text("");jQuery("#tb-SeoStudio-container").unblock();F(6)}else{jQuery(".tb-seo-studio-applying-status-detail").text("Adding tag "+jQuery("span.yt-chip").length+" of "+s.length+" total")}},500)}}}A()}).catch(function(e){TBUtilities.LogError(e)})});jQuery(document).on("click",".tb-seo-studio-apply-cancel",function(){jQuery.unblockUI();jQuery("#tb-SeoStudio-container").unblock()});jQuery(document).on("change","#tb-seo-studio-upload-thumbnail-input",function(e){if(jQuery(this)[0].files[0]){var t=jQuery(this)[0].files[0].size;y=null;if(t>10485760){jQuery(this).wrap("<form>").closest("form").get(0).reset();jQuery(this).unwrap();TBUtilities.Alert("Sorry, you need to select a file less than 10MB")}var i=new FileReader;i.readAsDataURL(e.target.files[0]);i.onloadend=function(e){var t=e.target.result;jQuery(".tb-seo-studio-search-preview--this-video img").attr("src",t);y=t;g=true;L(true,null)}}});jQuery(document).on("click","#tb-seo-studio-add-kw-first-tag",function(e){jQuery(".tb-seo-studio-tags-container .tb-seo-studio-tag-text--added").each(function(){if(ce(jQuery(this).text().trim())===ce(l)){jQuery(this).siblings(".tb-seo-studio-tag-remove").trigger("click")}});N(l,false,true)});jQuery(document).on("click","#tb-seo-studio-change-kw",function(){k()})};var w=function(e,t,i){jQuery("#tb-seo-studio-optimized-title").val(e).trigger("paste");jQuery("#tb-seo-studio-optimized-description").val(t).trigger("paste");O(e);D(t);M();if(i&&i.length>0){i.forEach(function(e){N(e,false)})}};var k=function(){TBUtilities.Confirm("Would you like to save changes to this optimization before you go?",B,function(){F(1)}).set({labels:{ok:"Yes",cancel:"No"}})};var B=function(){L(true,null);F(1);jQuery('.tb-seo-studio-step-1-option[data-start-option="saved"]').trigger("click");jQuery('.tb-seo-studio-saved-optimization-tab-header[data-tab-id="drafts"]').trigger("click");jQuery("#tb-seo-studio-optimization-saved-message").fadeIn("slow");setTimeout(function(){jQuery("#tb-seo-studio-optimization-saved-message").fadeOut("slow")},1e4)};var C=function(){F(1);TubeBuddyMenu.HideBackground();jQuery("#tb-SeoStudio-container").hide()};var x=function(e){return new Promise(function(t,i){var o=TBGlobal.host+TBGlobal.apiUrls.seoScoreAddScore;TBExtension.Post(o,JSON.stringify(e),function(e,o,a){try{if(e){t(JSON.parse(a))}else{i()}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddySEOStudio] saveOptimization"});i()}},null,{contentType:"application/json",dataType:"text"})})};var S=function(e){return new Promise(function(t,i){var o=TBGlobal.host+TBGlobal.apiUrls.seoScoreUpdateScore;TBExtension.Post(o,JSON.stringify(e),function(e,o,a){try{if(e){t()}else{i()}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddySEOStudio] saveOptimization"});i()}},null,{contentType:"application/json",dataType:"text"})})};var L=function(e,t){var i=jQuery("#tb-seo-studio-optimized-title").val();var o=jQuery("#tb-seo-studio-optimized-description").val();var a=[];var s=jQuery(".tb-seo-studio-tags-container .tb-seo-studio-tag-text--added");var n=null;jQuery.each(s,function(){a.push(jQuery(this).text().trim())});if(s.length>0&&a.length>0){n=a.join(",")}if(i.length>100){TBUtilities.Alert("Title cannot exceed 100 characters");return}else if(o.length>5e3){TBUtilities.Alert("Description cannot exceed 5000 characters");return}var r={Keyword:l,Score:u,Title:i,Description:o,Tags:n,IsActive:e,VideoId:t,ThumbnailDataUrl:y};return new Promise(function(e){if(!d){x(r).then(function(t){d=t;E();I();e(t)})}else{r.Id=d;S(r).then(function(){E();I();e(d)})}})};var _=function(e,t){var i={Id:e.Id,Keyword:e.Keyword,Title:e.Title,Description:e.Description,Tags:e.Tags,IsActive:true,VideoId:t};S(i).then(function(){E();A()})};var I=function(){if(jQuery('.tb-seo-studio-metadata-tab[data-step-id="2"]').hasClass("tb-seo-studio-tab-header--active")){jQuery("#tb-seo-studio-show-saved").hide();jQuery("#tb-seo-studio-saved-optimizations-loading").show()}var e=TBGlobal.host+TBGlobal.apiUrls.seoScoreGetScores;TBExtension.Get(e,function(e,t,i){if(e){p=JSON.parse(i);b=p.filter(function(e){return e.VideoId===null});h=p.filter(function(e){return e.VideoId!==null});jQuery("#tb-seo-studio-saved-optimizations-loading").hide();if(p.length>0){jQuery("#tb-seo-studio-show-saved").show()}else{jQuery("#tb-seo-studio-show-saved").hide()}jQuery(".tb-seo-studio-saved-optimization-tab-content").empty();jQuery("#tb-seo-studio-saved-optimizations--loading").hide();if(b.length>0){jQuery.each(b,function(){var e=jQuery("#tb-seo-studio-saved-optimization-draft-template").html();var t=e.formatTemplate(this.Keyword,this.Id);jQuery("#tb-seo-studio-saved-optimizations-list--drafts").append(t);jQuery("#tb-seo-studio-manage-saved").show()})}else{jQuery("#tb-seo-studio-saved-optimizations-list--drafts").append('<span class="tb-move-down5">You don\'t currently have any saved drafts.</span>');jQuery("#tb-seo-studio-manage-saved").hide()}if(h.length>0){jQuery.each(h,function(){var e=jQuery("#tb-seo-studio-saved-optimization-applied-template").html();var t=e.formatTemplate(this.Keyword,this.Id,moment(this.DateModified).format("M/D/YY"));jQuery("#tb-seo-studio-saved-optimizations-list--applied").append(t)})}else{jQuery("#tb-seo-studio-saved-optimizations-list--applied").append('<span class="tb-move-down5">You haven\'t applied any optimizations yet.</span>')}}},null,{contentType:"application/json",dataType:"text"})};var U=function(e){if(!e.cancel){jQuery('.tb-seo-studio-saved-optimization[data-id="'+d+'"]').fadeOut("slow");var t=TBGlobal.host+TBGlobal.apiUrls.seoScoreDeleteScore;TBExtension.Post(t,JSON.stringify({Id:d}),function(e,t,i){d=null},null,{contentType:"application/json",dataType:"text"})}};var E=function(){try{TBUtilities.AddAction({},TBUtilities.ActionTypes.SEOStudio_Save,"seostudio")}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddySeoStudio] addSaveChannelAction"})}};var A=function(){try{TBUtilities.AddAction({},TBUtilities.ActionTypes.SEOStudio_ApplyToVideo,"seostudio")}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddySEOStudio] applyToVideo"})}};var G=function(){TubeBuddyYouTubeActions.GetYouTubeAutoComplete(Y(),a,function(e){jQuery("#tb-seo-studio-suggested-kw-list").empty();if(e&&e.length>0){jQuery.each(e,function(){jQuery("#tb-seo-studio-suggested-kw-list").append('<div class="tb-seo-studio-suggested-keyword tb-margin-top5 tb-margin-bottom5 tb-seo-studio-flex tb-seo-studio-flex-align-center tb-font-size14 tb-cursor-pointer">'+this+"</div>");jQuery("#tb-seo-studio-step1-suggestions").show()})}else{jQuery("#tb-seo-studio-suggested-kw-list").append('<div class="tb-font-color-gray">Sorry, no suggestions found for video title: '+a+"</div>");jQuery("#tb-seo-studio-step1-suggestions").hide()}})};var R=function(){var e=TBGlobal.host+TBGlobal.apiUrls.uploadDefaultsList;TBExtension.Get(e,function(e,t,i){try{TBUtilities.Log("TubeBuddyUploadDefaults - get list");c=[];if(e){var t=JSON.parse(i);TBUtilities.Log(t);if(t.length>0){t.forEach(function(e){c.push(e)});jQuery("#tb-seo-studio-upload-default-select option").remove();jQuery("#tb-seo-studio-upload-default-select").append('<option value="0">Apply Upload Default...</option>');jQuery.each(c,function(e,t){jQuery("#tb-seo-studio-upload-default-select").append(jQuery("<option></option>").attr("value",t.Id).text(t.Name))});jQuery("#tb-seo-studio-apply-defaults-container").show()}else{jQuery("#tb-seo-studio-apply-defaults-container").hide()}}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddySEOStudio] getUploadDefaults"})}},null,{contentType:"application/json",dataType:"text"})};var P=function(e,t,i){try{if(!i){i="tb-highlight"}var o={className:i,accuracy:{value:"exactly",limiters:[",",".","?","!","@","#","$","%","^","&","*","(",")","_","-",";",":",'"',"'","/","<",">"]},separateWordSearch:false};var a=jQuery(t);a.mark(e,o);t=a[0].outerHTML}catch(e){TBUtilities.LogError(e)}return t};var O=function(e){jQuery("#tb-seo-studio-title-highlights").text(e);var t=jQuery("#tb-seo-studio-title-backdrop").html();t=P(l,t,"tb-seo-studio-kw-exact-match");l.split(" ").forEach(function(e){t=P(e,t,"tb-seo-studio-kw-partial-match")});jQuery("#tb-seo-studio-title-backdrop").html(t)};var D=function(e){jQuery("#tb-seo-studio-description-highlights").text(e);var t=jQuery("#tb-seo-studio-description-backdrop").html();t=P(l,t,"tb-seo-studio-kw-exact-match");l.split(" ").forEach(function(e){t=P(e,t,"tb-seo-studio-kw-partial-match")});jQuery("#tb-seo-studio-description-backdrop").html(t)};var M=function(){if(jQuery("#tb-seo-studio-optimized-tags-input").parent().hasClass("highlightTextarea")){jQuery("#tb-seo-studio-optimized-tags-input").highlightTextarea("destroy")}var e=ce(l).split(" ");var t={words:[{color:"yellow",words:[ce(l)]},{color:e.length>1?"#ffffcc":"yellow",words:e}],resizable:false,caseSensitive:false};jQuery("#tb-seo-studio-optimized-tags-input").highlightTextarea(t)};var N=function(e,t,i){var o=jQuery("#tb-seo-studio-optimized-tags-input");var a=jQuery("#tb-seo-studio-tag-template").html();var s=a.formatTemplate(e,t);var n=l.toLowerCase().split(" ");for(var r=0;r<n.length;r++){s=P(n[r],s,"tb-seo-studio-kw-partial-match")}if(i&&jQuery(".tb-seo-studio-tags-container .tb-seo-studio-tag--added").length>0){jQuery(".tb-seo-studio-tags-container .tb-seo-studio-tag--added:first").before(s)}else{o.parent(".highlightTextarea").before(s)}o.val("");o.parent(".highlightTextarea").find("mark").remove();Be();se();H();var u=document.getElementById("tb-seo-studio-tags-list");var d=Sortable.create(u,{onSort:Be})};var V=function(){if(f)f.destroy();f=new JustGage({id:"tb-seo-studio-score-chart",title:"TubeBuddy SEO Score",min:0,max:100,gaugeWidthScale:1,value:u,symbol:"%",valueFontFamily:"inherit",valueFontColor:"#666",customSectors:{ranges:[{color:m[0],lo:0,hi:50},{color:m[1],lo:51,hi:70},{color:m[2],lo:71,hi:100}]},donut:true,counter:true,startAnimationTime:1e3,refreshAnimationTime:1e3,label:" "})};var z=function(e){f.refresh(e)};var F=function(e){jQuery("#tb-seo-studio-tabs-container").css("height",jQuery(window).height()<=768?"550px":"590px");jQuery(".tb-seo-studio-tab-content").hide();jQuery(".tb-seo-studio-metadata-tab").removeClass("tb-seo-studio-tab-header--active");jQuery("#tb-seo-studio-next").show();jQuery("#tb-seo-studio-step1-suggestions").hide();jQuery("#tb-seo-studio-step6-container").hide();jQuery(".tb-seo-studio-confirmation-section").hide();jQuery("#tb-seo-studio-optimization-saved-message").hide();if(location.href.indexOf("studio.youtube")<0){jQuery("#tb-seo-studio-metadata-tab-content-container").css("top","90px");jQuery(".tb-seo-studio-improve-panel").css("margin-top","247px")}else{jQuery("#tb-seo-studio-metadata-tab-content-container").css("top","100px");jQuery(".tb-seo-studio-improve-panel").css("margin-top","237px")}switch(e){case 1:u=0;v.forEach(function(e){e.completed=false});r=null;y=null;d=null;g=false;I();$();jQuery("#tb-seo-studio-target-keyword-input").val("");jQuery("#tb-seo-studio-optimized-title").val("");jQuery("#tb-seo-studio-optimized-description").val("");jQuery("#tb-seo-studio-optimized-tags-input").val("");jQuery(".tb-seo-studio-tags-container .tb-seo-studio-tag--added").remove();jQuery(".tb-seo-studio-step1-option-detail").hide();jQuery("#tb-seo-studio-save-footer").hide();jQuery("#tb-seo-studio-tabs-container").hide();jQuery("#tb-seo-studio-footer").hide();jQuery(".tb-seo-studio-section-done").hide();jQuery("#tb-seo-studio-step5-container").hide();jQuery(".tb-seo-studio-improve-items-done").hide();jQuery("#tb-seo-studio-step1").show();jQuery("#tb-seo-studio-keyword-score-container").show();jQuery("#tb-seo-studio-serch-results-screenshot").show();jQuery("#tb-seo-studio-apply-upload-defaults").hide();jQuery("#tb-seo-studio-upload-default-select").val(0);if(ne()&&!re()&&!le()){ue().then(xe());G()}else{jQuery("#tb-SeoStudio-video-thumbnail").attr("src",TBGlobal.host+"/images/modules/seostudio/seostudio-thumbnail-placeholder.png");jQuery("#tb-SeoStudio-video-link").text("New Optimization")}if(a!=null&&le()){jQuery("#tb-SeoStudio-video-link").text(a);G()}if(p.length===0)jQuery("#tb-seo-studio-saved-optimizations--loading").show();break;case 2:jQuery("#tb-seo-studio-step1").hide();jQuery("#tb-seo-studio-target-keyword").text(l);jQuery("#tb-seo-studio-tabs-container").show();jQuery("#tb-seo-studio-save-footer").show();jQuery("#tb-seo-studio-footer").show();jQuery("#tb-seo-studio-thumbnail-search-input").val(l);jQuery("#tb-seo-studio-step2-container").show();jQuery("#tb-seo-studio-save-footer").show();jQuery("#tb-seo-studio-keyword-score-container").show();if(l.length>30){jQuery("#tb-seo-studio-target-keyword").removeClass("tb-font-size16");jQuery("#tb-seo-studio-target-keyword").addClass("tb-font-size13")}else{jQuery("#tb-seo-studio-target-keyword").removeClass("tb-font-size13");jQuery("#tb-seo-studio-target-keyword").addClass("tb-font-size16")}if(c&&c.length>0)jQuery("#tb-seo-studio-apply-defaults-container").show();jQuery('.tb-seo-studio-metadata-tab[data-step-id="2"]').addClass("tb-seo-studio-tab-header--active");q();if(be(l)==1){var t=v.filter(function(e){return e.isPartialCheck==true});t.forEach(function(e){jQuery("#tb-seo-studio-"+e.id).hide()})}if(!ne()&&!re()&&!le())jQuery("#tb-seo-studio-non-video-context-side-warning").show();break;case 3:jQuery("#tb-seo-studio-step3-container").show();jQuery("#tb-seo-studio-title-desc-done").show();jQuery("#tb-seo-studio-save-footer").show();jQuery("#tb-seo-studio-keyword-score-container").show();if(c&&c.length>0)jQuery("#tb-seo-studio-apply-defaults-container").show();jQuery('.tb-seo-studio-metadata-tab[data-step-id="3"]').addClass("tb-seo-studio-tab-header--active");break;case 4:jQuery("#tb-seo-studio-keyword-score-container").show();jQuery("#tb-seo-studio-step4-container").show();jQuery("#tb-seo-studio-save-footer").show();W(l);jQuery("#tb-seo-studio-title-desc-done").show();jQuery("#tb-seo-studio-tags-done").show();jQuery("#tb-seo-studio-apply-defaults-container").hide();jQuery('.tb-seo-studio-metadata-tab[data-step-id="4"]').addClass("tb-seo-studio-tab-header--active");if(ne()||re()){jQuery(".tb-seo-studio-launch-thumbnail-generator").removeClass("tb-btn-disabled");jQuery(".tb-seo-studio-launch-thumbnail-generator").qtip("destroy",true)}else if(le()){jQuery(".tb-seo-studio-launch-thumbnail-generator").addClass("tb-btn-disabled");jQuery(".tb-seo-studio-launch-thumbnail-generator").qtip({content:{text:"Thumbnail Generator is disabled until video is 100% processed."},style:{classes:"qtip-youtube-tubebuddy",tip:false},position:{at:"bottom left"}});var i=setInterval(function(){if(jQuery("#still-0[processing]").length===0){clearInterval(i);jQuery(".tb-seo-studio-launch-thumbnail-generator").removeClass("tb-btn-disabled");jQuery(".tb-seo-studio-launch-thumbnail-generator").qtip("destroy",true)}},100)}else{jQuery(".tb-seo-studio-launch-thumbnail-generator").addClass("tb-btn-disabled");jQuery(".tb-seo-studio-launch-thumbnail-generator").qtip({content:{text:"Thumbnail Generator is only available when you're editing a video."},style:{classes:"qtip-youtube-tubebuddy",tip:false},position:{at:"bottom left"}})}break;case 5:if(g&&(ne()||re()||le())){if(le()){jQuery(".tb-seo-studio-thumbnail-notice").text("NOTE: Your custom thumbnail will also be applied.")}else{jQuery(".tb-seo-studio-thumbnail-notice").text("NOTE: Your custom thumbnail will also be applied when you save changes on YouTube's site.")}jQuery(".tb-seo-studio-thumbnail-notice").show()}else{jQuery(".tb-seo-studio-thumbnail-notice").hide()}jQuery("#tb-seo-studio-save-footer").hide();jQuery("#tb-seo-studio-next").hide();jQuery("#tb-seo-studio-apply-defaults-container").hide();jQuery("#tb-seo-studio-keyword-score-container").hide();jQuery('.tb-seo-studio-metadata-tab[data-step-id="5"]').addClass("tb-seo-studio-tab-header--active");jQuery("#tb-seo-studio-tabs-container").css("height","480px");if(ne()&&!le()){if(location.href.indexOf("studio.youtube")===-1)jQuery(".tb-seo-studio-save-changes-text").text("Save changes");jQuery("#tb-seo-studio-confirm-video-edit-context").show()}else if(re()||le()){jQuery("#tb-seo-studio-confirm-video-upload-context").show();jQuery(".tb-seo-studio-save-changes-text").text("Done")}else{jQuery("#tb-seo-studio-confirm-non-video-context").show()}jQuery("#tb-seo-studio-preview-done").show();jQuery("#tb-seo-studio-step5-container").show();break;case 6:jQuery("#tb-seo-studio-footer").hide();jQuery("#tb-seo-studio-options-done").show();jQuery("#tb-seo-studio-tabs-container").css("height","300px");if(re())jQuery(".tb-seo-studio-save-changes-text").text("Done");else if(ne()&&location.href.indexOf("studio.youtube")===-1)jQuery(".tb-seo-studio-save-changes-text").text("Save changes");jQuery("#tb-seo-studio-step6-container").show();break}};var $=function(){jQuery(".tb-seo-studio-score-items-container").empty();var e=jQuery("#tb-seo-studio-improve-list-item-template").html();v.forEach(function(t){var i=e.formatTemplate("tb-seo-studio-"+t.id,t.improveText,t.improveDetail);var o=jQuery("#tb-seo-studio-improve-"+t.dataTabId).find(".tb-seo-studio-score-items-container");o.append(i);if(t.id=="tags-exact-first"){jQuery("#tb-seo-studio-tags-exact-first .tb-seo-studio-improve-text").append('<a class="tb-margin-left5" id="tb-seo-studio-add-kw-first-tag" style="display:none;">add now</a>');if(!t.completed){jQuery("#tb-seo-studio-add-kw-first-tag").show()}}});jQuery('[data-tbtooltip!=""]').qtip({content:{attr:"data-tbtooltip"},style:{classes:"qtip-youtube-tubebuddy",tip:false},position:{at:"bottom left",adjust:{x:-130}}})};var H=function(){jQuery(".tb-seo-studio-tags-container .tb-seo-studio-tag--added").removeClass("tb-seo-studio-tag--target-match");jQuery(".tb-seo-studio-tags-container .tb-seo-studio-tag--added").each(function(){if(jQuery(this).find(".tb-seo-studio-tag-text").text().trim().toLowerCase()==l.toLowerCase()){jQuery(this).addClass("tb-seo-studio-tag--target-match")}})};var Y=function(){var e=jQuery("body")[0].outerHTML;var t=e.indexOf('PSUGGEST_TOKEN":"')+'PSUGGEST_TOKEN":"'.length;var i=e.indexOf('"',t);var o=e.substring(t,i);return o};var W=function(e){jQuery("#tb-seo-studio-thumbnail-results-loading").show();jQuery("#tb-seo-studio-thumbnail-results-container").empty().hide();var t=jQuery("#tb-seo-studio-search-preview-template").html();TubeBuddyYouTubeActions.GetVideoSearchResults(e,function(e){if(e!=null&&e.length>0){jQuery.each(e,function(e,i){var o=t.formatTemplate(i.thumbnail,"https://youtube.com/watch?v="+i.id,i.title,i.channelUrl,i.channelName,i.views,TBUtilities.Truncate(i.description,125,false));o=P(l,o,"tb-seo-studio-kw-exact-match");l.toLowerCase().split(" ").forEach(function(e){o=P(e,o,"tb-seo-studio-kw-partial-match")});jQuery("#tb-seo-studio-thumbnail-results-container:visible").append(o)});jQuery("#tb-seo-studio-thumbnail-results-loading").hide()}});var i=r?r:TBGlobal.host+"/images/modules/seostudio/seostudio-thumbnail-placeholder.png";var a=o?"https://youtube.com/watch?v="+o:null;var s=jQuery("#tb-seo-studio-optimized-title").val();var n="https://www.youtube.com/channel/"+TBGlobal.CurrentChannelId();var u=TBUtilities.Truncate(TBGlobal.Profile().Title,45,false);var d=(o&&!le()?K(o):0)+" views";var c=TBUtilities.Truncate(jQuery("#tb-seo-studio-optimized-description").val(),125,false);var p=t.formatTemplate(i,a,s,n,u,d,c,"tb-seo-studio-search-preview--this-video");p=P(l,p,"tb-seo-studio-kw-exact-match");l.toLowerCase().split(" ").forEach(function(e){p=P(e,p,"tb-seo-studio-kw-partial-match")});jQuery("#tb-seo-studio-thumbnail-results-container").prepend(p);jQuery("#tb-seo-studio-thumbnail-results-container").show()};var K=function(e){var t=JSON.parse(window.localStorage.getItem("tb-videos-list-studio-video-info"+TBGlobal.CurrentChannelId()));var i=t?t.filter(function(t){return t.videoId==e}):null;if(i){return i[0].views}else if(e&&location.href.indexOf("edit")>-1&&location.href.indexOf("studio.youtube"<0)){return jQuery(".video-view-count .video-info-text").text().trim()}else{return 0}};var q=function(){jQuery("#tb-seo-studio-suggested-tags-list-loading").show();jQuery("#tb-seo-studio-suggested-tags-list-none").hide();var e=jQuery("#tb-seo-studio-suggested-tags-list");var t=jQuery("#tb-seo-studio-suggested-tag-template").clone().html();e.empty();TBUtilities.GetKeywordRecommendedTags(l).then(X).then(Z).then(function(i){if(i&&i.length>0){jQuery.each(i,function(o,a){var s;if(a.score>0){var n=ee(a.score);s=t.formatTemplate(a.tag,a.priority,Math.round(a.score),"border-bottom: 2px solid "+n+" !important;")}else{s=t.formatTemplate(a.tag,a.priority,a.score,"display:none;")}var r=l.toLowerCase().split(" ");for(var u=0;u<r.length;u++){s=P(r[u],s,"tb-seo-studio-kw-partial-match")}e.append(s);if(o===i.length-1){jQuery("#tb-seo-studio-suggested-tags-list-loading").hide();jQuery("#tb-seo-studio-suggested-tags-sortby-relevance").trigger("click")}})}else{jQuery("#tb-seo-studio-suggested-tags-list-loading").hide();jQuery("#tb-seo-studio-suggested-tags-list-none").show()}}).catch(J)};var J=function(e){jQuery("#tb-seo-studio-suggested-tags-list-loading").hide();jQuery("#tb-seo-studio-suggested-tags-list-none").show()};var X=function(e){return new Promise(function(t,i){if(e&&e.length>0){var o=jQuery(".tb-seo-studio-tags-container .tb-seo-studio-tag-text--added");var a=[];jQuery.each(o,function(){a.push(jQuery(this).text().trim().toLowerCase())});var s=e.filter(function(e,t){return a.indexOf(e.tag.toLowerCase())==-1});t(s)}else{i("no tags found")}})};var Z=function(e){return new Promise(function(t,i){if(e&&e.length>0){var o=e.filter(function(e){return e.tag.toLowerCase()!==l.toLowerCase()});var a=o.map(function(e){return e.tag});var s=a.filter(function(e,t){return e.indexOf(e)>=t});var n=TBGlobal.host+TBGlobal.apiUrls.tagScoreGetStored;var r=TBGlobal.GetPrefCookieObject();var u={Region:"us",Tags:s,Language:"en"};if(r&&r.gl)u.Region=r.gl;if(r&&r.hl)u.Language=r.hl;TBExtension.Post(n,JSON.stringify(u),function(e,i,a){if(e===true){var s=JSON.parse(a);jQuery.each(o,function(e,t){if(s.map(function(e){return e.Tag}).indexOf(t.tag)>-1)t.score=s[s.map(function(e){return e.Tag}).indexOf(t.tag)].Score;else t.score=0});t(o)}},null,{contentType:"application/json",dataType:"text"})}else i("no tags found")})};var ee=function(e){var t=TubeBuddyTagExplorer.GetScoreColors();var i="";if(e<=20){i=t[0]}else if(e>20&&e<40){i=t[1]}else if(e>=40&&e<60){i=t[2]}else if(e>=60&&e<80){i=t[3]}else if(e>=80){i=t[4]}return i};var te=function(e){var t="data-"+e;var i=jQuery("#tb-seo-studio-suggested-tags-list .tb-seo-studio-tag--suggested");jQuery("#tb-seo-studio-suggested-tags-list").empty();jQuery(".tb-seo-studio-sort-tags").removeClass("tb-seo-studio-sort-tags--active");jQuery('.tb-seo-studio-sort-tags[data-sort-type="'+e+'"]').addClass("tb-seo-studio-sort-tags--active");var o=i.sort(function(i,o){if(e==="score")return jQuery(o).attr(t)-jQuery(i).attr(t);else return jQuery(i).attr(t)-jQuery(o).attr(t)});jQuery.each(o,function(e,t){jQuery("#tb-seo-studio-suggested-tags-list").append(t)})};var ie=function(e){var t=[];jQuery(".tb-seo-studio-tags-container .tb-seo-studio-tag--added").each(function(){t.push(jQuery(this).find(".tb-seo-studio-tag-text").text().trim())});return t.indexOf(e)>-1};var oe=function(){if(jQuery(".tb-seo-studio-tag--editing").length>0){var e=jQuery("#tb-seo-studio-tag-template").html();var t=jQuery(".tb-seo-studio-tag--editing").find("input").val();var i=e.formatTemplate(t,false);var o=l.toLowerCase().split(" ");for(var a=0;a<o.length;a++){i=P(o[a],i,"tb-seo-studio-kw-partial-match")}jQuery(".tb-seo-studio-tag--editing").replaceWith(i);jQuery(".tb-seo-studio-tag--editing").find("input").hide();jQuery(".tb-seo-studio-tag--editing").find("span").show();jQuery(".tb-seo-studio-tag--editing").removeClass("tb-seo-studio-tag--editing")}jQuery("#tb-seo-studio-optimized-tags-input").focus();H();Be()};var ae=function(){var e=0;e+=jQuery("#tb-seo-studio-optimized-tags-input").val().replace(/\s/,"---").length;jQuery(".tb-seo-studio-tags-container .tb-seo-studio-tag-text--added").each(function(){var t=jQuery(this).text().trim().replace(/\s/,"---");e+=t.length;e+=1});if(e>0)e--;return e};var se=function(){jQuery("#tb-seo-studio-optimized-tags-char-count").text(ae()+"/500");if(ae()>500){jQuery("#tb-seo-studio-tags-input-container").addClass("tb-seo-studio-tags-container--error");jQuery("#tb-seo-studio-optimized-tags-char-count").addClass("tb-seo-studio-char-count--error");jQuery("#tb-seo-studio-tags-error").show()}else{jQuery("#tb-seo-studio-tags-input-container").removeClass("tb-seo-studio-tags-container--error");jQuery("#tb-seo-studio-optimized-tags-char-count").removeClass("tb-seo-studio-char-count--error");jQuery("#tb-seo-studio-tags-error").hide()}};var ne=function(){return document.location.href.indexOf("/edit")>-1&&document.location.href.indexOf("/editor")===-1};var re=function(){return document.location.href.indexOf("youtube.com/upload")>-1};var le=function(){return jQuery("paper-dialog.ytcp-uploads-dialog#dialog").length>0};var ue=function(){return new Promise(function(e){var t=document.location.href;n=[];if(t.indexOf("studio.youtube")>-1){var i=jQuery(".title #textbox").length>0;o=t.split("/")[4];a=i?jQuery(".title #textbox").text().trim():jQuery(".title").find("textarea").val();s=i?jQuery(".description #textbox").text().trim():jQuery(".description").find("textarea").val();jQuery(".ytcp-video-metadata-basics .chip").each(function(){n.push(jQuery(this).find("#chip-text").text().trim())})}else{o=TBUtilities.GetUrlParameter("video_id");a=jQuery("#creator-editor-title-link").text().trim();s=jQuery(".video-settings-description").val();jQuery(".yt-chip").each(function(){n.push(jQuery(this).find("span:first").text().trim())})}jQuery("#tb-SeoStudio-video-link").text(a);jQuery("#tb-SeoStudio-video-link").attr("href","https://youtu.be/"+o);e()})};var de=function(e,t){var i=ce(e);var o=ce(l);if(t&&i.indexOf(o)>-1){return 1}else{var a=i.split(" ");var s=o.split(" ");var n=0;for(var r=0;r<a.length;r++){if(s.indexOf(a[r])>-1){n++}}return n/s.length}};var ce=function(e){return e.replace(/[.,\/#!$+%\^&\*;:{}=\-_`~()]/g,"").toLowerCase()};var pe=function(e){var t=jQuery("#tb-seo-studio-"+e.id);if(e.completed==true){t.find(".tb-seo-studio-improve-list-item-status").text("check").addClass("tb-seo-studio-improve-list-item-status--complete");t.removeClass("tb-seo-studio-improve-list-item--incomplete")}else{t.find(".tb-seo-studio-improve-list-item-status").text("close").removeClass("tb-seo-studio-improve-list-item-status--complete");t.addClass("tb-seo-studio-improve-list-item--incomplete")}Ce()};var be=function(e){return e.split(" ").length};var he=function(){return new Promise(function(e){var t=de(jQuery("#tb-seo-studio-optimized-title").val(),true)===1;v[0].completed=t;pe(v[0]);e()})};var me=function(){return new Promise(function(e){var t=be(l)==1&&v[0].completed==true||de(jQuery("#tb-seo-studio-optimized-title").val(),false)>=.8;v[1].completed=t;pe(v[1]);e()})};var fe=function(){return new Promise(function(e){var t=jQuery("#tb-seo-studio-optimized-title").val();var i;if(l.length<=60){i=de(t.slice(0,60),true)===1}else{i=ce(t.slice(0,l.length))===ce(l)}v[2].completed=i;pe(v[2]);e()})};var ye=function(){return new Promise(function(e){var t=v[0].completed&&be(jQuery("#tb-seo-studio-optimized-title").val().trim())>=be(l)+1;v[3].completed=t;pe(v[3]);e()})};var ge=function(){return new Promise(function(e){var t=de(jQuery("#tb-seo-studio-optimized-description").val().slice(0,200),true)>=1;v[4].completed=t;pe(v[4]);e()})};var ve=function(){return new Promise(function(e){var t=be(l)==1&&v[4].completed==true||de(jQuery("#tb-seo-studio-optimized-description").val(),false)>1;v[5].completed=t;pe(v[5]);e()})};var Te=function(){return new Promise(function(e){var t=ce(jQuery(".tb-seo-studio-tags-container .tb-seo-studio-tag-text--added:first").text().trim())==ce(l);v[6].completed=t;pe(v[6]);if(t){jQuery("#tb-seo-studio-add-kw-first-tag").hide()}else{jQuery("#tb-seo-studio-add-kw-first-tag").show()}e()})};var je=function(){return new Promise(function(e){var t=0;jQuery(".tb-seo-studio-tags-container .tb-seo-studio-tag-text--added").each(function(){if(de(jQuery(this).text().trim(),false)>0)t++});if(Te())t--;var i=be(l)==1&&v[8].completed==true||t>1;v[7].completed=i;pe(v[7]);e()})};var Qe=function(){return new Promise(function(e){var t=ae()>=300;v[8].completed=t;pe(v[8]);e()})};var we=function(){he().then(setTimeout(function(){me().then(setTimeout(function(){fe().then(setTimeout(function(){ye()},1e3))},1e3))},1e3))};var ke=function(){ge().then(setTimeout(function(){ve()},1e3))};var Be=function(){Te().then(setTimeout(function(){Qe().then(setTimeout(function(){je()},1e3))},1e3))};var Ce=function(){u=v.filter(function(e){return e.completed===true}).reduce(function(e,t){return t.weighted+e},0);z(u)};var xe=function(){var e=document.location.href;if(e.indexOf("studio.youtube")>-1){r=jQuery("#img-with-fallback").attr("src")}else{r=jQuery(".selectable-thumb-selected").find("img").attr("src")}jQuery("#tb-SeoStudio-video-thumbnail").attr("src",r)};var Se=function(){jQuery(document.body).on("CRTBLoadSeoStudioTemplate",function(e,i){try{if(i.success){if(jQuery("#tb-SeoStudio-container").length>0){jQuery("#tb-SeoStudio-container").remove()}i.response=TBUtilities.FixLocalHtml(DOMPurify.sanitize(i.response,DOMPurifyConfig));if(t){t.append(i.response)}else{jQuery("body").append(i.response)}T();_e();Le()}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddySeoStudio] CRTBLoadSeoStudioTemplate"})}})};var Le=function(){jQuery("#tb-seo-studio-optimized-title").scroll(function(){var e=jQuery(this).scrollTop();var t=jQuery("#tb-seo-studio-title-backdrop");t.scrollTop(e)});jQuery("#tb-seo-studio-optimized-description").scroll(function(){var e=jQuery(this).scrollTop();var t=jQuery(this).siblings(".tb-seo-studio-textarea-backdrop");t.scrollTop(e)})};var _e=function(e,t,i,o,a){jQuery("#tb-SeoStudio-container").show()};return{ShowSeoStudio:function(r,u,d,c,p,b,h,m){l=r?r:null;o=u?u:null;a=d?d:null;s=c?c:null;n=p&&p.length>0?p:[];y=null;_initButton=h?h:null;t=m?m:null;if(TBGlobal.IsAuthenticated()){i=b;if(!e){Se();j();Q();e=true}else{j()}}},SaveAppliedOptimization:function(e,t){_(e,t)}}}();var TubeBuddyUpgradeScreen=function(){var e="";var t="";var i=false;var o=null;var a=function(){};var s=function(){var e=TBGlobal.host+"/ModuleManager/UpgradeScreen/UpgradeScreen?v="+TBGlobal.versionNumber;if(loadLocalHTML&&(TBExtension.GetType()=="chrome"||TBExtension.GetType()=="firefox")){e=chrome.extension.getURL("modules/upgradescreen.html")}else if(loadLocalHTML&&TBExtension.GetType()=="safari"){e="modules/UpgradeScreen.html"}TBExtension.Get(e,"CRTBLoadUpgradeScreenTemplate")};var n=function(){jQuery(document).on("click",".tb-module-upgrade-screen-close",function(){jQuery("#tb-upgrade-screen-container").hide();jQuery("#tb-upgrade-screen-white-background").hide();jQuery("#tb-upgrade-screen-license-msg").empty();if(o){clearInterval(o)}})};var r=function(){jQuery(document.body).on("CRTBLoadUpgradeScreenTemplate",function(e,t){try{if(t.success){t.response=TBUtilities.FixLocalHtml(DOMPurify.sanitize(t.response,DOMPurifyConfig));jQuery("body").append(t.response);a()}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyUpgradeScreen] CRTBLoadUpgradeScreenTemplate"})}})};return{Initialize:function(){if(TBGlobal.IsAuthenticated()){if(!i){r();s();n();i=true}else{a()}}},Show:function(i,a){var s=TBGlobal.Profile().LicenseName;jQuery("#tb-upgrade-screen-white-background").prependTo("body");jQuery("#tb-upgrade-screen-white-background").show();jQuery("#tb-upgrade-screen-container").show();if(i!=null&&i!=""){jQuery("#tb-upgrade-screen-custom-msg").text("Sorry, you can't "+i+" with a "+s+" license.")}else{jQuery("#tb-upgrade-screen-custom-msg").text("Sorry, you can't use this tool with a "+s+" license.")}if(a==null){a="";jQuery("#tb-upgrade-screen-license-msg").append("Unlock this feature (and many more) with a higher upgrade.")}else{if(a=="Pro"||a=="Star"||a=="Legend"){switch(a){case"Pro":jQuery("#tb-upgrade-screen-license-msg").append('Unlock this feature (and many more) with a <span class="tb-font-cbold">Pro</span> or higher upgrade.');break;case"Star":jQuery("#tb-upgrade-screen-license-msg").append('Unlock this feature (and many more) with a <span class="tb-font-cbold">Star</span> or higher upgrade.');break;case"Legend":jQuery("#tb-upgrade-screen-license-msg").append('Unlock this feature (and many more) with a <span class="tb-font-cbold">Legend</span> or higher upgrade.');break}}else{e=a;jQuery.each(TBGlobal.GetAllTools(),function(i,o){if(e==o.id){if(o.Level1Access){t="Pro";jQuery("#tb-upgrade-screen-license-msg").append('Unlock this feature (and many more) with a <span class="tb-font-cbold">'+t+"</span> or higher upgrade.");return false}else if(o.Level2Access){t="Star";jQuery("#tb-upgrade-screen-license-msg").append('Unlock this feature (and many more) with a <span class="tb-font-cbold">'+t+"</span> or higher upgrade.");return false}else if(o.Level3Access){t="Legend";jQuery("#tb-upgrade-screen-license-msg").append('Unlock this feature (and many more) with a <span class="tb-font-cbold">'+t+"</span> or higher upgrade.");return false}}})}}var n="";if(TBGlobal.Profile().LicenseId){n=TBGlobal.host+"/account/license/"+TBGlobal.Profile().LicenseId+"?upgrade=true"}else{n=TBGlobal.host+"/account/upgrade";n+="?id="+TBGlobal.CurrentChannelId();n+="&f="+a}jQuery("#tb-upgrade-screen-button").attr("href",n);jQuery("#tb-upgrade-screen-slideshow > div.tb-upgragre-screen-slide").slice("1").hide();o=setInterval(function(){jQuery("#tb-upgrade-screen-slideshow > div.tb-upgragre-screen-slide:first").fadeOut(1e3).next().fadeIn(1500).end().appendTo("#tb-upgrade-screen-slideshow")},6e3)}}}();var TubeBuddyUploadStudio=function(){var e=false;var t=null;var i=null;var o=null;var a=null;var s=[];var n=null;var r=false;var l=false;var u=0;var d=null;var c=[];var p=[];var b=null;var h=null;var m=function(){};var f=function(){var e=TBGlobal.host+"/ModuleManager/UploadStudio/UploadStudio?v="+TBGlobal.versionNumber;if(loadLocalHTML&&(TBExtension.GetType()=="chrome"||TBExtension.GetType()=="firefox")){e=chrome.extension.getURL("modules/uploadstudio.html")}else if(loadLocalHTML&&TBExtension.GetType()=="safari"){e="modules/UploadStudio.html"}TBExtension.Get(e,"CRTBLoadUpoladStudioTemplate")};var y=function(){jQuery(document).on("click","#creation-menu paper-item#text-item-0",function(){P()});jQuery(document).on("click",".ytcp-uploads-dialog button.step",function(){P()});jQuery(document).on("click",".ytcp-uploads-dialog #next-button",function(){P()});jQuery(document).on("click",".ytcp-uploads-dialog #back-button",function(){P()});jQuery(document).on("blur focusout",".ytcp-uploads-dialog .title-textarea textarea, .ytcp-uploads-dialog .title-textarea #textbox",function(){i=z();E(false)});jQuery(document).on("blur focusout",".ytcp-uploads-dialog .description-textarea textarea, .ytcp-uploads-dialog .description-textarea #textbox",function(){o=F()});jQuery(document).on("click",".ytcp-uploads-dialog .delete-icon",function(){E(false)});jQuery(document).on("focusout",".ytcp-uploads-dialog #outer input:last, .ytcp-uploads-dialog #tags-container #text-input",function(){E(false)});jQuery(document).on("click",".ytcp-uploads-dialog #tags-container .remove-defaults",function(){E(false)});jQuery(document).on("change keyup keypress paste",".ytcp-uploads-dialog .text-input",function(){W()});jQuery(document).on("click",".ytcp-uploads-dialog .tags, .ytcp-uploads-dialog .advanced-button.ytcp-uploads-details",function(){var e=jQuery(this).find("button.ytcp-expansion-panel").attr("aria-expanded")=="true";if(e||l){if(TBGlobal.Profile().SettingsShowInstaSuggest==true){jQuery(".ytcp-uploads-dialog #tags-container").tagautocomplete({inputSelector:"input:not([type=radio]):last",onTagsAdd:function(e,t){var i=jQuery(".ytcp-chip").filter(function(){return jQuery(this).html()==t});var o=i.parent();if(i.length>0&&o.is(jQuery(".chip:last"))){if(i.siblings(".delete-icon").length>0){i.siblings(".delete-icon").one("click",function(e){e.stopPropagation()});i.siblings(".delete-icon").click()}else if(o.children(".delete-icon").length>0){o.children(".delete-icon").one("click",function(e){e.stopPropagation()});o.children(".delete-icon").click()}}TubeBuddyUploadStudio.AddTags(e)},openSuggestedTags:function(e){TubeBuddySuggestedTags.Show(t,i,jQuery(e).find(".tb-upload-tag-suggestions-button"),s)},openTagExplorer:function(e,t){TubeBuddyTagExplorer.ShowTagExplorer(e,jQuery(t).find(".tb-upload-tag-explorer-button"),s,jQuery(t))}}).data("plugin_tagautocomplete")}if(TBGlobal.Profile().SettingsShowSuggestedTags==true){if(jQuery(".ytcp-uploads-dialog .tb-suggestedtags-element").length>0){jQuery(".tb-suggestedtags-element").removeClass("tb-suggestedtags-element").empty()}jQuery(".ytcp-uploads-dialog #tags-container").after(jQuery("#tb-upload-studio-tag-tools-template").html());A();TBExtension.GetDbValue("tb-upload-studio-tag-tools-expanded-"+TBGlobal.CurrentChannelId(),function(e,t){if(t){jQuery(".ytcp-uploads-dialog #tb-upload-studio-tag-tools-display-toggle").trigger("click")}});jQuery(".ytcp-uploads-dialog #tb-upload-studio-recommended-tags").suggestedtags({onTagsAdd:function(e){TubeBuddyUploadStudio.AddTags(e)},resultsMaxWidth:"100%"}).data("plugin_suggestedtags");E(true)}}});jQuery(document).on("click","#tb-upload-studio-tag-tools-display-toggle",function(){var e=jQuery(".ytcp-uploads-dialog #tb-upload-studio-tag-utils");if(e.is(":visible")){e.hide();jQuery(this).find(".material-icons").text("keyboard_arrow_down");jQuery(this).attr("data-tbtooltip","Click to expand");TBExtension.SetDbValue("tb-upload-studio-tag-tools-expanded-"+TBGlobal.CurrentChannelId(),false)}else{e.show();jQuery(this).find(".material-icons").text("keyboard_arrow_up");jQuery(this).attr("data-tbtooltip","Click to hide");TBExtension.SetDbValue("tb-upload-studio-tag-tools-expanded-"+TBGlobal.CurrentChannelId(),true)}A()});jQuery(document).on("click","#tb-upload-studio-thumbnail-creator-button",function(){if(jQuery(this).hasClass("tb-btn-disabled"))return;TBUtilities.AddAction(null,TBUtilities.ActionTypes.ThumbnailGenerator_Use,"thumbnailgenerator");i=z();o=F();TubeBuddyThumbnailCreator.Show(t,i,a,o,"0",jQuery("div.dialog-content.ytcp-uploads-dialog"))});jQuery(document).on("click","#tb-upload-studio-apply-card-template-button",function(){if(jQuery(this).hasClass("tb-btn-disabled"))return;if(t)TubeBuddyCardTemplates.Show(t,i,a,jQuery("paper-dialog.ytcp-uploads-dialog#dialog"))});jQuery(document).on("click","#tb-upload-studio-apply-endscreen-template-button",function(){if(jQuery(this).hasClass("tb-btn-disabled"))return;if(t)TubeBuddyEndScreenTemplates.Show(t,i,a,jQuery("paper-dialog.ytcp-uploads-dialog#dialog"))});jQuery(document).on("click","#made-for-kids-group paper-radio-button",function(){if(jQuery('#made-for-kids-group paper-radio-button[aria-checked="true"]').length>0){jQuery(".dialog-content.ytcp-uploads-dialog #tb-upload-studio-apply-upload-default-button").qtip("destroy");jQuery(".dialog-content.ytcp-uploads-dialog #tb-upload-studio-apply-optimization-button").qtip("destroy");jQuery(".dialog-content.ytcp-uploads-dialog #tb-upload-studio-apply-upload-default-button").removeAttr("data-tbtooltip");jQuery(".dialog-content.ytcp-uploads-dialog #tb-upload-studio-upload-default-select").change()}});jQuery(document).on("change","#tb-upload-studio-upload-default-select",function(){if(jQuery(this).val()==0){jQuery(this).siblings("button").addClass("tb-btn-disabled")}else if(jQuery('#made-for-kids-group paper-radio-button[aria-checked="true"]').length===0){jQuery(this).siblings("button").addClass("tb-btn-disabled");jQuery(this).siblings("button").attr("data-tbtooltip","Upload defaults are disabled until you answer the Audience question below.");A()}else{jQuery(this).siblings("button").removeClass("tb-btn-disabled")}});jQuery(document).on("change","#tb-upload-studio-optimization-select",function(){if(jQuery(this).val()==0){jQuery(this).siblings("button").addClass("tb-btn-disabled")}else if(jQuery('#made-for-kids-group paper-radio-button[aria-checked="true"]').length===0){jQuery(this).siblings("button").addClass("tb-btn-disabled");jQuery(this).siblings("button").attr("data-tbtooltip","SEO Studio optimizations are disabled until you answer the Audience question below.");A()}else{jQuery(this).siblings("button").removeClass("tb-btn-disabled")}});jQuery(document).on("click","#tb-upload-studio-apply-optimization-button",function(){if(jQuery(this).hasClass("tb-btn-disabled"))return;jQuery(".dialog-content.ytcp-uploads-dialog #tb-upload-default-seo-studio-dropdown-menu").addClass("tb-hid");var e=p.filter(function(e){return e.Id===jQuery(".dialog-content.ytcp-uploads-dialog #tb-upload-studio-optimization-select").val()})[0];b=e.Id;var i=e.ThumbnailUrl?b:null;g(e.Title,e.Description,e.Tags,t,i)});jQuery(document).on("click","#tb-upload-studio-menu-dropdown-button",function(e){e.stopPropagation();jQuery(".dialog-content.ytcp-uploads-dialog #tb-upload-studio-apply-optimization-button").addClass("tb-btn-disabled");N().then(function(e){V()}).catch(function(e){TBUtilities.LogError({Exception:e,Location:"[upload studio - getSeoStudioOptimizations]"})});jQuery(".dialog-content.ytcp-uploads-dialog #tb-upload-default-seo-studio-dropdown-menu").toggleClass("tb-hid")});jQuery(document).on("click","#tb-upload-default-seo-studio-dropdown-menu",function(e){e.stopPropagation()});jQuery(document).on("click",".dialog-content.ytcp-uploads-dialog",function(){jQuery(".dialog-content.ytcp-uploads-dialog #tb-upload-default-seo-studio-dropdown-menu").addClass("tb-hid")});jQuery(document).on("click","#tb-upload-studio-new-optimization",function(){if(jQuery("#advanced").attr("hidden")){jQuery(".advanced-button").click()}jQuery(".dialog-content.ytcp-uploads-dialog #tb-upload-default-seo-studio-dropdown-menu").addClass("tb-hid");var e=jQuery("paper-dialog.ytcp-uploads-dialog#dialog");W().then(function(a){TubeBuddySeoStudio.ShowSeoStudio(null,t,i,o,a,null,null,e)})});jQuery(document).on("click",".tb-upload-studio-cancel-apply-optimization",function(){jQuery.unblockUI()});jQuery(document).on("click","#tb-upload-studio-apply-upload-default-button",function(){if(jQuery(this).hasClass("tb-btn-disabled"))return;jQuery(".dialog-content.ytcp-uploads-dialog #tb-upload-default-seo-studio-dropdown-menu").addClass("tb-hid");var e="0";try{TBUtilities.AddAction(null,TBUtilities.ActionTypes.DefaultUploadProfiles_Apply,"defaultuploadprofiles");var t=c.filter(function(e){return e.Id===jQuery(".dialog-content.ytcp-uploads-dialog #tb-upload-studio-upload-default-select").val()})[0];TBUtilities.Log("TubeBuddyUploadStudio - Apply Upload Default Profile: "+JSON.stringify(t));e+="["+t.Id+"]";e+="["+c.length+"]";e+="["+t+"]";var i=jQuery("#tb-upload-studio-block-message-template").html();var o=i.formatTemplate(t.Name);jQuery.blockUI({message:o,blockMsgClass:"tb-upload-studio-block-msg",overlayCSS:{backgroundColor:"#fff",cursor:"unavailable",zIndex:"2210",opacity:.6}});jQuery(".blockUI #tb-upload-studio-cancel-apply-defaults").hide();setTimeout(function(){jQuery(".blockUI #tb-upload-studio-cancel-apply-defaults").show()},6e4);var a=t.Title?t.Title:"PLACEHOLDER";Q(a);w(t.Description);e+="[A]";if(jQuery("#advanced").attr("hidden")){jQuery(".advanced-button").click()}if(jQuery(".allow-ratings #paper-checkbox").attr("aria-checked")!==t.UsersCanViewRatingsForThisVideo.toString()){jQuery(".allow-ratings #paper-checkbox").click()}e+="[B]";jQuery("#tags-container #clear-button").click();var s=jQuery(".ytcp-uploads-dialog #outer").find("input:last:not([type=radio])");if(s.siblings("ytcp-chip.chip.ytcp-chip-bar").length>0){jQuery.each(s.siblings("ytcp-chip.chip.ytcp-chip-bar"),function(){jQuery(this).find("#delete-icon").click()})}e+="[C]";var n=[];if(t.Tags.indexOf('"')>=0){var l=/[^\s"]+|"([^"]*)"/gi;do{var u=l.exec(t.Tags);if(u!=null){n.push(u[1]?u[1]:u[0])}}while(u!=null)}else{n=t.Tags.split(",")}TubeBuddyUploadStudio.AddTags(n);e+="[D]";var d=setInterval(function(){if(!r){clearInterval(d);B(t.VideoLanguageAbbreviation).then(function(){C(t.CaptionCertification).then(function(){x(t.License).then(function(){S(t.Category).then(function(){L(t.AllowCommentsDetail).then(function(){_(t.Privacy).then(function(){e+="[E]";I(t).then(function(){e+="[F]";setTimeout(function(){jQuery('button.step[step-index="0"]').click()},100);setTimeout(function(){jQuery(".advanced-button").click();if(!t.Title){Q("")}},200);jQuery.unblockUI()}).catch(function(t){jQuery.unblockUI();TBUtilities.LogError({Exception:t,Location:"[TubeBuddyUploadsStudio] tb-upload-studio-apply-upload-default-button [click] "+e})})})})})})})})}},100)}catch(t){TBUtilities.LogError({Exception:t,Location:"[TubeBuddyUploadsStudio] tb-upload-studio-apply-upload-default-button [click] "+e})}});jQuery(document).on("click","#tb-upload-studio-cancel-apply-defaults",function(){jQuery.unblockUI()});jQuery(document).on("click",".tb-upload-studio-tag-tool-button",function(e){var i=jQuery(this).attr("data-action");var o=jQuery("paper-dialog.ytcp-uploads-dialog#dialog");G();W();switch(i){case"copy":{e.stopPropagation();TubeBuddyCopyTo.ShowMenu(jQuery(this),s,false,jQuery("#details"),0,o);break}case"sort":{var a=[];var l=jQuery("#tags-container");l.find("div.ytcp-chip").each(function(){a.push(jQuery(this).text())});TubeBuddyTagSorter.Show(a,[],null,function(e){n=e;l.find("#clear-button").click();r=true;u=0;d=setTimeout(Y,10)},o.parent());break}case"suggested":{var c=z();TubeBuddySuggestedTags.Show(t,c,jQuery(this),s,function(e){var t=[];t.push(e);n=t;r=true;u=0;d=setTimeout(Y,10)});break}case"explore":{TubeBuddyTagExplorer.ShowTagExplorer(null,jQuery(this),s,o,o);break}case"translate":{TubeBuddyTagTranslator.Show(s,function(e){var t=[];t.push(e);n=t;r=true;u=0;d=setTimeout(Y,10)},o);break}case"import":{TubeBuddyTagLists.Show(true,function(e){n=e;r=true;u=0;d=setTimeout(Y,10)},o);break}}})};var g=function(e,t,i,o,a){if(b!=null){var s=p.filter(function(e){return e.Id===b})[0];TubeBuddySeoStudio.SaveAppliedOptimization(s,o)}var r=jQuery("#tb-upload-studio-optimization-block-message-template").html();var l=r.formatTemplate("Applying optimization title, description and tags...");jQuery.blockUI({message:l,blockMsgClass:"tb-upload-studio-block-msg",overlayCSS:{backgroundColor:"#fff",cursor:"unavailable",zIndex:"2210",opacity:.6}});var d=setTimeout(function(){jQuery(".tb-upload-studio-apply-status-detail").after('<a class="tb-upload-studio-cancel-apply-optimization tb-margin-left5">cancel</a>');clearTimeout(d)},6e4);jQuery(".tb-upload-studio-apply-status-detail").text("Updating title");Q(e);jQuery(".tb-upload-studio-apply-status-detail").text("Updating description");w(t);T(i);if(a!=null){setTimeout(function(){jQuery(".dialog-content.ytcp-uploads-dialog #tb-upload-studio-apply-optimization-block-text").text("Applying optimized thumbnail...")},1500);v(a,o).then(function(e){jQuery(".dialog-content.ytcp-uploads-dialog #tb-upload-studio-apply-optimization-block-text").text("Thumbnail successfully applied")}).catch(function(e){jQuery(".dialog-content.ytcp-uploads-dialog #tb-upload-studio-apply-optimization-block-text").text("An error occurred applying your custom thumbnail")}).finally(function(){var e=setInterval(function(){if(u>=n.length-1){clearInterval(e);jQuery(".tb-upload-studio-apply-status-detail").text("");jQuery.unblockUI()}else{jQuery(".tb-upload-studio-apply-status-detail").text("Updating tag "+(u+1)+" of "+n.length+" total.")}},500)})}else{var c=setInterval(function(){if(u>=n.length-1){clearInterval(c);jQuery(".tb-upload-studio-apply-status-detail").text("");jQuery.unblockUI()}else{jQuery(".tb-upload-studio-apply-status-detail").text("Updating tag "+(u+1)+" of "+n.length+" total.")}},500)}b=null};var v=function(e,t){return new Promise(function(i,o){var a={ThumbnailId:e,VideoId:t};var s=TBGlobal.host+TBGlobal.apiUrls.seoScorePublishSavedThumbnailData;try{TBExtension.Post(s,JSON.stringify(a),function(e,t,a){if(e){i(a)}else{o(a)}},null,{contentType:"application/json"})}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyUploadStudio] publishOptimizationThumbnail"});o(e)}})};var T=function(e){if(jQuery("paper-dialog.ytcp-uploads-dialog#dialog #advanced").attr("hidden")){jQuery("paper-dialog.ytcp-uploads-dialog#dialog .advanced-button").click()}jQuery("paper-dialog.ytcp-uploads-dialog#dialog #tags-container #clear-button").click();var t=jQuery("paper-dialog.ytcp-uploads-dialog#dialog .ytcp-uploads-dialog #outer").find("input:last:not([type=radio])");if(t.siblings("ytcp-chip.chip.ytcp-chip-bar").length>0){jQuery.each(t.siblings("ytcp-chip.chip.ytcp-chip-bar"),function(){jQuery(this).find("#delete-icon").click()})}var i=[];if(Array.isArray(e)){i=e}else{if(e.indexOf('"')>=0){var o=/[^\s"]+|"([^"]*)"/gi;do{var a=o.exec(e);if(a!=null){i.push(a[1]?a[1]:a[0])}}while(a!=null)}else{i=e.split(",")}}TubeBuddyUploadStudio.AddTags(i)};var j=function(e){return new Promise(function(t,i){var o=jQuery(e)[0];if(o){o.focus();var a=document.createEvent("HTMLEvents");a.initEvent("input",true,true);o.dispatchEvent(a);t()}else{i()}})};var Q=function(e){if(l){jQuery("paper-dialog.ytcp-uploads-dialog#dialog .title-textarea #textbox").text(e);j("paper-dialog.ytcp-uploads-dialog#dialog .title-textarea #textbox")}else{jQuery("paper-dialog.ytcp-uploads-dialog#dialog .title-textarea textarea").val(e);j("paper-dialog.ytcp-uploads-dialog#dialog .title-textarea textarea")}};var w=function(e){if(l){jQuery("paper-dialog.ytcp-uploads-dialog#dialog .description-textarea #textbox").text(e);j("paper-dialog.ytcp-uploads-dialog#dialog .description-textarea #textbox")}else{jQuery("paper-dialog.ytcp-uploads-dialog#dialog .description-textarea textarea").val(e);j("paper-dialog.ytcp-uploads-dialog#dialog .description-textarea textarea")}};var k=function(){return new Promise(function(e){var t=setInterval(function(){var i=jQuery('paper-listbox[role="listbox"] paper-item');if(i.length>0){i.closest("#dialog").hide();clearInterval(t);e()}},100)})};var B=function(e){return new Promise(function(t,i){if(jQuery("#language-input #trigger").length>0){jQuery("#language-input #trigger").click();k().then(function(){jQuery('[test-id="'+e+'"]').trigger("click");t()})}else{i("An error occurred applying language settings.")}})};var C=function(e){return new Promise(function(t,i){var o=[{index:0,testId:"VIDEO_UNCAPTIONED_REASON_UNNECESSARY_OR_NOT_SET"},{index:1,testId:"VIDEO_UNCAPTIONED_REASON_NO_US_TV_CONTENT"},{index:2,testId:"VIDEO_UNCAPTIONED_REASON_CAPTIONLESS_TV_CONTENT"},{index:3,testId:"VIDEO_UNCAPTIONED_REASON_LEGACY"},{index:4,testId:"VIDEO_UNCAPTIONED_REASON_NO_FULL_LENGTH_VIDEO"},{index:5,testId:"VIDEO_UNCAPTIONED_REASON_NOT_REQUIRED"},{index:6,testId:"VIDEO_UNCAPTIONED_REASON_EXCEPTION_GRANTED"}];if(jQuery("#uncaptioned-reason #trigger").length>0){jQuery("#uncaptioned-reason #trigger").click();k().then(function(){jQuery('[test-id="'+o[e].testId+'"]').click();t()})}else{i("An error occurred applying caption settings")}})};var x=function(e){return new Promise(function(t,i){var o=[{tbValue:"all_rights_reserved",testId:"VIDEO_LICENSE_STANDARD"},{tbValue:"creative_commons",testId:"VIDEO_LICENSE_CREATIVE_COMMONS"}];var a=o.filter(function(t){return t.tbValue===e})[0].testId;if(jQuery("#license #trigger").length>0){jQuery("#license #trigger").click();k().then(function(){jQuery('[test-id="'+a+'"]').click();t()})}else{i("An error occurred applying license settings")}})};var S=function(e){return new Promise(function(t,i){var o=[{tbValue:1,testId:"CREATOR_VIDEO_CATEGORY_FILM"},{tbValue:2,testId:"CREATOR_VIDEO_CATEGORY_AUTOS"},{tbValue:10,testId:"CREATOR_VIDEO_CATEGORY_MUSIC"},{tbValue:15,testId:"CREATOR_VIDEO_CATEGORY_PETS"},{tbValue:17,testId:"CREATOR_VIDEO_CATEGORY_SPORTS"},{tbValue:19,testId:"CREATOR_VIDEO_CATEGORY_TRAVEL"},{tbValue:20,testId:"CREATOR_VIDEO_CATEGORY_GADGETS"},{tbValue:0,testId:"CREATOR_VIDEO_CATEGORY_PEOPLE"},{tbValue:22,testId:"CREATOR_VIDEO_CATEGORY_PEOPLE"},{tbValue:23,testId:"CREATOR_VIDEO_CATEGORY_COMEDY"},{tbValue:24,testId:"CREATOR_VIDEO_CATEGORY_ENTERTAINMENT"},{tbValue:25,testId:"CREATOR_VIDEO_CATEGORY_NEWS"},{tbValue:26,testId:"CREATOR_VIDEO_CATEGORY_HOWTO"},{tbValue:27,testId:"CREATOR_VIDEO_CATEGORY_EDUCATION"},{tbValue:28,testId:"CREATOR_VIDEO_CATEGORY_SCIENCE"},{tbValue:29,testId:"CREATOR_VIDEO_CATEGORY_GOVERNMENT"}];var a=o.filter(function(t){return t.tbValue===e})[0].testId;if(jQuery("#category #trigger").length>0){jQuery("#category #trigger").click();k().then(function(){jQuery('[test-id="'+a+'"]').click();t()})}else{i("An error occurred applying category settings")}})};var L=function(e){return new Promise(function(t,i){var o=[{tbValue:"all",testId:"COMMENTS_MODERATION_TYPE_ALLOW_ALL"},{tbValue:"auto",testId:"COMMENTS_MODERATION_TYPE_AUTOMOD"},{tbValue:"approval",testId:"COMMENTS_MODERATION_TYPE_HOLD_ALL"},{tbValue:"false",testId:"COMMENTS_MODERATION_TYPE_DISABLED"}];var a=o.filter(function(t){return t.tbValue===e})[0].testId;var s=jQuery("ytcp-form-select.ytcp-uploads-advanced #trigger");var n=jQuery("ytcp-form-select.ytcp-uploads-advanced:eq("+(s.length-2)+") #trigger");if(n.length>0){n.click();k().then(function(){jQuery('[test-id="'+a+'"]').click();t()})}else{i("An error occurred applying comments settings")}})};var _=function(e){return new Promise(function(t,i){var o=R();var a=o.totalTabs===3?2:3;jQuery('button.step[step-index="'+a+'"]').click();var s=setInterval(function(){if(jQuery("#publish-now-container").length>0||jQuery("div#first-container.ytcp-video-visibility-select-v2").length>0){clearInterval(s);if(jQuery("#publish-now-container .button-area").attr("aria-expanded")=="false"){jQuery("#publish-now-container .button-area").click()}jQuery('[name="'+e.toUpperCase()+'"]').click();t()}else{i("An error occurred applying visibility settings")}},100)})};var I=function(e){return new Promise(function(t,i){var o=R();if(o.totalTabs===3){t()}else{jQuery('button.step[step-index="1"]').click();var a=setInterval(function(){if(jQuery(".ytcp-video-monetization .clickable").length>0){clearInterval(a);var i=e.MonetizeWithAds||e.OverlayInVideoAds||e.SponsoredCards||e.SkippableVideoAds||e.NonSkipableVideoAds;var o=jQuery('.ytcp-video-monetization ytcp-icon-button[icon="editor:attach-money').length>0;if(!o&&i){jQuery(".ytcp-video-monetization .clickable").click();var s=setInterval(function(){if(jQuery("#radio-on").length>0){clearInterval(s);jQuery("#radio-on").click();jQuery("#save-button").click()}},100)}else if(o&&!i){jQuery(".ytcp-video-monetization .clickable").click();var s=setInterval(function(){if(jQuery("#radio-off").length>0){clearInterval(s);jQuery("#radio-off").click();jQuery("#save-button").click();t()}},100)}else if(!o&&!i){t()}var n=setInterval(function(){if(jQuery("ytpp-ad-options-settings.monetization-options .manual-settings[disabled]").length===0){clearInterval(n);U(".overlay-ads-checkbox #paper-checkbox",e.OverlayInVideoAds).then(function(){U(".product-listing-ads-checkbox #paper-checkbox",e.SponsoredCards).then(function(){U(".skippable-video-ads-checkbox #paper-checkbox",e.SkippableVideoAds).then(function(){U(".non-skippable-video-ads-checkbox #paper-checkbox",e.NonSkipableVideoAds).then(function(){t()})})})})}},100)}},100)}})};var U=function(e,t){return new Promise(function(i){if(t!=(jQuery(e).attr("aria-checked")=="true")){jQuery(e).click()}i()})};var E=function(e){if(TBGlobal.Profile().SettingsShowSuggestedTags==true){try{if(h!=null){clearTimeout(h)}h=setTimeout(function(){h=null;W();var i=z();var o=jQuery(".ytcp-uploads-dialog #tb-upload-studio-recommended-tags").suggestedtags().data("plugin_suggestedtags");if(o)o.getSuggestions(t,s,i,e)},2e3)}catch(e){TBUtiities.LogError({Exception:e,Location:"[TubeBuddyUploadStudio] getSuggestedTags"})}}};var A=function(){jQuery('[data-tbtooltip!=""]').qtip({content:{attr:"data-tbtooltip"},style:{classes:"tb-comment-filter-studio-qtip",tip:false},position:{at:"bottom left",adjust:{x:-40,y:5}}})};var G=function(){if(jQuery(".video-url-fadeable>a").attr("href").split("/")[3].length===11)t=jQuery(".video-url-fadeable>a").attr("href").split("/")[3]};var R=function(){var e=jQuery('.stepper .step[state="numbered"').length>0?jQuery('.stepper .step[state="numbered"'):jQuery('.stepper .step[state="error"');var t={activeStepIndex:parseInt(e.attr("step-index")),totalTabs:jQuery(".stepper .step").length};return t};var P=function(){TBUtilities.Log("TubeBuddyUploadStudio - Load Tools");var e=setInterval(function(){var i=jQuery(".ytcp-uploads-dialog h1").text().trim();if(i.length>0){clearInterval(e);O();var o=R();if(!t&&jQuery('button[step-index="0"][state="numbered"]').length>0)G();if(o.activeStepIndex===0)$();else if(o.activeStepIndex===1&&o.totalTabs===3||o.activeStepIndex===2&&o.totalTabs===4)H()}},100)};var O=function(){l=jQuery("paper-progress.ytcp-uploads-progress").length==0};var D=function(){var e=jQuery(".dialog-content.ytcp-uploads-dialog #tb-upload-studio-upload-default-select");jQuery(".dialog-content.ytcp-uploads-dialog #tb-upload-studio-upload-default-select option").remove();jQuery(".dialog-content.ytcp-uploads-dialog #tb-upload-studio-upload-default-select").append('<option value="0">Apply Upload Default...</option>');if(c.length>0){jQuery.each(c,function(e,t){jQuery(".dialog-content.ytcp-uploads-dialog #tb-upload-studio-upload-default-select").append(jQuery("<option></option>").attr("value",t.Id).text(t.Name))})}};var M=function(){return new Promise(function(e,t){c=[];var i=TBGlobal.host+TBGlobal.apiUrls.uploadDefaultsList;TBExtension.Get(i,function(i,o,a){try{c=[];TBUtilities.Log("TubeBuddyUploadStudioDefaults - get list");if(i){var o=JSON.parse(a);TBUtilities.Log(o);if(o.length>0){o.forEach(function(e){c.push(e)})}e()}else{t()}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyUploadStudio] getUploadDefaults"});t()}},null,{contentType:"application/json",dataType:"text"})})};var N=function(){return new Promise(function(e,t){var i=TBGlobal.host+TBGlobal.apiUrls.seoScoreGetScores;TBExtension.Get(i,function(i,o,a){try{p=[];TBUtilities.Log("TubeBuddyUploadStudio - SEO Studio Optimizations - get list");if(i){var o=JSON.parse(a);TBUtilities.Log(o);if(o.length>0){o.forEach(function(e){if(e.VideoId===null)p.push(e)})}e(p)}else{t()}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyUploadStudio] getSeoStudioOptimizations"})}},null,{contentType:"application/json",dataType:"text"})})};var V=function(){jQuery(".dialog-content.ytcp-uploads-dialog #tb-upload-studio-optimization-select option").remove();jQuery(".dialog-content.ytcp-uploads-dialog #tb-upload-studio-optimization-select").append('<option value="0">Apply Existing Optimization...</option>');if(p.length>0){jQuery.each(p,function(e,t){jQuery(".dialog-content.ytcp-uploads-dialog #tb-upload-studio-optimization-select").append(jQuery("<option></option>").attr("value",t.Id).text(t.Keyword))})}};var z=function(){if(l)return jQuery(".ytcp-uploads-dialog .title-textarea #textbox").text().trim();else return jQuery(".ytcp-uploads-dialog .title-textarea textarea").val()};var F=function(){if(l)return jQuery(".ytcp-uploads-dialog .description-textarea #textbox").text().trim();else return jQuery(".ytcp-uploads-dialog .description-textarea textarea").val()};var $=function(){var e=setInterval(function(){if((jQuery('button[step-index="0"][state="numbered"]').length>0||jQuery('button[step-index="0"][state="error"]').length>0)&&jQuery(".video-url-fadeable>a").attr("href").split("/")[3].length===11){clearInterval(e);G();i=z();o=F();var t=setInterval(function(){if(jQuery("#still-0[processing]").length===0){clearInterval(t);a=jQuery(".ytcp-uploads-dialog #img-with-fallback").first().attr("src")}},100);if(jQuery("div.dialog-content.ytcp-uploads-dialog #tb-upload-studio-dropdown-menu-container").length===0){jQuery(".title-textarea").before(jQuery("#tb-upload-studio-dropdown-template").html());M().then(function(){D()});N().then(function(e){V()}).catch(function(e){TBUtilities.LogError({Exception:e,Location:"[upload studio - getSeoStudioOptimizations]"})})}else{D();V()}var s=jQuery("#tb-upload-studio-thumbnail-creator-button-template").html();if(jQuery("div.dialog-content.ytcp-uploads-dialog #tb-upload-studio-thumbnail-creator-button").length==0){jQuery("paper-dialog.ytcp-uploads-dialog#dialog ytcp-thumbnails-compact-editor").append(s);A()}var n=setInterval(function(){if(jQuery("#still-0[processing]").length===0){clearInterval(n);jQuery(".dialog-content.ytcp-uploads-dialog #tb-upload-studio-thumbnail-creator-button").removeClass("tb-btn-disabled");jQuery(".dialog-content.ytcp-uploads-dialog #tb-upload-studio-thumbnail-creator-button").find(".tb-upload-studio-icon-transparent").addClass("tb-upload-studio-icon-transparent--enabled");jQuery(".dialog-content.ytcp-uploads-dialog #tb-upload-studio-thumbnail-creator-button").qtip("destroy");jQuery(".dialog-content.ytcp-uploads-dialog .tb-seo-studio-launch-thumbnail-generator").removeClass("tb-btn-disabled");jQuery(".dialog-content.ytcp-uploads-dialog .tb-seo-studio-launch-thumbnail-generator").qtip("destroy")}},100)}},100)};var H=function(){O();var e=jQuery("#tb-upload-studio-apply-card-template-button-template").html();if(jQuery("ytcp-uploads-video-elements.ytcp-uploads-dialog #tb-upload-studio-apply-card-template-button").length==0){if(!l){jQuery("#info-cards-panel").after(e)}else{jQuery("#cards-button").before(e)}jQuery("ytcp-uploads-video-elements.ytcp-uploads-dialog #tb-upload-studio-apply-card-template-button").addClass("tb-upload-studio-apply-template-button--new-uploads-page");A()}var t=jQuery("#tb-upload-studio-apply-endscreen-template-button-template").html();if(jQuery("ytcp-uploads-video-elements.ytcp-uploads-dialog #tb-upload-studio-apply-endscreen-template-button").length==0){if(!l){jQuery("#end-screen-panel").after(t)}else{jQuery("#endscreens-button").before(t)}jQuery("ytcp-uploads-video-elements.ytcp-uploads-dialog #tb-upload-studio-apply-endscreen-template-button").addClass("tb-upload-studio-apply-template-button--new-uploads-page");A()}var i=setInterval(function(){if(jQuery(".still-processing-scrim:visible").length===0){clearInterval(i);jQuery(".dialog-content.ytcp-uploads-dialog #tb-upload-studio-apply-card-template-button").removeClass("tb-btn-disabled");jQuery(".dialog-content.ytcp-uploads-dialog #tb-upload-studio-apply-card-template-button").find(".tb-upload-studio-icon-transparent").addClass("tb-upload-studio-icon-transparent--enabled");jQuery(".dialog-content.ytcp-uploads-dialog #tb-upload-studio-apply-card-template-button").qtip("destroy");jQuery(".dialog-content.ytcp-uploads-dialog #tb-upload-studio-apply-endscreen-template-button").removeClass("tb-btn-disabled");jQuery(".dialog-content.ytcp-uploads-dialog #tb-upload-studio-apply-endscreen-template-button").find(".tb-upload-studio-icon-transparent").addClass("tb-upload-studio-icon-transparent--enabled");jQuery(".dialog-content.ytcp-uploads-dialog #tb-upload-studio-apply-endscreen-template-button").qtip("destroy")}},100)};var Y=function(){try{if(u>=n.length){clearTimeout(d);d=null;r=false;E(false);return}var e=jQuery(".ytcp-uploads-dialog #outer").find("input:last:not([type=radio])");e.val(n[u++]);e.trigger("focus");e.trigger("blur");d=setTimeout(Y,10)}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyUploadVideoStudio] addTagsOneAtATime"})}};var W=function(){return new Promise(function(e){s=[];if(jQuery(".ytcp-uploads-dialog #outer").find("div.ytcp-chip").length===0)e(s);jQuery(".ytcp-uploads-dialog #outer").find("div.ytcp-chip").each(function(t){s.push(jQuery(this).text());if(t==jQuery(".ytcp-uploads-dialog #outer").find("div.ytcp-chip").length-1){e(s)}})})};var K=function(){jQuery(document.body).on("CRTBLoadUpoladStudioTemplate",function(e,t){try{if(t.success){t.response=TBUtilities.FixLocalHtml(DOMPurify.sanitize(t.response,DOMPurifyConfig));jQuery("body").append(t.response);m()}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyUploadStudio] CRTBLoadUploadStudioTemplate"})}})};return{Initialize:function(){if(TBGlobal.IsAuthenticated()){if(!e){K();f();y();e=true}}},LoadTubeBuddyTools:function(){P()},AddTags:function(e){n=e;r=true;u=0;d=setTimeout(Y,10)},ApplyOptimization:function(e,t,i,o,a){g(e,t,i,o,a)},GetVideoId:function(){return t},GetVideoMetadata:function(){return{videoTitle:i,videoDescription:o,videoTags:s}}}}();var TubeBuddyWordCloud=function(){var e=false;var t=function(){};var i=function(){var e=TBGlobal.host+"/ModuleManager/WordCloud/WordCloud?v="+TBGlobal.versionNumber;if(loadLocalHTML&&(TBExtension.GetType()=="chrome"||TBExtension.GetType()=="firefox")){e=chrome.extension.getURL("modules/wordcloud.html")}else if(loadLocalHTML&&TBExtension.GetType()=="safari"){e="modules/WordCloud.html"}TBExtension.Get(e,"CRTBLoadWordCloudTemplate")};var o=function(e,t){if(!t||!e){return false}else{var i=e.split(t),o={};for(var a=0,s=i.length;a<s;a++){i[a]=i[a].trim();if(o.hasOwnProperty(i[a])){o[i[a]]=parseInt(o[i[a]],10)+1}else{o[i[a]]=1}}return o}};var a=function(e){jQuery(".tb-module-content-word-cloud:first").jQCloud("destroy");e=TBUtilities.ReplaceAll(e,".","");e=TBUtilities.ReplaceAll(e,",","");e=TBUtilities.ReplaceAll(e,"?","");e=TBUtilities.ReplaceAll(e,"!","");e=e.toLowerCase();var t=o(e," ");var i=[];var a=[];var s=[{name:"you"},{name:"the"},{name:"to"},{name:"i"},{name:"i'm"},{name:"iâ€™m"},{name:"im"},{name:"i've"},{name:"for"},{name:"and"},{name:"then"},{name:"than"},{name:"my"},{name:"what"},{name:"but"},{name:"can"},{name:"so"},{name:"how"},{name:"a"},{name:"is"},{name:"me"},{name:"of"},{name:"of"},{name:"from"},{name:"not"},{name:"your"},{name:"in"},{name:"on"},{name:"this"},{name:"that"},{name:"because"},{name:"it's"},{name:"do"},{name:"here"},{name:"them"},{name:"it"},{name:"channel"},{name:"am"},{name:"he"},{name:"she"},{name:"get"},{name:"got"},{name:"or"},{name:"as"},{name:"have"},{name:"we"},{name:"why"},{name:"u"},{name:"did"},{name:"why"},{name:"just"},{name:"they"},{name:"at"},{name:"was"},{name:"are"},{name:"an"},{name:"be"},{name:"was"},{name:"more"},{name:"about"},{name:"-"},{name:"â€“"},{name:'"'},{name:":"},{name:"!"},{name:"with"},{name:"if"},{name:"I"},{name:"1"},{name:"2"},{name:"3"},{name:"4"},{name:"5"},{name:"6"},{name:"7"},{name:"8"},{name:"9"},{name:"y"}];var n=Object.keys(t).length>250;TBUtilities.Log("Length: "+Object.keys(t).length);jQuery.each(e.split(" "),function(e,o){if(TBUtilities.GetInArray(a,"name",o.trim()))return;if(TBUtilities.GetInArray(s,"name",o.trim()))return;if(n&&t[o.trim()]==1)return;i.push({text:o.trim(),weight:t[o.trim()]});a.push({name:o.trim()})});jQuery(".tb-module-content-word-cloud:first").jQCloud(i,{width:775,height:410,fontSize:{from:.075,to:.015},colors:["#424242","#4f4f4f","#565656","#606060","#6b6b6b","#757575","#7c7c7c","#848484"]})};var s=function(){jQuery(document).on("click",".tb-module-close",function(){jQuery(".tb-word-cloud-studio-white-bg").hide()})};var n=function(){jQuery(document.body).on("CRTBLoadWordCloudTemplate",function(e,i){try{if(i.success){i.response=TBUtilities.FixLocalHtml(DOMPurify.sanitize(i.response,DOMPurifyConfig));jQuery("body").append(i.response);t()}else{}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyWordCloud] CRTBLoadWordCloudTemplate"})}})};return{Initialize:function(){if(TBGlobal.IsAuthenticated()){if(!e){n();i();s();e=true}else{t()}}},Show:function(e){jQuery("#tb-word-cloud-container").show();jQuery(".tb-word-cloud-studio-white-bg").appendTo("body");jQuery(".tb-word-cloud-studio-white-bg").show();a(e)}}}();var TubeBuddyKidsCenter=function(){var e=false;var t=[];var i=false;var o;var a=function(){if(o){o=setInterval(function(){if(jQuery(".tb-videos-bulk-list-dropdown").length){clearInterval(o);o=null;var e=jQuery(".tb-trigger-kids-center");if(e.length===0){s()}else{jQuery(".tb-videos-bulk-list-dropdown").after(jQuery(".tb-trigger-kids-center")[0].outerHTML)}}},300)}};var s=function(){var e=TBGlobal.host+"/ModuleManager/kidscenter/kidscenter?v="+TBGlobal.versionNumber;if(loadLocalHTML&&(TBExtension.GetType()==="chrome"||TBExtension.GetType()==="firefox")){e=chrome.extension.getURL("modules/kidscenter.html")}else if(loadLocalHTML&&TBExtension.GetType()==="safari"){e="modules/kidscenter.html"}TBExtension.Get(e,"CRTBLoadTubeBuddyKidsCenterTemplate")};var n=function(){TubeBuddyYouTubeActions.GetVideosListStudio().then(function(e){if(i)return;try{jQuery.each(e.videosList,function(e,i){t.push(i)});jQuery("#tb-kc-scan-complete-list").empty();var o=0;var a=0;let i="";let s="";jQuery.each(t,function(e,t){if(t.privacy!="VIDEO_PRIVACY_PUBLIC")return;var n='<tr class="#ROWTYPE# #FILTER#"><td style="height: 50px; padding-left:5px; position:relative; border-top:solid 1px #ddd; width: 460px; max-width:405px; overflow:hidden;">\n'+'<img class="lazy" data-src="'+t.thumbnailDetails.thumbnails[0].url+'" style="position:absolute; height:35px; top:10px;" />\n'+'<div style="padding-left:70px">\n'+t.title+"\n"+"</div>\n"+"</td>\n"+'<td style="border-top:solid 1px #ddd;text-align:center; width: 140px; ">\n#RATEDBY#'+"</td>\n"+'<td style="text-align:center;border-top:solid 1px #ddd; width: 70px;">\n'+'    <a href="https://studio.youtube.com/video/'+t.videoId+'/edit" target="_blank">\n'+'        <span style="">edit</span>\n'+"      </a>\n"+" </td></tr>";if(t.audienceRestriction.effectiveRating=="VIDEO_TARGETED_AUDIENCE_ALL"||t.ageRestriction=="VIDEO_AGE_RESTRICTION_SELF"){if(t.ageRestriction=="VIDEO_AGE_RESTRICTION_SELF"){n=TBUtilities.ReplaceAll(n,"#RATEDBY#",'<span data-tbtooltip="You set this video to 18+">You<span style="font-size:10px; background:red; padding: 2px 4px; color:white; position:relative; left:2px; top:-3px; border-radius:5px;">18+</span> </span>');n=TBUtilities.ReplaceAll(n,"#FILTER#","tb-kc-nfc-filt-You")}else if(t.audienceRestriction.selfRating=="VIDEO_TARGETED_AUDIENCE_ALL"&&t.audienceRestriction.systemRating=="VIDEO_TARGETED_AUDIENCE_CROSSWALK"){n=TBUtilities.ReplaceAll(n,"#RATEDBY#",'<span data-tbtooltip="YouTube\'s algorithm deturmined this video was made for kids but you manually overrode the setting and marked it as not made for kids." style="background:#ffae42; color:white; border-radius:3px; padding: 3px;">You (YouTube~Kids)</span>');n=TBUtilities.ReplaceAll(n,"#FILTER#","tb-kc-nfc-filt-YouYouTubeKids")}else if(t.audienceRestriction.selfRating=="VIDEO_TARGETED_AUDIENCE_ALL"){n=TBUtilities.ReplaceAll(n,"#RATEDBY#",'<span data-tbtooltip="YouTube\'s algorithm was unable to deturmine if this video was made for kids, but you manually rated it as not made for kids.">You</span>');n=TBUtilities.ReplaceAll(n,"#FILTER#","tb-kc-nfc-filt-You")}else{n=TBUtilities.ReplaceAll(n,"#FILTER#","tb-kc-nfc-filt-NoOne");n=TBUtilities.ReplaceAll(n,"#RATEDBY#",'<span data-tbtooltip="YouTube\'s algorithm was unable to deturmine if the video was made for kids and you have not manually set a rating yourself either." style="color:#777;">(no one)</span>')}n=TBUtilities.ReplaceAll(n,"#ROWTYPE#","tb-kc-nmfkr");s+=n;a++}else{n=TBUtilities.ReplaceAll(n,"#ROWTYPE#","tb-kc-mfkr");if(t.audienceRestriction.selfRating=="VIDEO_TARGETED_AUDIENCE_CROSSWALK"&&t.audienceRestriction.systemRating=="VIDEO_TARGETED_AUDIENCE_CROSSWALK"){n=TBUtilities.ReplaceAll(n,"#RATEDBY#",'<span data-tbtooltip="YouTube\'s algorithm deturmined this video was made for kids, you agreed, and manually applied the made for kids rating yourself too.">You &amp; YouTube</span>');n=TBUtilities.ReplaceAll(n,"#FILTER#","tb-kc-fc-filt-YouAndYouTube")}else if(t.audienceRestriction.selfRating=="VIDEO_TARGETED_AUDIENCE_CROSSWALK"){n=TBUtilities.ReplaceAll(n,"#RATEDBY#",'<span data-tbtooltip="YouTube\'s algorithm was unable to deturmine if the video was made for kids, but you manually rated it as made for kids.">You</span>');n=TBUtilities.ReplaceAll(n,"#FILTER#","tb-kc-fc-filt-You")}else{n=TBUtilities.ReplaceAll(n,"#RATEDBY#",'<span data-tbtooltip="YouTube\'s algorithm deturmined this video was made for kids, but you have not yet manually set a rating for the video yourself yet.">YouTube</span>');n=TBUtilities.ReplaceAll(n,"#FILTER#","tb-kc-fc-filt-YouTube")}i+=n;o++}});jQuery("#tb-kc-mfk2").after(s);jQuery("#tb-kc-mfk").after(i);if(a==0){jQuery("#tb-nmfk-none").show();jQuery("#tb-nmfk-list").hide()}else{jQuery("#tb-nmfk-none").hide();jQuery("#tb-nmfk-list").show()}if(o==0){jQuery("#tb-mfk-none").show();jQuery("#tb-mfk-list").hide();jQuery("#tb-mfk-list1").hide()}else{jQuery("#tb-mfk-none").hide();jQuery("#tb-mfk-list").show();jQuery("#tb-mfk-list1").show()}jQuery('[data-tbtooltip!=""]').qtip({content:{attr:"data-tbtooltip"},style:{classes:"qtip-youtube-tubebuddy"}});$("#tb-kc-nmfc-container .lazy").lazy({appendScroll:$("#tb-kc-nmfc-container")});$("#tb-kc-mfc-container .lazy").lazy({appendScroll:$("#tb-kc-mfc-container")});if(o==0){jQuery("#tb-fk-percent").text("0.0%")}else if(a==0){jQuery("#tb-fk-percent").text("100%")}else{jQuery("#tb-fk-percent").text((100*(1*o)/(o+a)).toFixed(1)+"%")}$("#tb-mfk-count").html(' &nbsp;(<span style="padding:0px 3px">'+o+"</span>)");$("#tb-nmfk-count").html(' &nbsp;(<span style="padding:0px 3px">'+a+"</span>)");if(o>5)jQuery("#tb-kc-mfk-table").css("width","98.5%");if(a>5)jQuery("#tb-kc-nmfk-table").css("width","98.5%");jQuery("#tb-kids-center-info").hide();jQuery("#tb-kids-center-analysis").hide();jQuery("#tb-kc-scan-complete").slideDown()}catch{TBUtilities.Alert("Sorry, there was an error building the report.")}}).catch(function(e){TBUtilities.Alert('Sorry, there was an error: "'+e+'".')})};var r=function(){jQuery(document).on("click",".tb-kids-center-closex",function(){jQuery("#tb-kids-center-container").hide();TubeBuddyMenu.HideBackground()});jQuery(document).on("click","#tb-kc-mfk-tab",function(){TBUtilities.Log("Clicked - mfk tab");jQuery("#tb-kc-mfk-filter-container").show();jQuery("#tb-kc-nmfk-filter-container").hide()});jQuery(document).on("click","#tb-kc-nmfk-tab",function(){TBUtilities.Log("Clicked - nmfk tab");jQuery("#tb-kc-nmfk-filter-container").show();jQuery("#tb-kc-mfk-filter-container").hide()});jQuery(document).on("change","#tb-kc-mfk-filter",function(){TBUtilities.Log("Changed - mfk filter");var e=jQuery("#tb-kc-mfk-filter option:selected").val();if(e=="All"){$(".tb-kc-mfkr").show()}else{$(".tb-kc-mfkr").hide();$(".tb-kc-fc-filt-"+e).show()}});jQuery(document).on("change","#tb-kc-nmfk-filter",function(){TBUtilities.Log("Changed - nmfk filter");var e=jQuery("#tb-kc-nmfk-filter option:selected").val();if(e=="All"){$(".tb-kc-nmfkr").show()}else{$(".tb-kc-nmfkr").hide();$(".tb-kc-nfc-filt-"+e).show()}});jQuery(document).on("click","#tb-kc-mfk-tab",function(){jQuery("#tb-tab-nmfk-content").hide();jQuery("#tb-tab-mfk-content").show();jQuery(".tb-tabs-selected-menu-item").removeClass("tb-tabs-selected-menu-item");jQuery(this).addClass("tb-tabs-selected-menu-item")});jQuery(document).on("click","#tb-kc-nmfk-tab",function(){jQuery("#tb-tab-nmfk-content").show();jQuery("#tb-tab-mfk-content").hide();jQuery(".tb-tabs-selected-menu-item").removeClass("tb-tabs-selected-menu-item");jQuery(this).addClass("tb-tabs-selected-menu-item")});jQuery(document).on("click","#tb-kc-export",function(){var e="data:text/csv;charset=utf-8, Video Id, Video Title, Privacy, Public Rating, YouTube's Rating, Your Rating, Rated Byr\n";t.forEach(function(t){if(t.privacy!="")return;let i="";i+=t.videoId+",";i+='"'+TBUtilities.ReplaceAll(t.title,",",".")+'",';switch(t.privacy){case"VIDEO_PRIVACY_UNLISTED":i+="Unlisted, ";break;case"VIDEO_PRIVACY_PRIVATE":i+="Private, ";break;case"VIDEO_PRIVACY_PUBLIC":i+="Public, ";break;default:i+="Unknown, ";break}switch(t.audienceRestriction.effectiveRating){case"VIDEO_TARGETED_AUDIENCE_ALL":i+="Not for Kids, ";break;case"VIDEO_TARGETED_AUDIENCE_CROSSWALK":i+="For Kids, ";break;default:i+="Unknown, ";break}switch(t.audienceRestriction.systemRating){case"VIDEO_TARGETED_AUDIENCE_ALL":i+="Not for Kids, ";break;case"VIDEO_TARGETED_AUDIENCE_CROSSWALK":i+="For Kids, ";break;default:i+="-, ";break}switch(t.audienceRestriction.selfRating){case"VIDEO_TARGETED_AUDIENCE_ALL":i+="Not for Kids, ";break;case"VIDEO_TARGETED_AUDIENCE_CROSSWALK":i+="For Kids, ";break;default:i+="-, ";break}if(t.audienceRestriction.imposer=="VIDEO_TARGETED_AUDIENCE_IMPOSER_SELF"){i+="You"}else{i+="YouTube"}i+="\r\n";e+=i});var i=new Blob([e],{type:"text/csv"});var o=URL.createObjectURL(i);var a=document.createElement("a");a.setAttribute("href",o);a.setAttribute("download","channel_data.csv");document.body.appendChild(a);a.click()});jQuery(document).on("click","#tb-fc-back",function(){jQuery("#tb-kc-scan-complete").hide();jQuery("#tb-kids-center-processing").hide();jQuery("#tb-kids-center-results").show();jQuery("#tb-kids-center-analysis").show();jQuery("#tb-kids-center-info").show()});jQuery(document).on("click","#tb-kids-center-results",function(){jQuery("#tb-kc-scan-complete").show();jQuery("#tb-kids-center-processing").hide();jQuery("#tb-kids-center-results").show();jQuery("#tb-kids-center-analysis").hide();jQuery("#tb-kids-center-info").hide()});jQuery(document).on("click","#tb-kids-center-start",function(){i=false;jQuery(this).fadeOut(250,function(){jQuery("#tb-kids-center-processing").fadeIn(500);n()})});jQuery(document).on("click","#tb-kc-cancel-process",function(){jQuery("#tb-kids-center-processing").hide();jQuery("#tb-kids-center-start").show()});jQuery(document).on("click",".tb-trigger-kids-center",function(){TubeBuddyMenu.ShowBackgroundSticky();l()})};var l=function(){if(jQuery(".tb-menu-channel-thumbnail").length>0)jQuery("#tb-kc-thumbnail").append('<img style="border-radius:50%; margin-bottom:20px;" src="'+jQuery(".tb-menu-channel-thumbnail:first").attr("src")+'" />');else jQuery("#tb-kc-thumbnail").append('<img style="border-radius:50%; height:88px; width:88px; margin-bottom:20px;" src="'+jQuery("#img:first").attr("src")+'" />');jQuery("#tb-kids-center-container").show()};var u=function(){jQuery(document.body).on("CRTBLoadTubeBuddyKidsCenterTemplate",function(e,t){try{if(t.success){if(jQuery("#tb-kids-center-container").length>0||jQuery(".tb-trigger-kids-center").length>0){jQuery("#tb-kids-center-container").remove();jQuery(".tb-trigger-kids-center").remove()}t.response=TBUtilities.FixLocalHtml(DOMPurify.sanitize(t.response,DOMPurifyConfig));jQuery("body").append(t.response);a()}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyTubeBuddyKidsCenter] CRTBLoadTubeBuddyKidsCenterTemplate"})}})};return{Initialize:function(){if(TBGlobal.IsAuthenticated()){if(!e){u();s();r();e=true}else{a()}}},Show:function(){l()}}}();!function(e,t){"use strict";function i(i,o,s,r,l){function u(){k=e.devicePixelRatio>1,s=d(s),o.delay>=0&&setTimeout(function(){c(!0)},o.delay),(o.delay<0||o.combined)&&(r.e=g(o.throttle,function(e){"resize"===e.type&&(Q=w=-1),c(e.all)}),r.a=function(e){e=d(e),s.push.apply(s,e)},r.g=function(){return s=a(s).filter(function(){return!a(this).data(o.loadedName)})},r.f=function(e){for(var t=0;t<e.length;t++){var i=s.filter(function(){return this===e[t]});i.length&&c(!1,i)}},c(),a(o.appendScroll).on("scroll."+l+" resize."+l,r.e))}function d(e){var s=o.defaultImage,n=o.placeholder,r=o.imageBase,l=o.srcsetAttribute,u=o.loaderAttribute,d=o._f||{};e=a(e).filter(function(){var e=a(this),i=f(this);return!e.data(o.handledName)&&(e.attr(o.attribute)||e.attr(l)||e.attr(u)||d[i]!==t)}).data("plugin_"+o.name,i);for(var c=0,p=e.length;c<p;c++){var b=a(e[c]),h=f(e[c]),m=b.attr(o.imageBaseAttribute)||r;h===S&&m&&b.attr(l)&&b.attr(l,y(b.attr(l),m)),d[h]===t||b.attr(u)||b.attr(u,d[h]),h===S&&s&&!b.attr(L)?b.attr(L,s):h===S||!n||b.css(U)&&"none"!==b.css(U)||b.css(U,"url('"+n+"')")}return e}function c(e,t){if(!s.length)return void(o.autoDestroy&&i.destroy());for(var n=t||s,r=!1,l=o.imageBase||"",u=o.srcsetAttribute,d=o.handledName,c=0;c<n.length;c++)if(e||t||b(n[c])){var h=a(n[c]),m=f(n[c]),y=h.attr(o.attribute),g=h.attr(o.imageBaseAttribute)||l,v=h.attr(o.loaderAttribute);h.data(d)||o.visibleOnly&&!h.is(":visible")||!((y||h.attr(u))&&(m===S&&(g+y!==h.attr(L)||h.attr(u)!==h.attr(_))||m!==S&&g+y!==h.css(U))||v)||(r=!0,h.data(d,!0),p(h,m,g,v))}r&&(s=a(s).filter(function(){return!a(this).data(d)}))}function p(e,t,i,s){++j;var n=function(){T("onError",e),v(),n=a.noop};T("beforeLoad",e);var r=o.attribute,l=o.srcsetAttribute,u=o.sizesAttribute,d=o.retinaAttribute,c=o.removeAttribute,p=o.loadedName,b=e.attr(d);if(s){var h=function(){c&&e.removeAttr(o.loaderAttribute),e.data(p,!0),T(B,e),setTimeout(v,1),h=a.noop};e.off(x).one(x,n).one(C,h),T(s,e,function(t){t?(e.off(C),h()):(e.off(x),n())})||e.trigger(x)}else{var m=a(new Image);m.one(x,n).one(C,function(){e.hide(),t===S?e.attr(I,m.attr(I)).attr(_,m.attr(_)).attr(L,m.attr(L)):e.css(U,"url('"+m.attr(L)+"')"),e[o.effect](o.effectTime),c&&(e.removeAttr(r+" "+l+" "+d+" "+o.imageBaseAttribute),u!==I&&e.removeAttr(u)),e.data(p,!0),T(B,e),m.remove(),v()});var f=(k&&b?b:e.attr(r))||"";m.attr(I,e.attr(u)).attr(_,e.attr(l)).attr(L,f?i+f:null),m.complete&&m.trigger(C)}}function b(e){var t=e.getBoundingClientRect(),i=o.scrollDirection,a=o.threshold,s=m()+a>t.top&&-a<t.bottom,n=h()+a>t.left&&-a<t.right;return"vertical"===i?s:"horizontal"===i?n:s&&n}function h(){return Q>=0?Q:Q=a(e).width()}function m(){return w>=0?w:w=a(e).height()}function f(e){return e.tagName.toLowerCase()}function y(e,t){if(t){var i=e.split(",");e="";for(var o=0,a=i.length;o<a;o++)e+=t+i[o].trim()+(o!==a-1?",":"")}return e}function g(e,t){var a,s=0;return function(n,r){function l(){s=+new Date,t.call(i,n)}var u=+new Date-s;a&&clearTimeout(a),u>e||!o.enableThrottle||r?l():a=setTimeout(l,e-u)}}function v(){--j,s.length||j||T("onFinishedAll")}function T(e,t,a){return!!(e=o[e])&&(e.apply(i,[].slice.call(arguments,1)),!0)}var j=0,Q=-1,w=-1,k=!1,B="afterLoad",C="load",x="error",S="img",L="src",_="srcset",I="sizes",U="background-image";"event"===o.bind||n?u():a(e).on(C+"."+l,u)}function o(o,n){var r=this,l=a.extend({},r.config,n),u={},d=l.name+"-"+ ++s;return r.config=function(e,i){return i===t?l[e]:(l[e]=i,r)},r.addItems=function(e){return u.a&&u.a("string"===a.type(e)?a(e):e),r},r.getItems=function(){return u.g?u.g():{}},r.update=function(e){return u.e&&u.e({},!e),r},r.force=function(e){return u.f&&u.f("string"===a.type(e)?a(e):e),r},r.loadAll=function(){return u.e&&u.e({all:!0},!0),r},r.destroy=function(){return a(l.appendScroll).off("."+d,u.e),a(e).off("."+d),u={},t},i(r,l,o,u,d),l.chainable?o:r}var a=e.jQuery||e.Zepto,s=0,n=!1;a.fn.Lazy=a.fn.lazy=function(e){return new o(this,e)},a.Lazy=a.lazy=function(e,i,s){if(a.isFunction(i)&&(s=i,i=[]),a.isFunction(s)){e=a.isArray(e)?e:[e],i=a.isArray(i)?i:[i];for(var n=o.prototype.config,r=n._f||(n._f={}),l=0,u=e.length;l<u;l++)(n[e[l]]===t||a.isFunction(n[e[l]]))&&(n[e[l]]=s);for(var d=0,c=i.length;d<c;d++)r[i[d]]=e[0]}},o.prototype.config={name:"lazy",chainable:!0,autoDestroy:!0,bind:"load",threshold:500,visibleOnly:!1,appendScroll:e,scrollDirection:"both",imageBase:null,defaultImage:"data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==",placeholder:null,delay:-1,combined:!1,attribute:"data-src",srcsetAttribute:"data-srcset",sizesAttribute:"data-sizes",retinaAttribute:"data-retina",loaderAttribute:"data-loader",imageBaseAttribute:"data-imagebase",removeAttribute:!0,handledName:"handled",loadedName:"loaded",effect:"show",effectTime:0,enableThrottle:!0,throttle:250,beforeLoad:t,afterLoad:t,onError:t,onFinishedAll:t},a(e).on("load",function(){n=!0})}(window);var TubeBuddyVideoEditorStudio=function(){var e=false;var t=null;var i=null;var o=function(e,t,i,o){var a=setInterval(function(){var s=jQuery("ytcp-animatable#page-title").filter(":visible");var n=jQuery("ytcp-animatable#video-editor").filter(":visible");if(s.length>0){clearInterval(a);jQuery(s).css("z-index","999999");if(s.find(".tb-video-editor-studio-select").length<=0){jQuery(".tb-video-editor-studio-select").appendTo("div#page-title-container");jQuery(".tb-video-editor-studio-select").show()}if(e){jQuery(".tb-video-editor-studio-cards-template-checkbox").prop("checked",true);jQuery(".tb-material-checkbox-cards-text").addClass("tb-hid");jQuery(".tb-video-editor-studio-cards-template-name").removeClass("tb-hid");if(t){jQuery(".tb-video-editor-studio-cards-template-name p").text(t)}else{var r=jQuery("#entity-name").text();jQuery(".tb-video-editor-studio-cards-template-name p").text(r)}}else{jQuery(".tb-video-editor-studio-cards-template-checkbox").prop("checked",false);jQuery(".tb-video-editor-studio-cards-template-name").addClass("tb-hid")}if(i){jQuery(".tb-video-editor-studio-endscreen-template-checkbox").prop("checked",true);jQuery(".tb-material-checkbox-endscreen-text").addClass("tb-hid");jQuery(".tb-video-editor-studio-endscreen-template-name").removeClass("tb-hid");if(o){jQuery(".tb-video-editor-studio-endscreen-template-name p").text(o)}else{var r=jQuery("#entity-name").text();jQuery(".tb-video-editor-studio-endscreen-template-name p").text(r)}}else{jQuery(".tb-video-editor-studio-endscreen-template-checkbox").prop("checked",false);jQuery(".tb-video-editor-studio-endscreen-template-name").addClass("tb-hid")}}},1e3)};var a=function(){var e=TBGlobal.host+"/ModuleManager/VideoEditorStudio/VideoEditorStudio?v="+TBGlobal.versionNumber;if(loadLocalHTML&&(TBExtension.GetType()=="chrome"||TBExtension.GetType()=="firefox")){e=chrome.extension.getURL("modules/videoeditorstudio.html")}else if(loadLocalHTML&&TBExtension.GetType()=="safari"){e="modules/videoeditorstudio.html"}TBExtension.Get(e,"CRTBLoadVideoEditorStudioTemplate")};var s=function(){jQuery(document).on("click","#menu-item-2",function(){setTimeout(function(){if(jQuery(".tb-video-editor-studio-select").length<=0){a();o()}},1e3)});jQuery(document).on("click","ul#main-menu li",function(){if(jQuery(this).find("paper-icon-item").attr("id")!="missing-features-item"&&jQuery(this).find("a.menu-item-link").attr("id")!="menu-item-2"){jQuery(".tb-video-editor-studio-select").remove();jQuery(".tb-video-editor-studio-dropdown").remove()}});jQuery(document).on("click","a",function(){var e=jQuery(this).attr("id");if(e=="back-button"||e=="home-button"){jQuery(".tb-video-editor-studio-select").remove();jQuery(".tb-video-editor-studio-dropdown").remove()}});jQuery(document).on("click","ul.tb-menu-quick-list li",function(){var e=jQuery(this).find("a.tb-menu-item").text();if(e=="Dashboard"||e=="My Videos"||e=="Comments"||e=="AnalyticsRealtime"){jQuery(".tb-video-editor-studio-select").remove();jQuery(".tb-video-editor-studio-dropdown").remove()}});jQuery(document).on("click","#tb-video-editor-studio-select-menu",function(){if(jQuery(".tb-video-editor-studio-dropdown").is(":visible")){jQuery(".tb-video-editor-studio-arrow-up").hide();jQuery(".tb-video-editor-studio-arrow-down").fadeIn("slow");jQuery(".tb-video-editor-studio-dropdown").hide()}else{jQuery(".tb-video-editor-studio-arrow-down").hide();jQuery(".tb-video-editor-studio-arrow-up").fadeIn(1e3);jQuery(".tb-video-editor-studio-dropdown").show()}});jQuery(document).mouseup(function(e){var t=jQuery(".tb-video-editor-studio-dropdown");var i=jQuery("#tb-video-editor-studio-select-menu");var o=jQuery("div.ajs-dialog");if(jQuery(e.target).closest(t).length===0&&jQuery(e.target).closest(i).length===0&&jQuery(e.target).closest(o).length===0){jQuery(".tb-video-editor-studio-dropdown").hide()}});jQuery(document).on("click","#tb-video-editor-studio-apply-cards-template",function(){TubeBuddyMenu.ShowBackgroundSticky();var e=window.location.pathname.split("/");var t=e[2];var i=jQuery("#entity-name").text();var o=jQuery("ytcp-thumbnail").find("img#img-with-fallback").attr("src");jQuery(".tb-video-editor-studio-dropdown").hide();TubeBuddyCardTemplates.Show(t,i,o);var a=setInterval(function(){var e=jQuery("#tb-card-templates-container").filter(":visible");if(e.length>0){clearInterval(a);jQuery("#tb-card-templates-container").css("border-radius","5px 5px 0 0")}},500)});jQuery(document).on("click","#tb-video-editor-studio-apply-endscreen-template",function(){TubeBuddyMenu.ShowBackgroundSticky();var e=window.location.pathname.split("/");var t=e[2];var i=jQuery("#entity-name").text();var o=jQuery("ytcp-thumbnail").find("img#img-with-fallback").attr("src");jQuery(".tb-video-editor-studio-dropdown").hide();TubeBuddyEndScreenTemplatesStudio.Show(t,i,o)});jQuery(document).on("change",".tb-video-editor-studio-cards-template-checkbox",function(){var e=jQuery(this).is(":checked");var t=window.location.pathname.split("/");var i=t[2];var o=jQuery("#entity-name").text();var a=TBGlobal.host+TBGlobal.apiUrls.youTubeVideosToggleCardTemplate;var s={Id:i,Enabled:e,Title:o};if(e){u(e,i,o,a,s)}else{TBExtension.Post(a,JSON.stringify(s),"CRTBLoadEditVideoCardsStudioTemplateToggle",null,{contentType:"application/json"});jQuery(".tb-material-checkbox-cards-text").removeClass("tb-hid");jQuery(".tb-video-editor-studio-cards-template-name").addClass("tb-hid");jQuery("#tb-video-editor-studio-changes-saved-cards").hide();jQuery("#tb-video-editor-studio-changes-saved-cards").show().delay(2e3).fadeOut()}});jQuery(document).on("change",".tb-video-editor-studio-endscreen-template-checkbox",function(){var e=jQuery(this).is(":checked");var t=window.location.pathname.split("/");var i=t[2];var o=jQuery("#entity-name").text();var a=TBGlobal.host+TBGlobal.apiUrls.youTubeVideosToggleEndScreenTemplate;var s={Id:i,Enabled:e,Title:o};if(e){l(e,i,o,a,s)}else{TBExtension.Post(a,JSON.stringify(s),"CRTBLoadEditVideoEndScreenTemplateToggle",null,{contentType:"application/json"});jQuery(".tb-material-checkbox-endscreen-text").removeClass("tb-hid");jQuery(".tb-video-editor-studio-endscreen-template-name").addClass("tb-hid");jQuery("#tb-video-editor-studio-changes-saved-endscreen").hide();jQuery("#tb-video-editor-studio-changes-saved-endscreen").show().delay(2e3).fadeOut()}});jQuery(document).on("click",".tb-video-editor-studio-cards-template-name",function(){var e=window.location.pathname.split("/");var t=e[2];var i=jQuery(this).find("p").text();var o=true;var a=TBGlobal.host+TBGlobal.apiUrls.youTubeVideosToggleCardTemplate;var s={Id:t,Enabled:o,Title:i};n(o,t,i,a,s)});jQuery(document).on("click",".tb-video-editor-studio-endscreen-template-name",function(){var e=window.location.pathname.split("/");var t=e[2];var i=jQuery(this).find("p").text();var o=true;var a=TBGlobal.host+TBGlobal.apiUrls.youTubeVideosToggleEndScreenTemplate;var s={Id:t,Enabled:o,Title:i};r(o,t,i,a,s)})};var n=function(e,t,i,o,a){try{TBUtilities.Log("TubeBuddyVideoEditorStudio - editCardsTemplateName");TBUtilities.Prompt("Edit template name",i,function(i,s){if(s.length==0){TBUtilities.Alert("Please enter a name.");return}else{a={Id:t,Enabled:e,Title:s};TBUtilities.Log(a);TBExtension.Post(o,JSON.stringify(a),"CRTBLoadEditVideoCardTemplateToggle",null,{contentType:"application/json"});TBUtilities.AddAction(null,TBUtilities.ActionTypes.CardTemplates_Apply,"cardtemplates");jQuery(".tb-video-editor-studio-cards-template-name p").text(s);jQuery("#tb-video-editor-studio-changes-saved-cards").hide();jQuery("#tb-video-editor-studio-changes-saved-cards").show().delay(2e3).fadeOut()}},function(e,t){return})}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyEndScreensVideo] editCardsTemplateName"})}};var r=function(e,t,i,o,a){try{TBUtilities.Log("TubeBuddyVideoEditorStudio - editEndsTemplateName");TBUtilities.Prompt("Template name",i,function(i,s){if(s.length==0){TBUtilities.Alert("Please enter a name.");return}else{a={Id:t,Enabled:e,Title:s};TBUtilities.Log(a);TBExtension.Post(o,JSON.stringify(a),"CRTBLoadEditVideoEndScreenTemplateToggle",null,{contentType:"application/json"});TBUtilities.AddAction(null,TBUtilities.ActionTypes.EndScreenTemplates_Apply,"endscreentemplates");jQuery(".tb-video-editor-studio-endscreen-template-name p").text(s);jQuery("#tb-video-editor-studio-changes-saved-endscreen").hide();jQuery("#tb-video-editor-studio-changes-saved-endscreen").show().delay(2e3).fadeOut()}},function(e,t){return})}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyEndScreensVideo] editEndsTemplateName"})}};var l=function(e,t,i,o,a){try{TBUtilities.Log("TubeBuddyVideoEditorStudio - saveEndsTemplateChanges");TBUtilities.Prompt("Template name",i,function(i,s){if(s.length==0){TBUtilities.Alert("Please enter a name.");return}else{a={Id:t,Enabled:e,Title:s};TBUtilities.Log(a);TBExtension.Post(o,JSON.stringify(a),"CRTBLoadEditVideoEndScreenTemplateToggle",null,{contentType:"application/json"});TBUtilities.AddAction(null,TBUtilities.ActionTypes.EndScreenTemplates_Apply,"endscreentemplates");jQuery(".tb-video-editor-studio-endscreen-template-name p").text(s);jQuery(".tb-material-checkbox-endscreen-text").addClass("tb-hid");jQuery(".tb-video-editor-studio-endscreen-template-name").removeClass("tb-hid");jQuery("#tb-video-editor-studio-changes-saved-endscreen").hide();jQuery("#tb-video-editor-studio-changes-saved-endscreen").show().delay(2e3).fadeOut()}},function(e,s){s=i;a={Id:t,Enabled:false,Title:s};TBUtilities.Log(a);TBExtension.Post(o,JSON.stringify(a),"CRTBLoadEditVideoEndScreenTemplateToggle",null,{contentType:"application/json"});jQuery(".tb-video-editor-studio-endscreen-template-checkbox").prop("checked",false);return})}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyEndScreensVideo] saveEndsTemplateChanges"})}};var u=function(e,t,i,o,a){try{TBUtilities.Log("TubeBuddyVideoEditorStudio - saveCardsTemplateChanges");TBUtilities.Prompt("Template name",i,function(i,s){if(s.length==0){TBUtilities.Alert("Please enter a name.");return}else{a={Id:t,Enabled:e,Title:s};TBUtilities.Log(a);TBExtension.Post(o,JSON.stringify(a),"CRTBLoadEditVideoCardTemplateToggle",null,{contentType:"application/json"});TBUtilities.AddAction(null,TBUtilities.ActionTypes.CardTemplates_Apply,"cardtemplates");jQuery(".tb-video-editor-studio-cards-template-name p").text(s);jQuery(".tb-material-checkbox-cards-text").addClass("tb-hid");jQuery(".tb-video-editor-studio-cards-template-name").removeClass("tb-hid");jQuery("#tb-video-editor-studio-changes-saved-cards").hide();jQuery("#tb-video-editor-studio-changes-saved-cards").show().delay(2e3).fadeOut()}},function(e,s){s=i;a={Id:t,Enabled:false,Title:s};TBUtilities.Log(a);TBExtension.Post(o,JSON.stringify(a),"CRTBLoadEditVideoCardTemplateToggle",null,{contentType:"application/json"});jQuery(".tb-video-editor-studio-cards-template-checkbox").prop("checked",false);return})}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyCardsVideo] saveCardsTemplateChanges"})}};var d=function(){var e=window.location.pathname.split("/");var t=e[2];var i=TBGlobal.host+TBGlobal.apiUrls.youTubeVideosGetVideo+"?videoid="+t;TBExtension.Get(i,"CRTBEditVideoCardsStudioLoadVideo",null)};var c=function(){jQuery(document.body).on("CRTBLoadVideoEditorStudioTemplate",function(e,t){try{if(t.success){t.response=TBUtilities.FixLocalHtml(DOMPurify.sanitize(t.response,DOMPurifyConfig));jQuery("body").append(t.response);d()}else{}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyVideoEditorStudio] CRTBLoadVideoEditorStudioTemplate"})}});jQuery(document.body).on("CRTBEditVideoCardsStudioLoadVideo",function(e,i){try{if(i.success){t=jQuery.parseJSON(i.response);o(t.IsCardTemplate,t.CardTemplateName,t.IsEndScreenTemplate,t.EndScreenTemplateName)}else{}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyCardsVideo] CRTBEditVideoCardsStudioLoadVideo"})}})};return{Initialize:function(){if(TBGlobal.IsAuthenticated()){if(!e){c();a();s();e=true}else{o()}}}}}();var TubeBuddyEditVideoStudioUploadDefaults=function(){var e=false;var t=[];var i="";var o=false;var a=[];var s=null;var n=0;var r=false;var l=function(){var e=TBGlobal.host+"/ModuleManager/EditVideoStudioUploadDefaults/EditVideoStudioUploadDefaults?v="+TBGlobal.versionNumber;if(loadLocalHTML&&(TBExtension.GetType()=="chrome"||TBExtension.GetType()=="firefox")){e=chrome.extension.getURL("modules/editvideostudiouploaddefaults.html")}else if(loadLocalHTML&&TBExtension.GetType()=="safari"){e="modules/editvideostudiouploaddefaults.html"}TBExtension.Get(e,"CRTBLoadEditVideoStudioUploadDefaultsTemplate")};var u=function(){var e=setInterval(function(){if(jQuery(".tb-best-practices-plugin-container:visible").length>0){clearInterval(e);if(jQuery(".tb-edit-video-studio-upload-defaults-container:visible").length==0){jQuery(".tb-best-practices-plugin-container").before(jQuery(".tb-edit-video-studio-upload-defaults-container:last")[0].outerHTML)}if(jQuery(".tb-edit-video-studio-upload-defaults-body").is(":visible"))jQuery(".tb-edit-video-studio-upload-defaults-header:visible").trigger("click");jQuery(".tb-edit-video-studio-upload-defaults-container .tb-material-checkbox-input").removeAttr("checked")}},500)};var d=function(){var e=TBGlobal.host+TBGlobal.apiUrls.uploadDefaultsList;TBExtension.Get(e,"CREditVideoStudioUploadDefaultsGetList")};var c=function(){a=i.Tags.split(",");r=true;n=0;s=setTimeout(p,10)};var p=function(){try{if(n>=a.length){clearTimeout(s);s=null;r=false;return}var e=jQuery("#edit .title #textbox").length>0?jQuery(".tags.input-container ytcp-form-input-container #text-input"):jQuery("#outer").find("input:last:not([type=radio])");e.val(a[n++]);e.trigger("focus");e.trigger("blur");s=setTimeout(p,100)}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyEditVideoStudioUploadDefaults] addTagsOneAtATime"})}};var b=function(){return new Promise(function(e,t){if(jQuery("#tb-edit-video-studio-upload-defaults-update-title").is(":checked")&&!o){jQuery(".blockUI #tb-edit-video-studio-upload-default-status").text(" Updating title.");var a=jQuery(".title #textbox").length>0;var s=a?jQuery(".title #textbox")[0]:jQuery(".title").find("textarea")[0];jQuery(s).text(i.Title);s.focus();var n=document.createEvent("HTMLEvents");n.initEvent("input",true,true);s.dispatchEvent(n);TBUtilities.Log("[TubeBuddyEditVideoStudioUploadDefaults] updated title");e()}else{e()}})};var h=function(){return new Promise(function(e,t){if(jQuery("#tb-edit-video-studio-upload-defaults-update-description").is(":checked")&&!o){jQuery(".blockUI #tb-edit-video-studio-upload-default-status").text(" Updating description.");var a=jQuery(".title #textbox").length>0;var s=a?jQuery(".description #textbox")[0]:jQuery(".description").find("textarea")[0];jQuery(s).text(i.Description);s.focus();var n=document.createEvent("HTMLEvents");n.initEvent("input",true,true);s.dispatchEvent(n);TBUtilities.Log("[TubeBuddyEditVideoStudioUploadDefaults] updated description");e()}else{e()}})};var m=function(){return new Promise(function(e,t){if(jQuery("#tb-edit-video-studio-upload-defaults-update-tags").is(":checked")&&!o){jQuery('#clear-button[aria-label="Delete all"]').click();c();var i=setInterval(function(){if(!r){clearInterval(i);jQuery(".blockUI #tb-edit-video-studio-upload-default-status").text("");TBUtilities.Log("[TubeBuddyEditVideoStudioUploadDefaults] updated tags");e()}else{jQuery(".blockUI #tb-edit-video-studio-upload-default-status").text(" Adding tag "+n+" of "+a.length+".")}},500)}else{jQuery(".blockUI #tb-edit-video-studio-upload-default-status").text("");e()}})};var f=function(){return new Promise(function(e,t){if(!jQuery("paper-tab#basic-tab").hasClass("iron-selected")||!jQuery("ytcp-video-metadata-basics.ytcp-video-metadata-editor").is(":visible")){jQuery("paper-tab#basic-tab").click();var i=setInterval(function(){if(jQuery("ytcp-video-metadata-basics.ytcp-video-metadata-editor").is(":visible")){clearInterval(i);b().then(h).then(m).then(()=>e())}},500)}else{b().then(h).then(m).then(()=>e())}})};var y=function(){return new Promise(function(e,t){if(jQuery("#tb-edit-video-studio-upload-defaults-update-advanced").is(":checked")&&!o){jQuery(".blockUI #tb-edit-video-studio-upload-default-status").text(" Updating advanced settings.");if(!jQuery("ytcp-video-metadata-advanced.ytcp-video-metadata-editor").is(":visible"))jQuery("paper-tab#advanced-tab").click();var i=setInterval(function(){if(jQuery("ytcp-video-metadata-advanced.ytcp-video-metadata-editor").is(":visible")){clearInterval(i);v().then(T).then(j).then(Q).then(w).then(k).then(function(){e()}).catch(function(e){TBUtilities.LogError({Ex:e,Location:"TubeBuddyEditVideoStudioUploadDefaults - UpdateAdvancedSettings"})})}},500)}else{e()}})};var g=function(){return new Promise(function(e){var t=setInterval(function(){var i=jQuery('paper-listbox[role="listbox"] paper-item:visible');if(i.length>0){i.closest("#dialog").hide();clearInterval(t);e()}},100)})};var v=function(){return new Promise(function(e,t){if(jQuery(".ytcp-video-metadata-advanced ytcp-form-language-input #trigger").length>0){jQuery(".ytcp-video-metadata-advanced ytcp-form-language-input #trigger").click();g().then(function(){jQuery('[test-id="'+i.VideoLanguageAbbreviation+'"]').trigger("click");TBUtilities.Log("[TubeBuddyEditVideoStudioUploadDefaults] updated language");e()})}else{t("An error occurred applying language settings")}})};var T=function(){return new Promise(function(e,t){var o=[{index:0,testId:"VIDEO_UNCAPTIONED_REASON_UNNECESSARY_OR_NOT_SET"},{index:1,testId:"VIDEO_UNCAPTIONED_REASON_NO_US_TV_CONTENT"},{index:2,testId:"VIDEO_UNCAPTIONED_REASON_CAPTIONLESS_TV_CONTENT"},{index:3,testId:"VIDEO_UNCAPTIONED_REASON_LEGACY"},{index:4,testId:"VIDEO_UNCAPTIONED_REASON_NO_FULL_LENGTH_VIDEO"},{index:5,testId:"VIDEO_UNCAPTIONED_REASON_NOT_REQUIRED"},{index:6,testId:"VIDEO_UNCAPTIONED_REASON_EXCEPTION_GRANTED"}];if(jQuery('ytcp-form-select[label="Caption certification"] #trigger').length>0){jQuery('ytcp-form-select[label="Caption certification"] #trigger').click();g().then(function(){jQuery('[test-id="'+o[i.CaptionCertification].testId+'"]').trigger("click");TBUtilities.Log("[TubeBuddyEditVideoStudioUploadDefaults] updated caption");e()})}else{t("An error occurred applying caption settings")}})};var j=function(){return new Promise(function(e,t){var o=[{tbValue:"all_rights_reserved",testId:"VIDEO_LICENSE_STANDARD"},{tbValue:"creative_commons",testId:"VIDEO_LICENSE_CREATIVE_COMMONS"}];var a=o.filter(function(e){return e.tbValue===i.License})[0].testId;if(jQuery("#license #trigger").length>0){jQuery("#license #trigger").click();g().then(function(){jQuery('[test-id="'+a+'"]').click();TBUtilities.Log("[TubeBuddyEditVideoStudioUploadDefaults] updated license");e()})}else{t("An error occurred applying license settings")}})};var Q=function(){return new Promise(function(e,t){var o=[{tbValue:1,testId:"CREATOR_VIDEO_CATEGORY_FILM"},{tbValue:2,testId:"CREATOR_VIDEO_CATEGORY_AUTOS"},{tbValue:10,testId:"CREATOR_VIDEO_CATEGORY_MUSIC"},{tbValue:15,testId:"CREATOR_VIDEO_CATEGORY_PETS"},{tbValue:17,testId:"CREATOR_VIDEO_CATEGORY_SPORTS"},{tbValue:19,testId:"CREATOR_VIDEO_CATEGORY_TRAVEL"},{tbValue:20,testId:"CREATOR_VIDEO_CATEGORY_GADGETS"},{tbValue:0,testId:"CREATOR_VIDEO_CATEGORY_PEOPLE"},{tbValue:22,testId:"CREATOR_VIDEO_CATEGORY_PEOPLE"},{tbValue:23,testId:"CREATOR_VIDEO_CATEGORY_COMEDY"},{tbValue:24,testId:"CREATOR_VIDEO_CATEGORY_ENTERTAINMENT"},{tbValue:25,testId:"CREATOR_VIDEO_CATEGORY_NEWS"},{tbValue:26,testId:"CREATOR_VIDEO_CATEGORY_HOWTO"},{tbValue:27,testId:"CREATOR_VIDEO_CATEGORY_EDUCATION"},{tbValue:28,testId:"CREATOR_VIDEO_CATEGORY_SCIENCE"},{tbValue:29,testId:"CREATOR_VIDEO_CATEGORY_GOVERNMENT"}];var a=o.filter(function(e){return e.tbValue===i.Category})[0].testId;if(jQuery("#category #trigger").length>0){jQuery("#category #trigger").click();g().then(function(){jQuery('[test-id="'+a+'"]').click();TBUtilities.Log("[TubeBuddyEditVideoStudioUploadDefaults] updated category");e()})}else{t("An error occurred applying category settings")}})};var w=function(){return new Promise(function(e,t){var o=[{tbValue:"all",testId:"COMMENTS_MODERATION_TYPE_ALLOW_ALL"},{tbValue:"auto",testId:"COMMENTS_MODERATION_TYPE_AUTOMOD"},{tbValue:"approval",testId:"COMMENTS_MODERATION_TYPE_HOLD_ALL"},{tbValue:"false",testId:"COMMENTS_MODERATION_TYPE_DISABLED"}];var a=o.filter(function(e){return e.tbValue===i.AllowCommentsDetail})[0].testId;if(jQuery("#comment-moderation #trigger").length>0){jQuery("#comment-moderation #trigger").click();g().then(function(){jQuery('[test-id="'+a+'"]').click();TBUtilities.Log("[TubeBuddyEditVideoStudioUploadDefaults] updated comment settings");e()})}else{t("An error occurred applying comment settings")}})};var k=function(){return new Promise(function(e,t){if(jQuery('ytcp-form-checkbox[label="Users can view ratings for this video"] ytcp-checkbox-lit').attr("aria-checked")!=i.UsersCanViewRatingsForThisVideo.toString()){jQuery('ytcp-form-checkbox[label="Users can view ratings for this video"] ytcp-checkbox-lit').click();TBUtilities.Log("[TubeBuddyEditVideoStudioUploadDefaults] updated user can view ratings");e()}else{e()}})};var B=function(){return new Promise(function(e,t){if(jQuery("#tb-edit-video-studio-upload-defaults-update-visibility").is(":checked")&&!o){jQuery(".input-container.visibility #container").click();var a=setInterval(function(){if(jQuery("#privacy-radios paper-radio-button").length>0){clearInterval(a);jQuery('#privacy-radios paper-radio-button[name="'+i.Privacy.toUpperCase()+'"]').click();var t=setTimeout(function(){jQuery("ytcp-video-visibility-edit-popup #save-button").click();clearTimeout(t);e()},100)}},100)}else{e()}})};var C=function(){jQuery(document).on("click",".tb-edit-video-studio-upload-defaults-header, .tb-edit-video-studio-upload-defaults-toggle",function(e){if(jQuery(this).hasClass("tb-edit-video-studio-upload-defaults-toggle"))e.stopPropagation();if(jQuery(".tb-edit-video-studio-upload-defaults-body").is(":visible")){jQuery("#tb-edit-video-studio-upload-defaults-toggle-icon").text("arrow_drop_down");jQuery(".tb-edit-video-studio-upload-defaults-body").hide()}else{jQuery("#tb-edit-video-studio-upload-defaults-toggle-icon").text("arrow_drop_up");jQuery(".tb-edit-video-studio-upload-defaults-body").show()}});jQuery(document).on("click",".tb-edit-video-studio-upload-defaults-settings",function(){jQuery(".tb-edit-video-studio-upload-defaults-refresh").show();jQuery("paper-icon-item#settings-item").trigger("click");var e=setInterval(function(){if(jQuery(".tb-upload-defaults-studio-videos-list:visible").length>0){setTimeout(function(){jQuery(".tb-upload-defaults-studio-videos-list:visible").click();clearInterval(e)},500)}},500)});jQuery(document).on("click","#tb-edit-video-studio-upload-defaults-cancel-apply-defaults",function(){o=true;jQuery.unblockUI();jQuery(".blockUI #tb-edit-video-studio-upload-default-status").text("")});jQuery(document).on("click",".tb-edit-video-studio-upload-defaults-refresh",function(){window.location.reload()});jQuery(document).on("click",".tb-edit-video-studio-apply-upload-default",function(){if(jQuery(".tb-edit-video-studio-upload-defaults-checkbox-group .tb-material-checkbox-input:checked").length==0){TBUtilities.Alert("Please select at least one item to update.");return}o=false;var e=jQuery(".tb-edit-video-studio-upload-defaults-select:visible").val();var a=t.filter(function(t){return t.Id==e})[0];i=a;var s=jQuery("#tb-edit-video-studio-upload-defaults-block-message-template").html();var n=s.formatTemplate(i.Name);jQuery.blockUI({message:n,blockMsgClass:"tb-upload-studio-block-msg",overlayCSS:{backgroundColor:"#fff",cursor:"unavailable",zIndex:"2210",opacity:.6}});jQuery(".blockUI #tb-edit-video-studio-upload-defaults-cancel-apply-defaults").hide();setTimeout(function(){jQuery(".blockUI #tb-edit-video-studio-upload-defaults-cancel-apply-defaults").show()},3e4);if(jQuery("#tb-edit-video-studio-upload-defaults-update-advanced").is(":checked")){y().then(f).then(B).then(function(){jQuery.unblockUI();jQuery(".blockUI #tb-edit-video-studio-upload-default-status").text("")})}else{f().then(B).then(function(){jQuery.unblockUI();jQuery(".blockUI #tb-edit-video-studio-upload-default-status").text("")})}})};var x=function(){jQuery(document.body).on("CRTBLoadEditVideoStudioUploadDefaultsTemplate",function(e,t){try{if(t.success){t.response=TBUtilities.FixLocalHtml(DOMPurify.sanitize(t.response,DOMPurifyConfig));jQuery("body").append(t.response);u();d()}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyEditVideoStudioUploadDefaults] CRTBLoadEditVideoStudioUploadDefaltsTemplate"})}});jQuery(document.body).on("CREditVideoStudioUploadDefaultsGetList",function(e,i){try{if(i.success){t=[];jQuery.each(JSON.parse(i.response),function(e,i){t.push(i)});if(t.length>0){var o=jQuery(".tb-edit-video-studio-upload-defaults-select");o.empty();jQuery.each(t,function(e,t){o.append(jQuery("<option></option>").attr("value",t.Id).text(t.Name))});jQuery("#tb-edit-video-studio-upload-defaults-no-profiles").hide();jQuery("#tb-edit-video-studio-upload-defaults-has-profiles").show()}else{jQuery("#tb-edit-video-studio-upload-defaults-has-profiles").hide();jQuery("#tb-edit-video-studio-upload-defaults-no-profiles").show()}}}catch(e){TBUtilities.LogError({Exception:e,Location:"[TubeBuddyEditVideoStudioUploadDefaults] CREditVideoStudioUploadDefaultsGetList"})}})};return{Initialize:function(){if(TBGlobal.IsAuthenticated()){if(!e){x();l();C();e=true}else{u()}}}}}();const FetchUtilities=function(){const e=(e,i)=>{let o="include";if(e.data.ajaxOptions.credentials===false){o="omit"}let a={method:e.data.ajaxOptions.type,credentials:o,mode:e.mode,cache:e.data.ajaxOptions.cache===true?"default":"no-cache",headers:{}};for(let t in e.data.ajaxOptions.headers){a.headers[t]=e.data.ajaxOptions.headers[t]}if(e.data.ajaxOptions.contentType){a.headers["Content-Type"]=e.data.ajaxOptions.contentType}if(a.method.toLowerCase()==="post"&&e.data.ajaxOptions.data){if(e.data.ajaxOptions.dataIsSearlizedFormData){let o=JSON.parse(e.data.ajaxOptions.data);const a=Object.keys(o);let s=new FormData;for(const e of a){switch(e.toLowerCase()){case"imagefile":{try{let a=t(o[e]);s.append(e,a,"blob")}catch(e){console.log(e);i({success:false,response:e});return isAsyn}break}case"video_file_chunk":{try{let a=t(o[e]);s.delete(e);s.append(e,a)}catch(e){console.log(e);i({success:false,response:e});return isAsyn}break}case"fb-thumb":{try{let a=t(o[e]);s.delete("fb-thumb");s.append("thumb",a,"image/jpeg")}catch(e){console.log(e);i({success:false,response:e});return isAsyn}break}case"choices_as_string":{try{let t=o[e];let a=t.split(",");s.delete("choices_as_string");for(let e=0;e<a.length;e++){s.append("choices",a[e])}}catch(e){console.log(e);i({success:false,response:e});return isAsyn}break}default:{s.append(e,o[e]);break}}}e.data.ajaxOptions.data=s}a.body=e.data.ajaxOptions.data}let s=window;if(e.data.ajaxOptions.useContent&&e.data.ajaxOptions.useContent===true){s=content}request=s.fetch(e.data.ajaxOptions.url,a).then(function(e){if(e.ok){e.text().then(function(e){i({success:true,response:e})})}else{i({success:false,response:e.status})}}).catch(function(e){console.log("tb-xhr",e);i({success:false,response:"",error:e})})};const t=e=>{"use strict";let t,i;if(e.split(",")[0].indexOf("base64")!==-1){t=atob(e.split(",")[1])}else{t=decodeURI(e.split(",")[1])}i=e.split(",")[0].split(":")[1].split(";")[0];let o=new Array;for(let e=0;e<t.length;e++){o[e]=t.charCodeAt(e)}return new Blob([new Uint8Array(o)],{type:i})};return{MakeFetchRequest:e}}();var TubeBuddyGlobalHasInitialized=false;jQuery(document).ready(function(){if(!TubeBuddyGlobalHasInitialized&&window.top===window){TubeBuddyGlobalHasInitialized=true;TBGlobal.Initialize()}});